/**
 * vizabi - Vizabi Framework, Interactive charts and visualization tools animated through time
 * @version v0.40.14
 * @build timestamp Wed Mar 06 2019 13:38:10 GMT+0100 (CET)
 * @link http://vizabi.org
 * @license BSD-3-Clause
 */

!function(t,e){"object"==typeof exports&&"object"==typeof module?module.exports=e():"function"==typeof define&&define.amd?define("Vizabi",[],e):"object"==typeof exports?exports.Vizabi=e():t.Vizabi=e()}(window,function(){return function(t){var e={};function n(i){if(e[i])return e[i].exports;var r=e[i]={i:i,l:!1,exports:{}};return t[i].call(r.exports,r,r.exports,n),r.l=!0,r.exports}return n.m=t,n.c=e,n.d=function(t,e,i){n.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:i})},n.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},n.t=function(t,e){if(1&e&&(t=n(t)),8&e)return t;if(4&e&&"object"==typeof t&&t&&t.__esModule)return t;var i=Object.create(null);if(n.r(i),Object.defineProperty(i,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var r in t)n.d(i,r,function(e){return t[e]}.bind(null,r));return i},n.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return n.d(e,"a",e),e},n.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},n.p="",n(n.s=192)}([function(t,e,n){var i=n(3),r=n(22),a=n(14),s=n(15),o=n(23),l=function(t,e,n){var c,u,h,d,f=t&l.F,p=t&l.G,v=t&l.S,g=t&l.P,m=t&l.B,b=p?i:v?i[e]||(i[e]={}):(i[e]||{}).prototype,y=p?r:r[e]||(r[e]={}),_=y.prototype||(y.prototype={});for(c in p&&(n=e),n)h=((u=!f&&b&&void 0!==b[c])?b:n)[c],d=m&&u?o(h,i):g&&"function"==typeof h?o(Function.call,h):h,b&&s(b,c,h,t&l.U),y[c]!=h&&a(y,c,d),g&&_[c]!=h&&(_[c]=h)};i.core=r,l.F=1,l.G=2,l.S=4,l.P=8,l.B=16,l.W=32,l.U=64,l.R=128,t.exports=l},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.getOSname=e.normaliseLink=e.getBrowserDetails=e.getSubtitle=e.replaceNumberSpacesToNonBreak=e.px2num=e.getProp=e.isFunction=e.isMobileOrTablet=e.capitalize=e.setIcon=e.pruneTree=e.isTouchDevice=e.debounce=e.memoize=e.post=e.get=e.ajax=e.interpolatePoint=e.interpolateVector=e.nestArrayToValues=e.nestArrayToObjWithFlatKeys=e.nestArrayToObj=e.hashCode=e.clearDelay=e.delay=e.defer=e.diffObject=e.arrayLast=e.arrayMedian=e.arraySum=e.arrayMean=e.arrayMax=e.arrayMin=e.values=e.keys=e.throttle=e.hasClass=e.classed=e.removeClass=e.addClass=e.countDecimals=e.error=e.groupEnd=e.groupCollapsed=e.warn=e.timeStamp=e.areaToRadius=e.cathetus=e.hypotenuse=e.radiusToArea=e.preventAncestorScrolling=e.matchAny=e.filterAny=e.filter=e.find=e.uniqueLast=e.unique=e.without=e.deepClone=e.clone=e.merge=e.deepExtend=e.extend=e.forEach=e.strToFloat=e.roundStep=e.findScrollableAncestor=e.getViewportPosition=e.comparePlainObjects=e.deepArrayEquals=e.arrayEquals=e.isPlainObject=e.isNumber=e.isEmpty=e.isNaN=e.isString=e.isDate=e.isObject=e.isArray=e.isElement=e.uniqueId=e.printAutoconfigResult=e.approxEqual=e.d3text=e.d3json=void 0;var i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t};e.makeAbsoluteContext=function(t,e){return function(n,i){var r=e.getBoundingClientRect(),a=t.getScreenCTM();return{x:a.a*n+a.c*i+a.e-r.left,y:a.b*n+a.d*i+a.f-r.top}}},e.firstBy=function(){function t(t){return t}function e(t){return"string"==typeof t?t.toLowerCase():t}return function n(i,r){var a="function"==typeof this&&this;var s=function(n,i){if(i="number"==typeof i?{direction:i}:i||{},"function"!=typeof n){var r=n;n=function(t){return t[r]?t[r]:""}}if(1===n.length){var a=n,s=i.ignoreCase?e:t;n=function(t,e){return s(a(t))<s(a(e))?-1:s(a(t))>s(a(e))?1:0}}return-1===i.direction?function(t,e){return-n(t,e)}:n}(i,r);var o=a?function(t,e){return a(t,e)||s(t,e)}:s;o.thenBy=n;return o}},e.transform=function(t){var e=t.transform.baseVal.consolidate().matrix,n=e.a,i=e.b,r=e.c,a=e.d,s=e.e,o=e.f;return function(t,e,n,i,r,a){var s=void 0,o=void 0,l=void 0;return(s=Math.sqrt(t*t+e*e))&&(t/=s,e/=s),(l=t*n+e*i)&&(n-=t*l,i-=e*l),(o=Math.sqrt(n*n+i*i))&&(n/=o,i/=o,l/=o),t*i<e*n&&(t=-t,e=-e,l=-l,s=-s),{translateX:r,translateY:a,rotate:Math.atan2(e,t)*Math.PI/180,skewX:Math.atan(l)*Math.PI/180,scaleX:s,scaleY:o}}(n,i,r,a,s,o)},e.getKey=function(t,e){for(var n=t[e[0]],i=1,r=e.length;i<r;i++)n=n+","+t[e[i]];return n};var r,a=n(397),s=(r=a)&&r.__esModule?r:{default:r};e.d3json=function(t,e){d3.json(t).then(function(t){return e(null,t)}).catch(function(t){return e(t)})},e.d3text=function(t,e){d3.text(t).then(function(t){return e(null,t)}).catch(function(t){return e(t)})},e.approxEqual=function(t,e,n){return n=n||0,e>0?(1-n)*e<=t&&t<=e*(1+n):e<0?(1+n)*e<=t&&t<=e*(1-n):Math.abs(t)<=n},e.printAutoconfigResult=function(t){console.info("AUTOCONFIG: "+t._name+(t.isHook()?" of "+t._parent._name:"")+" choses "+(t.dim||t.which)+" from "+(t.dataSource?t.dataSource._name:"<DATA SOURCE MISSING!>")+" to be "+("entities"===t._type||"time"===t._type?"DIM":"WHICH"))},e.uniqueId=(o=0,function(t){return t?t+(o+=1):o+=1}),e.isElement=function(t){return!(!t||1!==t.nodeType)};var o,l=e.isArray=Array.isArray||function(t){return"[object Array]"===Object.prototype.toString.call(t)},c=e.isObject=function(t){return"object"===(void 0===t?"undefined":i(t))&&!!t},u=(e.isDate=function(t){return t instanceof Date},e.isString=function(t){return"string"==typeof t}),h=e.isNaN=function(t){return f(t)&&t!==+t},d=e.isEmpty=function(t){return 0===Object.keys(t).length&&t.constructor===Object},f=e.isNumber=function(t){return"number"==typeof t||!!t&&"object"===(void 0===t?"undefined":i(t))&&"[object Number]"===Object.prototype.toString.call(t)},p=e.isPlainObject=function(t){return null!==t&&"[object Object]"===Object.prototype.toString.call(t)},v=(e.arrayEquals=function(t,e){if(t===e)return!0;if(null==t||null==e)return!1;if(t.length!=e.length)return!1;for(var n=0;n<t.length;++n)if(t[n]!==e[n])return!1;return!0},e.deepArrayEquals=function(t,e){if(t===e)return!0;if(null==t||null==e)return!1;if(t.length!=e.length)return!1;for(var n=0;n<t.length;++n)if(p(t[n])&&p(e[n])){if(!g(t[n],e[n]))return!1}else if(t[n]!==e[n])return!1;return!0}),g=e.comparePlainObjects=function(t,e){var n=function(t){if(void 0===t)return"undefined";if(null===t)return"null";var e=void 0===t?"undefined":i(t);return"object"===e&&(e=function(t){return Object.prototype.toString.call(t).match(/^\[object\s(.*)\]$/)[1]}(t).toLowerCase()),"number"===e?t.toString().indexOf(".")>0?"float":"integer":e},r=function(t,e){if(t===e)return!0;for(var n in t){if(!e.hasOwnProperty(n))return!1;if(!s(t[n],e[n]))return!1}for(var i in e)if(!t.hasOwnProperty(i))return!1;return!0},a={array:function(t,e){if(t===e)return!0;if(t.length!==e.length)return!1;for(var n=0;n<t.length;n++)if(!s(t[n],e[n]))return!1;return!0}};a.object=r,a.date=function(t,e){return t.getTime()===e.getTime()},a.regexp=function(t,e){return t.toString()===e.toString()};var s=function(t,e){if(t!==e){var i=n(t);return i===n(e)&&(a.hasOwnProperty(i)?a[i](t,e):t==e)}return!0};return r(t,e)},m=(e.getViewportPosition=function(t){for(var e=0,n=0;t;)e+=t.offsetLeft-t.scrollLeft+t.clientLeft,n+=t.offsetTop-t.scrollTop+t.clientTop,t=t.offsetParent;return{x:e,y:n}},e.findScrollableAncestor=function(t){for(var e=["scroll","auto"];t=t.parentNode;){if(t.scrollHeight>t.clientHeight&&-1!==e.indexOf(d3.select(t).style("overflow")))return t}return null},e.roundStep=function(t,e){return Math.round(t/e)*e},e.strToFloat=function(t){return+t.replace(/[^\d.-]/g,"")},e.forEach=function(t,e,n){if(t){var i=void 0,r=void 0;if(l(t))for(r=t.length,i=0;i<r;i+=1){if(!1===e.apply(n,[t[i],i]))break}else{var a=Object.keys(t);for(r=a.length,i=0;i<r;i+=1){if(!1===e.apply(n,[t[a[i]],a[i]]))break}}}});e.extend=function(t){var e=Array.prototype.slice.call(arguments,1);return m(e,function(e,n){m(e,function(n,i){e.hasOwnProperty(i)&&(t[i]=n)})}),t};function b(t){return Boolean(t instanceof Date||t instanceof RegExp)}function y(t){if(t instanceof Date)return new Date(t.getTime());if(t instanceof RegExp)return new RegExp(t);throw new Error("Unexpected situation")}function _(t){var e=[];return m(t,function(t,n){"object"===(void 0===t?"undefined":i(t))&&null!==t?l(t)?e[n]=_(t):b(t)?e[n]=y(t):e[n]=M({},t):e[n]=t}),e}var M=e.deepExtend=function t(){if(arguments.length<1||"object"!==i(arguments[0]))return!1;if(arguments.length<2)return arguments[0];var e=arguments[0],n="boolean"==typeof arguments[arguments.length-1],r=n&&arguments[arguments.length-1],a=Array.prototype.slice.call(arguments,1,n?-1:arguments.length),s=void 0,o=void 0;return m(a,function(n){"object"!==(void 0===n?"undefined":i(n))||l(n)||m(Object.keys(n),function(a){o=e[a],(s=n[a])===e||("object"!==(void 0===s?"undefined":i(s))||null===s||s._data?e[a]=s:l(s)?e[a]=_(s):b(s)?e[a]=y(s):"object"!==(void 0===o?"undefined":i(o))||null===o||l(o)?e[a]=t({},s):r&&d(s)?e[a]={}:e[a]=t(o,s,r))})}),e},w=(e.merge=function(t){var e=Array.prototype.slice.call(arguments,1);return m(e,function(e,n){m(e,function(n,i){e.hasOwnProperty(i)&&(t.hasOwnProperty(i)?(l(t[i])||(t[i]=[t[i]]),t[i].push(n)):t[i]=n)})}),t},e.clone=function(t,e,n){if(l(t))return t.slice(0);var i={};return m(t,function(r,a){e&&-1===e.indexOf(a)||n&&-1!==n.indexOf(a)||t.hasOwnProperty(a)&&(i[a]=r)}),i},e.deepClone=function t(e){var n={};return l(e)&&(n=[]),m(e,function(e,i){c(e)||l(e)?n[i]=t(e):n[i]=e}),n},e.without=function(t,e){var n=t.indexOf(e);return-1!==n&&t.splice(n,1),t},e.unique=function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:function(t){return t},n={};return t.filter(function(t){var i=e(t);return!n.hasOwnProperty(i)&&(n[i]=1,!0)})},e.uniqueLast=function(t,e){var n={},i=[];e||(e=function(t){return t});for(var r=0,a=t.length;r<a;r+=1){var s=e(t[r]);n.hasOwnProperty(s)&&i.splice(n[s],1),i.push(t[r]),n[s]=i.length-1}return i},e.find=function(t,e){var n=void 0;return m(t,function(t){if(e(t))return n=t,!1}),n},e.filter=function(t,e){for(var n=-1,i=t.length,r=-1,a=[],s=Object.keys(e),o=s.length,l=void 0,c=void 0;(n+=1)<i;){var u=t[n],h=!0;for(l=0;l<o;l+=1)if(c=s[l],!u.hasOwnProperty(c)||u[c]!==e[c]){h=!1;break}h&&(a[r+=1]=u)}return a},e.filterAny=function(t,e,n){for(var i=-1,r=t.length,a=-1,s=[],o=Object.keys(e),l=o.length,c=void 0,u=void 0;(i+=1)<r;){var h=t[i],d=!0;for(c=0;c<l;c+=1)if(u=o[c],!h.hasOwnProperty(u)||!w(h[u],e[u],n)){d=!1;break}d&&(s[a+=1]=h)}return s},e.matchAny=function(t,e,n){l(t)||(t=[t]),n||(n="*");for(var i=!1,r=0;r<t.length;r++){var a=t[r];if(!l(e)&&a==e){i=!0;break}if(l(e)){for(var s=-1,o=0;o<e.length;o++){var c=e[o];if(!(l(c)||c!=a&&c!==n)){s=o;break}if(l(c)){var u=c[0],h=c[1]||u;if(a>=u&&a<=h){s=o;break}}}if(-1!==s){i=!0;break}}}return i}),x=(e.preventAncestorScrolling=function(t){var e=!1;t.on("mousewheel",function(n,i){var r=this.scrollTop,a=this.scrollHeight,s=t.node().offsetHeight,o=d3.event.wheelDelta,l=o>0,c=function(t){return function(){var e=this,n=d3.interpolateNumber(this.scrollTop,t);return function(t){e.scrollTop=n(t)}}};if(l?l&&(o>r&&r>0?(t.transition().delay(0).duration(0).tween("scrolltween",c(0)),e=!0,setTimeout(function(){e=!1},2e3)):a==s+r&&(e=!1)):-o>a-s-r&&a!=s+r?(t.transition().delay(0).duration(0).tween("scrolltween",c(a)),e=!0,setTimeout(function(){e=!1},2e3)):0==r&&(e=!1),e)return d3.event.stopPropagation(),d3.event.preventDefault(),d3.event.returnValue=!1,!1})},e.radiusToArea=function(t){return t*t*Math.PI},e.hypotenuse=function(t,e){return Math.sqrt(t*t+e*e)},e.cathetus=function(t,e){return Math.sqrt(t*t-e*e)},e.areaToRadius=function(t){return Math.sqrt(t/Math.PI)},e.timeStamp=function(t){console&&"function"==typeof console.timeStamp&&console.timeStamp(t)},e.warn=function(t){return t=Array.prototype.slice.call(arguments).map(function(t){return t instanceof Object?JSON.stringify(t,null,4):t}).join(" "),console&&"function"==typeof console.warn&&console.warn(t),!0}),S=(e.groupCollapsed=function(t){t=Array.prototype.slice.call(arguments).join(" "),console&&"function"==typeof console.groupCollapsed&&console.groupCollapsed(t)},e.groupEnd=function(){console&&"function"==typeof console.groupEnd&&console.groupEnd()},e.error=function(t){console&&"function"==typeof console.error&&(t.stack?console.error(t.stack):console.error(t),arguments.length>1&&console.error.apply(this,Array.prototype.slice.call(arguments,1)))},e.countDecimals=function(t){return Math.floor(t.valueOf())===t.valueOf()?0:t.toString().split(".")[1].length||0},e.addClass=function(t,e){t.classList?t.classList.add(e):t.className+=" "+e}),z=e.removeClass=function(t,e){t.classList?t.classList.remove(e):t.className=t.className.replace(new RegExp("(^|\\b)"+e.split(" ").join("|")+"(\\b|$)","gi")," ")},O=(e.classed=function(t,e,n){if(!0===n)S(t,e);else{if(!1!==n)return O(t,e);z(t,e)}},e.hasClass=function(t,e){return t.classList?t.classList.contains(e):new RegExp("(^| )"+e+"( |$)","gi").test(t.className)}),k=(e.throttle=function(t,e){var n=!1,i=void 0,r=void 0,a=void 0,s=function(){n&&(n=!1,t.apply(r,i))},o=function(){if(a>Date.now())return n=!0,i=arguments,void(r=this);a=Date.now()+e,n=!1,t.apply(this,arguments),setTimeout(function(){s()},e)};return o.recallLast=s,o},e.keys=function(t){return Object.keys(t)},e.values=function(t){for(var e=[],n=Object.keys(t),i=n.length,r=0;r<i;r+=1)e.push(t[n[r]]);return e},e.arrayMin=function(t){return t.reduce(function(t,e){return t<e?t:e})},e.arrayMax=function(t){return t.reduce(function(t,e){return t>e?t:e})},e.arrayMean=function(t){return k(t)/t.length},e.arraySum=function(t){return t.reduce(function(t,e){return t+e})}),E=(e.arrayMedian=function(t){t=t.sort(function(t,e){return t-e});var e=Math.floor((t.length-1)/2);return t.length%2?t[e]:(t[e]+t[e+1])/2},e.arrayLast=function(t){return t.length?t[t.length-1]:null},e.diffObject=function t(e,n){var i={};return m(n,function(n,r){!e.hasOwnProperty(r)&&p(n)&&(i[r]=t({},n))}),m(e,function(e,r){if(n.hasOwnProperty(r)){if(e!==n[r])if(p(e)&&p(n[r]))if(d(e))d(n[r])||(i[r]={});else{var a=t(e,n[r]);Object.keys(a).length>0&&(i[r]=a)}else l(e)&&l(n[r])&&v(e,n[r])||(i[r]=e)}else i[r]=e}),i},e.defer=function(t){setTimeout(t,1)},e.delay=function(t){return new Promise(function(e){return setTimeout(e,t)})},e.clearDelay=function(t){return clearTimeout(t)},e.hashCode=function(t){u(t)||(t=JSON.stringify(t));var e=0,n=t.length;if(0===n)return e;for(var i=0;i<n;i+=1)e=(e<<5)-e+t.charCodeAt(i),e&=e;return e.toString()},e.nestArrayToObj=function t(e){if(!e||!e.length||!e[0].key)return e;for(var n={},i=0;i<e.length;i++)n[e[i].key]=t(e[i].values);return n},e.nestArrayToObjWithFlatKeys=function t(e){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},i=arguments[2],r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"";if(!e||!e.length||!e[0].key)return i?(!n[i+="]"]&&(n[i]={}),n[i][r]=e):n[r]=e,e;r&&(i=i?i+","+JSON.stringify(r):"["+JSON.stringify(r));for(var a=0;a<e.length;a++)t(e[a].values||e[a].value,n,i,e[a].key);return n},e.nestArrayToValues=function t(e){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[];if(e&&e.length&&e[0].key){for(var i=0;i<e.length;i++)t(e[i].values||e[i].value,n);return n}n.push.apply(n,function(t){if(Array.isArray(t)){for(var e=0,n=Array(t.length);e<t.length;e++)n[e]=t[e];return n}return Array.from(t)}(e))},e.interpolateVector=function(){},e.interpolatePoint=function(t,e,n,i,r,a,o,l){if(!t||0===t.length)return x("interpolatePoint failed because incoming array is empty. It was "+n),null;if("constant"===e)return n;if("property"===e)return t[0][n];if(l){if(a-t[0][r]<=0)return t[0][n];if(a-t[t.length-1][r]>=0)return t[t.length-1][n]}else if(a<t[0][r]||a>t[t.length-1][r])return null;if(i||0===i||(i=d3.bisectLeft(t.map(function(t){return t[r]}),a)),0===i)return t[0][n];if(void 0===t[i]||null===t[i][n]||null===t[i-1][n]||""===t[i][n])return x("interpolatePoint failed because next/previous points are bad in "+n),null;var c=s.default[o||"linear"](t[i-1][r],t[i][r],t[i-1][n],t[i][n],a);return n===r&&(c=new Date(c)),h(c)&&(x("interpolatePoint failed because result is NaN. It was "+n),c=null),c},e.ajax=function(t){var e=new XMLHttpRequest;e.open(t.method,t.url,!0),"POST"!==t.method||t.json?"POST"===t.method&&t.json&&e.setRequestHeader("Content-Type","application/json; charset=UTF-8"):e.setRequestHeader("Content-Type","application/x-www-form-urlencoded; charset=UTF-8"),e.onload=function(){if(e.status>=200&&e.status<400){var n=t.json?JSON.parse(e.responseText):e.responseText;t.success&&t.success(n)}else t.error&&t.error()},e.onerror=function(){t.error&&t.error()},e.send(t.data)});e.get=function(t,e,n,i,r){m(e=e||[],function(t,n){e.push(n+"="+t)}),t=e.length?t+"?"+e.join("&"):t,E({method:"GET",url:t,success:n,error:i,json:r})},e.post=function(t,e,n,i,r){E({method:"POST",url:t,success:n,error:i,json:r,data:e})},e.memoize=function(t){return function(){for(var e=Array.prototype.slice.call(arguments),n="",i=e.length,r=null;i--;)n+=(r=e[i])===Object(r)?JSON.stringify(r):r,t.memoize||(t.memoize={});return n in t.memoize?t.memoize[n]:t.memoize[n]=t.apply(this,e)}},e.debounce=function(t,e,n){var i=void 0;return function(){var r=this,a=arguments,s=n&&!i;clearTimeout(i),i=setTimeout(function(){i=null,n||t.apply(r,a)},e),s&&t.apply(r,a)}},e.isTouchDevice=function(){return null!=((d3.event||{}).sourceCapabilities||{}).firesTouchEvents?d3.event.sourceCapabilities.firesTouchEvents:!!("ontouchstart"in window||window.DocumentTouch&&document instanceof DocumentTouch)},e.pruneTree=function t(e,n){var i={},r=[];return e.hasOwnProperty("children")&&(r=e.children.map(function(e){return t(e,n)}).filter(function(t){return 0!==Object.keys(t).length})),(0!=r.length||n(e))&&m(e,function(t,e){i[e]=t}),0!=r.length&&(i.children=r),i},e.setIcon=function(t,e){return t.selectAll("*").remove(),t.node().appendChild(t.node().ownerDocument.importNode((new DOMParser).parseFromString(e,"application/xml").documentElement,!0)),t};e.capitalize=function(t){return t.slice(0,1).toUpperCase()+t.slice(1).toLowerCase()},e.isMobileOrTablet=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:navigator.userAgent||navigator.vendor||window.opera;return/(android|bb\d+|meego).+mobile|avantgo|bada\/|blackberry|blazer|compal|elaine|fennec|hiptop|iemobile|ip(hone|od)|iris|kindle|lge |maemo|midp|mmp|mobile.+firefox|netfront|opera m(ob|in)i|palm( os)?|phone|p(ixi|re)\/|plucker|pocket|psp|series(4|6)0|symbian|treo|up\.(browser|link)|vodafone|wap|windows ce|xda|xiino|android|ipad|playbook|silk/i.test(t)||/1207|6310|6590|3gso|4thp|50[1-6]i|770s|802s|a wa|abac|ac(er|oo|s-)|ai(ko|rn)|al(av|ca|co)|amoi|an(ex|ny|yw)|aptu|ar(ch|go)|as(te|us)|attw|au(di|-m|r |s )|avan|be(ck|ll|nq)|bi(lb|rd)|bl(ac|az)|br(e|v)w|bumb|bw-(n|u)|c55\/|capi|ccwa|cdm-|cell|chtm|cldc|cmd-|co(mp|nd)|craw|da(it|ll|ng)|dbte|dc-s|devi|dica|dmob|do(c|p)o|ds(12|-d)|el(49|ai)|em(l2|ul)|er(ic|k0)|esl8|ez([4-7]0|os|wa|ze)|fetc|fly(-|_)|g1 u|g560|gene|gf-5|g-mo|go(\.w|od)|gr(ad|un)|haie|hcit|hd-(m|p|t)|hei-|hi(pt|ta)|hp( i|ip)|hs-c|ht(c(-| |_|a|g|p|s|t)|tp)|hu(aw|tc)|i-(20|go|ma)|i230|iac( |-|\/)|ibro|idea|ig01|ikom|im1k|inno|ipaq|iris|ja(t|v)a|jbro|jemu|jigs|kddi|keji|kgt( |\/)|klon|kpt |kwc-|kyo(c|k)|le(no|xi)|lg( g|\/(k|l|u)|50|54|-[a-w])|libw|lynx|m1-w|m3ga|m50\/|ma(te|ui|xo)|mc(01|21|ca)|m-cr|me(rc|ri)|mi(o8|oa|ts)|mmef|mo(01|02|bi|de|do|t(-| |o|v)|zz)|mt(50|p1|v )|mwbp|mywa|n10[0-2]|n20[2-3]|n30(0|2)|n50(0|2|5)|n7(0(0|1)|10)|ne((c|m)-|on|tf|wf|wg|wt)|nok(6|i)|nzph|o2im|op(ti|wv)|oran|owg1|p800|pan(a|d|t)|pdxg|pg(13|-([1-8]|c))|phil|pire|pl(ay|uc)|pn-2|po(ck|rt|se)|prox|psio|pt-g|qa-a|qc(07|12|21|32|60|-[2-7]|i-)|qtek|r380|r600|raks|rim9|ro(ve|zo)|s55\/|sa(ge|ma|mm|ms|ny|va)|sc(01|h-|oo|p-)|sdk\/|se(c(-|0|1)|47|mc|nd|ri)|sgh-|shar|sie(-|m)|sk-0|sl(45|id)|sm(al|ar|b3|it|t5)|so(ft|ny)|sp(01|h-|v-|v )|sy(01|mb)|t2(18|50)|t6(00|10|18)|ta(gt|lk)|tcl-|tdg-|tel(i|m)|tim-|t-mo|to(pl|sh)|ts(70|m-|m3|m5)|tx-9|up(\.b|g1|si)|utst|v400|v750|veri|vi(rg|te)|vk(40|5[0-3]|-v)|vm40|voda|vulc|vx(52|53|60|61|70|80|81|83|85|98)|w3c(-| )|webc|whit|wi(g |nc|nw)|wmlb|wonu|x700|yas-|your|zeto|zte-/i.test(t.substr(0,4))};e.isFunction=function(t){return"function"==typeof t},e.getProp=function(t,e,n){for(;e.length;){var i=e.shift();if(!t.hasOwnProperty(i))return n;t=t[i]}return t},e.px2num=function(t){return u(t)&&t.endsWith("px")?parseFloat(t):console.warn("Strange pixels value: "+t)||t},e.replaceNumberSpacesToNonBreak=function(t){return t?t.replace(/\d{1,3}(?: \d{3})+(?=\W)/g,function(t){return t.replace(/ /g," ")}):t},e.getSubtitle=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",e=arguments[1],n=t.replace(e,"");","===n[0]&&(n=n.slice(1));var i=/^\((.*)\)$|.*/.exec(n.trim());return i[1]||i[0]||""},e.getBrowserDetails=function(){navigator.appVersion;var t=navigator.userAgent,e=navigator.appName,n=""+parseFloat(navigator.appVersion),i=parseInt(navigator.appVersion,10),r=void 0,a=void 0,s=void 0,o=navigator.userAgent.toLowerCase().indexOf(" electron/")>-1;return-1!=(a=t.indexOf("Opera"))?(e="Opera",n=t.substring(a+6),-1!=(a=t.indexOf("Version"))&&(n=t.substring(a+8))):-1!=(a=t.indexOf("MSIE"))?(e="Microsoft Internet Explorer",n=t.substring(a+5)):-1!=(a=t.indexOf("Chrome"))?(e="Chrome",n=t.substring(a+7)):-1!=(a=t.indexOf("Safari"))?(e="Safari",n=t.substring(a+7),-1!=(a=t.indexOf("Version"))&&(n=t.substring(a+8))):-1!=(a=t.indexOf("Firefox"))?(e="Firefox",n=t.substring(a+8)):(r=t.lastIndexOf(" ")+1)<(a=t.lastIndexOf("/"))&&(e=t.substring(r,a),n=t.substring(a+1),e.toLowerCase()==e.toUpperCase()&&(e=navigator.appName)),-1!=(s=n.indexOf(";"))&&(n=n.substring(0,s)),-1!=(s=n.indexOf(" "))&&(n=n.substring(0,s)),i=parseInt(""+n,10),h(i)&&(n=""+parseFloat(navigator.appVersion),i=parseInt(navigator.appVersion,10)),(o?"Electron ":"")+e+" "+i+" ("+n+")"},e.normaliseLink=function(t){return 0===t.indexOf("http://")||0===t.indexOf("https://")?t:0===t.indexOf("//")?"http://"+t.slice(2):"http://"+t},e.getOSname=function(){var t="Unknown";return-1!=window.navigator.userAgent.indexOf("Windows NT 10.0")&&(t="Windows 10"),-1!=window.navigator.userAgent.indexOf("Windows NT 6.2")&&(t="Windows 8"),-1!=window.navigator.userAgent.indexOf("Windows NT 6.1")&&(t="Windows 7"),-1!=window.navigator.userAgent.indexOf("Windows NT 6.0")&&(t="Windows Vista"),-1!=window.navigator.userAgent.indexOf("Windows NT 5.1")&&(t="Windows XP"),-1!=window.navigator.userAgent.indexOf("Windows NT 5.0")&&(t="Windows 2000"),-1!=window.navigator.userAgent.indexOf("Mac")&&(t="Mac/iOS"),-1!=window.navigator.userAgent.indexOf("X11")&&(t="UNIX"),-1!=window.navigator.userAgent.indexOf("Linux")&&(t="Linux"),t}},function(t,e,n){var i=n(6);t.exports=function(t){if(!i(t))throw TypeError(t+" is not an object!");return t}},function(t,e){var n=t.exports="undefined"!=typeof window&&window.Math==Math?window:"undefined"!=typeof self&&self.Math==Math?self:Function("return this")();"number"==typeof __g&&(__g=n)},function(t,e){t.exports=function(t){try{return!!t()}catch(t){return!0}}},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i=function(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n]);return e.default=t,e}(n(1)),r=l(n(50)),a=l(n(49)),s=l(n(113)),o=n(21);function l(t){return t&&t.__esModule?t:{default:t}}var c={},u=r.default.extend({init:function(t,e){if(this._id=this._id||i.uniqueId("c"),this._ready=!1,this._readyOnce=!1,this.name=this.name||t.name||this._id,this.template=this.template||"<div></div>",this.placeholder=this.placeholder||t.placeholder,this.template_data=this.template_data||{name:this.name},this.placeholder&&!i.isElement(this.placeholder))try{this.placeholder=e.placeholder.querySelector(this.placeholder)}catch(t){i.error("Error finding placeholder '"+this.placeholder+"' for component '"+this.name+"'")}this.parent=e||null,this.root=this.parent?this.parent.root:this,this.components=this.components||[],this._components_config=this.components.map(function(t){return i.clone(t)}),this.model_expects=this.model_expects||[],this.model_binds=this.model_binds||{},this.createModel(t.model),this.ui=this.model.ui||this.ui||t.ui,this._super(),this.registerListeners()},createModel:function(t){this.model=this._modelMapping(t)},registerListeners:function(){this.on({readyOnce:this.readyOnce,ready:this.ready,domReady:this.domReady,resize:this.resize})},startPreload:function(){var t=[];return t.push(this.preload()),i.forEach(this.components,function(e){return t.push(e.startPreload())}),Promise.all(t)},preload:function(){return Promise.resolve()},afterPreload:function(){this.model&&this.model.afterPreload(),i.forEach(this.components,function(t){t.afterPreload()})},render:function(){this.prerender(),this.postrender()},prerender:function(){this.loadTemplate(),this.loadSubComponents()},postrender:function(){var t=this;i.forEach(this.components,function(e){e.render(),t.on("resize",function(){e.trigger("resize")})}),this.startLoading()},startLoading:function(){var t=this;this.model.on("ready",function(){t.loadingDone()}),this.model&&this.model.isLoading()||this.loadingDone()},loadingDone:function(){i.removeClass(this.placeholder,"vzb-loading-first"),i.removeClass(this.placeholder,"vzb-loading-data"),this.setReady()},renderError:function(t){var e=this;if(!t)return i.warn("renderError() was called without any specific error. Not rendering anything then.");if(i.hasClass(this.placeholder,"vzb-error"))return i.warn("The app is already showing error dialog. Not rendering again.");i.removeClass(this.placeholder,"vzb-loading-first"),i.removeClass(this.placeholder,"vzb-loading-data"),i.addClass(this.placeholder,"vzb-error");var n=JSON.stringify(t,null,2);"{}"==n&&(n=t.stack);var r=this.model._root.locale.getTFunction(),a="mailto:angie@gapminder.org?subject=Gapminder Vizabi error report&body=Hi Angie! Please have a look at this! %0D%0A %0D%0A %0D%0A\n      These are the steps to reproduce the error: %0D%0A \n      1. Go to "+window.location.origin+" %0D%0A \n      2. %5Bplease write here what you did%5D %0D%0A %0D%0A %0D%0A"+encodeURIComponent(n);this.errorMessageEl.classed("vzb-hidden",!1);var s=this.errorMessageEl.select(".vzb-error-message-technical").html(n);this.errorMessageEl.select(".vzb-error-message-expand").on("click",function(){return s.classed("vzb-hidden",!s.classed("vzb-hidden"))}).html(r("crash/expand")),this.errorMessageEl.select(".vzb-error-message-close").on("click",function(){e.errorMessageEl.classed("vzb-hidden",!0),i.removeClass(e.placeholder,"vzb-error")}),this.errorMessageEl.select(".vzb-error-message-title").select("h1").html(t.icon||"🙄");var o="crash/intro",l="crash/outro",c={};r(t.name)!==t.name&&(o="reader/error/generic",l=t.name,"reader/error/wrongTimeUnitsOrColumn"===t.name&&(c={expected:this.model._root.state.time.getFormatter()(new Date),found:t.details}),"reader/error/repeatedKeys"===t.name&&(c=t.details),"reader/error/undefinedDelimiter"===t.name&&(c={file:t.endpoint})),this.errorMessageEl.select(".vzb-error-message-intro").html(r(o,c).replace("mailto",a)),this.errorMessageEl.select(".vzb-error-message-outro").html(r(l,c).replace("mailto",a)),i.error(n)},setReady:function(t){this._readyOnce||(this.trigger("readyOnce"),this._readyOnce=!0),this._ready=!0,this.trigger("ready")},loadTemplate:function(){var t=this.template,e=this.template_data,n="";if(this.placeholder){if(e=i.extend(e,{t:this.getTranslationFunction(!0)}),this.template)try{n=function t(e,n){var i=/<[a-z][\s\S]*>/i.test(e)?function(t){return e.replace(/<%=([^%]*)%>/g,function(e){var n=e.match(/t\s*\(([^)]+)\)/g);return n.length?n=t.t(n[0].match(/"([^"]+)"/g)[0].split('"').join("")):(n=e.match(/([a-z\-A-Z]+([a-z\-A-Z0-9]?[a-zA-Z0-9]?)?)/g)[0],n=t[n]||n),n})}:c[e]=c[e]||t(s.default.templates[e]);return n?i(n):i}(t,e)}catch(t){var r=new Error;r.name="template",r.message="Templating error for component. Check if template name is unique and correct",r.details=this.name,this.renderError(r)}i.addClass(this.placeholder,"vzb-loading-data"),i.addClass(this.placeholder,"vzb-loading-first"),this.placeholder.innerHTML=n,this.element=this.placeholder.children[0],this.errorMessageEl=d3.select(this.element).append("div").attr("class","vzb-error-message vzb-hidden").html('\n        <div class="vzb-error-message-background"></div>\n        <div class="vzb-error-message-box">\n          <div class="vzb-error-message-close">'+o.close+'</div>\n          <div class="vzb-error-message-title"><h1></h1></div>\n          <div class="vzb-error-message-body">\n            <p class="vzb-error-message-intro"></p>\n            <br>\n            <p class="vzb-error-message-expand"></p>\n            <textarea class="vzb-error-message-technical vzb-hidden"></textarea>\n            <br>\n            <p class="vzb-error-message-outro"></p>\n          </div>\n        </div>\n      '),this.trigger("domReady")}},getActiveProfile:function(t,e){var n=this.getLayoutProfile(),r=this.getPresentationMode(),a=i.deepClone(t[n]);return r&&(e||{})[n]&&i.deepExtend(a,e[n]),a},loadSubComponents:function(){var t=this,e=void 0,n=void 0;this.components=[],i.forEach(this._components_config,function(r){if(r.model=r.model||{},r.component){if(n=i.isString(r.component)?u.get(r.component):r.component){e=i.extend(r,{name:r.component,ui:t._uiMapping(r.placeholder,r.ui)});var a=new n(e,t);t.components.push(a)}}else i.error("Error loading component: name not provided")})},findChildByName:function(t){return i.find(this.components,function(e){return e.name===t})},getLayoutProfile:function(){return this.model.ui?this.model.ui.currentProfile():this.parent.getLayoutProfile()},getPresentationMode:function(){return this.model.ui?this.model.ui.getPresentationMode():this.parent.getPresentationMode()},_uiMapping:function(t,e){if(e)return new a.default("ui",e);if(t&&this.ui){t=t.replace(".","");var n=this.ui[t];if(n)return n}return this.ui},_modelMapping:function(t){var e=this,n={};if(i.isArray(t)&&i.isArray(this.model_expects)){this.model_expects.length!==t.length&&(i.groupCollapsed("DIFFERENCE IN NUMBER OF MODELS EXPECTED AND RECEIVED"),i.warn("Please, configure the 'model_expects' attribute accordingly in '"+this.name+"' or check the models passed in '"+e.parent.name+"'.\n\nComponent: '"+e.parent.name+"'\nSubcomponent: '"+this.name+"'\nNumber of Models Expected: "+this.model_expects.length+"\nNumber of Models Received: "+t.length),i.groupEnd()),i.forEach(t,function(r,a){if(r){var s=function(t){var n=t.split("."),i=e.parent.model,r="";for(;n.length;)r=n.shift(),i=i[r];return{name:t,model:i,type:i?i.getType():null}}(r),o=void 0;e.model_expects[a]?(o=e.model_expects[a].name,!e.model_expects[a].type||s.type===e.model_expects[a].type||i.isArray(e.model_expects[a].type)&&-1!==e.model_expects[a].type.indexOf(s.type)||(i.groupCollapsed("UNEXPECTED MODEL TYPE: '"+s.type+"' instead of '"+e.model_expects[a].type+"'"),i.warn("Please, configure the 'model_expects' attribute accordingly in '"+e.name+"' or check the models passed in '"+e.parent.name+"'.\n\nComponent: '"+e.parent.name+"'\nSubcomponent: '"+e.name+"'\nExpected Model: '"+e.model_expects[a].type+"'\nReceived Model: '"+s.type+"'\nModel order: "+a),i.groupEnd())):(i.groupCollapsed("UNEXPECTED MODEL: '"+t[a]+"'"),i.warn("Please, configure the 'model_expects' attribute accordingly in '"+e.name+"' or check the models passed in '"+e.parent.name+"'.\n\nComponent: '"+e.parent.name+"'\nSubcomponent: '"+e.name+"'\nNumber of Models Expected: "+e.model_expects.length+"\nNumber of Models Received: "+t.length),i.groupEnd(),o=s.name),n[o]=s.model}});var r=t.length,s=this.model_expects.length;return s>r&&(this.model_expects.splice(0,r),i.forEach(s,function(t){n[t.name]={}})),new a.default(this.name,n,null,this.model_binds)}},getTranslationFunction:function(t){var e=void 0;try{e=this.model.get("locale").getTFunction()}catch(t){this.parent&&this.parent!==this&&(e=this.parent.getTranslationFunction())}return e||(e=function(t){return t}),t?this._translatedStringFunction(e):e},_translatedStringFunction:function(t){return function(e){return'<span data-vzb-translate="'+e+'">'+t(e)+"</span>"}},translateStrings:function(){var t=this.getTranslationFunction(),e=this.placeholder.querySelectorAll("[data-vzb-translate]");0!==e.length&&i.forEach(e,function(e){e&&e.getAttribute&&(e.innerHTML=t(e.getAttribute("data-vzb-translate")))})},readyOnce:function(){},ready:function(){},resize:function(){},domReady:function(){},clear:function(){this.freeze(),this.model&&this.model.freeze(),i.forEach(this.components,function(t){t.clear()})}});u.isComponent=function(t){return t._id&&("t"===t._id[0]||"c"===t._id[0])},e.default=u},function(t,e){t.exports=function(t){return"object"==typeof t?null!==t:"function"==typeof t}},function(t,e,n){var i=n(58)("wks"),r=n(39),a=n(3).Symbol,s="function"==typeof a;(t.exports=function(t){return i[t]||(i[t]=s&&a[t]||(s?a:r)("Symbol."+t))}).store=i},function(t,e,n){var i=n(25),r=Math.min;t.exports=function(t){return t>0?r(i(t),9007199254740991):0}},function(t,e,n){t.exports=!n(4)(function(){return 7!=Object.defineProperty({},"a",{get:function(){return 7}}).a})},function(t,e,n){var i=n(2),r=n(116),a=n(27),s=Object.defineProperty;e.f=n(9)?Object.defineProperty:function(t,e,n){if(i(t),e=a(e,!0),i(n),r)try{return s(t,e,n)}catch(t){}if("get"in n||"set"in n)throw TypeError("Accessors not supported!");return"value"in n&&(t[e]=n.value),t}},function(t,e,n){var i=n(28);t.exports=function(t){return Object(i(t))}},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i=function(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n]);return e.default=t,e}(n(1)),r=s(n(5)),a=n(21);function s(t){return t&&t.__esModule?t:{default:t}}var o=(0,s(n(108)).default)(n(409)),l=r.default.extend({isDialog:!0,init:function(t,e){this.name=this.name||"",this.model_expects=this.model_expects||[{name:"state",type:"model"},{name:"ui",type:"ui"},{name:"locale",type:"locale"}],this.template=o[this.name],this._super(t,e),this.transitionEvents=["webkitTransitionEnd","transitionend","msTransitionEnd","oTransitionEnd"]},readyOnce:function(){this.element=d3.select(this.element),this.titleEl=this.element.selectAll(".vzb-top-dialog > .vzb-dialog-modal > .vzb-dialog-title"),this.buttonsEl=this.element.selectAll(".vzb-top-dialog > .vzb-dialog-modal > .vzb-dialog-buttons"),this.contentEl=this.element.selectAll(".vzb-top-dialog > .vzb-dialog-modal > .vzb-dialog-content")},ready:function(){var t=this;this.placeholderEl=d3.select(this.placeholder),this.rootEl=this.root.element instanceof Array?this.root.element:d3.select(this.root.element),this.dragHandler=this.placeholderEl.select("[data-click='dragDialog']"),this.dragHandler.html(a.drag),this.pinIcon=this.placeholderEl.select("[data-click='pinDialog']"),this.pinIcon.html(a.pin),this.topPos="";var e,n,r,s,o,l,c,u,h,d,f,p,v,g,m,b,y,_=this.getLayoutProfile(),M=(e=this.placeholderEl,n=this.rootEl,r=10,s=void 0,o=void 0,l=void 0,c=void 0,u=void 0,h=void 0,d=void 0,f=void 0,p=void 0,v=void 0,g=void 0,m=void 0,b=void 0,y=void 0,{move:function(t,n){e.style("right",t+"px"),e.style("top",n+"px")},dragStart:function(t){if(i.isTouchDevice()){var a=d3.touches(n.node());s=a[0][0],o=a[0][1]}else s=t.sourceEvent.clientX,o=t.sourceEvent.clientY;l=parseInt(e.style("top"))||0,c=parseInt(e.style("right"))||0,h=parseInt(e.style("margin-left"))||0,u=parseInt(e.style("margin-right"))||0,f=Math.min(r,h),d=Math.min(r,u),p=parseInt(e.style("width"),10)+h-f||0,v=parseInt(e.style("height"),10)||0,g=parseInt(n.style("width"),10)-u||0,m=parseInt(n.style("height"),10)||0,b=s+c,y=o-l},drag:function(t){if(i.isTouchDevice()){var e=d3.touches(n.node());s=e[0][0],o=e[0][1]}else s=t.sourceEvent.clientX,o=t.sourceEvent.clientY;var r=-s+b,a=o-y;r<-d&&(r=-d),a<0&&(a=0),r+p>g&&(r=g-p),a+v>m&&(a=m-v),this.move(r,a)}}),w=d3.drag().on("start",function(){var e=t.placeholderEl.node().offsetTop;t.placeholderEl.style("top",e+"px"),t.placeholderEl.style("bottom","auto"),t.trigger("dragstart"),M.dragStart(d3.event)}).on("drag",function(){t.trigger("drag"),M.drag(d3.event)}).on("end",function(){t.rightPos=t.placeholderEl.style("right"),t.topPos=t.placeholderEl.style("top"),t.trigger("dragend")});this.dragHandler.call(w),this.dragHandler.classed("vzb-hidden","small"===_),this.pinIcon.classed("vzb-hidden","small"===_),this.resize()},resize:function(){if(this.placeholderEl&&this.rootEl&&this.placeholderEl.classed("vzb-top-dialog")){this.placeholderEl.classed("notransition",!0);var t=this.getLayoutProfile();if("small"!==t){var e=parseInt(this.rootEl.style("width"),10)||0,n=parseInt(this.rootEl.style("height"),10)||0,r=parseInt(this.placeholderEl.style("width"),10)||0,a=parseInt(this.placeholderEl.style("height"),10)||0,s=parseInt(this.rightPos,10),o=parseInt(this.topPos,10),l=parseInt(this.placeholderEl.style("margin-right"),10)||0;i.isNumber(s)&&s>e-r-l&&this.rightPos&&(this.rightPos=e-r-l+"px",this.isOpen&&this.placeholderEl.style("right",this.rightPos)),i.isNumber(o)&&i.isNumber(a)&&o>=0&&o>n-a&&this.topPos&&(this.topPos=(n-a>0?n-a:0)+"px",this.isOpen&&this.placeholderEl.style("top",this.topPos)),this.topPos&&"large"===this.getLayoutProfile()&&this.rootEl.classed("vzb-dialog-expand-true")&&this.placeholderEl.style("bottom","auto"),this.rootEl.classed("vzb-landscape"),this.element.style("max-height","")}else this.rightPos="",this.topPos="",this.placeholderEl.attr("style","");this.dragHandler.classed("vzb-hidden","small"===t),this.pinIcon.classed("vzb-hidden","small"===t),this._setMaxHeight()}},_setMaxHeight:function(){var t=this.root.element.offsetHeight;"small"!==this.getLayoutProfile()?!this.topPos&&"large"===this.getLayoutProfile()&&this.rootEl.classed("vzb-dialog-expand-true")?t-=parseInt(this.placeholderEl.style("bottom"),10):t-=this.topPos?parseInt(this.topPos,10):this.placeholderEl.node().offsetTop:t=this.rootEl.classed("vzb-portrait")?t-50:t-10;this.element.style("max-height",t+"px");var e=t-this.titleEl.node().offsetHeight-this.buttonsEl.node().offsetHeight;this.contentEl.style("max-height",e+"px")},beforeOpen:function(){var t=this;if(this.transitionEvents.forEach(function(e){t.placeholderEl.on(e,t.transitionEnd.bind(t,e))}),this.placeholderEl.classed("notransition",!0),this.placeholderEl.style("top",""),this.placeholderEl.style("bottom",""),this.topPos&&"large"===this.getLayoutProfile()&&this.rootEl.classed("vzb-dialog-expand-true")){var e=this.placeholderEl.node().offsetTop;this.placeholderEl.style("top",e+"px"),this.placeholderEl.style("bottom","auto")}else this.getLayoutProfile();this.placeholderEl.node().offsetTop,this.placeholderEl.classed("notransition",!1),"small"===this.getLayoutProfile()?this.placeholderEl.style("top",""):this.rootEl.classed("vzb-landscape")},open:function(){this.isOpen=!0,"small"!==this.getLayoutProfile()&&this.topPos&&(this.placeholderEl.style("top",this.topPos),this.placeholderEl.style("right",this.rightPos))},beforeClose:function(){this.rootEl.classed("vzb-portrait")&&"small"===this.getLayoutProfile()&&this.placeholderEl.style("top","auto"),"large"===this.getLayoutProfile()&&this.rootEl.classed("vzb-dialog-expand-true")&&(this.topPos0=this.topPos?this.placeholderEl.node().parentNode.offsetHeight-this.placeholderEl.node().offsetHeight+"px":""),this.placeholderEl.classed("notransition",!1),this.placeholderEl.node().offsetHeight},close:function(){this.rootEl.classed("vzb-portrait")&&"small"===this.getLayoutProfile()||(this.placeholderEl.style("top",""),this.placeholderEl.style("right","")),"large"===this.getLayoutProfile()&&this.rootEl.classed("vzb-dialog-expand-true")&&(this.placeholderEl.style("top",this.topPos0),this.placeholderEl.style("right","")),this.isOpen=!1,this.trigger("close")},transitionEnd:function(t){var e=this;this.transitionEvents.forEach(function(t){e.placeholderEl.on(t,null)}),this.isOpen&&this.placeholderEl.classed("notransition",!0)}});e.default=l},function(t,e){t.exports=function(t){if("function"!=typeof t)throw TypeError(t+" is not a function!");return t}},function(t,e,n){var i=n(10),r=n(38);t.exports=n(9)?function(t,e,n){return i.f(t,e,r(1,n))}:function(t,e,n){return t[e]=n,t}},function(t,e,n){var i=n(3),r=n(14),a=n(17),s=n(39)("src"),o=n(196),l=(""+o).split("toString");n(22).inspectSource=function(t){return o.call(t)},(t.exports=function(t,e,n,o){var c="function"==typeof n;c&&(a(n,"name")||r(n,"name",e)),t[e]!==n&&(c&&(a(n,s)||r(n,s,t[e]?""+t[e]:l.join(String(e)))),t===i?t[e]=n:o?t[e]?t[e]=n:r(t,e,n):(delete t[e],r(t,e,n)))})(Function.prototype,"toString",function(){return"function"==typeof this&&this[s]||o.call(this)})},function(t,e,n){var i=n(0),r=n(4),a=n(28),s=/"/g,o=function(t,e,n,i){var r=String(a(t)),o="<"+e;return""!==n&&(o+=" "+n+'="'+String(i).replace(s,"&quot;")+'"'),o+">"+r+"</"+e+">"};t.exports=function(t,e){var n={};n[t]=e(o),i(i.P+i.F*r(function(){var e=""[t]('"');return e!==e.toLowerCase()||e.split('"').length>3}),"String",n)}},function(t,e){var n={}.hasOwnProperty;t.exports=function(t,e){return n.call(t,e)}},function(t,e,n){var i=n(59),r=n(28);t.exports=function(t){return i(r(t))}},function(t,e,n){var i=n(60),r=n(38),a=n(18),s=n(27),o=n(17),l=n(116),c=Object.getOwnPropertyDescriptor;e.f=n(9)?c:function(t,e){if(t=a(t),e=s(e,!0),l)try{return c(t,e)}catch(t){}if(o(t,e))return r(!i.f.call(t,e),t[e])}},function(t,e,n){var i=n(17),r=n(11),a=n(83)("IE_PROTO"),s=Object.prototype;t.exports=Object.getPrototypeOf||function(t){return t=r(t),i(t,a)?t[a]:"function"==typeof t.constructor&&t instanceof t.constructor?t.constructor.prototype:t instanceof Object?s:null}},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});e.paintbrush='<svg class="vzb-icon" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 1792 1792"><path d="M1615 0q70 0 122.5 46.5t52.5 116.5q0 63-45 151-332 629-465 752-97 91-218 91-126 0-216.5-92.5t-90.5-219.5q0-128 92-212l638-579q59-54 130-54zm-909 1034q39 76 106.5 130t150.5 76l1 71q4 213-129.5 347t-348.5 134q-123 0-218-46.5t-152.5-127.5-86.5-183-29-220q7 5 41 30t62 44.5 59 36.5 46 17q41 0 55-37 25-66 57.5-112.5t69.5-76 88-47.5 103-25.5 125-10.5z"/></svg>',e.search='<svg class="vzb-icon" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 1792 1792"><path d="M1216 832q0-185-131.5-316.5t-316.5-131.5-316.5 131.5-131.5 316.5 131.5 316.5 316.5 131.5 316.5-131.5 131.5-316.5zm512 832q0 52-38 90t-90 38q-54 0-90-38l-343-342q-179 124-399 124-143 0-273.5-55.5t-225-150-150-225-55.5-273.5 55.5-273.5 150-225 225-150 273.5-55.5 273.5 55.5 225 150 150 225 55.5 273.5q0 220-124 399l343 343q37 37 37 90z"/></svg>',e.circle='<svg class="vzb-icon" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 1792 1792"><path d="M1664 896q0 209-103 385.5t-279.5 279.5-385.5 103-385.5-103-279.5-279.5-103-385.5 103-385.5 279.5-279.5 385.5-103 385.5 103 279.5 279.5 103 385.5z"/></svg>',e.expand='<svg class="vzb-icon" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 1792 1792"><path d="M883 1056q0 13-10 23l-332 332 144 144q19 19 19 45t-19 45-45 19h-448q-26 0-45-19t-19-45v-448q0-26 19-45t45-19 45 19l144 144 332-332q10-10 23-10t23 10l114 114q10 10 10 23zm781-864v448q0 26-19 45t-45 19-45-19l-144-144-332 332q-10 10-23 10t-23-10l-114-114q-10-10-10-23t10-23l332-332-144-144q-19-19-19-45t19-45 45-19h448q26 0 45 19t19 45z"/></svg>',e.asterisk='<svg class="vzb-icon" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 1792 1792"><path d="M1546 1050q46 26 59.5 77.5t-12.5 97.5l-64 110q-26 46-77.5 59.5t-97.5-12.5l-266-153v307q0 52-38 90t-90 38h-128q-52 0-90-38t-38-90v-307l-266 153q-46 26-97.5 12.5t-77.5-59.5l-64-110q-26-46-12.5-97.5t59.5-77.5l266-154-266-154q-46-26-59.5-77.5t12.5-97.5l64-110q26-46 77.5-59.5t97.5 12.5l266 153v-307q0-52 38-90t90-38h128q52 0 90 38t38 90v307l266-153q46-26 97.5-12.5t77.5 59.5l64 110q26 46 12.5 97.5t-59.5 77.5l-266 154z"/></svg>',e.trails='<svg class="vzb-icon" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 1792 1792"><path d="M 1381.375 17.1875 C 1375.7825 17.176804 1370.1216 17.316078 1364.4375 17.5625 C 1273.4913 21.505489 1197.0982 57.199956 1135.2188 124.6875 C 1076.5961 188.62338 1047.6964 263.96059 1048.5312 350.65625 L 835.71875 433 C 797.77288 391.67699 749.96961 361.96416 692.3125 343.84375 C 604.96227 316.39162 520.95691 323.70366 440.25 365.8125 C 359.5432 407.92133 305.45225 472.64985 278 560 C 250.54783 647.35004 257.89117 731.38694 300 812.09375 C 342.10886 892.80075 406.83755 946.89147 494.1875 974.34375 C 576.9404 1000.3512 657.38873 994.58645 735.5625 957.09375 L 959.28125 1171.4375 L 972.375 1184.4062 C 966.2931 1198.3454 961.94845 1209.2226 959.34375 1217.0625 C 956.73915 1224.9024 953.7186 1236.224 950.25 1251.0312 L 711.03125 1285.1875 C 669.59175 1209.0324 607.72526 1157.2863 525.40625 1129.9375 C 438.51381 1101.0693 354.34933 1107.021 272.96875 1147.8125 C 191.58796 1188.6039 136.49335 1252.4513 107.625 1339.3438 C 78.756758 1426.2362 84.708528 1510.3694 125.5 1591.75 C 166.29138 1673.1307 230.1387 1728.2567 317.03125 1757.125 C 403.92369 1785.9933 488.05682 1780.0415 569.4375 1739.25 C 650.81799 1698.4587 705.94425 1634.6111 734.8125 1547.7188 C 737.41718 1539.8788 740.43763 1528.5573 743.90625 1513.75 L 983.125 1479.5938 C 1024.5644 1555.7487 1086.4309 1607.4948 1168.75 1634.8438 C 1255.6425 1663.7119 1339.8069 1657.7603 1421.1875 1616.9688 C 1502.5682 1576.1772 1557.6631 1512.3299 1586.5312 1425.4375 C 1615.3996 1338.5451 1609.4477 1254.4119 1568.6562 1173.0312 C 1527.8647 1091.6506 1464.0174 1036.5244 1377.125 1007.6562 C 1294.9259 980.34721 1214.5066 984.74084 1135.8438 1020.8125 L 1120.2812 1005.9062 L 898.0625 785.96875 C 902.79653 774.40321 906.33847 765.03422 908.5 758.15625 C 920.42249 720.22 925.7916 682.90194 924.59375 646.21875 L 1130.9688 566.34375 C 1141.2015 577.59424 1149.3796 586.0106 1155.4688 591.59375 C 1222.9566 653.47326 1302.1474 682.44278 1393.0938 678.5 C 1484.04 674.55731 1560.4642 638.83151 1622.3438 571.34375 C 1684.2232 503.85591 1713.1929 424.6337 1709.25 333.6875 C 1705.3072 242.74139 1669.5816 166.34819 1602.0938 104.46875 C 1538.8238 46.456824 1465.2625 17.347946 1381.375 17.1875 z "/></svg>',e.lock='<svg class="vzb-icon" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 1792 1792"><path d="M640 768h512v-192q0-106-75-181t-181-75-181 75-75 181v192zm832 96v576q0 40-28 68t-68 28h-960q-40 0-68-28t-28-68v-576q0-40 28-68t68-28h32v-192q0-184 132-316t316-132 316 132 132 316v192h32q40 0 68 28t28 68z"/></svg>',e.unlock='<svg class="vzb-icon" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 1792 1792"><path d="M1376 768q40 0 68 28t28 68v576q0 40-28 68t-68 28h-960q-40 0-68-28t-28-68v-576q0-40 28-68t68-28h32v-320q0-185 131.5-316.5t316.5-131.5 316.5 131.5 131.5 316.5q0 26-19 45t-45 19h-64q-26 0-45-19t-19-45q0-106-75-181t-181-75-181 75-75 181v320h736z"/></svg>',e.unexpand='<svg class="vzb-icon" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 1792 1792"><path d="M896 960v448q0 26-19 45t-45 19-45-19l-144-144-332 332q-10 10-23 10t-23-10l-114-114q-10-10-10-23t10-23l332-332-144-144q-19-19-19-45t19-45 45-19h448q26 0 45 19t19 45zm755-672q0 13-10 23l-332 332 144 144q19 19 19 45t-19 45-45 19h-448q-26 0-45-19t-19-45v-448q0-26 19-45t45-19 45 19l144 144 332-332q10-10 23-10t23 10l114 114q10 10 10 23z"/></svg>',e.axes='<svg class="vzb-icon" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 500 500"><path d="M430.25,379.655l-75.982-43.869v59.771H120.73V151.966h59.774l-43.869-75.983L92.767,0L48.898,75.983L5.029,151.966h59.775 v271.557c0,15.443,12.52,27.965,27.963,27.965h261.5v59.773l75.982-43.869l75.982-43.867L430.25,379.655z"/></svg>',e.gear='<svg class="vzb-icon" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 1792 1792"><path d="M1152 896q0-106-75-181t-181-75-181 75-75 181 75 181 181 75 181-75 75-181zm512-109v222q0 12-8 23t-20 13l-185 28q-19 54-39 91 35 50 107 138 10 12 10 25t-9 23q-27 37-99 108t-94 71q-12 0-26-9l-138-108q-44 23-91 38-16 136-29 186-7 28-36 28h-222q-14 0-24.5-8.5t-11.5-21.5l-28-184q-49-16-90-37l-141 107q-10 9-25 9-14 0-25-11-126-114-165-168-7-10-7-23 0-12 8-23 15-21 51-66.5t54-70.5q-27-50-41-99l-183-27q-13-2-21-12.5t-8-23.5v-222q0-12 8-23t19-13l186-28q14-46 39-92-40-57-107-138-10-12-10-24 0-10 9-23 26-36 98.5-107.5t94.5-71.5q13 0 26 10l138 107q44-23 91-38 16-136 29-186 7-28 36-28h222q14 0 24.5 8.5t11.5 21.5l28 184q49 16 90 37l142-107q9-9 24-9 13 0 25 10 129 119 165 170 7 8 7 22 0 12-8 23-15 21-51 66.5t-54 70.5q26 50 41 98l183 28q13 2 21 12.5t8 23.5z"/></svg>',e.stack='<svg class="vzb-icon" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 54.849 54.849"><g><path d="M54.497,39.614l-10.363-4.49l-14.917,5.968c-0.537,0.214-1.165,0.319-1.793,0.319c-0.627,0-1.254-0.104-1.79-0.318     l-14.921-5.968L0.351,39.614c-0.472,0.203-0.467,0.524,0.01,0.716L26.56,50.81c0.477,0.191,1.251,0.191,1.729,0L54.488,40.33     C54.964,40.139,54.969,39.817,54.497,39.614z"/><path d="M54.497,27.512l-10.364-4.491l-14.916,5.966c-0.536,0.215-1.165,0.321-1.792,0.321c-0.628,0-1.256-0.106-1.793-0.321     l-14.918-5.966L0.351,27.512c-0.472,0.203-0.467,0.523,0.01,0.716L26.56,38.706c0.477,0.19,1.251,0.19,1.729,0l26.199-10.479     C54.964,28.036,54.969,27.716,54.497,27.512z"/><path d="M0.361,16.125l13.662,5.465l12.537,5.015c0.477,0.191,1.251,0.191,1.729,0l12.541-5.016l13.658-5.463     c0.477-0.191,0.48-0.511,0.01-0.716L28.277,4.048c-0.471-0.204-1.236-0.204-1.708,0L0.351,15.41     C-0.121,15.614-0.116,15.935,0.361,16.125z"/></g></svg>',e.drag='<svg class="vzb-icon" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 1792 1792"><path d="M896 384q-53 0-90.5 37.5t-37.5 90.5v128h-32v-93q0-48-32-81.5t-80-33.5q-46 0-79 33t-33 79v429l-32-30v-172q0-48-32-81.5t-80-33.5q-46 0-79 33t-33 79v224q0 47 35 82l310 296q39 39 39 102 0 26 19 45t45 19h640q26 0 45-19t19-45v-25q0-41 10-77l108-436q10-36 10-77v-246q0-48-32-81.5t-80-33.5q-46 0-79 33t-33 79v32h-32v-125q0-40-25-72.5t-64-40.5q-14-2-23-2-46 0-79 33t-33 79v128h-32v-122q0-51-32.5-89.5t-82.5-43.5q-5-1-13-1zm0-128q84 0 149 50 57-34 123-34 59 0 111 27t86 76q27-7 59-7 100 0 170 71.5t70 171.5v246q0 51-13 108l-109 436q-6 24-6 71 0 80-56 136t-136 56h-640q-84 0-138-58.5t-54-142.5l-308-296q-76-73-76-175v-224q0-99 70.5-169.5t169.5-70.5q11 0 16 1 6-95 75.5-160t164.5-65q52 0 98 21 72-69 174-69z"/></svg>',e.warn='<svg class="vzb-icon" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512.209 512.209"><path d="M507.345,439.683L288.084,37.688c-3.237-5.899-7.71-10.564-13.429-13.988c-5.705-3.427-11.893-5.142-18.554-5.142   s-12.85,1.718-18.558,5.142c-5.708,3.424-10.184,8.089-13.418,13.988L4.859,439.683c-6.663,11.998-6.473,23.989,0.57,35.98   c3.239,5.517,7.664,9.897,13.278,13.128c5.618,3.237,11.66,4.859,18.132,4.859h438.529c6.479,0,12.519-1.622,18.134-4.859   c5.62-3.23,10.038-7.611,13.278-13.128C513.823,463.665,514.015,451.681,507.345,439.683z M292.655,411.132   c0,2.662-0.91,4.897-2.71,6.704c-1.807,1.811-3.949,2.71-6.427,2.71h-54.816c-2.474,0-4.616-0.899-6.423-2.71   c-1.809-1.807-2.713-4.042-2.713-6.704v-54.248c0-2.662,0.905-4.897,2.713-6.704c1.807-1.811,3.946-2.71,6.423-2.71h54.812   c2.479,0,4.62,0.899,6.428,2.71c1.803,1.807,2.71,4.042,2.71,6.704v54.248H292.655z M292.088,304.357   c-0.198,1.902-1.198,3.47-3.001,4.709c-1.811,1.238-4.046,1.854-6.711,1.854h-52.82c-2.663,0-4.947-0.62-6.849-1.854   c-1.908-1.243-2.858-2.807-2.858-4.716l-4.853-130.47c0-2.667,0.953-4.665,2.856-5.996c2.474-2.093,4.758-3.14,6.854-3.14h62.809   c2.098,0,4.38,1.043,6.854,3.14c1.902,1.331,2.851,3.14,2.851,5.424L292.088,304.357z"/></svg>',e.pin='<svg class="vzb-icon" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 1792 1792"><path d="M800 864v-448q0-14-9-23t-23-9-23 9-9 23v448q0 14 9 23t23 9 23-9 9-23zm672 352q0 26-19 45t-45 19h-429l-51 483q-2 12-10.5 20.5t-20.5 8.5h-1q-27 0-32-27l-76-485h-404q-26 0-45-19t-19-45q0-123 78.5-221.5t177.5-98.5v-512q-52 0-90-38t-38-90 38-90 90-38h640q52 0 90 38t38 90-38 90-90 38v512q99 0 177.5 98.5t78.5 221.5z"/></svg>',e.question='<svg class="vzb-icon" xmlns="http://www.w3.org/2000/svg" viewBox="17 17 483 483"> <circle stroke-width="40" cx="258.57" cy="258.57" r="220"/> <path d="M299.756,413.021v-61.78c0-3.003-0.966-5.472-2.896-7.401s-4.398-2.896-7.401-2.896h-61.78 c-3.003,0-5.47,0.965-7.4,2.896c-1.932,1.931-2.896,4.398-2.896,7.401v61.78c0,3.002,0.965,5.47,2.896,7.399 c1.931,1.931,4.396,2.896,7.4,2.896h61.779c3.003,0,5.472-0.967,7.401-2.896S299.756,416.021,299.756,413.021z"/> <path d="M382.128,196.789c0-18.877-5.952-36.36-17.856-52.449c-11.905-16.088-26.762-28.53-44.566-37.325 c-17.804-8.795-36.037-13.192-54.7-13.192c-52.127,0-91.919,22.845-119.377,68.537c-3.218,5.148-2.359,9.653,2.574,13.514 l42.474,32.177c1.502,1.287,3.54,1.931,6.114,1.931c3.433,0,6.115-1.287,8.044-3.861c11.369-14.587,20.594-24.454,27.672-29.603 c7.294-5.148,16.519-7.723,27.673-7.723c10.297,0,19.468,2.789,27.513,8.366c8.044,5.578,12.065,11.906,12.065,18.985 c0,8.151-2.146,14.694-6.437,19.628c-4.29,4.934-11.583,9.76-21.881,14.479c-13.514,6.006-25.901,15.284-37.164,27.834 c-11.263,12.549-16.894,26.01-16.894,40.382v11.583c0,3.004,0.965,5.472,2.896,7.401c1.931,1.93,4.396,2.896,7.4,2.896h61.779 c3.003,0,5.471-0.965,7.401-2.896c1.93-1.931,2.896-4.397,2.896-7.401c0-4.075,2.306-9.385,6.917-15.928 c4.612-6.542,10.458-11.852,17.537-15.927c6.863-3.861,12.119-6.918,15.768-9.171c3.646-2.252,8.579-6.008,14.802-11.263 c6.22-5.255,10.993-10.402,14.317-15.443c3.325-5.042,6.328-11.53,9.01-19.467C380.788,214.916,382.128,206.228,382.128,196.789z"/> </svg>',e.close='<svg class="vzb-icon vzb-icon-pin" viewBox="-150 -250 1792 1792" xmlns="http://www.w3.org/2000/svg"><path d="M1149 414q0 26 -19 45l-181 181l181 181q19 19 19 45q0 27 -19 46l-90 90q-19 19 -46 19q-26 0 -45 -19l-181 -181l-181 181q-19 19 -45 19q-27 0 -46 -19l-90 -90q-19 -19 -19 -46q0 -26 19 -45l181 -181l-181 -181q-19 -19 -19 -45q0 -27 19 -46l90 -90q19 -19 46 -19 q26 0 45 19l181 181l181 -181q19 -19 45 -19q27 0 46 19l90 90q19 19 19 46z"/></svg>',e.presentation='<svg class="vzb-icon" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><path id="flip-chart-1" d="M334.549,393.834l58.607,68.666h-45.096l-58.709-68.666H334.549z M240.333,462.5h34.333v-68.666h-34.333 V462.5z M360.5,153.5h-34.334v137.334H360.5V153.5z M121.566,462.5h45.113l58.709-68.666h-45.197L121.566,462.5z M206,273.666 h-34.333v17.168H206V273.666z M257.5,239.333h-34.333v51.5H257.5V239.333z M309,205h-34.334v85.834H309V205z M446.334,102h-17.168 v257.5H85.833V102H68.667V50.5h377.667V102z M394.834,102H120.167v223.166h274.667V102z"/></svg>',e.about='<svg class="vzb-icon" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 1792 1792"><path d="M1088 1256v240q0 16-12 28t-28 12h-240q-16 0-28-12t-12-28v-240q0-16 12-28t28-12h240q16 0 28 12t12 28zm316-600q0 54-15.5 101t-35 76.5-55 59.5-57.5 43.5-61 35.5q-41 23-68.5 65t-27.5 67q0 17-12 32.5t-28 15.5h-240q-15 0-25.5-18.5t-10.5-37.5v-45q0-83 65-156.5t143-108.5q59-27 84-56t25-76q0-42-46.5-74t-107.5-32q-65 0-108 29-35 25-107 115-13 16-31 16-12 0-25-8l-164-125q-13-10-15.5-25t5.5-28q160-266 464-266 80 0 161 31t146 83 106 127.5 41 158.5z"/></svg>',e.cursorArrow='<svg class="vzb-icon" viewBox="-200 0 1792 1792" xmlns="http://www.w3.org/2000/svg"><path d="M1389 1043q31 30 14 69-17 40-59 40h-382l201 476q10 25 0 49t-34 35l-177 75q-25 10-49 0t-35-34l-191-452-312 312q-19 19-45 19-12 0-24-5-40-17-40-59v-1504q0-42 40-59 12-5 24-5 27 0 45 19z"/></svg>',e.cursorPlus='<svg class="vzb-icon" viewBox="0 0 1792 1792" xmlns="http://www.w3.org/2000/svg"><path d="M1088 800v64q0 13-9.5 22.5t-22.5 9.5h-224v224q0 13-9.5 22.5t-22.5 9.5h-64q-13 0-22.5-9.5t-9.5-22.5v-224h-224q-13 0-22.5-9.5t-9.5-22.5v-64q0-13 9.5-22.5t22.5-9.5h224v-224q0-13 9.5-22.5t22.5-9.5h64q13 0 22.5 9.5t9.5 22.5v224h224q13 0 22.5 9.5t9.5 22.5zm128 32q0-185-131.5-316.5t-316.5-131.5-316.5 131.5-131.5 316.5 131.5 316.5 316.5 131.5 316.5-131.5 131.5-316.5zm512 832q0 53-37.5 90.5t-90.5 37.5q-54 0-90-38l-343-342q-179 124-399 124-143 0-273.5-55.5t-225-150-150-225-55.5-273.5 55.5-273.5 150-225 225-150 273.5-55.5 273.5 55.5 225 150 150 225 55.5 273.5q0 220-124 399l343 343q37 37 37 90z"/></svg>',e.cursorMinus='<svg class="vzb-icon" viewBox="0 0 1792 1792" xmlns="http://www.w3.org/2000/svg"><path d="M1088 800v64q0 13-9.5 22.5t-22.5 9.5h-576q-13 0-22.5-9.5t-9.5-22.5v-64q0-13 9.5-22.5t22.5-9.5h576q13 0 22.5 9.5t9.5 22.5zm128 32q0-185-131.5-316.5t-316.5-131.5-316.5 131.5-131.5 316.5 131.5 316.5 316.5 131.5 316.5-131.5 131.5-316.5zm512 832q0 53-37.5 90.5t-90.5 37.5q-54 0-90-38l-343-342q-179 124-399 124-143 0-273.5-55.5t-225-150-150-225-55.5-273.5 55.5-273.5 150-225 225-150 273.5-55.5 273.5 55.5 225 150 150 225 55.5 273.5q0 220-124 399l343 343q37 37 37 90z"/></svg>',e.hundredPercent='<svg class="vzb-icon" xmlns="http://www.w3.org/2000/svg"><g transform="translate(18 11)"><text transform="scale(0.9 1)" x="0" y="0">100</text><text transform="scale(0.6 1)" class="percent" x="0" y="0">%</text></g></svg>',e.percent='<svg class="vzb-icon" viewBox="0 0 1792 1792" xmlns="http://www.w3.org/2000/svg"><path d="M1408 1280q0-52-38-90t-90-38-90 38-38 90 38 90 90 38 90-38 38-90zm-768-768q0-52-38-90t-90-38-90 38-38 90 38 90 90 38 90-38 38-90zm1024 768q0 159-112.5 271.5t-271.5 112.5-271.5-112.5-112.5-271.5 112.5-271.5 271.5-112.5 271.5 112.5 112.5 271.5zm-96-1088q0 20-13 38l-1056 1408q-19 26-51 26h-160q-26 0-45-19t-19-45q0-20 13-38l1056-1408q19-26 51-26h160q26 0 45 19t19 45zm-672 320q0 159-112.5 271.5t-271.5 112.5-271.5-112.5-112.5-271.5 112.5-271.5 271.5-112.5 271.5 112.5 112.5 271.5z"/></svg>',e.side='<svg class="vzb-icon" viewBox="-120 -1540 1792 1792" xmlns="http://www.w3.org/2000/svg"><path transform="rotate(-90) scale(1.2)" d="M1024 448q0 -26 -19 -45l-448 -448q-19 -19 -45 -19t-45 19l-448 448q-19 19 -19 45t19 45t45 19h896q26 0 45 -19t19 -45zM1024 832q0 -26 -19 -45t-45 -19h-896q-26 0 -45 19t-19 45t19 45l448 448q19 19 45 19t45 -19l448 -448q19 -19 19 -45z"/></svg>',e.cursorHand='<svg class="vzb-icon" viewBox="0 -1540 1792 1792" xmlns="http://www.w3.org/2000/svg"><path transform="scale(1,-1)" d="M880 1408q-46 0 -79 -33t-33 -79v-656h-32v528q0 46 -33 79t-79 33t-79 -33t-33 -79v-528v-256l-154 205q-38 51 -102 51q-53 0 -90.5 -37.5t-37.5 -90.5q0 -43 26 -77l384 -512q38 -51 102 -51h688q34 0 61 22t34 56l76 405q5 32 5 59v498q0 46 -33 79t-79 33t-79 -33t-33 -79v-272h-32v528q0 46 -33 79t-79 33t-79 -33t-33 -79v-528h-32v656q0 46 -33 79t-79 33zM880 1536q68 0 125.5 -35.5t88.5 -96.5q19 4 42 4q99 0 169.5 -70.5t70.5 -169.5v-17q105 6 180.5 -64t75.5 -175v-498q0 -40 -8 -83l-76 -404q-14 -79 -76.5 -131t-143.5 -52h-688q-60 0 -114.5 27.5t-90.5 74.5l-384 512q-51 68 -51 154q0 106 75 181t181 75q78 0 128 -34v434q0 99 70.5 169.5t169.5 70.5q23 0 42 -4q31 61 88.5 96.5t125.5 35.5z"/></svg>',e.angleDoubleLeft='<svg class="vzb-icon" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><path d="M223.7 239l136-136c9.4-9.4 24.6-9.4 33.9 0l22.6 22.6c9.4 9.4 9.4 24.6 0 33.9L319.9 256l96.4 96.4c9.4 9.4 9.4 24.6 0 33.9L393.7 409c-9.4 9.4-24.6 9.4-33.9 0l-136-136c-9.5-9.4-9.5-24.6-.1-34zm-192 34l136 136c9.4 9.4 24.6 9.4 33.9 0l22.6-22.6c9.4-9.4 9.4-24.6 0-33.9L127.9 256l96.4-96.4c9.4-9.4 9.4-24.6 0-33.9L201.7 103c-9.4-9.4-24.6-9.4-33.9 0l-136 136c-9.5 9.4-9.5 24.6-.1 34z"/></svg>',e.forecast='<svg class="vzb-icon" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 1792 1792"><g><path d="M560.7,775.2c-8.5,8.4-17.2,17.1-26,25.8C418,917.8,327.5,1039.9,231.9,1209.3c-72.9,129.4-131,262.4-172.5,395.4l171.8,53.7c37.8-120.9,90.8-242.3,157.5-360.7c43.8-77.7,85.9-143.7,128.7-201.7c43.7-59.3,91-114.2,144.6-167.7c11.3-11.3,22.2-22.2,33-32.8L560.7,775.2z"/><path d="M973.7,461.9c-21.4,12.1-43.4,24.8-66.1,38.5c-56.1,33.7-103.4,65.5-145.8,97.2l114.5,139.2c36.3-26.8,76.5-53.6,124-82.1c23.6-14.2,46.3-27.3,68.4-39.7L973.7,461.9z"/><path d="M1448.9,252.3c-37.1,13.4-75.2,27.2-111.3,40.9c-37.6,14.2-76.7,29.6-118,47.2l71.7,165.1c36.5-15.5,72.9-29.8,110.1-44c33.7-12.8,69.4-25.8,104.4-38.4L1448.9,252.3z"/></g></svg>'},function(t,e){var n=t.exports={version:"2.6.5"};"number"==typeof __e&&(__e=n)},function(t,e,n){var i=n(13);t.exports=function(t,e,n){if(i(t),void 0===e)return t;switch(n){case 1:return function(n){return t.call(e,n)};case 2:return function(n,i){return t.call(e,n,i)};case 3:return function(n,i,r){return t.call(e,n,i,r)}}return function(){return t.apply(e,arguments)}}},function(t,e){var n={}.toString;t.exports=function(t){return n.call(t).slice(8,-1)}},function(t,e){var n=Math.ceil,i=Math.floor;t.exports=function(t){return isNaN(t=+t)?0:(t>0?i:n)(t)}},function(t,e,n){"use strict";var i=n(4);t.exports=function(t,e){return!!t&&i(function(){e?t.call(null,function(){},1):t.call(null)})}},function(t,e,n){var i=n(6);t.exports=function(t,e){if(!i(t))return t;var n,r;if(e&&"function"==typeof(n=t.toString)&&!i(r=n.call(t)))return r;if("function"==typeof(n=t.valueOf)&&!i(r=n.call(t)))return r;if(!e&&"function"==typeof(n=t.toString)&&!i(r=n.call(t)))return r;throw TypeError("Can't convert object to primitive value")}},function(t,e){t.exports=function(t){if(void 0==t)throw TypeError("Can't call method on  "+t);return t}},function(t,e,n){var i=n(0),r=n(22),a=n(4);t.exports=function(t,e){var n=(r.Object||{})[t]||Object[t],s={};s[t]=e(n),i(i.S+i.F*a(function(){n(1)}),"Object",s)}},function(t,e,n){var i=n(23),r=n(59),a=n(11),s=n(8),o=n(99);t.exports=function(t,e){var n=1==t,l=2==t,c=3==t,u=4==t,h=6==t,d=5==t||h,f=e||o;return function(e,o,p){for(var v,g,m=a(e),b=r(m),y=i(o,p,3),_=s(b.length),M=0,w=n?f(e,_):l?f(e,0):void 0;_>M;M++)if((d||M in b)&&(g=y(v=b[M],M,m),t))if(n)w[M]=g;else if(g)switch(t){case 3:return!0;case 5:return v;case 6:return M;case 2:w.push(v)}else if(u)return!1;return h?-1:c||u?u:w}}},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i=n(1),r=!1,a=/xyz/.test(function(){})?/\b_super\b/:/.*/;var s=function(){};s.extend=function t(e,n){n=1===arguments.length?e:n;var s=this.prototype;r=!0;var o=new this;function l(){this.trackInstances&&l.instances.push(this),!r&&this.init&&this.init.apply(this,arguments)}return r=!1,(0,i.forEach)(n,function(t,e){"function"==typeof n[e]&&"function"==typeof s[e]&&a.test(n[e])?o[e]=function(t,e){return function(){var n=this._super;this._super=s[t];var i=e.apply(this,arguments);return this._super=n,i}}(e,n[e]):o[e]=t}),l.prototype=o,l.prototype.constructor=l,l.extend=t,l._collection={},l.instances=[],l.register=function(t,e){void 0!==this._collection[t]&&(0,i.warn)('"'+t+'" is already registered. Overwriting...'),this._collection[t]=e},l.unregister=function(t){this._collection[t]=void 0},l.getCollection=function(){return this._collection},l.define=function(t,e){this.prototype[t]=e},l.get=function(t,e){return this._collection.hasOwnProperty(t)?this._collection[t]:(e||(0,i.warn)('"'+t+'" was not found.'),!1)},arguments.length>1&&this.register&&this.register(e,l),l},e.default=s},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i=function(){return function(t,e){if(Array.isArray(t))return t;if(Symbol.iterator in Object(t))return function(t,e){var n=[],i=!0,r=!1,a=void 0;try{for(var s,o=t[Symbol.iterator]();!(i=(s=o.next()).done)&&(n.push(s.value),!e||n.length!==e);i=!0);}catch(t){r=!0,a=t}finally{try{!i&&o.return&&o.return()}finally{if(r)throw a}}return n}(t,e);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}(),r=function(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n]);return e.default=t,e}(n(1)),a=s(n(57));s(n(50));function s(t){return t&&t.__esModule?t:{default:t}}var o=a.default.extend({_important:!1,objectLeafs:["autoconfig"],dataConnectedChildren:["use","which"],getClassDefaults:function(){return r.deepExtend(this._super(),{syncModels:[],data:"data",which:null})},buildScale:function(){},setInterModelListeners:function(){var t=this,e=this._parent.getSpace(this);r.forEach(e,function(e){t._space[e]=t.getClosestModel(e),t._space[e].on("dataConnectedChange",t.handleDataConnectedChange.bind(t)),t._space[e].setLinkWith(t)}),this.getClosestModel("locale").on("dataConnectedChange",this.handleDataConnectedChange.bind(this))},onSuccessfullLoad:function(){this.trigger("onSuccessfullLoad"),this.validate(),this.buildScale(),this._super()},setWhich:function(t){var e={which:t.concept};t.dataSource&&(e.data=t.dataSource);var n=(this.dataSource=this.getClosestModel(e.data||this.data)).getConceptprops(t.concept);t.use&&(e.use=t.use),n&&n.scales&&(e.scaleType=n.scales[0]),"axis"!==this.getType()&&"size"!==this.getType()||(e.domainMin=null,e.domainMax=null,e.zoomedMin=null,e.zoomedMax=null),"property"===t.use&&t.key&&1===t.key.length&&(e.spaceRef=r.find(this._space,function(e){return e.dim===t.key[0].concept})._name),"constant"!==t.use&&"indicator"!==t.use||(e.spaceRef=null),this.set(e,void 0,void 0,void 0,this.setWhich),this._root.trigger("change_hook_which",{which:e.which,hook:this._name}),this._updateSyncModels()},setScaleType:function(t){this.buildScale(t)},preloadData:function(){return this.dataSource=this.getClosestModel(this.data),this._super()},afterPreload:function(){this.autoconfigureModel(),this.spaceRef||(this.spaceRef=this.updateSpaceReference()),this._updateSyncModels()},_updateSyncModels:function(){var t=this,e=this;this.syncModels.forEach(function(n){e.getClosestModel(n)._receiveSyncModelUpdate(t)})},_receiveSyncModelUpdate:function(t){this.set({which:t.which,data:t.data,spaceRef:t.spaceRef},!1,!1)},autoconfigureModel:function(t){if(!this.which&&this.autoconfig){if(t||(t=this._parent.getAvailableConcept(this.autoconfig)),t){var e=t.value,n={which:e.concept,use:(t.key.size||t.key.length)>1||"time"===this.autoconfig.type?"indicator":"property",scaleType:e.scales[0]||"linear"};this.set(n)}else{this.set({which:"_default",use:"constant",scaleType:"ordinal"})}r.printAutoconfigResult(this)}},updateSpaceReference:function(){if("property"!==this.use)return null;var t="entities"+this._name.replace(this._type,"");return this._space[t]?t:this._parent.getSpace()[0]._name},loadData:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};if(this.setReady(!1),!this.which||"constant"===this.use)return Promise.resolve();this.trigger("hook_change");var e=this.getQuery(t.splashScreen);if(!0===e)return Promise.resolve();this._loadCall=!0,r.timeStamp("Vizabi Model: Loading Data: "+this._id);var n=this._getAllParsers(),i=this.dataSource.load(e,n);return i.then(this.afterLoad.bind(this),function(t){return r.warn("Problem with query: ",t,JSON.stringify(e))}),i},handleDataConnectedChange:function(t){var e=this;r.defer(function(){e.startLoading().catch(r.warn)})},_isLoading:function(){return!this._loadedOnce||this._loadCall},afterLoad:function(t){this._dataId=t,r.timeStamp("Vizabi Model: Data loaded: "+this._id)},getQuery:function(t){var e=void 0;if(Object.keys(this._space).length<1)return r.error("Error:",this._id,"can't find the space"),!0;var n="property"===this.use||"constant"===this.use,i=n?{exceptType:"time"}:{},a=r.unique(this._getAllDimensions(i)),s="property"===this.use&&a.length>1?[-1!==a.indexOf(this.which)?this.which:this.getEntity().dim]:a;if(!s||!s.length)return r.warn("getQuery() produced no query because no keys are available"),!0;var o={key:s,value:-1!=s.indexOf(this.which)||"constant"===this.use?[]:[this.which]},l=this._getFirstDimension({type:"time"}),c=n?"entities":"datapoints";if(e=this._getAllFilters(i,{splash:t,entityTypeRequest:n}),n&&a.length>1){var u={};e[s]&&(u[s]=e[s]),e=u}var h={};if(Object.keys(e).length>0)for(var d in h.$and=[],e){var f={};f[d]=e[d],h.$and.push(f)}var p=this._getAllJoins(i,{splash:t,entityTypeRequest:n});if(n&&a.length>1){var v={};p["$"+s]&&(v["$"+s]=p["$"+s]),p=v}var g=this._parent._getGrouping();g&&(g=r.clone(g,s),r.isEmpty(g)&&(g=!1));var m={language:this.getClosestModel("locale").id,from:c,animatable:l,gapfill:!this.disable_gapfill,select:o,where:h,join:p,order_by:n?["rank"]:[this._space.time.dim]};return g&&(m.grouping=g),m},_getAllDimensions:function(t){return this._parent._getAllDimensions(t)},_getFirstDimension:function(t){return this._parent._getFirstDimension(t)},_getAllFilters:function(t,e){t=t||{};var n={},i=this;return r.forEach(this._space,function(a){if(t.exceptType&&a.getType()===t.exceptType)return!0;if(t.onlyType&&a.getType()!==t.onlyType)return!0;if(r.arrayEquals(i._getAllDimensions(t),[a.getDimension()]))n=r.extend(n,a.getFilter(e));else{var s=a.getFilter(e);if(null!=s&&!r.isEmpty(s)){var o={};o[a.getDimension()]="$"+a.getDimension(),n=r.extend(n,o)}}}),n},_getAllJoins:function(t,e){var n={},i=this;return r.forEach(this._space,function(a){if(t.exceptType&&a.getType()===t.exceptType)return!0;if(t.onlyType&&a.getType()!==t.onlyType)return!0;if(r.arrayEquals(i._getAllDimensions(t),[a.getDimension()]))return!0;var s=a.getFilter(e);null==s||r.isEmpty(s)||(n["$"+a.getDimension()]={key:a.getDimension(),where:a.getFilter(e)})}),n},_getAllParsers:function(){return Object.values(this._space).concat(this).reduce(function(t,e){var n=e.getParser(),i=e.getDimensionOrWhich();return n&&i&&!(i in t)&&(t[i]=n),t},{})},getTickFormatter:function(){var t=this;return function(e,n,i,a,s){if("share"===(s=t.getConceptprops().format)&&(e*=100),r.isDate(e))return t._space.time.formatDate(e);if("time"===t.scaleType&&!r.isDate(e))return t._space.time.formatDate(new Date(e));if(r.isString(e)||!e&&0!==e)return e;if(Math.abs(e)<1e-14)return"0";var o="";if(a)return d3.format(".3r")(e);switch(Math.floor(Math.log(Math.abs(e))/Math.LN10+1e-14)){case-13:e*=1e12,o="p";break;case-10:e*=1e9,o="n";break;case-7:case-6:case-5:e*=1e6,o="µ";break;case-4:case-3:case-2:case-1:case 0:case 1:case 2:case 3:break;case 4:case 5:e/=1e3,o="k";break;case 6:case 7:case 8:e/=1e6,o="M";break;case 9:case 10:case 11:e/=1e9,o="B";break;case 12:case 13:case 14:e/=1e12,o="TR";break;default:return d3.format(".3s")(e).replace("G","B")}var l=d3.format(".3r")(e);return l.indexOf(".")>-1&&(l=l.replace(/0+$/,"").replace(/\.$/,"")),l+o+("percent"===s||"share"===s?"%":"")}},getScale:function(){return null==this.scale&&console.warn("scale is null"),this.scale},getUnique:function(t){if(this.isHook())return t||(t=this._getFirstDimension({type:"time"})),this.dataSource.getData(this._dataId,"unique",t)},getData:function(){return this.dataSource.getData(this._dataId)},getValidItems:function(){return this.dataSource.getData(this._dataId,"valid",this.which)},getNestedItems:function(t){return t?this.dataSource.getData(this._dataId,"nested",t):r.warn("No keys provided to getNestedItems(<keys>)")},getHaveNoDataPointsPerKey:function(){return this.dataSource.getData(this._dataId,"haveNoDataPointsPerKey",this.which)},getLimits:function(t){return this.dataSource.getData(this._dataId,"limits",t)},getTimespan:function(){var t=this._parent._parent.time;if("indicator"===this.use&&this.which!=t.dim&&this._important&&this._dataId)return this.dataSource.getData(this._dataId,"timespan",this.which)},getFrame:function(t,e,n){return this.dataSource.getFrame(this._dataId,t,e,n)},getFrames:function(t,e){return this.dataSource.getFrames(this._dataId,t,e)},getItems:function(t){var e=this,n=this.spaceRef&&this._space[this.spaceRef]?this._space[this.spaceRef].dim:e._getFirstDimension({exceptType:"time"}),i={},a=this.getValidItems(),s=t?this.getEntity().getFilteredEntities().map(function(t){return t[n]}):[],o=s.length;return r.isArray(a)&&a.forEach(function(t){o&&!s.includes(t[n])||(i[t[n]]=t[e.which])}),i},getLimitsByDimensions:function(t){var e=this.dataSource.getData(this._dataId,"nested",t),n={},i=this.which;return r.forEach(e,function(t,e){var a=n[JSON.parse(e).join(",")]={};r.forEach(t,function(t,e){!function(t,e,n){for(var a=t.reduce(function(t,e){var n=r.isDate(e[i])?e[i]:parseFloat(e[i]);return isNaN(n)||t.push(n),t},[]),s=void 0,o=void 0,l={},c=0;c<a.length;c+=1){var u=a[c];(void 0===s||u<s)&&(s=u),(void 0===o||u>o)&&(o=u)}l.min=s||0,l.max=o||100,e[n]=l}(t,a,e)})}),n},getConceptprops:function(){return"constant"!==this.use&&this.dataSource?this.dataSource.getConceptprops(this.which):{}},isDiscrete:function(){return"ordinal"===this.scaleType},validate:function(){var t=this;if(this._super(),this.which){var e=this.scaleType,n=(this.getConceptprops()||{}).scales,r=void 0===n?[]:n;this.allow&&this.allow.scales&&this.allow.scales.length>0&&(r=r.filter(function(e){return-1!=t.allow.scales.indexOf(e)}));var a=r.includes(e),s=r.includes("log")&&"genericLog"===e;if(!a&&!s&&r.length>0){var o=i(r,1)[0];this.set({scaleType:o},null,!1)}}},getEntity:function(){return this._space[this.spaceRef]||this._parent._space[this.spaceRef]||this._parent.getFirstEntityModel()},getDataKeys:function(){return this.spaceRef?[this.getEntity().dim]:this._getAllDimensions({exceptType:"time"})}});e.default=o},function(t,e,n){"use strict";if(n(9)){var i=n(35),r=n(3),a=n(4),s=n(0),o=n(74),l=n(107),c=n(23),u=n(45),h=n(38),d=n(14),f=n(47),p=n(25),v=n(8),g=n(144),m=n(41),b=n(27),y=n(17),_=n(54),M=n(6),w=n(11),x=n(96),S=n(42),z=n(20),O=n(43).f,k=n(98),E=n(39),T=n(7),P=n(30),A=n(64),C=n(62),L=n(101),D=n(56),I=n(69),F=n(44),j=n(100),R=n(133),N=n(10),q=n(19),B=N.f,H=q.f,V=r.RangeError,W=r.TypeError,U=r.Uint8Array,Y=Array.prototype,G=l.ArrayBuffer,K=l.DataView,X=P(0),Q=P(2),$=P(3),J=P(4),Z=P(5),tt=P(6),et=A(!0),nt=A(!1),it=L.values,rt=L.keys,at=L.entries,st=Y.lastIndexOf,ot=Y.reduce,lt=Y.reduceRight,ct=Y.join,ut=Y.sort,ht=Y.slice,dt=Y.toString,ft=Y.toLocaleString,pt=T("iterator"),vt=T("toStringTag"),gt=E("typed_constructor"),mt=E("def_constructor"),bt=o.CONSTR,yt=o.TYPED,_t=o.VIEW,Mt=P(1,function(t,e){return Ot(C(t,t[mt]),e)}),wt=a(function(){return 1===new U(new Uint16Array([1]).buffer)[0]}),xt=!!U&&!!U.prototype.set&&a(function(){new U(1).set({})}),St=function(t,e){var n=p(t);if(n<0||n%e)throw V("Wrong offset!");return n},zt=function(t){if(M(t)&&yt in t)return t;throw W(t+" is not a typed array!")},Ot=function(t,e){if(!(M(t)&&gt in t))throw W("It is not a typed array constructor!");return new t(e)},kt=function(t,e){return Et(C(t,t[mt]),e)},Et=function(t,e){for(var n=0,i=e.length,r=Ot(t,i);i>n;)r[n]=e[n++];return r},Tt=function(t,e,n){B(t,e,{get:function(){return this._d[n]}})},Pt=function(t){var e,n,i,r,a,s,o=w(t),l=arguments.length,u=l>1?arguments[1]:void 0,h=void 0!==u,d=k(o);if(void 0!=d&&!x(d)){for(s=d.call(o),i=[],e=0;!(a=s.next()).done;e++)i.push(a.value);o=i}for(h&&l>2&&(u=c(u,arguments[2],2)),e=0,n=v(o.length),r=Ot(this,n);n>e;e++)r[e]=h?u(o[e],e):o[e];return r},At=function(){for(var t=0,e=arguments.length,n=Ot(this,e);e>t;)n[t]=arguments[t++];return n},Ct=!!U&&a(function(){ft.call(new U(1))}),Lt=function(){return ft.apply(Ct?ht.call(zt(this)):zt(this),arguments)},Dt={copyWithin:function(t,e){return R.call(zt(this),t,e,arguments.length>2?arguments[2]:void 0)},every:function(t){return J(zt(this),t,arguments.length>1?arguments[1]:void 0)},fill:function(t){return j.apply(zt(this),arguments)},filter:function(t){return kt(this,Q(zt(this),t,arguments.length>1?arguments[1]:void 0))},find:function(t){return Z(zt(this),t,arguments.length>1?arguments[1]:void 0)},findIndex:function(t){return tt(zt(this),t,arguments.length>1?arguments[1]:void 0)},forEach:function(t){X(zt(this),t,arguments.length>1?arguments[1]:void 0)},indexOf:function(t){return nt(zt(this),t,arguments.length>1?arguments[1]:void 0)},includes:function(t){return et(zt(this),t,arguments.length>1?arguments[1]:void 0)},join:function(t){return ct.apply(zt(this),arguments)},lastIndexOf:function(t){return st.apply(zt(this),arguments)},map:function(t){return Mt(zt(this),t,arguments.length>1?arguments[1]:void 0)},reduce:function(t){return ot.apply(zt(this),arguments)},reduceRight:function(t){return lt.apply(zt(this),arguments)},reverse:function(){for(var t,e=zt(this).length,n=Math.floor(e/2),i=0;i<n;)t=this[i],this[i++]=this[--e],this[e]=t;return this},some:function(t){return $(zt(this),t,arguments.length>1?arguments[1]:void 0)},sort:function(t){return ut.call(zt(this),t)},subarray:function(t,e){var n=zt(this),i=n.length,r=m(t,i);return new(C(n,n[mt]))(n.buffer,n.byteOffset+r*n.BYTES_PER_ELEMENT,v((void 0===e?i:m(e,i))-r))}},It=function(t,e){return kt(this,ht.call(zt(this),t,e))},Ft=function(t){zt(this);var e=St(arguments[1],1),n=this.length,i=w(t),r=v(i.length),a=0;if(r+e>n)throw V("Wrong length!");for(;a<r;)this[e+a]=i[a++]},jt={entries:function(){return at.call(zt(this))},keys:function(){return rt.call(zt(this))},values:function(){return it.call(zt(this))}},Rt=function(t,e){return M(t)&&t[yt]&&"symbol"!=typeof e&&e in t&&String(+e)==String(e)},Nt=function(t,e){return Rt(t,e=b(e,!0))?h(2,t[e]):H(t,e)},qt=function(t,e,n){return!(Rt(t,e=b(e,!0))&&M(n)&&y(n,"value"))||y(n,"get")||y(n,"set")||n.configurable||y(n,"writable")&&!n.writable||y(n,"enumerable")&&!n.enumerable?B(t,e,n):(t[e]=n.value,t)};bt||(q.f=Nt,N.f=qt),s(s.S+s.F*!bt,"Object",{getOwnPropertyDescriptor:Nt,defineProperty:qt}),a(function(){dt.call({})})&&(dt=ft=function(){return ct.call(this)});var Bt=f({},Dt);f(Bt,jt),d(Bt,pt,jt.values),f(Bt,{slice:It,set:Ft,constructor:function(){},toString:dt,toLocaleString:Lt}),Tt(Bt,"buffer","b"),Tt(Bt,"byteOffset","o"),Tt(Bt,"byteLength","l"),Tt(Bt,"length","e"),B(Bt,vt,{get:function(){return this[yt]}}),t.exports=function(t,e,n,l){var c=t+((l=!!l)?"Clamped":"")+"Array",h="get"+t,f="set"+t,p=r[c],m=p||{},b=p&&z(p),y=!p||!o.ABV,w={},x=p&&p.prototype,k=function(t,n){B(t,n,{get:function(){return function(t,n){var i=t._d;return i.v[h](n*e+i.o,wt)}(this,n)},set:function(t){return function(t,n,i){var r=t._d;l&&(i=(i=Math.round(i))<0?0:i>255?255:255&i),r.v[f](n*e+r.o,i,wt)}(this,n,t)},enumerable:!0})};y?(p=n(function(t,n,i,r){u(t,p,c,"_d");var a,s,o,l,h=0,f=0;if(M(n)){if(!(n instanceof G||"ArrayBuffer"==(l=_(n))||"SharedArrayBuffer"==l))return yt in n?Et(p,n):Pt.call(p,n);a=n,f=St(i,e);var m=n.byteLength;if(void 0===r){if(m%e)throw V("Wrong length!");if((s=m-f)<0)throw V("Wrong length!")}else if((s=v(r)*e)+f>m)throw V("Wrong length!");o=s/e}else o=g(n),a=new G(s=o*e);for(d(t,"_d",{b:a,o:f,l:s,e:o,v:new K(a)});h<o;)k(t,h++)}),x=p.prototype=S(Bt),d(x,"constructor",p)):a(function(){p(1)})&&a(function(){new p(-1)})&&I(function(t){new p,new p(null),new p(1.5),new p(t)},!0)||(p=n(function(t,n,i,r){var a;return u(t,p,c),M(n)?n instanceof G||"ArrayBuffer"==(a=_(n))||"SharedArrayBuffer"==a?void 0!==r?new m(n,St(i,e),r):void 0!==i?new m(n,St(i,e)):new m(n):yt in n?Et(p,n):Pt.call(p,n):new m(g(n))}),X(b!==Function.prototype?O(m).concat(O(b)):O(m),function(t){t in p||d(p,t,m[t])}),p.prototype=x,i||(x.constructor=p));var E=x[pt],T=!!E&&("values"==E.name||void 0==E.name),P=jt.values;d(p,gt,!0),d(x,yt,c),d(x,_t,!0),d(x,mt,p),(l?new p(1)[vt]==c:vt in x)||B(x,vt,{get:function(){return c}}),w[c]=p,s(s.G+s.W+s.F*(p!=m),w),s(s.S,c,{BYTES_PER_ELEMENT:e}),s(s.S+s.F*a(function(){m.of.call(p,1)}),c,{from:Pt,of:At}),"BYTES_PER_ELEMENT"in x||d(x,"BYTES_PER_ELEMENT",e),s(s.P,c,Dt),F(c),s(s.P+s.F*xt,c,{set:Ft}),s(s.P+s.F*!T,c,jt),i||x.toString==dt||(x.toString=dt),s(s.P+s.F*a(function(){new p(1).slice()}),c,{slice:It}),s(s.P+s.F*(a(function(){return[1,2].toLocaleString()!=new p([1,2]).toLocaleString()})||!a(function(){x.toLocaleString.call([1,2])})),c,{toLocaleString:Lt}),D[c]=T?E:P,i||T||d(x,pt,P)}}else t.exports=function(){}},function(t,e,n){var i=n(139),r=n(0),a=n(58)("metadata"),s=a.store||(a.store=new(n(142))),o=function(t,e,n){var r=s.get(t);if(!r){if(!n)return;s.set(t,r=new i)}var a=r.get(e);if(!a){if(!n)return;r.set(e,a=new i)}return a};t.exports={store:s,map:o,has:function(t,e,n){var i=o(e,n,!1);return void 0!==i&&i.has(t)},get:function(t,e,n){var i=o(e,n,!1);return void 0===i?void 0:i.get(t)},set:function(t,e,n,i){o(n,i,!0).set(t,e)},keys:function(t,e){var n=o(t,e,!1),i=[];return n&&n.forEach(function(t,e){i.push(e)}),i},key:function(t){return void 0===t||"symbol"==typeof t?t:String(t)},exp:function(t){r(r.S,"Reflect",t)}}},function(t,e){t.exports=!1},function(t,e,n){var i=n(39)("meta"),r=n(6),a=n(17),s=n(10).f,o=0,l=Object.isExtensible||function(){return!0},c=!n(4)(function(){return l(Object.preventExtensions({}))}),u=function(t){s(t,i,{value:{i:"O"+ ++o,w:{}}})},h=t.exports={KEY:i,NEED:!1,fastKey:function(t,e){if(!r(t))return"symbol"==typeof t?t:("string"==typeof t?"S":"P")+t;if(!a(t,i)){if(!l(t))return"F";if(!e)return"E";u(t)}return t[i].i},getWeak:function(t,e){if(!a(t,i)){if(!l(t))return!0;if(!e)return!1;u(t)}return t[i].w},onFreeze:function(t){return c&&h.NEED&&l(t)&&!a(t,i)&&u(t),t}}},function(t,e,n){var i=n(7)("unscopables"),r=Array.prototype;void 0==r[i]&&n(14)(r,i,{}),t.exports=function(t){r[i][t]=!0}},function(t,e){t.exports=function(t,e){return{enumerable:!(1&t),configurable:!(2&t),writable:!(4&t),value:e}}},function(t,e){var n=0,i=Math.random();t.exports=function(t){return"Symbol(".concat(void 0===t?"":t,")_",(++n+i).toString(36))}},function(t,e,n){var i=n(118),r=n(84);t.exports=Object.keys||function(t){return i(t,r)}},function(t,e,n){var i=n(25),r=Math.max,a=Math.min;t.exports=function(t,e){return(t=i(t))<0?r(t+e,0):a(t,e)}},function(t,e,n){var i=n(2),r=n(119),a=n(84),s=n(83)("IE_PROTO"),o=function(){},l=function(){var t,e=n(81)("iframe"),i=a.length;for(e.style.display="none",n(85).appendChild(e),e.src="javascript:",(t=e.contentWindow.document).open(),t.write("<script>document.F=Object<\/script>"),t.close(),l=t.F;i--;)delete l.prototype[a[i]];return l()};t.exports=Object.create||function(t,e){var n;return null!==t?(o.prototype=i(t),n=new o,o.prototype=null,n[s]=t):n=l(),void 0===e?n:r(n,e)}},function(t,e,n){var i=n(118),r=n(84).concat("length","prototype");e.f=Object.getOwnPropertyNames||function(t){return i(t,r)}},function(t,e,n){"use strict";var i=n(3),r=n(10),a=n(9),s=n(7)("species");t.exports=function(t){var e=i[t];a&&e&&!e[s]&&r.f(e,s,{configurable:!0,get:function(){return this}})}},function(t,e){t.exports=function(t,e,n,i){if(!(t instanceof e)||void 0!==i&&i in t)throw TypeError(n+": incorrect invocation!");return t}},function(t,e,n){var i=n(23),r=n(131),a=n(96),s=n(2),o=n(8),l=n(98),c={},u={};(e=t.exports=function(t,e,n,h,d){var f,p,v,g,m=d?function(){return t}:l(t),b=i(n,h,e?2:1),y=0;if("function"!=typeof m)throw TypeError(t+" is not iterable!");if(a(m)){for(f=o(t.length);f>y;y++)if((g=e?b(s(p=t[y])[0],p[1]):b(t[y]))===c||g===u)return g}else for(v=m.call(t);!(p=v.next()).done;)if((g=r(v,b,p.value,e))===c||g===u)return g}).BREAK=c,e.RETURN=u},function(t,e,n){var i=n(15);t.exports=function(t,e,n){for(var r in e)i(t,r,e[r],n);return t}},function(t,e,n){var i=n(6);t.exports=function(t,e){if(!i(t)||t._t!==e)throw TypeError("Incompatible receiver, "+e+" required!");return t}},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i=function(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n]);return e.default=t,e}(n(1)),r=n(50),a=o(r),s=o(n(398));function o(t){return t&&t.__esModule?t:{default:t}}var l=a.default.extend({_name:"",_parent:null,_persistent:!0,init:function(t,e,n,i,r){Object.defineProperty(this,"value",{get:this.get,set:this.set}),Object.defineProperty(this,"persistent",{get:function(){return this._persistent}}),this._super(),this._name=t,this._parent=n,this._root=n._root,this.set(e,!1,r),this.on(i)},get:function(t){return t&&!this._persistent?this._persistentVal:this._val},set:function(t,e,n){return!!this.isSetAllowed(t,e)&&((n=void 0===n||n)&&(this._persistentVal=t),this._previousVal=i.deepClone(this._val),this._val=t,this._persistent=n,this.trigger(new r.ChangeEvent(this),this._name),!0)},isSetAllowed:function(t,e){return e||this._val!==t&&JSON.stringify(this._val)!==JSON.stringify(t)},setTreeFreezer:function(t){t?this.freeze(["hook_change"]):this.unfreeze()}}),c=a.default.extend({getClassDefaults:function(){return{}},objectLeafs:[],init:function(t,e,n,r){this._type=this._type||"model",this._id=this._id||i.uniqueId("m"),this._data={},this._parent=n,this._root=n?n._root:this,this._name=t,this._inError=!1,this._ready=!1,this._readyOnce=!1,this._loadedOnce=!1,this._intervals=function t(e){return e._intervals||(e._parent?t(e._parent):new s.default)}(this),this._space={},this._dataId=!1,this._limits={},this._super();var a=i.deepExtend({},this.getClassDefaults(),e);this.set(a),r&&this.on(r)},get:function(t){if(t){var e=this._data[t];return c.isModel(e)?e:e.value}return this._data},set:function(t,e,n,r,a){var s=this._setting,o=void 0,d=!1;if(i.isPlainObject(t)?(o=t,r=n,n=e):(o={})[t]=e,0!==Object.keys(o).length){this._setting=!0,this._freeze||(d=!0,this.setTreeFreezer(!0));var f=[];for(var p in o){e=o[p];var v=i.isPlainObject(e)&&this._data[p]instanceof c,g=(!i.isPlainObject(e)||this.isObjectLeaf(p))&&this._data[p]instanceof l;if(this._data[p]&&(v||g)){var m=this._data[p].value,b=this._data[p].set(e,n,r);g&&b&&f.push(p);var y="set"+i.capitalize(p[0])+p.slice(1);this.isHook()&&i.isFunction(this[y])&&a!==this[y]&&e!==m&&this[y]("which"===p?{concept:e}:e)}else this._data[p]=h(p,e,this,r),u(this,p)}s||(this.checkDataChanges(f),this.validate&&this.validate()),s&&!n||(this._setting=!1,!d||this.isHook()&&this.isLoading()||this.setTreeFreezer(!1),this.isHook()||this.isLoading()||this.setReady())}},checkDataChanges:function(){},setTreeFreezer:function(t){i.forEach(this._data,function(e){e.setTreeFreezer(t)}),t?this.freeze(["hook_change"]):this.unfreeze()},getType:function(){return this._type},getSubmodels:function(){var t=arguments.length>0&&void 0!==arguments[0]&&arguments[0],e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:function(){return!0},n=t?{}:[];return i.forEach(this._data,function(i,r){i&&void 0!==i._id&&c.isModel(i)&&e(i)&&(t?n[r]=i:n.push(i))}),n},getPlainObject:function(t){var e={},n=this;return i.forEach(this._data,function(r,a){if(r instanceof c)e[a]=r.getPlainObject(t);else if(!t||r.persistent){var s=r.get(t);i.isDate(s)&&(s=n.formatDate(s)),e[a]=s}}),e},formatDate:function(t){return t.toString()},getModelObject:function(t){return t?this._data[t]:this},clear:function(){var t=this.getSubmodels();for(var e in t)t[e].clear();this.setReady(!1),this.off(),this._intervals.clearAllIntervals(),this._data={}},validate:function(){},_isLoading:function(){return!1},isLoading:function(){if(this._isLoading())return!0;var t=this.getSubmodels(),e=void 0;for(e=0;e<t.length;e+=1)if(t[e].isLoading())return!0;return!1},setReady:function(t){if(!1===t)return this._ready=!1,void(this._parent&&this._parent.setReady&&this._parent.setReady(!1));var e=this._ready;this._ready=!this.isLoading()&&!this._setting,this._ready&&e!==this._ready&&(this._readyOnce||(this._readyOnce=!0,this.trigger("readyOnce")),this.trigger("ready"))},setInterModelListeners:function(){i.forEach(this.getSubmodels(),function(t){return t.setInterModelListeners()})},startPreload:function(){var t=[];return t.push(this.preloadData()),i.forEach(this.getSubmodels(),function(e){return t.push(e.startPreload())}),Promise.all(t)},preloadData:function(){return Promise.resolve()},startLoading:function(t){var e=this;this.trigger("startLoading");var n=[];return n.push(this.loadData(t)),i.forEach(this.getSubmodels(),function(e){return n.push(e.startLoading(t))}),Promise.all(n).then(this.onSuccessfullLoad.bind(this)).catch(function(t){i.error("error in model "+e._name),e.triggerLoadError(t)})},loadData:function(t){return this.isHook()&&i.warn("Hook "+this._name+" is not loading because it's not extending Hook prototype."),Promise.resolve()},loadSubmodels:function(t){var e=[],n=this.getSubmodels();return i.forEach(n,function(n){e.push(n.startLoading(t))}),e.length>0?Promise.all(e):Promise.resolve()},onSuccessfullLoad:function(){var t=this;this.validate(),i.timeStamp("Vizabi Model: Model loaded: "+this._name+"("+this._id+")"),this._loadedOnce=!0,this._loadCall=!1,this.setTreeFreezer(!1),i.defer(function(){return t.setReady()})},handleLoadError:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.getDefaultError();this.triggerLoadError(t)},getDefaultError:function(){var t=new Error;return t.message=this.getClosestModel("locale").getTFunction()("connection/error"),t},triggerLoadError:function(t){if(a.default.unfreezeAll(),this._inError)return i.error("Model "+this._name+" already in error");this._inError=!0,this._root.trigger("load_error",t),this._root.trigger("load_error1",t)},afterPreload:function(){var t=this.getSubmodels();i.forEach(t,function(t){t.afterPreload()})},isHook:function(){return Boolean(this.use)},getSubhooks:function(t){return this.getSubmodels(t,function(t){return t.isHook()})},getHookWhich:function(t){var e=[];return this.use&&this.use===t&&e.push(this.which),i.forEach(this.getSubmodels(),function(n){e=i.unique(e.concat(n.getHookWhich(t)))}),e},getIndicators:function(){return this.getHookWhich("indicator")},getProperties:function(){return this.getHookWhich("property")},getDimension:function(){return this.dim||!1},getDimensionOrWhich:function(){return this.dim||"constant"!=this.use&&this.which},getFilter:function(){return{}},mapValue:function(t){return t},getParser:function(){return null},getDefaults:function(){return i.deepExtend({},this.getClassDefaults(),this.getSubmodelDefaults())},getSubmodelDefaults:function(){var t={};return i.forEach(this.getSubmodels(!0),function(e,n){t[n]=e.getDefaults()}),t},isObjectLeaf:function(t){return-1!==this.objectLeafs.indexOf(t)},getClosestModel:function(t){var e=this.findSubmodel(t);return e||(this._parent?this._parent.getClosestModel(t):null)},findSubmodel:function(t){for(var e in this._data)if(e===t&&c.isModel(this._data[e]))return this._data[e];return null},isEntities:function(){return!1}});function u(t,e){var n;Object.defineProperty(t,e,{configurable:!0,get:(n=e,function(){return t.get(n)}),set:function(e){return function(n){return t.set(e,n)}}(e)})}function h(t,e,r,a){var s=void 0;if(!i.isPlainObject(e)||i.isArray(e)||r.isObjectLeaf(t)){s=new l(t,e,r,{change:d},a)}else{var o={change:d,hook_change:function(t,e){r.trigger(t,e)},load_error:function(){return r.trigger.apply(r,arguments)},dataLoaded:function(){return r.trigger.apply(r,arguments)},ready:function(t,e){r.setReady(!1),i.defer(function(){r.setReady()})}};if(c.isModel(e,!0))(s=e).on(o);else{var u=t.split("_")[0],h=c.get(u,!0);if(!h)try{h=n(399)("./"+u).default}catch(t){h=c}s=new h(t,e,r,o)}}return s;function d(t,e){r._ready&&(e=r._name+"."+e,r.trigger(t,e))}}c.isModel=function(t,e){return t&&(t.hasOwnProperty("_data")||e&&t.hasOwnProperty("_val"))},e.default=c},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.ChangeEvent=e.DefaultEvent=void 0;var i,r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},a=function(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n]);return e.default=t,e}(n(1)),s=n(31),o=(i=s)&&i.__esModule?i:{default:i};var l=!1,c=[],u={},h=e.DefaultEvent=o.default.extend({source:"",type:"default",init:function(t,e){this.source=t,e&&(this.type=e)}}),d=(e.ChangeEvent=h.extend("change",{type:"change",init:function(t){this._super(t)}}),o.default.extend({init:function(){this._id=this._id||a.uniqueId("e"),this._events={},this._freeze=!1,this._freezer=[],this._freezeExceptions={}},on:function(t,e,n){if(!this.splitEventParameters(t,e,n,this.on)){var i=this.traversePath(e);i&&(i._events[t]=i._events[t]||[],"function"==typeof n?i._events[t].push(n):a.warn("Can't bind event '"+t+"'. It must be a function."))}},off:function(t,e,n){if(0!=arguments.length){if(!this.splitEventParameters(t,e,n,this.off)){var i=this.traversePath(e);if(i&&i._events.hasOwnProperty(t)){if(void 0===n)return void(i._events[t]=[]);var r=i._events[t].indexOf(n);r>-1?i._events[t].splice(r,1):a.warn("Could not unbind function "+n.name+". Function not in bound function list.")}}}else this._events={}},splitEventParameters:function(t,e,n,i){var r=void 0;if(a.isArray(t)){for(r=0;r<t.length;r+=1)i.call(this,t[r],n);return!0}if(a.isObject(t)){for(r in t)i.call(this,r,t[r]);return!0}if("function"==typeof e){if(n=e,-1!==t.indexOf(":")){var s=t.split(":");t=s[0],e=s[1]}else e=void 0;return i.call(this,t,e,n),!0}if(a.isArray(e)){for(r=0;r<e.length;r+=1)i.call(this,t,e[r],n);return!0}if(n&&a.isArray(n)){for(r=0;r<n.length;r+=1)i.call(this,t,e,n[r]);return!0}return!1},traversePath:function(t){if(void 0===t||a.isArray(t)&&0==t.length)return this;if("string"==typeof t&&(t=t.split(".")),!a.isArray(t))return a.error("Path is wrong type. Path should be a string or array but is "+(void 0===t?"undefined":r(t))+"."),null;var e=t.shift();if(void 0!==this[e])return this.getModelObject(e).traversePath(t);a.warn("Can't find child \""+e+'" of the model '+this._name+".")},createEventFromType:function(t){if(t instanceof h)return t;var e=h.get(t,!0);return e?new e(this):new h(this,t)},trigger:function(t,e){var n=this,i=void 0,r=void 0;if(a.isArray(t))for(i=0,r=t.length;i<r;i+=1)this.trigger(t[i],e);else{var s=this.createEventFromType(t);if(this._events.hasOwnProperty(s.type)){var o=this;a.forEach(this._events[s.type],function(t){var i=function(){var n="Vizabi Event: "+s.type;a.timeStamp(n),t.apply(o,[s,e])};n.allowExecution(s)?i():(n._freezer.push(i),l&&!c[n._id]&&(n.freeze(),c[n._id]=n))})}}},allowExecution:function(t){return!this._freeze&&!l||l&&u.hasOwnProperty(t.type)||!l&&this._freeze&&this._freezeExceptions.hasOwnProperty(t.type)},freeze:function(t){if(this._freeze=!0,t){a.isArray(t)||(t=[t]);for(var e=0;e<t.length;e+=1)this._freezeExceptions[t[e]]=!0}},unfreeze:function(){for(this._freeze=!1,this._freezeExceptions={};this._freezer.length;){this._freezer.shift()()}},clearFrozen:function(){this._freeze=!1,this._freezeExceptions={},this._freezer=[]}}));d.freezeAll=function(t){if(l=!0,!t)return;a.isArray(t)||(t=[t]);a.forEach(t,function(t){u[t]=!0})},d.unfreezeAll=function(){l=!1,u={};for(var t=Object.keys(c),e=0;e<t.length;e++){var n=c[t[e]];n&&n.unfreeze()}c={}},e.default=d},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i=function(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n]);return e.default=t,e}(n(1)),r=c(n(5)),a=c(n(112)),s=c(n(32)),o=c(n(78)),l=n(21);function c(t){return t&&t.__esModule?t:{default:t}}var u=r.default.extend({init:function(t,e){this.name="gapminder-indicatorpicker",this.template='<span class="vzb-ip-holder"><span class="vzb-ip-select"></span><span class="vzb-ip-info"></span></span>';var n=this;this.model_expects=[{name:"time",type:"time"},{name:"targetModel"},{name:"locale",type:"locale"}],this.showHoverValues=t.showHoverValues||!1,this.model_binds={"translate:locale":function(t){n.updateView()},ready:function(t){n.updateView()}},this.model_binds["change:targetModel"]=function(t,e){-1!=e.indexOf("."+n.targetProp)&&n.updateView()},this._super(t,e),this.model.targetModel.isHook()&&this.showHoverValues&&this.model.targetModel._parent.on("change:highlight",function(t,e){var r=n.model.targetModel;if(r.isHook()){var a=r._parent;if(n.showHoverValues&&"constant"!=r.use){var s=a.getHighlighted();s.length>1||(s.length?a.getFrame(n.model.time.value,function(t){if(!n._highlighted&&t){var e=a.getHighlighted();if(e.length){var s=r.getDataKeys(),o=t[r._name][i.getKey(e[0],s)],l=r.getConceptprops().concept_type;if(o&&"color"===r._type&&["entity_set","entity_domain"].includes(l)){var c=r.getColorlegendMarker();c.label.getItems()[o]&&(o=c.label.getItems()[o])}n._highlightedValue=o,n._highlighted=!n._highlightedValue&&0!==n._highlightedValue||"constant"!==r.use,n.updateView()}}}):(null!==e&&"highlight"!==e?e&&(n._highlightedValue=e[r._name],n._highlighted=!n._highlightedValue&&0!==n._highlightedValue||"constant"!==r.use):n._highlighted=!1,n.updateView()))}}}),this.targetProp=t.targetProp||this.model.targetModel instanceof s.default?"which":this.model.targetModel instanceof a.default?"dim":this.model.targetModel instanceof o.default?"space":null},ready:function(){this.updateView()},readyOnce:function(){var t=this;this.el_select=d3.select(this.element).select(".vzb-ip-select"),this.el_select.on("click",function(){var e=t.el_select.node().getBoundingClientRect(),n=(t.root.element instanceof Array?t.root.element:d3.select(t.root.element)).node().getBoundingClientRect(),i=t.root.findChildByName("gapminder-treemenu"),r=i.activeProfile.col_width,a=parseInt(i.wrapper.style("padding-left"),10)||0,s=parseInt(i.wrapper.style("padding-right"),10)||0,o=e.bottom-n.top,l=e.left-n.left-.5*(a+s+r-e.width);i.targetModel(t.model.targetModel).alignX("left").alignY("top").top(o).left(l).updateView().toggle()}),this.infoEl=d3.select(this.element).select(".vzb-ip-info"),t.model.targetModel.isHook()&&(i.setIcon(this.infoEl,l.question).select("svg").attr("width","0px").attr("height","0px"),this.infoEl.on("click",function(){t.root.findChildByName("gapminder-datanotes").pin()}),this.infoEl.on("mouseover",function(){var e=t.el_select.node().getBoundingClientRect(),n=t.root.element.getBoundingClientRect(),i=e.bottom-n.top,r=e.left-n.left+e.width;t.root.findChildByName("gapminder-datanotes").setHook(t.model.targetModel._name).show().setPos(r,i)}),this.infoEl.on("mouseout",function(){t.root.findChildByName("gapminder-datanotes").hide()}))},updateView:function(){if(this._readyOnce){var t=this.model.locale.getTFunction(),e=this.model.targetModel,n=e[this.targetProp],i=e._type,r=void 0,a=void 0;if(e instanceof s.default)if(r=e.getConceptprops(),this.showHoverValues&&this._highlighted){var o=e.getTickFormatter();a=this._highlightedValue||0===this._highlightedValue?o(this._highlightedValue):t("hints/nodata")}else a="_default"===n?t("indicator/_default/"+i):r.name_short;else{var l=e._root.dataManager;a=e.space.map(function(t){return l.getConceptProperty(e._space[t].dim,"name")}).join(", ")}this.el_select.text(a).attr("title",function(t){return this.offsetWidth<this.scrollWidth?a:null});var c=r&&!r.description&&!r.sourceName&&!r.sourceLink;this.infoEl.classed("vzb-invisible",c)}}});e.default=u},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i,r=n(5),a=(i=r)&&i.__esModule?i:{default:i};e.default=a.default.extend({init:function(t,e){this.template='<span class="vzb-sc-holder vzb-dialog-checkbox"><input type="checkbox"><label></label></span>';var n=this;this.name="gapminder-simplecheckbox",this.checkbox=t.checkbox,this.submodel=t.submodel,this.model_expects=[{name:"mdl"},{name:"locale",type:"locale"}],this.model_binds={"change:mdl":function(t){n.updateView()},"translate:locale":function(t){n.updateView()}};var i=this.submodel?this.submodel+":":"";this.model_binds["change:mdl."+i+this.checkbox]=function(){n.updateView()},this._super(t,e)},ready:function(){this.parentModel=this.submodel?this.model.mdl[this.submodel]:this.model.mdl,this.updateView()},readyOnce:function(){var t=this;this.element=d3.select(this.element);var e="-check-"+t._id;this.labelEl=this.element.select("label").attr("for",e),this.checkEl=this.element.select("input").attr("id",e).on("change",function(){t._setModel(d3.select(this).property("checked"))})},updateView:function(){this.translator=this.model.locale.getTFunction();var t=this.parentModel&&(this.parentModel[this.checkbox]||!1===this.parentModel[this.checkbox]);this.labelEl.classed("vzb-hidden",!t),t&&(this.labelEl.text(this.translator("check/"+this.checkbox)),this.checkEl.property("checked",!!this.parentModel[this.checkbox]))},_setModel:function(t){this.parentModel[this.checkbox]=t}})},function(t,e,n){var i=n(10).f,r=n(17),a=n(7)("toStringTag");t.exports=function(t,e,n){t&&!r(t=n?t:t.prototype,a)&&i(t,a,{configurable:!0,value:e})}},function(t,e,n){var i=n(24),r=n(7)("toStringTag"),a="Arguments"==i(function(){return arguments}());t.exports=function(t){var e,n,s;return void 0===t?"Undefined":null===t?"Null":"string"==typeof(n=function(t,e){try{return t[e]}catch(t){}}(e=Object(t),r))?n:a?i(e):"Object"==(s=i(e))&&"function"==typeof e.callee?"Arguments":s}},function(t,e,n){var i=n(0),r=n(28),a=n(4),s=n(87),o="["+s+"]",l=RegExp("^"+o+o+"*"),c=RegExp(o+o+"*$"),u=function(t,e,n){var r={},o=a(function(){return!!s[t]()||"​"!="​"[t]()}),l=r[t]=o?e(h):s[t];n&&(r[n]=l),i(i.P+i.F*o,"String",r)},h=u.trim=function(t,e){return t=String(r(t)),1&e&&(t=t.replace(l,"")),2&e&&(t=t.replace(c,"")),t};t.exports=u},function(t,e){t.exports={}},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i=function(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n]);return e.default=t,e}(n(1)),r=a(n(49));a(n(50));function a(t){return t&&t.__esModule?t:{default:t}}var s=r.default.extend({dataConnectedChildren:[],checkDataChanges:function(t){var e=this;t&&this.dataConnectedChildren&&(!i.isArray(t)&&i.isObject(t)&&(t=Object.keys(t)),0!=t.length&&0!=this.dataConnectedChildren.length&&t.filter(function(t){return-1!==e.dataConnectedChildren.indexOf(t)}).length>0&&(this.trigger("dataConnectedChange"),this.startLoading({dataConnectedChange:!0})))}});e.default=s},function(t,e,n){var i=n(22),r=n(3),a=r["__core-js_shared__"]||(r["__core-js_shared__"]={});(t.exports=function(t,e){return a[t]||(a[t]=void 0!==e?e:{})})("versions",[]).push({version:i.version,mode:n(35)?"pure":"global",copyright:"© 2019 Denis Pushkarev (zloirock.ru)"})},function(t,e,n){var i=n(24);t.exports=Object("z").propertyIsEnumerable(0)?Object:function(t){return"String"==i(t)?t.split(""):Object(t)}},function(t,e){e.f={}.propertyIsEnumerable},function(t,e,n){"use strict";var i=n(2);t.exports=function(){var t=i(this),e="";return t.global&&(e+="g"),t.ignoreCase&&(e+="i"),t.multiline&&(e+="m"),t.unicode&&(e+="u"),t.sticky&&(e+="y"),e}},function(t,e,n){var i=n(2),r=n(13),a=n(7)("species");t.exports=function(t,e){var n,s=i(t).constructor;return void 0===s||void 0==(n=i(s)[a])?e:r(n)}},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i,r=function(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n]);return e.default=t,e}(n(1)),a=n(79);var s={THUMB_HEIGHT:17,THUMB_STROKE_WIDTH:3},o={small:{},medium:{},large:{}},l=((i=a)&&i.__esModule?i:{default:i}).default.extend({init:function(t,e){this.name="singlehandleslider";var n=r.extend({},s);this.options=r.extend(n,this.options||{});var i=r.extend({},o);this.profiles=r.extend(i,this.profiles||{}),this.slider_properties=t.properties||{};var a=this.slider_properties.roundDigits;(a||0==a)&&(this.options.ROUND_DIGITS=a),this.slider_properties.domain&&(this.options.EXTENT_MIN=this.slider_properties.domain[0],this.options.EXTENT_MAX=this.slider_properties.domain[1]),this._super(t,e)},readyOnce:function(){this._super();var t=this.options,e=t.BAR_WIDTH,n=t.THUMB_HEIGHT;this.padding.top=.5*(n+t.THUMB_STROKE_WIDTH),this.padding.bottom=.5*(n+t.THUMB_STROKE_WIDTH)-e;var i=this._getComponentWidth();i<0&&(i=0),this.rescaler.domain(this.slider_properties.domain||[this.options.EXTENT_MIN,this.options.EXTENT_MAX]),this.rescaler.range(d3.range(0,i,i/(this.rescaler.domain().length-1)).concat([i])),this.sliderEl.call(this.brush.handleSize(t.THUMB_HEIGHT+t.THUMB_STROKE_WIDTH)),this.sliderEl.selectAll(".w").classed("vzb-hidden",!0),this.sliderEl.select(".selection").classed("vzb-hidden",!0),this.sliderEl.select(".overlay").lower().style("stroke-opacity","0").style("stroke-width",.5*n+"px").attr("rx",.5*e).attr("ry",.5*e),this.sliderEl.selectAll(".vzb-slider-thumb-badge").style("stroke-width",this.options.THUMB_STROKE_WIDTH+"px")},_getBrushEventListeners:function(){var t=this,e=this,n=this._super();return{start:n.start,brush:function(){!e.nonBrushChange&&d3.event.sourceEvent&&(e.slider_properties.suppressInput?e._snap(d3.event.selection):n.brush.apply(n,arguments))},end:function(){!e.nonBrushChange&&d3.event.sourceEvent&&(e.slider_properties.snapValue&&t._snap(d3.event.selection),e._setFromExtent(!0,!0))}}},_snap:function(t){var e=this.rescaler.invert(this._extentToValue(t)),n=this.rescaler.domain(),i=n[n.length-1]>n[0],r=d3.bisector(d3[i?"ascending":"descending"]).left(n,e)||1;e=(i?1:-1)*(e-n[r-1]-(n[r]-e))>0?n[r]:n[r-1],this._moveBrush(this._valueToExtent(e))},_createThumbs:function(t){this.options.BAR_WIDTH;var e=.5*this.options.THUMB_HEIGHT,n=d3.arc().outerRadius(e).startAngle(0).endAngle(2*Math.PI);t.attr("transform","translate("+(e+.5*this.options.THUMB_STROKE_WIDTH)+","+(e+.5*this.options.THUMB_STROKE_WIDTH)+")").append("path").attr("d",n)},_resize:function(){this._super();var t=this._getComponentWidth();this.rescaler.range(d3.range(0,t||1,t/(this.rescaler.domain().length-1)||1).concat([t]))},_valueToExtent:function(t){return[this.rescaler.domain()[0],t]},_extentToValue:function(t){return t[1]},_setModel:function(t,e,n){if(this.slider_properties.suppressInput&&this._extentToValue(t).toFixed(this.options.ROUND_DIGITS)==this.model.submodel[this.arg])return;this._super(t,e,n)}});e.default=l},function(t,e,n){var i=n(18),r=n(8),a=n(41);t.exports=function(t){return function(e,n,s){var o,l=i(e),c=r(l.length),u=a(s,c);if(t&&n!=n){for(;c>u;)if((o=l[u++])!=o)return!0}else for(;c>u;u++)if((t||u in l)&&l[u]===n)return t||u||0;return!t&&-1}}},function(t,e){e.f=Object.getOwnPropertySymbols},function(t,e,n){var i=n(24);t.exports=Array.isArray||function(t){return"Array"==i(t)}},function(t,e,n){var i=n(25),r=n(28);t.exports=function(t){return function(e,n){var a,s,o=String(r(e)),l=i(n),c=o.length;return l<0||l>=c?t?"":void 0:(a=o.charCodeAt(l))<55296||a>56319||l+1===c||(s=o.charCodeAt(l+1))<56320||s>57343?t?o.charAt(l):a:t?o.slice(l,l+2):s-56320+(a-55296<<10)+65536}}},function(t,e,n){var i=n(6),r=n(24),a=n(7)("match");t.exports=function(t){var e;return i(t)&&(void 0!==(e=t[a])?!!e:"RegExp"==r(t))}},function(t,e,n){var i=n(7)("iterator"),r=!1;try{var a=[7][i]();a.return=function(){r=!0},Array.from(a,function(){throw 2})}catch(t){}t.exports=function(t,e){if(!e&&!r)return!1;var n=!1;try{var a=[7],s=a[i]();s.next=function(){return{done:n=!0}},a[i]=function(){return s},t(a)}catch(t){}return n}},function(t,e,n){"use strict";var i=n(54),r=RegExp.prototype.exec;t.exports=function(t,e){var n=t.exec;if("function"==typeof n){var a=n.call(t,e);if("object"!=typeof a)throw new TypeError("RegExp exec method returned something other than an Object or null");return a}if("RegExp"!==i(t))throw new TypeError("RegExp#exec called on incompatible receiver");return r.call(t,e)}},function(t,e,n){"use strict";n(135);var i=n(15),r=n(14),a=n(4),s=n(28),o=n(7),l=n(102),c=o("species"),u=!a(function(){var t=/./;return t.exec=function(){var t=[];return t.groups={a:"7"},t},"7"!=="".replace(t,"$<a>")}),h=function(){var t=/(?:)/,e=t.exec;t.exec=function(){return e.apply(this,arguments)};var n="ab".split(t);return 2===n.length&&"a"===n[0]&&"b"===n[1]}();t.exports=function(t,e,n){var d=o(t),f=!a(function(){var e={};return e[d]=function(){return 7},7!=""[t](e)}),p=f?!a(function(){var e=!1,n=/a/;return n.exec=function(){return e=!0,null},"split"===t&&(n.constructor={},n.constructor[c]=function(){return n}),n[d](""),!e}):void 0;if(!f||!p||"replace"===t&&!u||"split"===t&&!h){var v=/./[d],g=n(s,d,""[t],function(t,e,n,i,r){return e.exec===l?f&&!r?{done:!0,value:v.call(e,n,i)}:{done:!0,value:t.call(n,e,i)}:{done:!1}}),m=g[0],b=g[1];i(String.prototype,t,m),r(RegExp.prototype,d,2==e?function(t,e){return b.call(t,this,e)}:function(t){return b.call(t,this)})}}},function(t,e,n){var i=n(3).navigator;t.exports=i&&i.userAgent||""},function(t,e,n){"use strict";var i=n(3),r=n(0),a=n(15),s=n(47),o=n(36),l=n(46),c=n(45),u=n(6),h=n(4),d=n(69),f=n(53),p=n(88);t.exports=function(t,e,n,v,g,m){var b=i[t],y=b,_=g?"set":"add",M=y&&y.prototype,w={},x=function(t){var e=M[t];a(M,t,"delete"==t?function(t){return!(m&&!u(t))&&e.call(this,0===t?0:t)}:"has"==t?function(t){return!(m&&!u(t))&&e.call(this,0===t?0:t)}:"get"==t?function(t){return m&&!u(t)?void 0:e.call(this,0===t?0:t)}:"add"==t?function(t){return e.call(this,0===t?0:t),this}:function(t,n){return e.call(this,0===t?0:t,n),this})};if("function"==typeof y&&(m||M.forEach&&!h(function(){(new y).entries().next()}))){var S=new y,z=S[_](m?{}:-0,1)!=S,O=h(function(){S.has(1)}),k=d(function(t){new y(t)}),E=!m&&h(function(){for(var t=new y,e=5;e--;)t[_](e,e);return!t.has(-0)});k||((y=e(function(e,n){c(e,y,t);var i=p(new b,e,y);return void 0!=n&&l(n,g,i[_],i),i})).prototype=M,M.constructor=y),(O||E)&&(x("delete"),x("has"),g&&x("get")),(E||z)&&x(_),m&&M.clear&&delete M.clear}else y=v.getConstructor(e,t,g,_),s(y.prototype,n),o.NEED=!0;return f(y,t),w[t]=y,r(r.G+r.W+r.F*(y!=b),w),m||v.setStrong(y,t,g),y}},function(t,e,n){for(var i,r=n(3),a=n(14),s=n(39),o=s("typed_array"),l=s("view"),c=!(!r.ArrayBuffer||!r.DataView),u=c,h=0,d="Int8Array,Uint8Array,Uint8ClampedArray,Int16Array,Uint16Array,Int32Array,Uint32Array,Float32Array,Float64Array".split(",");h<9;)(i=r[d[h++]])?(a(i.prototype,o,!0),a(i.prototype,l,!0)):u=!1;t.exports={ABV:c,CONSTR:u,TYPED:o,VIEW:l}},function(t,e,n){"use strict";t.exports=n(35)||!n(4)(function(){var t=Math.random();__defineSetter__.call(null,t,function(){}),delete n(3)[t]})},function(t,e,n){"use strict";var i=n(0);t.exports=function(t){i(i.S,t,{of:function(){for(var t=arguments.length,e=new Array(t);t--;)e[t]=arguments[t];return new this(e)}})}},function(t,e,n){"use strict";var i=n(0),r=n(13),a=n(23),s=n(46);t.exports=function(t){i(i.S,t,{from:function(t){var e,n,i,o,l=arguments[1];return r(this),(e=void 0!==l)&&r(l),void 0==t?new this:(n=[],e?(i=0,o=a(l,arguments[2],2),s(t,!1,function(t){n.push(o(t,i++))})):s(t,!1,n.push,n),new this(n))}})}},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i,r=function(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n]);return e.default=t,e}(n(1)),a=n(49);var s=((i=a)&&i.__esModule?i:{default:i}).default.extend({getClassDefaults:function(){return r.deepExtend(this._super(),{select:[],highlight:[],superHighlight:[],opacityHighlightDim:.1,opacitySelectDim:.3,opacityRegular:1,limit:1e3,allowSelectMultiple:!0})},init:function(t,e,n,i,r){this._type="marker",this._visible=[],this._super(t,e,n,i,r),this.on("change","space",this.setInterModelListeners.bind(this))},setInterModelListeners:function(){var t=this;r.forEach(this.getSpace(),function(e){t._space[e]=t.getClosestModel(e)}),this._super()},_receiveSyncModelUpdate:function(t){var e=t.getConceptprops().concept_type;if(["entity_set","entity_domain"].includes(e)){var n={dim:t.which,filter:t.which===t._getFirstDimension()?r.clone(t.getEntity().filter):{}};this.setDataSourceForAllSubhooks(t.data),this.getFirstEntityModel().set(n,!1,!1)}},getFirstEntityModel:function(){return this._space[this.space[0]]},setSpace:function(t){var e=this,n=Object.keys(this.getSubhooks(!0)),i={},a={};(i.space=this._root.dimensionManager.getDimensionModelsForSpace(this._space,t)).filter(function(t){return!e.space.includes(t)}).forEach(function(t){var r=e.getClosestModel(t),s="label"+t.replace(r._type,""),o={which:r.dim,use:"property"},l=e._root.dataManager.getAvailableDataForKey(r.dim,"name")[0];l&&(o.which=l.value,o.data=l.data),n.includes(s)?(o.spaceRef=t,i[s]=o):(o.key=[{concept:r.dim}],o.dataSource=o.data,o.concept=o.which,a[s]=o,i[s]={})}),this.set(i),r.forEach(a,function(t,n){e[n].setInterModelListeners(),e[n].setWhich(t)}),this._dataCube=this.getSubhooks(!0)},getAvailableSpaces:function(){var t=new Map;return r.forEach(this._root._data,function(e){if("data"===e._type){var n=e.getConceptprops();e.keyAvailability.forEach(function(e,i){e.length>1&&t.set(i,e.map(function(t){return n[t]}))})}}),t},getAvailableData:function(){var t=this;if(0===d3.keys(this._space).length)return r.warn("getAvailableData() is trying to access missing _space items of marker '"+this._name+"' which likely haven't been resoled in time");var e=r.unique(this.space.map(function(e){return t._space[e].dim})),n=this._root.dataManager.getAvailabilityForMarkerKey(e),i=this._root.dataManager.getDataModels().values().next().value;return e.filter(function(t){return null!=t}).forEach(function(t){return n.push({key:[i.getConceptprops(t)],value:i.getConceptprops(t),dataSource:i})}),n.push({key:[i.getConceptprops("_default")],value:i.getConceptprops("_default"),dataSource:i}),n},getAvailableConcept:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},e=t.index,n=void 0===e?0:e,i=t.type,r=void 0===i?null:i,a=t.includeOnlyIDs,s=void 0===a?[]:a,o=t.excludeIDs,l=void 0===o?[]:o;if(!r&&0==s.length&&0==l.length)return null;var c=this.getAvailableData().filter(function(t){return!(r&&t.value.concept_type&&t.value.concept_type!==r||0!=s.length&&-1===s.indexOf(t.value.concept)||0!=l.length&&-1!=l.indexOf(t.value.concept))});return c[n]||c[c.length-1]},setDataSourceForAllSubhooks:function(t){var e={};this.getSubhooks().forEach(function(n){e[n._name]={data:t}}),this.set(e,null,!1)},validate:function(){var t=this.getDimension(),e=this._visible.map(function(e){return e[t]});e.length&&(this.select=this.select.filter(function(n){return-1!==e.indexOf(n[t])}),this.setHighlight(this.highlight.filter(function(n){return-1!==e.indexOf(n[t])})))},setVisible:function(t){this._visible=t},getVisible:function(t){return this._visible},getSelected:function(t){return t?this.select.map(function(e){return e[t]}):this.select},selectMarker:function(t){var e=this,n=this._createValue(t);this.isSelected(t)?this.select=this.select.filter(function(t){return JSON.stringify(e._createValue(t))!==JSON.stringify(n)}):this.select=this.allowSelectMultiple?this.select.concat(n):[n]},selectAll:function(t,e){if(this.allowSelectMultiple){var n=void 0,i=r.unique(this._getAllDimensions({exceptType:"time"}));this.select=this._visible.map(function(t){return n={},i.forEach(function(e){return n[e]=t[e]}),n})}},isSelected:function(t){var e=this,n=JSON.stringify(this._createValue(t));return-1!==this.select.map(function(t){return JSON.stringify(e._createValue(t))===n}).indexOf(!0)},_createValue:function(t){return this._getAllDimensions({exceptType:"time"}).reduce(function(e,n){return e[n]=t[n],e},{})},getHighlighted:function(t){return t?this.highlight.map(function(e){return e[t]}):this.highlight},setHighlight:function(t){r.isArray(t)?this.getModelObject("highlight").set(t,!1,!1):this.setHighlight([].concat(t))},setSuperHighlight:function(t){this.getModelObject("superHighlight").set(r.isArray(t)?t:[t],!1,!1)},clearSuperHighlighted:function(){this.setSuperHighlight([])},isSuperHighlighted:function(t){var e=JSON.stringify(this._createValue(t));return~this.superHighlight.findIndex(function(t){return JSON.stringify(t)===e})},setSelect:function(t){r.isArray(t)?this.getModelObject("select").set(t):this.setSelect([].concat(t))},highlightMarker:function(t){var e=this._createValue(t);this.isHighlighted(t)||this.setHighlight(this.highlight.concat(e))},unhighlightEntity:function(t){var e=this._createValue(t);this.isHighlighted(t)&&this.setHighlight(this.highlight.filter(function(t){return t[dimension]!==e}))},isHighlighted:function(t){var e=this,n=JSON.stringify(this._createValue(t));return-1!==this.highlight.map(function(t){return JSON.stringify(e._createValue(t))===n}).indexOf(!0)},clearHighlighted:function(){this.setHighlight([])},clearSelected:function(){this.select=[]},setLabelOffset:function(t,e){if(0!==e[0]||1!==e[1]){var n=r.unique(this._getAllDimensions({exceptType:"time"})),i=n.join(",");this.select.find(function(e){return r.getKey(e,n)==t[i]}).labelOffset=[Math.round(1e3*e[0])/1e3,Math.round(1e3*e[1])/1e3],this.set("select",this.select,!0)}},getImportantHooks:function(){var t=[];return r.forEach(this._dataCube||this.getSubhooks(!0),function(e,n){e._important&&t.push(n)}),t},getLabelHookNames:function(){var t=this;return r.unique(this._getAllDimensions({exceptType:"time"})).reduce(function(e,n){var i={};r.forEach(t._dataCube||t.getSubhooks(!0),function(t,e){if(t.isDiscrete())return"label"===t._type&&t.getEntity().dim===n&&(i.label=e),"label"!==t._type&&t.getEntity().dim===n&&(i.key=e),!i.label||!i.key});var a=i.label||i.key;return a&&(e[n]=a),e},{})},getDataKeysPerHook:function(){var t={};return r.forEach(this._dataCube||this.getSubhooks(!0),function(e,n){t[n]=e.getDataKeys()}),t},getKeys:function(t){var e=void 0;t=t||r.unique(this._getAllDimensions({exceptType:"time"})),t=Array.isArray(t)?t:[t];var n=this._getFirstDimension({type:"time"}),i=this._dataCube||this.getSubhooks(!0),a=t.map(function(t){return[]}),s=t.map(function(t){return[]});return r.forEach(i,function(e,n){if("property"===e.use){var i=t.indexOf(e.getEntity().dim);-1===i||s[i].includes(e.dataSource)||(a[i].push(e),s[i].push(e.dataSource))}}),r.forEach(i,function(e,n){"indicator"===e.use&&e.getDataKeys().forEach(function(n){var i=t.indexOf(n);-1===i||s[i].includes(e.dataSource)||a[i].push(e)})}),a.forEach(function(i,a){var s=[];i.forEach(function(e){var i=e.getDataKeys(),r=i.indexOf(t[a]);s=s.concat(Object.keys(e.getNestedItems(i.concat(n))).map(function(t){return[JSON.parse(t)[r]]}))}),s=r.unique(s),e=e?d3.cross(e,s,function(t,e){return t.concat(e)}):s}),r.forEach(i,function(i,r){if(i._important&&"constant"!==i.use){var a=i.getDataKeys(),s=a.map(function(e){return t.indexOf(e)}).reduce(function(t,e,n){return-1!==e&&(t[n]=e),t},[]);if(s.length){var o=i.getNestedItems(a.concat(n)),l=i.getHaveNoDataPointsPerKey(),c=Object.keys(o),u=Object.keys(l||[]),h=(t.every(function(t,e){return t===a[e]}),c.reduce(function(t,e){return-1==u.indexOf(e)&&(t[JSON.stringify(s.map(function(t,n){return JSON.parse(e)[n]}))]=!0),t},{})),d=e.map(function(t){return JSON.stringify(s.map(function(e){return t[e]}))});e=e.filter(function(t,e){return h[d[e]]})}}}),e.length>this.limit&&(r.warn("MARKER getKeys(): only showing the first "+this.limit+" markerElements of "+this._name+". The rest are not displayed because chart may become slow and crash. Set a higher number in marker.limit or apply entity filters"),e=e.slice(0,this.limit)),e.map(function(e){var n={};return t.map(function(t,i){return n[t]=e[i]}),n})},_getCachePath:function(t){var e=this._parent.time.getAllSteps(),n=this.getClosestModel("locale").id+" - "+e[0]+" - "+e[e.length-1]+" - step:"+this._parent.time.step;this._dataCube=this._dataCube||this.getSubhooks(!0);var i=!1;return r.forEach(this._dataCube,function(t,e){t._loadCall&&(i=!0),n=n+"_"+t._dataId+t.which}),i?null:(t&&(n=n+"_"+t.join(",")),n)},_getGrouping:function(){var t=this._dataCube||this.getSubhooks(!0),e=t[Object.keys(t)[0]]._space,n={};return r.forEach(e,function(t){t.grouping&&(n[t.dim]={grouping:t.grouping})}),!r.isEmpty(n)&&n},_getAllDimensions:function(t){var e=[],n=this;r.forEach(this.space,function(t){e.push(n.getClosestModel(t))}),t=t||{};var i=[],a=void 0;return r.forEach(e,function(e){return!(!t.exceptType||e.getType()!==t.exceptType)||(!(!t.onlyType||e.getType()===t.onlyType)||void((a=e.getDimension())&&i.push(a)))}),i},_getFirstDimension:function(t){var e=[],n=this;r.forEach(this.space,function(t){e.push(n.getClosestModel(t))}),t=t||{};var i=!1;return r.forEach(e,function(e){return t.exceptType&&e.getType()!==t.exceptType?(i=e.getDimension(),!1):t.type&&e.getType()===t.type?(i=e.getDimension(),!1):t.exceptType||t.type?void 0:(i=e.getDimension(),!1)}),i},framesAreReady:function(){var t=this._getCachePath();return!!this.cachedFrames&&Object.keys(this.cachedFrames[t]).length==this._parent.time.getAllSteps().length},getFrame:function(t,e,n){var i=this;this.cachedFrames||(this.cachedFrames={});var a=this._parent.time.getAllSteps(),s=this._getCachePath();if(!s)return e(null,t);if(t&&i.cachedFrames[s]&&i.cachedFrames[s][t])return e(i.cachedFrames[s][t],t);if(!(s=this._getCachePath(n)))return e(null,t);if(t&&i.cachedFrames[s]&&i.cachedFrames[s][t])return e(i.cachedFrames[s][t],t);if(t&&a.length>1){var o=d3.bisectLeft(a,t);if(!a[o])return r.warn("The requested frame is out of range: "+t),e(null,t),null;if(a[o].toString()!=t.toString())return this._interpolateBetweenFrames(t,o,a,function(n){e(n,t)},n),null}i.getFrames(t,n).then(function(){return!t&&i.cachedFrames[s]?e(i.cachedFrames[s],t):i.cachedFrames[s]&&i.cachedFrames[s][t]?e(i.cachedFrames[s][t],t):(r.warn("marker.js getFrame: Data is not available for frame: "+t),e(null,t))})},_interpolateBetweenFrames:function(t,e,n,i,a){var s=this;if(0==e)this.getFrame(n[e],function(t){return i(t)},a);else{var o=n[e-1],l=n[e];this.getFrame(o,function(e){s.getFrame(l,function(n){var a=(t-o)/(l-o),s={};r.forEach(e,function(e,i){s[i]={},r.forEach(e,function(e,o){var l=n[i][o];r.isDate(e)?s[i][o]=t:r.isNumber(e)?s[i][o]=null==e||null==l?null:e+(l-e)*a:s[i][o]=e})}),i(s)},a)},a)}},getFrames:function(t,e){var n=this;this.cachedFrames||(this.cachedFrames={});var i=r.unique(this._getAllDimensions({exceptType:"time"})),a=this._getFirstDimension({type:"time"});this.frameQueues||(this.frameQueues={}),this.partialResult||(this.partialResult={});var s=this._parent.time.getAllSteps(),o=this._getCachePath(e);return o?(this.frameQueues[o]&&this.frameQueues[o]instanceof Promise||(this.frameQueues[o]=new Promise(function(t,c){n.partialResult[o]={},n.partialResult[o].timeOrConstantHooks=[],s.forEach(function(t){n.partialResult[o][t]={}});var u=[];if(r.forEach(n._dataCube,function(t,e){if("constant"===t.use||t.which===a)n.partialResult[o].timeOrConstantHooks.push({name:e,which:t.which});else if(i.includes(t.which)){var r=t.getValidItems();s.forEach(function(i){n.partialResult[o][i][e]={},r.forEach(function(r){n.partialResult[o][i][e][r[t.which]]=r[t.which]})})}else u.push(t)}),u.length>0){var h=[];r.forEach(u,function(t){h.push(new Promise(function(i,a){var l=t._name,c=t.which;t.getFrames(s,e).then(function(t){r.forEach(t,function(t,e){n.partialResult[o][e][l]=t[c]}),i()})}))}),Promise.all(h).then(function(){l(),n.cachedFrames[o]=n.partialResult[o],t()})}else l(),n.cachedFrames[o]=n.partialResult[o],t()})),new Promise(function(c,u){if(s.length<2||!t)n.frameQueues[o].then(function(){c()});else{var h=[];r.forEach(n._dataCube,function(r,l){var c,u;"constant"===r.use||i.includes(r.which)||r.which===a||(c=r,u=l,h.push(new Promise(function(i,r){c.getFrame(s,t,e).then(function(e){n.partialResult[o][t][u]=e[t][c.which],i()})})))}),h.length>0?Promise.all(h).then(function(){l(),n.cachedFrames[o]||(n.cachedFrames[o]={}),n.cachedFrames[o][t]=n.partialResult[o][t],c()}):c()}})):new Promise(function(t,e){t()});function l(){if(n.partialResult[o].timeOrConstantHooks){var t=n.partialResult[o].timeOrConstantHooks,e=n.getKeys();t.forEach(function(t){var l=t.which,c=t.name,u=l===a;s.forEach(function(t){n.partialResult[o][t][c]={},e.forEach(function(e){n.partialResult[o][t][c][r.getKey(e,i)]=u?new Date(t):l})})}),delete n.partialResult[o].timeOrConstantHooks}}},listenFramesQueue:function(t,e){var n=this,i=r.unique(this._getAllDimensions({exceptType:"time"})),a=this._getFirstDimension({type:"time"}),s=this._parent.time.getAllSteps(),o={};this.getFrames();var l=[],c=s.length,u=!1;r.forEach(n._dataCube,function(r,h){"constant"===r.use||i.includes(r.which)||r.which===a||l.includes(r._dataId)||(l.push(r._dataId),r.dataSource.listenFrame(r._dataId,s,t,function(t,i){var r=i.toString();void 0===o[r]&&(o[r]=[]),o[r].includes(t)||o[r].push(t),o[r].length===l.length&&(u||c!==Object.keys(o).length||(u=!0,n.trigger("dataLoaded")),e(i))}))})},getEntityLimits:function(t){var e=this,n=this._parent.time.getAllSteps(),i=[],a=[];r.forEach(e.getSubhooks(),function(t){"constant"!=t.use&&t._important&&a.push(t._name)});var s=function i(r,s){var o=r();if(null==o)return s(o);e.getFrame(n[o],function(e){!function(e){if(!e)return!1;for(var n=0,i=a.length;n<i;n++)if(!e[a[n]][t]&&0!==e[a[n]][t])return!1;return!0}(e)?i(r,s):s(o)})},o=[];return o.push(new Promise(function(t,e){var r,a;s((r=n.length,a=0,function(){return a<r?a++:null}),function(e){i[0]=n[e],t()})})),o.push(new Promise(function(t,e){var r;s((r=n.length-1,function(){return r>=0?r--:null}),function(e){i[1]=n[e],t()})})),Promise.all(o).then(function(){return{min:i[0],max:i[1]}})},getCompoundLabelText:function(t,e){var n=this._root.dataManager,i=r.unique(this._getAllDimensions({exceptType:"time"})),a=this.getLabelHookNames(),s=i.filter(function(e){return t[e]!==n.getConceptProperty(e,"totals_among_entities")}).map(function(n){return e[a[n]]&&e[a[n]][t[n]]||t[n]}).join(", ");return""===s&&(s=this._root.locale.getTFunction()("hints/grandtotal")),s},getSpace:function(){if(r.isArray(this.space))return this.space;r.error('ERROR: space not found.\n You must specify the objects this hook will use under the "space" attribute in the state.\n Example:\n space: ["entities", "time"]')}});e.default=s},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i,r=function(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n]);return e.default=t,e}(n(1)),a=n(5);var s={EXTENT_MIN:0,EXTENT_MAX:1,BAR_WIDTH:6,THUMB_HEIGHT:20,THUMB_STROKE_WIDTH:4,INTRO_DURATION:250,ROUND_DIGITS:2},o={small:{},medium:{},large:{}},l=((i=a)&&i.__esModule?i:{default:i}).default.extend({init:function(t,e){this.name=this.name||"brushslider";var i=r.extend({},s);this.options=r.extend(i,this.options||{});var a=r.extend({},o);this.profiles=r.extend(a,this.profiles||{}),this.template=this.template||n(406),this.arg=t.arg||"extent",this.model_expects=this.model_expects||[{name:"submodel"},{name:"locale",type:"locale"}],this.model_binds=this.model_binds||{},this.model_binds.ready||(this.model_binds.ready=this.readyHandler.bind(this)),this.model_binds["change:submodel."+this.arg]||(this.model_binds["change:submodel."+this.arg]=this.changeHandler.bind(this)),this._setModel=r.throttle(this._setModel,50),this._super(t,e)},changeHandler:function(t,e){var n=this._valueToExtent(this.model.submodel[this.arg])||[this.options.EXTENT_MIN,this.options.EXTENT_MAX];this._moveBrush(n)},readyHandler:function(t){},readyOnce:function(){var t=this;this.element=d3.select(this.element),this.sliderSvg=this.element.select(".vzb-slider-svg"),this.sliderWrap=this.sliderSvg.select(".vzb-slider-wrap"),this.sliderEl=this.sliderWrap.select(".vzb-slider").classed("vzb-slider-"+this.name,!0);var e=this.options,n=e.BAR_WIDTH,i=.5*e.THUMB_HEIGHT,r=(this.padding={top:.5*n,left:i,right:i,bottom:i+e.THUMB_STROKE_WIDTH},this._getComponentWidth()||0);r<0&&(r=0),this.rescaler=d3.scaleLinear().domain([e.EXTENT_MIN,e.EXTENT_MAX]).range([0,r]).clamp(!0),this.brushEventListeners=this._getBrushEventListeners(),this.brush=d3.brushX().handleSize(2*i+2*n).on("start",this.brushEventListeners.start).on("brush",this.brushEventListeners.brush).on("end",this.brushEventListeners.end),this.sliderThumbs=this.sliderEl.selectAll(".handle").data([{type:"w"},{type:"e"}],function(t){return t.type}).enter().append("svg").attr("class",function(t){return"handle handle--"+t.type+" "+t.type}).classed("vzb-slider-thumb",!0),this._createThumbs(this.sliderThumbs.append("g").attr("class","vzb-slider-thumb-badge")),this.sliderEl.call(t.brush),this.sliderEl.selectAll(".selection,.overlay").attr("height",n).attr("rx",.25*n).attr("ry",.25*n).attr("transform","translate(0,"+.5*-n+")"),this.on("resize",function(){t._resize(),t._updateView()})},ready:function(){this.isRTL=this.model.locale.isRTL(),this._resize(),this._updateView()},_getBrushEventListeners:function(){var t=this;return{start:function(){if(!t.nonBrushChange&&d3.event.sourceEvent){if(d3.event.selection&&d3.event.selection[0]==d3.event.selection[1])t.sliderEl.node().__brush.selection[1][0]+=.01;t._setFromExtent(!1,!1,!1)}},brush:function(){if(!t.nonBrushChange&&d3.event.sourceEvent){if(d3.event.selection&&d3.event.selection[0]==d3.event.selection[1])t.sliderEl.node().__brush.selection[1][0]+=.01;t._setFromExtent(!0,!1,!1)}},end:function(){!t.nonBrushChange&&d3.event.sourceEvent&&t._setFromExtent(!0,!0)}}},_createThumbs:function(t){var e=this.options.BAR_WIDTH,n=.5*this.options.THUMB_HEIGHT;t.append("path").attr("d","M"+(n+e)+" "+(n+1.5*e)+"l"+-n+" "+1.5*n+"h"+2*n+"Z")},_updateThumbs:function(t){},_updateSize:function(){var t=this._getComponentWidth()+this.padding.left+this.padding.right;this.sliderSvg.attr("height",this._getComponentHeight()+this.padding.top+this.padding.bottom).attr("width",t),this.sliderWrap.attr("transform",this.isRTL?"translate("+(t-this.padding.right)+","+this.padding.top+") scale(-1,1)":"translate("+this.padding.left+","+this.padding.top+")")},_resize:function(){this._updateSize();var t=this._getComponentWidth();this.rescaler.range([0,t])},_getComponentWidth:function(){var t=this.element.node().offsetWidth-this.padding.left-this.padding.right;return t<0?0:t},_getComponentHeight:function(){return this.options.BAR_WIDTH},_updateView:function(){this.sliderEl.call(this.brush.extent([[0,0],[this._getComponentWidth(),this._getComponentHeight()]]));var t=this._valueToExtent(this.model.submodel[this.arg])||[this.options.EXTENT_MIN,this.options.EXTENT_MAX];this._moveBrush(t)},_moveBrush:function(t){var e=t.map(this.rescaler);this.nonBrushChange=!0,this.sliderEl.call(this.brush.move,[e[0],e[1]+.01]),this.nonBrushChange=!1,this._setFromExtent(!1,!1,!1)},_valueToExtent:function(t){return t},_extentToValue:function(t){return t},_setFromExtent:function(t,e,n){var i=d3.brushSelection(this.sliderEl.node());i&&(i=[this.rescaler.invert(i[0]),this.rescaler.invert(+i[1].toFixed(1))],this._updateThumbs(i),t&&this._setModel(i,e,n))},_setModel:function(t,e,n){var i=this.options.ROUND_DIGITS;t=[+t[0].toFixed(i),+t[1].toFixed(i)];var r={};r[this.arg]=this._extentToValue(t),this.model.submodel.set(r,e,n)}});e.default=l},function(t,e){var n;n=function(){return this}();try{n=n||new Function("return this")()}catch(t){"object"==typeof window&&(n=window)}t.exports=n},function(t,e,n){var i=n(6),r=n(3).document,a=i(r)&&i(r.createElement);t.exports=function(t){return a?r.createElement(t):{}}},function(t,e,n){var i=n(3),r=n(22),a=n(35),s=n(117),o=n(10).f;t.exports=function(t){var e=r.Symbol||(r.Symbol=a?{}:i.Symbol||{});"_"==t.charAt(0)||t in e||o(e,t,{value:s.f(t)})}},function(t,e,n){var i=n(58)("keys"),r=n(39);t.exports=function(t){return i[t]||(i[t]=r(t))}},function(t,e){t.exports="constructor,hasOwnProperty,isPrototypeOf,propertyIsEnumerable,toLocaleString,toString,valueOf".split(",")},function(t,e,n){var i=n(3).document;t.exports=i&&i.documentElement},function(t,e,n){var i=n(6),r=n(2),a=function(t,e){if(r(t),!i(e)&&null!==e)throw TypeError(e+": can't set as prototype!")};t.exports={set:Object.setPrototypeOf||("__proto__"in{}?function(t,e,i){try{(i=n(23)(Function.call,n(19).f(Object.prototype,"__proto__").set,2))(t,[]),e=!(t instanceof Array)}catch(t){e=!0}return function(t,n){return a(t,n),e?t.__proto__=n:i(t,n),t}}({},!1):void 0),check:a}},function(t,e){t.exports="\t\n\v\f\r   ᠎             　\u2028\u2029\ufeff"},function(t,e,n){var i=n(6),r=n(86).set;t.exports=function(t,e,n){var a,s=e.constructor;return s!==n&&"function"==typeof s&&(a=s.prototype)!==n.prototype&&i(a)&&r&&r(t,a),t}},function(t,e,n){"use strict";var i=n(25),r=n(28);t.exports=function(t){var e=String(r(this)),n="",a=i(t);if(a<0||a==1/0)throw RangeError("Count can't be negative");for(;a>0;(a>>>=1)&&(e+=e))1&a&&(n+=e);return n}},function(t,e){t.exports=Math.sign||function(t){return 0==(t=+t)||t!=t?t:t<0?-1:1}},function(t,e){var n=Math.expm1;t.exports=!n||n(10)>22025.465794806718||n(10)<22025.465794806718||-2e-17!=n(-2e-17)?function(t){return 0==(t=+t)?t:t>-1e-6&&t<1e-6?t+t*t/2:Math.exp(t)-1}:n},function(t,e,n){"use strict";var i=n(35),r=n(0),a=n(15),s=n(14),o=n(56),l=n(93),c=n(53),u=n(20),h=n(7)("iterator"),d=!([].keys&&"next"in[].keys()),f=function(){return this};t.exports=function(t,e,n,p,v,g,m){l(n,e,p);var b,y,_,M=function(t){if(!d&&t in z)return z[t];switch(t){case"keys":case"values":return function(){return new n(this,t)}}return function(){return new n(this,t)}},w=e+" Iterator",x="values"==v,S=!1,z=t.prototype,O=z[h]||z["@@iterator"]||v&&z[v],k=O||M(v),E=v?x?M("entries"):k:void 0,T="Array"==e&&z.entries||O;if(T&&(_=u(T.call(new t)))!==Object.prototype&&_.next&&(c(_,w,!0),i||"function"==typeof _[h]||s(_,h,f)),x&&O&&"values"!==O.name&&(S=!0,k=function(){return O.call(this)}),i&&!m||!d&&!S&&z[h]||s(z,h,k),o[e]=k,o[w]=f,v)if(b={values:x?k:M("values"),keys:g?k:M("keys"),entries:E},m)for(y in b)y in z||a(z,y,b[y]);else r(r.P+r.F*(d||S),e,b);return b}},function(t,e,n){"use strict";var i=n(42),r=n(38),a=n(53),s={};n(14)(s,n(7)("iterator"),function(){return this}),t.exports=function(t,e,n){t.prototype=i(s,{next:r(1,n)}),a(t,e+" Iterator")}},function(t,e,n){var i=n(68),r=n(28);t.exports=function(t,e,n){if(i(e))throw TypeError("String#"+n+" doesn't accept regex!");return String(r(t))}},function(t,e,n){var i=n(7)("match");t.exports=function(t){var e=/./;try{"/./"[t](e)}catch(n){try{return e[i]=!1,!"/./"[t](e)}catch(t){}}return!0}},function(t,e,n){var i=n(56),r=n(7)("iterator"),a=Array.prototype;t.exports=function(t){return void 0!==t&&(i.Array===t||a[r]===t)}},function(t,e,n){"use strict";var i=n(10),r=n(38);t.exports=function(t,e,n){e in t?i.f(t,e,r(0,n)):t[e]=n}},function(t,e,n){var i=n(54),r=n(7)("iterator"),a=n(56);t.exports=n(22).getIteratorMethod=function(t){if(void 0!=t)return t[r]||t["@@iterator"]||a[i(t)]}},function(t,e,n){var i=n(285);t.exports=function(t,e){return new(i(t))(e)}},function(t,e,n){"use strict";var i=n(11),r=n(41),a=n(8);t.exports=function(t){for(var e=i(this),n=a(e.length),s=arguments.length,o=r(s>1?arguments[1]:void 0,n),l=s>2?arguments[2]:void 0,c=void 0===l?n:r(l,n);c>o;)e[o++]=t;return e}},function(t,e,n){"use strict";var i=n(37),r=n(134),a=n(56),s=n(18);t.exports=n(92)(Array,"Array",function(t,e){this._t=s(t),this._i=0,this._k=e},function(){var t=this._t,e=this._k,n=this._i++;return!t||n>=t.length?(this._t=void 0,r(1)):r(0,"keys"==e?n:"values"==e?t[n]:[n,t[n]])},"values"),a.Arguments=a.Array,i("keys"),i("values"),i("entries")},function(t,e,n){"use strict";var i,r,a=n(61),s=RegExp.prototype.exec,o=String.prototype.replace,l=s,c=(i=/a/,r=/b*/g,s.call(i,"a"),s.call(r,"a"),0!==i.lastIndex||0!==r.lastIndex),u=void 0!==/()??/.exec("")[1];(c||u)&&(l=function(t){var e,n,i,r,l=this;return u&&(n=new RegExp("^"+l.source+"$(?!\\s)",a.call(l))),c&&(e=l.lastIndex),i=s.call(l,t),c&&i&&(l.lastIndex=l.global?i.index+i[0].length:e),u&&i&&i.length>1&&o.call(i[0],n,function(){for(r=1;r<arguments.length-2;r++)void 0===arguments[r]&&(i[r]=void 0)}),i}),t.exports=l},function(t,e,n){"use strict";var i=n(67)(!0);t.exports=function(t,e,n){return e+(n?i(t,e).length:1)}},function(t,e,n){var i,r,a,s=n(23),o=n(124),l=n(85),c=n(81),u=n(3),h=u.process,d=u.setImmediate,f=u.clearImmediate,p=u.MessageChannel,v=u.Dispatch,g=0,m={},b=function(){var t=+this;if(m.hasOwnProperty(t)){var e=m[t];delete m[t],e()}},y=function(t){b.call(t.data)};d&&f||(d=function(t){for(var e=[],n=1;arguments.length>n;)e.push(arguments[n++]);return m[++g]=function(){o("function"==typeof t?t:Function(t),e)},i(g),g},f=function(t){delete m[t]},"process"==n(24)(h)?i=function(t){h.nextTick(s(b,t,1))}:v&&v.now?i=function(t){v.now(s(b,t,1))}:p?(a=(r=new p).port2,r.port1.onmessage=y,i=s(a.postMessage,a,1)):u.addEventListener&&"function"==typeof postMessage&&!u.importScripts?(i=function(t){u.postMessage(t+"","*")},u.addEventListener("message",y,!1)):i="onreadystatechange"in c("script")?function(t){l.appendChild(c("script")).onreadystatechange=function(){l.removeChild(this),b.call(t)}}:function(t){setTimeout(s(b,t,1),0)}),t.exports={set:d,clear:f}},function(t,e,n){var i=n(3),r=n(104).set,a=i.MutationObserver||i.WebKitMutationObserver,s=i.process,o=i.Promise,l="process"==n(24)(s);t.exports=function(){var t,e,n,c=function(){var i,r;for(l&&(i=s.domain)&&i.exit();t;){r=t.fn,t=t.next;try{r()}catch(i){throw t?n():e=void 0,i}}e=void 0,i&&i.enter()};if(l)n=function(){s.nextTick(c)};else if(!a||i.navigator&&i.navigator.standalone)if(o&&o.resolve){var u=o.resolve(void 0);n=function(){u.then(c)}}else n=function(){r.call(i,c)};else{var h=!0,d=document.createTextNode("");new a(c).observe(d,{characterData:!0}),n=function(){d.data=h=!h}}return function(i){var r={fn:i,next:void 0};e&&(e.next=r),t||(t=r,n()),e=r}}},function(t,e,n){"use strict";var i=n(13);t.exports.f=function(t){return new function(t){var e,n;this.promise=new t(function(t,i){if(void 0!==e||void 0!==n)throw TypeError("Bad Promise constructor");e=t,n=i}),this.resolve=i(e),this.reject=i(n)}(t)}},function(t,e,n){"use strict";var i=n(3),r=n(9),a=n(35),s=n(74),o=n(14),l=n(47),c=n(4),u=n(45),h=n(25),d=n(8),f=n(144),p=n(43).f,v=n(10).f,g=n(100),m=n(53),b="prototype",y="Wrong index!",_=i.ArrayBuffer,M=i.DataView,w=i.Math,x=i.RangeError,S=i.Infinity,z=_,O=w.abs,k=w.pow,E=w.floor,T=w.log,P=w.LN2,A=r?"_b":"buffer",C=r?"_l":"byteLength",L=r?"_o":"byteOffset";function D(t,e,n){var i,r,a,s=new Array(n),o=8*n-e-1,l=(1<<o)-1,c=l>>1,u=23===e?k(2,-24)-k(2,-77):0,h=0,d=t<0||0===t&&1/t<0?1:0;for((t=O(t))!=t||t===S?(r=t!=t?1:0,i=l):(i=E(T(t)/P),t*(a=k(2,-i))<1&&(i--,a*=2),(t+=i+c>=1?u/a:u*k(2,1-c))*a>=2&&(i++,a/=2),i+c>=l?(r=0,i=l):i+c>=1?(r=(t*a-1)*k(2,e),i+=c):(r=t*k(2,c-1)*k(2,e),i=0));e>=8;s[h++]=255&r,r/=256,e-=8);for(i=i<<e|r,o+=e;o>0;s[h++]=255&i,i/=256,o-=8);return s[--h]|=128*d,s}function I(t,e,n){var i,r=8*n-e-1,a=(1<<r)-1,s=a>>1,o=r-7,l=n-1,c=t[l--],u=127&c;for(c>>=7;o>0;u=256*u+t[l],l--,o-=8);for(i=u&(1<<-o)-1,u>>=-o,o+=e;o>0;i=256*i+t[l],l--,o-=8);if(0===u)u=1-s;else{if(u===a)return i?NaN:c?-S:S;i+=k(2,e),u-=s}return(c?-1:1)*i*k(2,u-e)}function F(t){return t[3]<<24|t[2]<<16|t[1]<<8|t[0]}function j(t){return[255&t]}function R(t){return[255&t,t>>8&255]}function N(t){return[255&t,t>>8&255,t>>16&255,t>>24&255]}function q(t){return D(t,52,8)}function B(t){return D(t,23,4)}function H(t,e,n){v(t[b],e,{get:function(){return this[n]}})}function V(t,e,n,i){var r=f(+n);if(r+e>t[C])throw x(y);var a=t[A]._b,s=r+t[L],o=a.slice(s,s+e);return i?o:o.reverse()}function W(t,e,n,i,r,a){var s=f(+n);if(s+e>t[C])throw x(y);for(var o=t[A]._b,l=s+t[L],c=i(+r),u=0;u<e;u++)o[l+u]=c[a?u:e-u-1]}if(s.ABV){if(!c(function(){_(1)})||!c(function(){new _(-1)})||c(function(){return new _,new _(1.5),new _(NaN),"ArrayBuffer"!=_.name})){for(var U,Y=(_=function(t){return u(this,_),new z(f(t))})[b]=z[b],G=p(z),K=0;G.length>K;)(U=G[K++])in _||o(_,U,z[U]);a||(Y.constructor=_)}var X=new M(new _(2)),Q=M[b].setInt8;X.setInt8(0,2147483648),X.setInt8(1,2147483649),!X.getInt8(0)&&X.getInt8(1)||l(M[b],{setInt8:function(t,e){Q.call(this,t,e<<24>>24)},setUint8:function(t,e){Q.call(this,t,e<<24>>24)}},!0)}else _=function(t){u(this,_,"ArrayBuffer");var e=f(t);this._b=g.call(new Array(e),0),this[C]=e},M=function(t,e,n){u(this,M,"DataView"),u(t,_,"DataView");var i=t[C],r=h(e);if(r<0||r>i)throw x("Wrong offset!");if(r+(n=void 0===n?i-r:d(n))>i)throw x("Wrong length!");this[A]=t,this[L]=r,this[C]=n},r&&(H(_,"byteLength","_l"),H(M,"buffer","_b"),H(M,"byteLength","_l"),H(M,"byteOffset","_o")),l(M[b],{getInt8:function(t){return V(this,1,t)[0]<<24>>24},getUint8:function(t){return V(this,1,t)[0]},getInt16:function(t){var e=V(this,2,t,arguments[1]);return(e[1]<<8|e[0])<<16>>16},getUint16:function(t){var e=V(this,2,t,arguments[1]);return e[1]<<8|e[0]},getInt32:function(t){return F(V(this,4,t,arguments[1]))},getUint32:function(t){return F(V(this,4,t,arguments[1]))>>>0},getFloat32:function(t){return I(V(this,4,t,arguments[1]),23,4)},getFloat64:function(t){return I(V(this,8,t,arguments[1]),52,8)},setInt8:function(t,e){W(this,1,t,j,e)},setUint8:function(t,e){W(this,1,t,j,e)},setInt16:function(t,e){W(this,2,t,R,e,arguments[2])},setUint16:function(t,e){W(this,2,t,R,e,arguments[2])},setInt32:function(t,e){W(this,4,t,N,e,arguments[2])},setUint32:function(t,e){W(this,4,t,N,e,arguments[2])},setFloat32:function(t,e){W(this,4,t,B,e,arguments[2])},setFloat64:function(t,e){W(this,8,t,q,e,arguments[2])}});m(_,"ArrayBuffer"),m(M,"DataView"),o(M[b],s.VIEW,!0),e.ArrayBuffer=_,e.DataView=M},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i=function(t){return t.match(/\//g).length};e.default=function(t,e){var n=t.keys();return e&&(n=n.filter("function"==typeof e?function(t){return e(i(t))}:function(t){return i(t)===e+1})),n.reduce(function(e,n){var i=/([^/]+)\..+$/.exec(n)[1];try{var r=t(n);e[i]=r.default||r}catch(t){console.warn("Import error",n,t)}return e},{})}},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i,r=function(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n]);return e.default=t,e}(n(1)),a=n(32);var s=((i=a)&&i.__esModule?i:{default:i}).default.extend({_important:!0,getClassDefaults:function(){return r.deepExtend(this._super(),{use:null,which:null,domainMin:null,domainMax:null,zoomedMin:null,zoomedMax:null,fixBaseline:null,scaleType:"linear",allow:{scales:["linear","log","genericLog","time","pow"]}})},autoconfigureModel:function(t){!this.which&&this.autoconfig&&"axis"===this._type&&(t=this._parent.getAvailableConcept(this.autoconfig)||this._parent.getAvailableConcept({type:"time"})),this._super(t)},_type:"axis",validate:function(){if(this._super(),this.scale&&"time"==this.scaleType){var t={};null==this.zoomedMin||r.isDate(this.zoomedMin)||(t.zoomedMin=this._space.time.parse(this.zoomedMin.toString())),null==this.zoomedMax||r.isDate(this.zoomedMax)||(t.zoomedMax=this._space.time.parse(this.zoomedMax.toString())),this.set(t)}},buildScale:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.scaleType,e=void 0;if("time"==t){var n=this._space.time,i=n.splash?{min:n.parse(n.startOrigin),max:n.parse(n.endOrigin)}:{min:n.start,max:n.end};e=[i.min,i.max],this.scale=d3.scaleUtc().domain(e)}else{var a=void 0;this.isDiscrete()?e="constant"===this.use?[this.which]:this.getUnique(this.which):((e=[(a=this.getLimits(this.which)).min,a.max])[0]=(this.fixBaseline||0===this.fixBaseline)&&a.min>0?+this.fixBaseline:e[0],e[0]=null!=this.domainMin?+this.domainMin:e[0],e[1]=null!=this.domainMax?+this.domainMax:e[1]);var s=("ordinal"===(t=d3.min(e)<=0&&d3.max(e)>=0&&"log"===t?"genericLog":t)?"point":t)||"linear";this.scale=d3["scale"+r.capitalize(s)]().domain(e),this.scale.constant&&this.scale.constant(a.minAbsNear0)}this.scaleType=t},formatDate:function(t){return this._space.time.formatDate(t)},_getZoomed:function(t){var e=this["zoomed"+t];return null!==e?e:d3[t.toLowerCase()](this.getScale().domain())},getZoomedMin:function(){return this._getZoomed("Min")},getZoomedMax:function(){return this._getZoomed("Max")}});e.default=s},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i=function(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n]);return e.default=t,e}(n(1)),r=l(n(49)),a=l(n(111)),s=l(n(50)),o=n(400);function l(t){return t&&t.__esModule?t:{default:t}}var c=r.default.extend({getClassDefaults:function(){return i.deepExtend(this._super(),{reader:"inline"})},trackInstances:!0,init:function(t,e,n,i){this._type="data",this.queryQueue={},this._collection={},this._collectionPromises={},this._super(t,e,n,i),this.readerObject=this.getReader()},preloadData:function(){return this.loadDataAvailability().then(this.loadConceptProps.bind(this))},load:function(t){var e=this,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=arguments[2];t=i.deepClone(t),this.dataset&&(t.dataset=this.dataset),this.version&&(t.version=this.version);var a=o.DataStorage.getDataId(t,this.readerObject,n);return a?t.grouping?o.DataStorage.aggregateData(a,t,this.readerObject,this.getConceptprops()):Promise.resolve(a):(i.timeStamp("Vizabi Data: Loading Data"),r||s.default.freezeAll(["hook_change","resize"]),o.DataStorage.loadFromReader(t,n,this.readerObject).then(function(n){return t.grouping?o.DataStorage.aggregateData(n,t,e.readerObject,e.getConceptprops()):n}).then(function(t){return r||s.default.unfreezeAll(),t}).catch(function(t){r||s.default.unfreezeAll(),e.handleLoadError(t)}))},getAsset:function(t,e){var n=this;return this.readerObject.getAsset(t).then(function(t){return e(t)}).catch(function(t){return n.handleLoadError(t)})},getReader:function(){var t=a.default.get(this.reader);if(!t)throw new Error("Unknown reader: "+this.reader);return new t(this.getPlainObject())},getData:function(t,e,n,r){return t?o.DataStorage.getData(t,e,n,r):i.warn("Data.js 'get' method doesn't like the dataId you gave it: "+t)},loadDataAvailability:function(){var t=this,e={select:{key:["key","value"],value:[]},from:"concepts.schema"},n=i.extend({},e,{from:"entities.schema"}),r=i.extend({},e,{from:"datapoints.schema"});return Promise.all([this.load(e),this.load(n),this.load(r)]).then(this.handleDataAvailabilityResponse.bind(this)).catch(function(e){return t.handleLoadError(e)})},handleDataAvailabilityResponse:function(t){var e=this;this.keyAvailability=new Map,this.dataAvailability=[],t.forEach(function(t){var n=e.getData(t,"query").from.split(".")[0];e.dataAvailability[n]=[],e.getData(t).forEach(function(t){var i=("string"==typeof t.key?JSON.parse(t.key):t.key).sort();e.dataAvailability[n].push({key:new Set(i),value:t.value}),e.keyAvailability.set(i.join(","),i)})})},loadConceptProps:function(){var t=this,e=this.dataAvailability.concepts.map(function(t){return t.value}),n={select:{key:["concept"],value:["concept_type","domain","totals_among_entities","source_url","source","color","scales","interpolation","tags","name","name_short","name_catalog","description","format"].filter(function(t){return e.includes(t)})},from:"concepts",where:{},language:this.getClosestModel("locale").id};return this.load(n).then(this.handleConceptPropsResponse.bind(this)).catch(function(e){return t.handleLoadError(e)})},handleConceptPropsResponse:function(t){var e=this;this.conceptDictionary={_default:{concept:"_default",concept_type:"string",use:"constant",scales:["ordinal"],tags:"_root"}},this.conceptArray=[],this.getData(t).forEach(function(t){var n={};n.concept=t.concept,n.concept_type=t.concept_type,n.sourceLink=t.source_url,n.sourceName=t.source;try{n.color=t.color&&""!==t.color?"string"==typeof t.color?JSON.parse(t.color):t.color:null}catch(t){n.color=null}try{n.scales=t.scales&&""!==t.color?"string"==typeof t.scales?JSON.parse(t.scales):t.scales:null}catch(t){n.scales=null}if(!n.scales)switch(t.concept_type){case"measure":n.scales=["linear","log"];break;case"string":case"entity_domain":case"entity_set":case"boolean":n.scales=["ordinal"];break;case"time":n.scales=["time"];break;default:n.scales=["linear","log"]}t.interpolation?n.interpolation=t.interpolation:"measure"==t.concept_type?n.interpolation=n.scales&&"log"==n.scales[0]?"exp":"linear":"time"==t.concept_type?n.interpolation="linear":n.interpolation="stepMiddle",n.domain=t.domain,n.totals_among_entities=t.totals_among_entities,n.tags=t.tags,n.format=t.format,n.name=t.name||t.concept||"",n.name_catalog=t.name_catalog||"",n.name_short=t.name_short||t.name||t.concept||"",n.description=t.description,e.conceptDictionary[t.concept]=n,e.conceptArray.push(n)})},getConceptprops:function(t){return void 0!==t?this.conceptDictionary[t]?this.conceptDictionary[t]:(i.warn("The concept "+t+" is not found in the dictionary"),null):this.conceptDictionary},getConcept:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},e=t.index,n=void 0===e?0:e,i=t.type,r=void 0===i?null:i,a=t.includeOnlyIDs,s=void 0===a?[]:a,o=t.excludeIDs,l=void 0===o?[]:o;if(!r&&0==s.length&&0==l.length)return null;var c=this.conceptArray.filter(function(t){return!(r&&t.concept_type&&t.concept_type!==r||0!=s.length&&-1===s.indexOf(t.concept)||0!=l.length&&-1!=l.indexOf(t.concept))});return c[n]||c[c.length-1]},getDatasetName:function(){if(this.readerObject.getDatasetInfo){var t=this.readerObject.getDatasetInfo();return t.name+(t.version?" "+t.version:"")}return this._name.replace("data_","")},setGrouping:function(t,e){o.DataStorage.setGrouping(t,e)},getFrames:function(t,e,n){return o.DataStorage.getFrames(t,e,n,this.getConceptprops())},getFrame:function(t,e,n,i){return o.DataStorage.getFrame(t,e,n,i)},listenFrame:function(t,e,n,i){o.DataStorage.listenFrame(t,e,n,i)},handleLoadError:function(t){t.browserDetails=i.getBrowserDetails(),t.osName=i.getOSname(),t.homepoint=window.location.href,t.time=(new Date).toString(),this._super(t)}});e.default=c},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i,r=function(){return function(t,e){if(Array.isArray(t))return t;if(Symbol.iterator in Object(t))return function(t,e){var n=[],i=!0,r=!1,a=void 0;try{for(var s,o=t[Symbol.iterator]();!(i=(s=o.next()).done)&&(n.push(s.value),!e||n.length!==e);i=!0);}catch(t){r=!0,a=t}finally{try{!i&&o.return&&o.return()}finally{if(r)throw a}}return n}(t,e);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}(),a="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},s=function(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n]);return e.default=t,e}(n(1)),o=n(31);function l(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}var c=((i=o)&&i.__esModule?i:{default:i}).default.extend({QUERY_FROM_CONCEPTS:"concepts",QUERY_FROM_DATAPOINTS:"datapoints",QUERY_FROM_ENTITIES:"entities",SCHEMA_QUERY_FROM_CONCEPTS:"concepts.schema",SCHEMA_QUERY_FROM_DATAPOINTS:"datapoints.schema",SCHEMA_QUERY_FROM_ENTITIES:"entities.schema",CONDITION_CALLBACKS:{$gt:function(t,e){return e>t},$gte:function(t,e){return e>=t},$lt:function(t,e){return e<t},$lte:function(t,e){return e<=t},$in:function(t,e){return t.includes(e)}},LOGICAL_TEST:{$and:"every",$or:"some"},ERRORS:{GENERIC_ERROR:"reader/error/generic"},_name:"reader",load:function(){return Promise.resolve({rows:[],columns:[]})},read:function(t){var e=this,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},i=t,r=t=this._normalizeQuery(t,n),a=r.select,o=r.from;return this.load(n).then(function(i){var r=i.rows,s=i.columns;switch(e._checkTimeParser(s,n),e.ensureDataIsCorrect(i,n),!0){case o===e.SCHEMA_QUERY_FROM_CONCEPTS:return[{key:["concept"],value:"concept_type"}];case o===e.SCHEMA_QUERY_FROM_ENTITIES:return s.slice(0,e.keySize).map(function(t){return{key:[t],value:t}});case o===e.SCHEMA_QUERY_FROM_DATAPOINTS:var l=s.slice(0,e.keySize+1);return s.slice(e.keySize+1).map(function(t){return{key:l,value:t}});case o===e.QUERY_FROM_CONCEPTS:return e._getConcepts(s,e._mapRows(r,t,n));case e._isDataQuery(o)&&a.key.length>0:return e._getData(r,t,n);default:return[]}}).catch(function(t){throw e._onLoadError(t),s.find(e.ERRORS,function(e){return e===t.name})||(t=e.error(e.ERRORS.GENERIC_ERROR,t)),t.endpoint||(t.endpoint=e._basepath),t.ddfql||(t.ddfql=i),t.details||(t.details=e._name),t})},ensureDataIsCorrect:function(){},_checkTimeParser:function(t,e){var n=t[this.keySize];e[n]||(e[n]=function(t){return t})},_normalizeQuery:function(t,e){var n=Object.assign({},t),i=n.where,r=void 0===i?{}:i,s=n.join,o=void 0===s?{}:s;return r.$and&&(r.$and=r.$and.reduce(function(t,n){return Object.keys(n).forEach(function(i){var r=n[i];if("string"==typeof r&&r.startsWith("$")){var s=o[r].where;Object.keys(s).forEach(function(n){var i=s[n],r=e[n];t.push(l({},n,r?"object"===(void 0===i?"undefined":a(i))?Object.keys(i).reduce(function(t,e){return t[e]=r(i[e]),t},{}):r(i):i))})}else{var c=e[i];t.push(l({},i,c?c(r):r))}}),t},[])),n},_getConcepts:function(t,e){var n=this;return t.map(function(i,a){var o={concept:i};if(a<n.keySize)o.concept_type="entity_domain";else if(a===n.keySize)o.concept_type="time";else{o.concept_type="measure";for(var l=e.length-1;l>-1;--l)if(s.isString(e[l][i])&&""!==e[l][i]){o.concept_type="string";var c=r(t,1);o.domain=c[0];break}}return o})},_getData:function(t,e,n){var i=e.order_by,a=r(void 0===i?[]:i,1)[0];return this._mapRows(t,e,n).reduce(this._applyQuery(e),[]).sort(function(t,e){return t[a]-e[a]})},_isDataQuery:function(t){return[this.QUERY_FROM_DATAPOINTS,this.QUERY_FROM_ENTITIES].includes(t)},_mapRows:function(t,e,n){return t.map(this._getRowMapper(e,n))},_getRowMapper:function(t,e){var n=this;return function(i){var r=!0,a=Object.keys(i).reduce(function(a,o){if(r){var l=i[o],c=String(l).trim(),u=e[o],h=s.isString(l)?u?u(c):n._parse(c):l;h||0===h?a[o]=h:t.select.key.includes(o)&&(r=!1)}return a},{});return r&&a}},_parse:function(t){return t},_applyQuery:function(t){var e=this,n=t.select,i=t.from,a=r(n.key,1)[0],s=[];return function(r,o){if(o){var l=o[a],c=i!==e.QUERY_FROM_ENTITIES||!s.includes(l);if(e._isSuitableRow(t,o)&&c){i===e.QUERY_FROM_ENTITIES&&s.push(l);var u=Object.keys(o).reduce(function(t,e){return(n.key.includes(e)||n.value.includes(e))&&(t[e]=o[e]),t},{});r.push(u)}}return r}},_isSuitableRow:function(t,e){var n=this,i=t.where;return!i||Object.keys(i).every(function(t){return n._testCondition(i[t],t,e)})},_testCondition:function(t,e,n){var i=this,r=this.LOGICAL_TEST[e],o=r?e:n[e];return void 0===o||(t instanceof Date?!(+t-+o):"object"!==(void 0===t?"undefined":a(t))?o===t||!0===t&&s.isString(o)&&"true"===o.toLowerCase().trim()||!1===t&&s.isString(o)&&"false"===o.toLowerCase().trim():r?t[r](function(t){return Object.keys(t).every(function(e){return i._testCondition(t[e],e,n)})}):Object.keys(t).every(function(e){return i.CONDITION_CALLBACKS[e](t[e],o,n)}))},_onLoadError:function(t){},error:function(t,e,n,i,r){var a=new Error;return a.name=t,a.message=e,a.details=n,a.ddfql=i,a.endpoint=r,a}});e.default=c},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i,r=function(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n]);return e.default=t,e}(n(1)),a=n(57);function s(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}var o=((i=a)&&i.__esModule?i:{default:i}).default.extend({getClassDefaults:function(){return r.deepExtend(this._super(),{show:{},showFallback:{},showItemsMaxCount:null,filter:{},dim:null,skipFilter:!1})},objectLeafs:["show","showFallback","filter","autoconfig"],dataConnectedChildren:["show","dim","grouping"],init:function(t,e,n,i){this._type="entities",this._super(t,e,n,i)},preloadData:function(){return this.dataSource=this.getClosestModel(this.data||"data"),this._super()},afterPreload:function(){this.autoconfigureModel()},setLinkWith:function(t){},autoconfigureModel:function(){if(!this.dim&&this.autoconfig){var t=this.dataSource.getConcept(this.autoconfig);t&&(this.dim=t.concept),r.printAutoconfigResult(this)}},setInterModelListeners:function(){this.getClosestModel("locale").on("dataConnectedChange",this.handleDataConnectedChange.bind(this))},validate:function(){var t=this;if(this._super(),this.showFallback[this.dim]||this.showItemsMaxCount){var e=this.show[this.dim]||this.show.$and&&this.show.$and.filter(function(e){return e[t.dim]})[0];e?e.$in&&this.showItemsMaxCount&&e.$in.length>this.showItemsMaxCount&&(e.$in.splice(0,e.$in.length-this.showItemsMaxCount),this.show=r.deepClone(this.show)):this.showFallback[this.dim]&&(this.show=s({},this.dim,r.deepClone(this.showFallback[this.dim])))}},handleDataConnectedChange:function(t){var e=this;r.defer(function(){e.startLoading().catch(r.warn)})},_isLoading:function(){return!this._loadedOnce||this._loadCall},loadData:function(){var t=this;this.setReady(!1),this._loadCall=!0;var e=this;if(!this.dim)return this._entitySets={},this._entitySetsData={},this._entitySetsValues={},Promise.resolve();var n=this.dim;if(this._entitySets=s({},n,r.unique(this._root.dataManager.getAvailableDataForKey(n,null).filter(function(e){return e.value!==n&&["entity_set","entity_domain"].includes(t._root.dataManager.getConceptProperty(e.value,"concept_type"))}).map(function(t){return t.value}))),!this._entitySets[n].length)return this._entitySetsValues=s({},n,[]),this._entitySetsData=s({},n,{}),Promise.resolve();var i={language:this.getClosestModel("locale").id},a=[this._root.dataManager.getDimensionValues(n,this._entitySets[n],i)].concat(this._entitySets[n].map(function(e){return t._root.dataManager.getDimensionValues(e,["name"],i)}));return Promise.all(a).then(function(t){e.dim===n&&(e._entitySetsValues=s({},n,t[0].length>1?r.unique([].concat(t[0]),function(t){return t[n]}):t[0]),e._entitySetsData=s({},n,{}),e._entitySets[n].forEach(function(i,a){e._entitySetsData[n][i]=t[a+1].length>1?r.unique([].concat(t[a+1]),function(t){return t[i]}):t[a+1]}))})},getEntitySets:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";return this["_entitySets"+r.capitalize(t)][this.dim]},getDimension:function(){return this.dim},setDimension:function(t){if(this.dim!==t){var e={show:{}};e.dim=t,this.set(e)}},getFilter:function(){var t=(arguments.length>0&&void 0!==arguments[0]?arguments[0]:{}).entityTypeRequest,e=r.deepClone(this.filter[this.dim]||{});if(t||this.skipFilter)return e;var n=r.deepClone(this.show);n[this.dim]&&r.isEmpty(n[this.dim])&&delete n[this.dim];var i=[];return r.isEmpty(e)||i.push(e),r.isEmpty(n)||i.push(n),i.length>1?{$and:i}:i[0]||{}},showEntity:function(t){var e=this,n=r.deepClone(this.show),i=this.getDimension(),a=void 0;a=r.isArray(t)?t:[t];var o=n[i]||(n.$and||[]).filter(function(t){return t[i]})[0]||{$in:[]};r.forEach(a,function(t){var n=t[i];e.isShown(t)?o.$in=o.$in.filter(function(t){return t!==n}):o.$in=o.$in.concat(n)}),0===o.$in.length?n.$and?n.$and=n.$and.filter(function(t){return!t[i]}):delete n[i]:n.$and?n.$and.push(s({},i,o)):n[i]=o,this.show=n},isShown:function(t){var e=this.getDimension(),n=(this.show[e]||(this.show.$and||[]).filter(function(t){return t[e]})[0]||{}).$in;return(void 0===n?[]:n).includes(t[e])},isInShowFilter:function(t,e){t[this.getDimension()];var n=(this.show.$and||[this.show]).filter(function(t){return t[e]})[0]||{};return r.getProp(n,[e,"$in"],[]).includes(t[e])},clearShow:function(){var t=this.getDimension(),e=r.deepClone(this.show);delete e[t],this.show=e},getFilteredEntities:function(){var t=this.getDimension(),e=(this.show[t]||{}).$in;return(void 0===e?[]:e).map(function(e){return s({},t,e)})},isEntities:function(){return!0}});e.default=o},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.default={build:1551875890651,version:"0.40.14"}},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.default=function(t){return function e(n){var r="vertical axis",a="horizontal axis",s="labels stack side by side",o="labels stack top to bottom",l="optimistic approximation: labels have different lengths",c="pessimistic approximation: all labels have the largest length";function u(t,e,n){return n.indexOf(t)===e}function h(t){var e=h.scale().domain(),l=h.scale().range();if(!e[0]&&0!==e[0]||!e[1]&&0!==e[1]||!l[0]&&0!==l[0]||!l[1]&&0!==l[1])return i.warn("d3.axisSmart() skips action because of invalid domain "+JSON.stringify(e)+" or range "+JSON.stringify(l)+" of the attached scale");if(null==f){var c=t.append("g").attr("class","tick widthSampling"),u=c.append("text").text("0M");y.cssMargin||(y.cssMargin={}),y.cssMargin.top=u.style("margin-top"),y.cssMargin.bottom=u.style("margin-bottom"),y.cssMargin.left=u.style("margin-left"),y.cssMargin.right=u.style("margin-right"),y.widthOfOneDigit=.5*u.node().getBBox().width,y.heightOfOneDigit=u.node().getBBox().height,c.remove(),h.labelFactory(y);var d=null;y.transitionDuration>0?n(d=t.transition().duration(y.transitionDuration)):n(t),t.attr("fill",null),t.attr("font-size",null),t.attr("font-family",null),t.attr("text-anchor",null);var p="top"==h.orient()||"bottom"==h.orient()?a:r,v=p==a&&h.pivot()||p==r&&!h.pivot()?o:s;t.selectAll(".vzb-axis-value").data([null]).enter().call(function(t){t.append("g").attr("class","vzb-axis-value").classed("vzb-hidden",!0).append("text").each(function(){var t=d3.select(this);t.classed("stroke",!0),t.style("paint-order").length||t.clone().classed("stroke",!1)}),t.append("g").attr("class","vzb-axis-value vzb-axis-value-shadow").style("opacity",0).append("text")});var g=h.tickPadding();if(t.selectAll("text").each(function(t,e){if(null!=h.pivot()){var n=d3.select(this);n.attr("transform","rotate("+(h.pivot()?-90:0)+")"),n.style("text-anchor",v==s?"middle":"end"),n.attr("x",v==s?p==r?-g:0:-g),n.attr("y",v==s?p==r?0:g:0),n.attr("dx",v==s&&p==r?g:0),n.attr("dy",v==s?p==r?-g:".72em":".32em")}}),null!=h.repositionLabels()){var b=function(){t.selectAll(".tick").each(function(t){var e=d3.select(this).select("text"),n=h.repositionLabels()[t]||{x:0,y:0};e.attr("x",+e.attr("x")+n.x),e.attr("y",+e.attr("y")+n.y)})};d?d.on("end",function(){return b()}):b()}var _=h.scale();y.viewportLength&&t.selectAll(".tick").classed("vzb-hidden",function(t){return _(t)<0||_(t)>y.viewportLength}),null==h.tickValuesMinor()&&h.tickValuesMinor([]);var M=t.selectAll(".tick-minor").data(m);M.exit().remove(),M=M.enter().append("line").attr("class","tick-minor").merge(M);var w=h.tickSizeMinor().outbound,x=h.tickSizeMinor().inbound;y.viewportLength&&M.classed("vzb-hidden",function(t){return _(t)<0||_(t)>y.viewportLength}),M.attr("y1",p==a?("top"==h.orient()?1:-1)*x:_).attr("y2",p==a?("top"==h.orient()?-1:1)*w:_).attr("x1",p==r?("right"==h.orient()?-1:1)*x:_).attr("x2",p==r?("right"==h.orient()?1:-1)*w:_),t.selectAll("path").remove();var S=t.selectAll(".vzb-axis-line").data([0]);S.exit().remove(),S=S.enter().append("line").attr("class","vzb-axis-line").merge(S),y.viewportLength?S.attr("x1",p==r?0:-1).attr("x2",p==r?0:y.viewportLength).attr("y1",0).attr("y2",p==a?0:y.viewportLength):S.attr("x1",p==r?0:d3.min(_.range())-(y.bump||0)-1).attr("x2",p==r?0:d3.max(_.range())+(y.bump||0)).attr("y1",p==a?0:d3.min(_.range())-(y.bump||0)).attr("y2",p==a?0:d3.max(_.range())+(y.bump||0))}else h.highlightValueRun(t)}h.highlightValueRun=function(t){y.viewportLength&&"none"!=f&&(h.scale()(f)>y.viewportLength||h.scale()(f)<0)&&(f="none");var e="top"==h.orient()||"bottom"==h.orient()?a:r,n=e==a&&h.pivot()||e==r&&!h.pivot()?"y":"x",i=h.pivot()?-1:1;t.select(".vzb-axis-value").classed("vzb-hidden","none"==f),t.select(".vzb-axis-value-shadow").select("text").text("none"==f?"":y.formatter(f));var s=void 0,o={};"none"!=f&&(s=t.select(".vzb-axis-value-shadow").node().getBBox(),o.bump=y.bump,o.formatter=y.formatter,o.viewportLength=y.viewportLength,o.toolMargin=y.toolMargin,o.cssMargin=y.cssMargin,o.widthOfOneDigit=s[h.pivot()?"height":"width"]/y.formatter(f).length,o.heightOfOneDigit=s[h.pivot()?"width":"height"]);var l=("none"==f?{x:0,y:0}:M([f],o,e,h.scale(),n)[f])[n],c=function(t){return"none"==f?"translate(0,0)":"translate("+(e==a?h.scale()(f)+l*i:0)+","+(e==r?h.scale()(f)+l*i:0)+")"},u=function(t,r,o){if("none"==f)return 1;var c=e==a?"width":"height",u=((h.repositionLabels()||{})[t]||{x:0,y:0})[n];return h.hlOpacityScale()(Math.abs(h.scale()(t)+u*i-h.scale()(f)-l*i)-o.getBBox()[c]/2-s[c]/2)};p?(t.select(".vzb-axis-value").transition().duration(p).ease(d3.easeLinear).attr("transform",c),t.select(".vzb-axis-value").selectAll("text").interrupt("text"+("none"==f?"on":"off")).transition("text"+("none"==f?"off":"on")).delay(p).text("none"==f?"":y.formatter(f)),t.selectAll(".tick:not(.vzb-hidden)").each(function(t,e){d3.select(this).select("text").transition().duration(p).ease(d3.easeLinear).style("opacity",u(t,e,this))})):(t.select(".vzb-axis-value").interrupt().attr("transform",c),t.select(".vzb-axis-value").selectAll("text").interrupt("texton").interrupt("textoff").text("none"==f?"":y.formatter(f)),t.selectAll(".tick:not(.vzb-hidden)").each(function(t,e){d3.select(this).select("text").interrupt().style("opacity",u(t,e,this))})),f=null};var d=d3.scaleLinear().domain([0,5]).range([0,1]).clamp(!0);h.hlOpacityScale=function(t){return arguments.length?(d=t,h):d};var f=null;h.highlightValue=function(t){return arguments.length?(f=t,h):f};var p=0;h.highlightTransDuration=function(t){return arguments.length?(p=t,h):p};var v=null;h.repositionLabels=function(t){return arguments.length?(v=t,h):v};var g=!1;h.pivot=function(t){return arguments.length?(g=!!t,h):g};var m=[];h.tickValuesMinor=function(t){return arguments.length?(m=t,h):m};var b={outbound:0,inbound:0};h.tickSizeMinor=function(t,e){return arguments.length?(w("setting",b={outbound:t,inbound:e||0}),h):b};var y={};function _(t,e){null==e&&(e=!0);var n=[],i=[];-1!=t.indexOf(0)&&(n.push([0]),i.push(t.indexOf(0)));for(var r=function(r){n.push(t.filter(function(t,n){return!(n%Math.floor(r)!=0||-1!=i.indexOf(n)&&e)&&(i.push(n),!0)}))},a=t.length;a>=1;a=a<4?a-1:a/2)r(a);return n}function M(t,e,n,i,s){if(!t)return null;var o={},l=n==r?{head:e.toolMargin.top,tail:e.toolMargin.bottom}:{head:e.toolMargin.right,tail:e.toolMargin.left},c=i.range(),u=e.bump;return e.viewportLength&&(t=t.filter(function(t){return i(t)>=0&&i(t)<=e.viewportLength}),c=[0,e.viewportLength],u=0),t.forEach(function(h,d){if(0==d||d==t.length-1){var f=Math.min(l.head,.5*e.widthOfOneDigit)+u+(n==a?1:0)*d3.max(c)-(n==a?0:1)*d3.min(c)+(n==a?-1:1)*i(h)-("x"==s)*e.formatter(h).length*e.widthOfOneDigit/2-("y"==s)*e.heightOfOneDigit/2-("x"==s)*parseInt(e.cssMargin.right)-("y"==s)*parseInt(e.cssMargin.top),p=Math.min(l.tail,.5*e.widthOfOneDigit)+u+(n==r?1:0)*d3.max(c)-(n==r?0:1)*d3.min(c)+(n==r?-1:1)*i(h)-("x"==s)*e.formatter(h).length*e.widthOfOneDigit/2-("y"==s)*e.heightOfOneDigit/2-("x"==s)*parseInt(e.cssMargin.left)-("y"==s)*parseInt(e.cssMargin.bottom);f>0&&(f=0),p>0&&(p=0),o[h]={x:0,y:0},o[h][s]=("y"==s&&n==r?-1:1)*(f-p)}}),t.forEach(function(l,c){if(0!=c&&c!=t.length-1){var u=Math.abs(i(l)-i(t[t.length-1]))-("y"==s)*(n==a?-1:1)*o[t[t.length-1]][s]-("x"==s)*(n==a?1:-1)*o[t[t.length-1]][s]-("x"==s)*e.widthOfOneDigit/2*e.formatter(l).length-("x"==s)*e.widthOfOneDigit/2*e.formatter(t[t.length-1]).length-("y"==s)*e.heightOfOneDigit*.7-("x"==s)*parseInt(e.cssMargin.left)-("y"==s)*parseInt(e.cssMargin.bottom),h=Math.abs(i(l)-i(t[0]))-("y"==s)*(n==r?-1:1)*o[t[0]][s]-("x"==s)*(n==r?1:-1)*o[t[0]][s]-("x"==s)*e.widthOfOneDigit/2*e.formatter(l).length-("x"==s)*e.widthOfOneDigit/2*e.formatter(t[0]).length-("y"==s)*e.heightOfOneDigit*.7-("x"==s)*parseInt(e.cssMargin.left)-("y"==s)*parseInt(e.cssMargin.bottom);u>0&&(u=0),h>0&&(h=0),o[l]={x:0,y:0},o[l][s]=("y"==s&&n==r?-1:1)*(u-h)}}),o}return h.labelerOptions=function(t){return arguments.length?(y=t,h):y},h.METHOD_REPEATING="repeating specified powers",h.METHOD_DOUBLING="doubling the value",h.labelFactory=function(t){if(null==t&&(t={}),"linear"!=t.scaleType&&"time"!=t.scaleType&&"genericLog"!=t.scaleType&&"log"!=t.scaleType&&"ordinal"!=t.scaleType)return h.ticks(t.limitMaxTickNumber).tickFormat(null).tickValues(null).tickValuesMinor(null).pivot(null).repositionLabels(null);if("ordinal"==t.scaleType)return h;null==t.logBase&&(t.logBase=10),null==t.stops&&(t.stops=[1,2,5,3,7,4,6,8,9]),null==t.removeAllLabels&&(t.removeAllLabels=!1),null==t.formatter&&(t.formatter=h.tickFormat()?h.tickFormat():function(t){return t+""}),t.cssLabelMarginLimit=5,null==t.cssMargin&&(t.cssMargin={}),(null==t.cssMargin.left||parseInt(t.cssMargin.left)<t.cssLabelMarginLimit)&&(t.cssMargin.left=t.cssLabelMarginLimit+"px"),(null==t.cssMargin.right||parseInt(t.cssMargin.right)<t.cssLabelMarginLimit)&&(t.cssMargin.right=t.cssLabelMarginLimit+"px"),(null==t.cssMargin.top||parseInt(t.cssMargin.top)<t.cssLabelMarginLimit)&&(t.cssMargin.top=t.cssLabelMarginLimit+"px"),(null==t.cssMargin.bottom||parseInt(t.cssMargin.bottom)<t.cssLabelMarginLimit)&&(t.cssMargin.bottom=t.cssLabelMarginLimit+"px"),null==t.toolMargin&&(t.toolMargin={left:30,bottom:30,right:30,top:30}),null==t.bump&&(t.bump=0),null==t.viewportLength&&(t.viewportLength=0),null==t.pivotingLimit&&(t.pivotingLimit=t.toolMargin[this.orient()]),null==t.showOuter&&(t.showOuter=!1),null==t.limitMaxTickNumber&&(t.limitMaxTickNumber=0);var e="top"==this.orient()||"bottom"==this.orient()?a:r;null==t.isPivotAuto&&(t.isPivotAuto=e==r),null==t.cssFontSize&&(t.cssFontSize="13px"),null==t.widthToFontsizeRatio&&(t.widthToFontsizeRatio=.75),null==t.heightToFontsizeRatio&&(t.heightToFontsizeRatio=1.2),null==t.widthOfOneDigit&&(t.widthOfOneDigit=parseInt(t.cssFontSize)*t.widthToFontsizeRatio),null==t.heightOfOneDigit&&(t.heightOfOneDigit=parseInt(t.cssFontSize)*t.heightToFontsizeRatio),null!=t.fitIntoScale&&"pessimistic"!=t.fitIntoScale||(t.fitIntoScale=c),"optimistic"==t.fitIntoScale&&(t.fitIntoScale=l),w("********** "+e+" **********");var n=h.scale().domain(),i=h.scale().range(),s=(Math.abs(n[n.length-1]-n[0]),Math.abs(i[i.length-1]-i[0])),o=d3.min([n[0],n[n.length-1]]),d=d3.max([n[0],n[n.length-1]]),f=("linear"==t.scaleType?o<0:o<=0)&&d>=0&&"time"!=t.scaleType,p=t.showOuter?[o,d]:[],v=[],g=5;function m(e,n){return 0==e||0==n?0:(null==n&&(n=t.logBase),Math.log(e)/Math.log(n))}var b=d3.max(d3.range(o,d,(d-o)/17).concat(d).map(function(e){return t.formatter(e).replace(".","").length}))*t.widthOfOneDigit+parseInt(t.cssMargin.left),y=t.isPivotAuto&&(b>t.pivotingLimit&&e==r||!(b>t.pivotingLimit)&&!(e==r)),x=e==a&&y||e==r&&!y,S=!x&&t.heightOfOneDigit>t.pivotingLimit;if(t.removeAllLabels)return h.tickValues([]);if(o==d)return h.tickValues([o]).ticks(1).tickFormat(t.formatter);var z=function(e,n,i,r){if(null==e||e.length<=1)return!0;if(null==i&&(i=c),null==r&&(scaleType="none"),x)return n>e.length*(t.heightOfOneDigit+parseInt(t.cssMargin.top)+parseInt(t.cssMargin.bottom));var a=parseInt(t.cssMargin.left)+parseInt(t.cssMargin.right),s=d3.max(e.map(function(e){return t.formatter(e).length}));return"log"==r?(n=Math.abs(h.scale()(d3.max(e))-h.scale()(d3.min(e))))>d3.sum(e.map(function(e){return(t.widthOfOneDigit*(i==c?s:t.formatter(e).length)+a)*(1+Math.log(e.toString().replace(/([0.])/g,"")[0])/Math.LN10)})):n>e.length*a+(i==c?t.widthOfOneDigit*e.length*s:0)+(i==l?t.widthOfOneDigit*e.map(function(e){return t.formatter(e)}).join("").length:0)},O=function(e,n){if(null==n||0==n.length)return!1;n instanceof Array||(n=[n]);for(var i=0;i<n.length;i++)if(e!=n[i]&&0!=e&&Math.abs(h.scale()(e)-h.scale()(n[i]))<(x?t.heightOfOneDigit:(t.formatter(e).length+t.formatter(n[i]).length)*t.widthOfOneDigit/2))return!0;return!1};if("genericLog"==t.scaleType||"log"==t.scaleType){var k=h.scale().constant?h.scale().constant():0,E=f?[0]:[],T=d<k?[]:d3.range(Math.floor(m(Math.max(k,o))),Math.ceil(m(d)),1).concat(Math.ceil(m(d))).map(function(e){return Math.pow(t.logBase,e)}),P=o>-k?[]:d3.range(Math.floor(m(Math.max(k,-d))),Math.ceil(m(-o)),1).concat(Math.ceil(m(-o))).map(function(e){return-Math.pow(t.logBase,e)});if(null==t.method){var A=f?Math.max(Math.abs(d),Math.abs(o))/k:Math.max(Math.abs(d),Math.abs(o))/Math.min(Math.abs(d),Math.abs(o));t.method=10<=A&&A<=1024?this.METHOD_DOUBLING:this.METHOD_REPEATING}if(t.method==this.METHOD_DOUBLING&&function(){var t=[];f&&p.push(0);var e=[].concat(p),n=d<k?null:4*T[Math.floor(T.length/2)-1],i=o>-k?null:4*P[Math.floor(P.length/2)-1];if(n)for(var r=n;r<=d;r*=2)t.push(r);if(n)for(var a=n/2;a>=Math.max(o,k);a/=2)t.push(a);if(i)for(var l=i;l>=o;l*=2)t.push(l);if(i)for(var h=i/2;h<=Math.min(d,-k);h/=2)t.push(h);t=t.sort(d3.ascending).filter(function(t){return o<=t&&t<=d}),v=v.concat(t),t=_(t,!1);for(var g=p,m=0;m<t.length;m++){var b=g.concat(t[m]).filter(function(t){return!O(t,e)}).filter(u);if(!z(b,s,c,"none"))break;p=b}}(),t.method==this.METHOD_REPEATING){var C=E.concat(T).concat(P).sort(d3.ascending);t.stops.forEach(function(t,e){v=v.concat(C.map(function(e){return e*t}))}),C=_(C);var L=E.concat(p),D=!1;t.stops.forEach(function(e,n){if(0==n){for(var i,r=0;r<C.length;r++){var a=p.concat(C[r].map(function(t){return t*e})).filter(function(t){return!O(t,L)}).filter(function(t){return o<=t&&t<=d}).filter(u);if(!z(a,s,c,"none"))break;p=a}C=(i=[]).concat.apply(i,function(t){if(Array.isArray(t)){for(var e=0,n=Array(t.length);e<t.length;e++)n[e]=t[e];return n}return Array.from(t)}(C))}else{if(D)return;var l=p.concat(C.map(function(t){return t*e})).filter(function(t){return o<=t&&t<=d}).filter(u);if(!z(l,s,c,"log"))return void(D=!0);if(p.length>t.limitMaxTickNumber&&0!=t.limitMaxTickNumber)return void(D=!0);p=l}})}}return"linear"!=t.scaleType&&"time"!=t.scaleType||function(){f&&p.push(0);var e=[].concat(p);g=x?Math.max(Math.floor(s/(t.heightOfOneDigit+parseInt(t.cssMargin.top))),2):Math.max(Math.floor(s/b),2),0!=t.limitMaxTickNumber&&g>t.limitMaxTickNumber&&(g=t.limitMaxTickNumber);var n=h.scale().ticks(g).sort(d3.ascending).filter(function(t){return o<=t&&t<=d});v=v.concat(n),n=_(n,!1);for(var i=p,r=0;r<n.length;r++){var a=i.concat(n[r]).filter(function(t){return!O(t,e)}).filter(u);if(!z(a,s,t.fitIntoScale,"none"))break;p=a}p=p.filter(function(t){return!O(t,e)}).filter(u)}(),null!=p&&p.length<=2&&!f&&(1!=(p=Math.abs(h.scale()(o)-h.scale()(d))<(x?t.heightOfOneDigit:(t.formatter(o).length+t.formatter(d).length)*t.widthOfOneDigit)?[d]:[o,d]).length||"linear"!=t.scaleType&&"time"!=t.scaleType||(v=[])),null!=p&&p.length<=3&&f&&(p=O(0,[o,d])?[o,d]:[o,0,d]),null!=p&&p.sort(function(t,n){return(e==a?-1:1)*(h.scale()(n)-h.scale()(t))}),S&&(p=[]),v=v.filter(function(t){return-1==p.indexOf(t)&&o<=t&&t<=d}),w("final result",p),h.ticks(g).tickFormat(t.formatter).tickValues(p).tickValuesMinor(v).pivot(y).repositionLabels(M(p,t,e,h.scale(),x?"y":"x"))},h.copy=function(){return e(d3["axis"+i.capitalize(t)]())},h.orient=function(){return arguments.length?h:t},d3.rebind(h,n,"scale","ticks","tickArguments","tickValues","tickFormat","tickSize","tickSizeInner","tickSizeOuter","tickPadding");function w(){var t;h.labelerOptions().isDevMode&&(t=console).log.apply(t,arguments)}}(d3["axis"+i.capitalize(t)]())};var i=function(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n]);return e.default=t,e}(n(1))},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i,r=function(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n]);return e.default=t,e}(n(1)),a=n(5);var s=((i=a)&&i.__esModule?i:{default:i}).default.extend({init:function(t,e){this.name="show";this.template=this.template||n(170),this.model_expects=this.model_expects||[{name:"state"},{name:"locale",type:"locale"}],this.tabsConfig=((t.ui.dialogs.dialog||{}).find||{}).showTabs||{},this._super(t,e)},readyOnce:function(){var t=this;this._super(),this.KEYS=r.unique(this.model.state.marker._getAllDimensions({exceptType:"time"})),this.resetFilter={};var e=this.model.state.marker._space;this.KEYS.forEach(function(n){t.resetFilter[n]=r.find(e,function(t){return t.dim===n}).show}),this.parentElement=d3.select(this.parent.element),this.contentEl=this.element=d3.select(this.element.parentNode),this.list=this.element.select(".vzb-show-list"),this.input_search=this.parentElement.select(".vzb-find-search"),this.deselect_all=this.parentElement.select(".vzb-show-deselect"),this.apply=this.parentElement.select(".vzb-show-apply");var n=this;this.deselect_all.on("click",function(){n.resetShow()}),this.apply.on("click",function(){n.applyShowChanges()}),this.root.on("ready",function(){n.ready()})},ready:function(){var t=this;this._super(),this.KEYS=r.unique(this.model.state.marker._getAllDimensions({exceptType:"time"})),this.labelNames=this.model.state.marker.getLabelHookNames();var e=this.model.state.marker.getSubhooks(!0);this.previewShow={},this.checkedDifference={},r.forEach(this.labelNames,function(n){var i=e[n].getEntity(),a=t.previewShow[i._name]={};r.forEach(i.show.$and||[i.show],function(t){r.forEach(t,function(t,e){a[e]=(t.$in||[]).slice(0)})})}),this.redraw(),this.showHideButtons(),r.preventAncestorScrolling(this.element.select(".vzb-dialog-scrollable"))},redraw:function(){var t=this,e=this;this.translator=this.model.locale.getTFunction(),this.model.state.marker.getFrame(this.model.state.time.value,function(n){if(n){var i=t.model.state.marker.getSubhooks(!0);e.list.html("");var a=[];r.forEach(t.labelNames,function(e,n){var r=i[e].getEntity(),s=r._name;a.push({dim:n,entities:s,labelName:e,key:n,category:t.root.model.dataManager.getConceptProperty(n,"name")});var o=r.getEntitySets().map(function(e){return{entities:s,key:e,dim:n,isSet:!0,category:t.root.model.dataManager.getConceptProperty(e,"name")}});a.push.apply(a,function(t){if(Array.isArray(t)){for(var e=0,n=Array(t.length);e<t.length;e++)n[e]=t[e];return n}return Array.from(t)}(o))}),r.forEach(a,function(i){i.dim;var a=i.key,s=i.category,o=i.labelName,l=i.entities,c=i.isSet,u=c?t.model.state[l].getEntitySets("data")[a][0].map(function(t){var n={entities:l,category:a};return n[a]=t[a],n.label=t.name,n.isShown=e.model.state[l].isInShowFilter(t,a),n}):r.keys(n[o]).map(function(t){var i={entities:l,category:a};return i[a]=t,i.label=n[o][t],i.isShown=e.model.state[l].isInShowFilter(i,a),i});u.sort(function(t,e){return t.label<e.label?-1:1});var h=e.list.append("div").attr("class","vzb-accordion-section").classed("vzb-accordion-active","open"===t.tabsConfig[a]).datum({key:a,isSet:c});h.append("div").attr("class","vzb-accordion-section-title").on("click",function(t){var e=d3.select(this.parentNode);e.classed("vzb-fullexpand",!1).classed("vzb-accordion-active",!e.classed("vzb-accordion-active"))}).call(function(t){return t.append("span").attr("class","vzb-show-category").classed("vzb-show-category-set",function(t){return t.isSet}).text(s).attr("title",function(t){return this.offsetWidth<this.scrollWidth?s:null})}).call(function(t){return t.append("span").attr("class","vzb-show-clear-cross").text("✖").on("click",function(){d3.event.stopPropagation(),h.selectAll(".vzb-checked input").property("checked",!1).dispatch("change")})}).call(function(t){return t.append("span").attr("class","vzb-show-more vzb-dialog-button").text(e.translator("buttons/moreellipsis")).on("click",function(){d3.event.stopPropagation(),h.classed("vzb-fullexpand",!0)})});var d=h.append("div").attr("class","vzb-show-category-list"),f=d.selectAll(".vzb-show-item").data(u).enter().append("div").attr("class","vzb-show-item vzb-dialog-checkbox").classed("vzb-checked",function(t){return t.isShown});f.append("input").attr("type","checkbox").attr("class","vzb-show-item").attr("id",function(t){return"-show-"+t.category+"-"+t[a]+"-"+e._id}).property("checked",function(t){return t.isShown}).on("change",function(e,n,i){if(e.isShown!==i[n].checked?t.checkedDifference[e.category+e[a]]=!0:delete t.checkedDifference[e.category+e[a]],t.apply.classed("vzb-disabled",!Object.keys(t.checkedDifference).length),!t.previewShow[e.entities][e.category]){var r=t.model.state[e.entities].show;t.previewShow[e.entities][e.category]=((r[e.category]||(r.$and||{})[e.category]||{}).$in||[]).slice(0)}var s=t.previewShow[e.entities][e.category].indexOf(e[e.category]);-1===s?t.previewShow[e.entities][e.category].push(e[e.category]):t.previewShow[e.entities][e.category].splice(s,1)}),f.append("label").attr("for",function(t){return"-show-"+t.category+"-"+t[a]+"-"+e._id}).text(function(t){return t.label}).attr("title",function(t){return this.offsetWidth<this.scrollWidth?t.label:null});var p=d.selectAll(".vzb-checked").classed("vzb-separator",!1).lower().nodes()[0];if(p&&p.nextSibling){d3.select(p).classed("vzb-separator",!!p.nextSibling);var v=p.parentNode.offsetTop+p.offsetTop;d3.select(p.parentNode.parentNode).style("max-height",v+p.offsetHeight+25+"px").select(".vzb-show-more").style("transform","translate(0, "+v+"px)")}else h.select(".vzb-show-more").classed("vzb-hidden",!0);h.classed("vzb-filtered",!!p),h.classed("vzb-fullexpand",!!p&&"open"===t.tabsConfig[a])}),e.contentEl.node().scrollTop=0,e.input_search.attr("placeholder",e.translator("placeholder/search")+"...")}})},applyShowChanges:function(){var t=this;this.model.state.marker.clearSelected();var e={};r.forEach(this.previewShow,function(n,i){var a=[],s=[];r.forEach(n,function(t,e){var n,i,r;s.push(e),t.length&&a.push((n={},i=e,r={$in:t.slice(0)},i in n?Object.defineProperty(n,i,{value:r,enumerable:!0,configurable:!0,writable:!0}):n[i]=r,n))}),r.forEach(t.model.state[i].show.$and||[t.model.state[i].show],function(t){r.forEach(t,function(t,e){s.includes(e)||a.push(r.deepClone(t))})}),e[i]={show:a.length>1?{$and:a}:a[0]||{}}}),this.model.state.set(e)},showHideSearch:function(){if("show"===this.parent.getPanelMode()){var t=this.input_search.node().value||"";t=t.toLowerCase(),this.list.selectAll(".vzb-show-item").classed("vzb-hidden",function(e){return-1===(e.label||"").toString().toLowerCase().indexOf(t)}),""!==t&&this.list.selectAll(".vzb-accordion-section").classed("vzb-accordion-active",!0)}},showHideButtons:function(){"show"===this.parent.getPanelMode()&&(this.deselect_all.classed("vzb-hidden",this.hideResetButton()),this.apply.classed("vzb-hidden",!1).classed("vzb-disabled",!0))},hideResetButton:function(){var t=this,e=!0,n=this.model.state.marker._space;return r.forEach(this.KEYS,function(i){return e=r.comparePlainObjects(t.resetFilter[i]||{},r.find(n,function(t){return t.dim===i}).show)}),e},resetShow:function(){var t=this,e={},n=this.model.state.marker._space;this.KEYS.forEach(function(i){var a=r.find(n,function(t){return t.dim===i})._name;e[a]={show:t.resetFilter[i]||{}}}),this.model.state.set(e)},closeClick:function(){this.applyShowChanges()}});e.default=s},function(t,e,n){t.exports=!n(9)&&!n(4)(function(){return 7!=Object.defineProperty(n(81)("div"),"a",{get:function(){return 7}}).a})},function(t,e,n){e.f=n(7)},function(t,e,n){var i=n(17),r=n(18),a=n(64)(!1),s=n(83)("IE_PROTO");t.exports=function(t,e){var n,o=r(t),l=0,c=[];for(n in o)n!=s&&i(o,n)&&c.push(n);for(;e.length>l;)i(o,n=e[l++])&&(~a(c,n)||c.push(n));return c}},function(t,e,n){var i=n(10),r=n(2),a=n(40);t.exports=n(9)?Object.defineProperties:function(t,e){r(t);for(var n,s=a(e),o=s.length,l=0;o>l;)i.f(t,n=s[l++],e[n]);return t}},function(t,e,n){var i=n(18),r=n(43).f,a={}.toString,s="object"==typeof window&&window&&Object.getOwnPropertyNames?Object.getOwnPropertyNames(window):[];t.exports.f=function(t){return s&&"[object Window]"==a.call(t)?function(t){try{return r(t)}catch(t){return s.slice()}}(t):r(i(t))}},function(t,e,n){"use strict";var i=n(40),r=n(65),a=n(60),s=n(11),o=n(59),l=Object.assign;t.exports=!l||n(4)(function(){var t={},e={},n=Symbol(),i="abcdefghijklmnopqrst";return t[n]=7,i.split("").forEach(function(t){e[t]=t}),7!=l({},t)[n]||Object.keys(l({},e)).join("")!=i})?function(t,e){for(var n=s(t),l=arguments.length,c=1,u=r.f,h=a.f;l>c;)for(var d,f=o(arguments[c++]),p=u?i(f).concat(u(f)):i(f),v=p.length,g=0;v>g;)h.call(f,d=p[g++])&&(n[d]=f[d]);return n}:l},function(t,e){t.exports=Object.is||function(t,e){return t===e?0!==t||1/t==1/e:t!=t&&e!=e}},function(t,e,n){"use strict";var i=n(13),r=n(6),a=n(124),s=[].slice,o={};t.exports=Function.bind||function(t){var e=i(this),n=s.call(arguments,1),l=function(){var i=n.concat(s.call(arguments));return this instanceof l?function(t,e,n){if(!(e in o)){for(var i=[],r=0;r<e;r++)i[r]="a["+r+"]";o[e]=Function("F,a","return new F("+i.join(",")+")")}return o[e](t,n)}(e,i.length,i):a(e,i,t)};return r(e.prototype)&&(l.prototype=e.prototype),l}},function(t,e){t.exports=function(t,e,n){var i=void 0===n;switch(e.length){case 0:return i?t():t.call(n);case 1:return i?t(e[0]):t.call(n,e[0]);case 2:return i?t(e[0],e[1]):t.call(n,e[0],e[1]);case 3:return i?t(e[0],e[1],e[2]):t.call(n,e[0],e[1],e[2]);case 4:return i?t(e[0],e[1],e[2],e[3]):t.call(n,e[0],e[1],e[2],e[3])}return t.apply(n,e)}},function(t,e,n){var i=n(3).parseInt,r=n(55).trim,a=n(87),s=/^[-+]?0[xX]/;t.exports=8!==i(a+"08")||22!==i(a+"0x16")?function(t,e){var n=r(String(t),3);return i(n,e>>>0||(s.test(n)?16:10))}:i},function(t,e,n){var i=n(3).parseFloat,r=n(55).trim;t.exports=1/i(n(87)+"-0")!=-1/0?function(t){var e=r(String(t),3),n=i(e);return 0===n&&"-"==e.charAt(0)?-0:n}:i},function(t,e,n){var i=n(24);t.exports=function(t,e){if("number"!=typeof t&&"Number"!=i(t))throw TypeError(e);return+t}},function(t,e,n){var i=n(6),r=Math.floor;t.exports=function(t){return!i(t)&&isFinite(t)&&r(t)===t}},function(t,e){t.exports=Math.log1p||function(t){return(t=+t)>-1e-8&&t<1e-8?t-t*t/2:Math.log(1+t)}},function(t,e,n){var i=n(90),r=Math.pow,a=r(2,-52),s=r(2,-23),o=r(2,127)*(2-s),l=r(2,-126);t.exports=Math.fround||function(t){var e,n,r=Math.abs(t),c=i(t);return r<l?c*(r/l/s+1/a-1/a)*l*s:(n=(e=(1+s/a)*r)-(e-r))>o||n!=n?c*(1/0):c*n}},function(t,e,n){var i=n(2);t.exports=function(t,e,n,r){try{return r?e(i(n)[0],n[1]):e(n)}catch(e){var a=t.return;throw void 0!==a&&i(a.call(t)),e}}},function(t,e,n){var i=n(13),r=n(11),a=n(59),s=n(8);t.exports=function(t,e,n,o,l){i(e);var c=r(t),u=a(c),h=s(c.length),d=l?h-1:0,f=l?-1:1;if(n<2)for(;;){if(d in u){o=u[d],d+=f;break}if(d+=f,l?d<0:h<=d)throw TypeError("Reduce of empty array with no initial value")}for(;l?d>=0:h>d;d+=f)d in u&&(o=e(o,u[d],d,c));return o}},function(t,e,n){"use strict";var i=n(11),r=n(41),a=n(8);t.exports=[].copyWithin||function(t,e){var n=i(this),s=a(n.length),o=r(t,s),l=r(e,s),c=arguments.length>2?arguments[2]:void 0,u=Math.min((void 0===c?s:r(c,s))-l,s-o),h=1;for(l<o&&o<l+u&&(h=-1,l+=u-1,o+=u-1);u-- >0;)l in n?n[o]=n[l]:delete n[o],o+=h,l+=h;return n}},function(t,e){t.exports=function(t,e){return{value:e,done:!!t}}},function(t,e,n){"use strict";var i=n(102);n(0)({target:"RegExp",proto:!0,forced:i!==/./.exec},{exec:i})},function(t,e,n){n(9)&&"g"!=/./g.flags&&n(10).f(RegExp.prototype,"flags",{configurable:!0,get:n(61)})},function(t,e){t.exports=function(t){try{return{e:!1,v:t()}}catch(t){return{e:!0,v:t}}}},function(t,e,n){var i=n(2),r=n(6),a=n(106);t.exports=function(t,e){if(i(t),r(e)&&e.constructor===t)return e;var n=a.f(t);return(0,n.resolve)(e),n.promise}},function(t,e,n){"use strict";var i=n(140),r=n(48);t.exports=n(73)("Map",function(t){return function(){return t(this,arguments.length>0?arguments[0]:void 0)}},{get:function(t){var e=i.getEntry(r(this,"Map"),t);return e&&e.v},set:function(t,e){return i.def(r(this,"Map"),0===t?0:t,e)}},i,!0)},function(t,e,n){"use strict";var i=n(10).f,r=n(42),a=n(47),s=n(23),o=n(45),l=n(46),c=n(92),u=n(134),h=n(44),d=n(9),f=n(36).fastKey,p=n(48),v=d?"_s":"size",g=function(t,e){var n,i=f(e);if("F"!==i)return t._i[i];for(n=t._f;n;n=n.n)if(n.k==e)return n};t.exports={getConstructor:function(t,e,n,c){var u=t(function(t,i){o(t,u,e,"_i"),t._t=e,t._i=r(null),t._f=void 0,t._l=void 0,t[v]=0,void 0!=i&&l(i,n,t[c],t)});return a(u.prototype,{clear:function(){for(var t=p(this,e),n=t._i,i=t._f;i;i=i.n)i.r=!0,i.p&&(i.p=i.p.n=void 0),delete n[i.i];t._f=t._l=void 0,t[v]=0},delete:function(t){var n=p(this,e),i=g(n,t);if(i){var r=i.n,a=i.p;delete n._i[i.i],i.r=!0,a&&(a.n=r),r&&(r.p=a),n._f==i&&(n._f=r),n._l==i&&(n._l=a),n[v]--}return!!i},forEach:function(t){p(this,e);for(var n,i=s(t,arguments.length>1?arguments[1]:void 0,3);n=n?n.n:this._f;)for(i(n.v,n.k,this);n&&n.r;)n=n.p},has:function(t){return!!g(p(this,e),t)}}),d&&i(u.prototype,"size",{get:function(){return p(this,e)[v]}}),u},def:function(t,e,n){var i,r,a=g(t,e);return a?a.v=n:(t._l=a={i:r=f(e,!0),k:e,v:n,p:i=t._l,n:void 0,r:!1},t._f||(t._f=a),i&&(i.n=a),t[v]++,"F"!==r&&(t._i[r]=a)),t},getEntry:g,setStrong:function(t,e,n){c(t,e,function(t,n){this._t=p(t,e),this._k=n,this._l=void 0},function(){for(var t=this._k,e=this._l;e&&e.r;)e=e.p;return this._t&&(this._l=e=e?e.n:this._t._f)?u(0,"keys"==t?e.k:"values"==t?e.v:[e.k,e.v]):(this._t=void 0,u(1))},n?"entries":"values",!n,!0),h(e)}}},function(t,e,n){"use strict";var i=n(140),r=n(48);t.exports=n(73)("Set",function(t){return function(){return t(this,arguments.length>0?arguments[0]:void 0)}},{add:function(t){return i.def(r(this,"Set"),t=0===t?0:t,t)}},i)},function(t,e,n){"use strict";var i,r=n(3),a=n(30)(0),s=n(15),o=n(36),l=n(121),c=n(143),u=n(6),h=n(48),d=n(48),f=!r.ActiveXObject&&"ActiveXObject"in r,p=o.getWeak,v=Object.isExtensible,g=c.ufstore,m=function(t){return function(){return t(this,arguments.length>0?arguments[0]:void 0)}},b={get:function(t){if(u(t)){var e=p(t);return!0===e?g(h(this,"WeakMap")).get(t):e?e[this._i]:void 0}},set:function(t,e){return c.def(h(this,"WeakMap"),t,e)}},y=t.exports=n(73)("WeakMap",m,b,c,!0,!0);d&&f&&(l((i=c.getConstructor(m,"WeakMap")).prototype,b),o.NEED=!0,a(["delete","has","get","set"],function(t){var e=y.prototype,n=e[t];s(e,t,function(e,r){if(u(e)&&!v(e)){this._f||(this._f=new i);var a=this._f[t](e,r);return"set"==t?this:a}return n.call(this,e,r)})}))},function(t,e,n){"use strict";var i=n(47),r=n(36).getWeak,a=n(2),s=n(6),o=n(45),l=n(46),c=n(30),u=n(17),h=n(48),d=c(5),f=c(6),p=0,v=function(t){return t._l||(t._l=new g)},g=function(){this.a=[]},m=function(t,e){return d(t.a,function(t){return t[0]===e})};g.prototype={get:function(t){var e=m(this,t);if(e)return e[1]},has:function(t){return!!m(this,t)},set:function(t,e){var n=m(this,t);n?n[1]=e:this.a.push([t,e])},delete:function(t){var e=f(this.a,function(e){return e[0]===t});return~e&&this.a.splice(e,1),!!~e}},t.exports={getConstructor:function(t,e,n,a){var c=t(function(t,i){o(t,c,e,"_i"),t._t=e,t._i=p++,t._l=void 0,void 0!=i&&l(i,n,t[a],t)});return i(c.prototype,{delete:function(t){if(!s(t))return!1;var n=r(t);return!0===n?v(h(this,e)).delete(t):n&&u(n,this._i)&&delete n[this._i]},has:function(t){if(!s(t))return!1;var n=r(t);return!0===n?v(h(this,e)).has(t):n&&u(n,this._i)}}),c},def:function(t,e,n){var i=r(a(e),!0);return!0===i?v(t).set(e,n):i[t._i]=n,t},ufstore:v}},function(t,e,n){var i=n(25),r=n(8);t.exports=function(t){if(void 0===t)return 0;var e=i(t),n=r(e);if(e!==n)throw RangeError("Wrong length!");return n}},function(t,e,n){var i=n(43),r=n(65),a=n(2),s=n(3).Reflect;t.exports=s&&s.ownKeys||function(t){var e=i.f(a(t)),n=r.f;return n?e.concat(n(t)):e}},function(t,e,n){"use strict";var i=n(66),r=n(6),a=n(8),s=n(23),o=n(7)("isConcatSpreadable");t.exports=function t(e,n,l,c,u,h,d,f){for(var p,v,g=u,m=0,b=!!d&&s(d,f,3);m<c;){if(m in l){if(p=b?b(l[m],m,n):l[m],v=!1,r(p)&&(v=void 0!==(v=p[o])?!!v:i(p)),v&&h>0)g=t(e,n,p,a(p.length),g,h-1)-1;else{if(g>=9007199254740991)throw TypeError();e[g]=p}g++}m++}return g}},function(t,e,n){var i=n(8),r=n(89),a=n(28);t.exports=function(t,e,n,s){var o=String(a(t)),l=o.length,c=void 0===n?" ":String(n),u=i(e);if(u<=l||""==c)return o;var h=u-l,d=r.call(c,Math.ceil(h/c.length));return d.length>h&&(d=d.slice(0,h)),s?d+o:o+d}},function(t,e,n){var i=n(40),r=n(18),a=n(60).f;t.exports=function(t){return function(e){for(var n,s=r(e),o=i(s),l=o.length,c=0,u=[];l>c;)a.call(s,n=o[c++])&&u.push(t?[n,s[n]]:s[n]);return u}}},function(t,e,n){var i=n(54),r=n(150);t.exports=function(t){return function(){if(i(this)!=t)throw TypeError(t+"#toJSON isn't generic");return r(this)}}},function(t,e,n){var i=n(46);t.exports=function(t,e){var n=[];return i(t,!1,n.push,n,e),n}},function(t,e){t.exports=Math.scale||function(t,e,n,i,r){return 0===arguments.length||t!=t||e!=e||n!=n||i!=i||r!=r?NaN:t===1/0||t===-1/0?t:(t-e)*(r-i)/(n-e)+i}},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},r=function(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n]);return e.default=t,e}(n(1)),a=u(n(49)),s=u(n(5)),o=n(50),l=(u(o),u(n(401))),c=u(n(402));function u(t){return t&&t.__esModule?t:{default:t}}var h=a.default.extend({init:function(t,e){this._id=r.uniqueId("tm"),this._type="tool",this._component=t,this.dimensionManager=(0,l.default)(this),this.dataManager=(0,c.default)(this),this.getClassDefaults=function(){return t.default_model};var n=r.extend(t.getToolListeners(),e.bind);delete e.bind,this._super(t.name,e,null,n)},getDefaults:function(){return r.deepExtend({},this.getSubmodelDefaults(),this.getClassDefaults())},validate:function(){var t=10,e=this;!function n(i){var a=JSON.stringify(e.getPlainObject());e._component.validate(e);var s=JSON.stringify(e.getPlainObject());i>=t?r.error("Max validation loop."):a!==s&&n(i++)}(0)}}),d=s.default.extend({init:function(t,e){this._id=r.uniqueId("t"),this.template=this.getToolTemplate(),this._super({placeholder:t,model:e}),this.prerender(),this.setCSSClasses(),this.setResizeHandler(),this.postrender()},createModel:function(t){(t=t||{}).bind=t.bind||{},this.model=new h(this,t),this.model.setInterModelListeners()},getToolTemplate:function(){return this.template||'<div class="vzb-tool vzb-tool-'+this.name+'"><div class="vzb-tool-stage"><div class="vzb-tool-viz"></div><div class="vzb-tool-time-speed-sliders"><div class="vzb-tool-timeslider"></div><div class="vzb-tool-stepped-speed-slider"></div></div></div><div class="vzb-tool-sidebar"><div class="vzb-tool-dialogs"></div><div class="vzb-tool-buttonlist"></div></div><div class="vzb-tool-datanotes vzb-hidden"></div><div class="vzb-tool-treemenu vzb-hidden"></div><div class="vzb-tool-datawarning vzb-hidden"></div><div class="vzb-tool-labels vzb-hidden"></div></div>'},getToolListeners:function(){var t=this,e=this;return r.extend(this.model_binds,{readyOnce:function(){return t.setResizeHandler()},change:function(t,n){e._ready&&(e.model.validate(),t.source.persistent&&e.model.trigger(new o.DefaultEvent(t.source,"persistentChange")))},hook_change:function(){e.model.state.time.splash||e.beforeLoading()},"resize:ui":function(){e._ready&&e.triggerResize()},"translate:locale":function(){e.translateStrings(),e.model.ui.setRTL(e.model.locale.isRTL())},load_error1:function(e,n){t.renderError(n)}})},setResizeHandler:function(){this.model.ui.setContainer(this.element)},getVizWidthHeight:function(){var t=0,e=0;return this.element?(t=d3.select(this.element).select(".vzb-tool-viz").node().clientWidth,e=d3.select(this.element).select(".vzb-tool-viz").node().clientHeight):r.warn("Tool getVizWidthHeight(): missing this.element"),{width:t,height:e}},triggerResize:r.throttle(function(){this.trigger("resize")},100),startLoading:function(){var t=this;this._super(),Promise.all([this.model.startPreload(),this.startPreload()]).then(this.afterPreload.bind(this)).then(this.loadSplashScreen.bind(this)).then(function(){return r.delay(300)}).then(this.model.startLoading.bind(this.model)).then(this.finishLoading.bind(this)).catch(function(e){r.error("error in tool promise chain"),t.model.triggerLoadError(e)})},loadSplashScreen:function(){var t=this,e=this.model.state.marker.getSubhooks().some(function(e){return e.which===t.model.state.time.dim});return this.model.ui.splash&&!e?(this.model.state.time.splash=!0,this.model.startLoading({splashScreen:!0})):Promise.resolve()},finishLoading:function(){this.model.state.time.splash=!1},getPersistentModel:function(){var t=this.model.getPlainObject(!0);return function t(e){for(var n in e)"function"==typeof e[n]?(delete e[n],r.warn("minModel validation. Function found in enumerable properties of "+n+". This key is deleted from minModel")):"object"===i(e[n])&&t(e[n])}(t),t},getPersistentMinimalModel:function(t){var e=this.model.getDefaults(),n=this.getPersistentModel(),i=r.deepExtend(e,t);return r.diffObject(n,i)},clear:function(){this.model.ui.clear(),this.setModel=this.getModel=function(){},this._super()},setModel:function(t,e){e?this.model.reset(t):this.model.set(t),this.setCSSClasses()},getModel:function(){return this.model.getPlainObject()||{}},beforeLoading:function(){r.addClass(this.placeholder,"vzb-loading-data")},validate:function(t){if(!(t=this.model||t)||!t.state)return r.warn("tool validation aborted: model.state looks wrong: "+t)},setCSSClasses:function(){r.addClass(this.placeholder,"vzb-placeholder"),this.model.ui&&this.model.ui.buttons&&this.model.ui.buttons.length?r.removeClass(this.element,"vzb-buttonlist-off"):r.addClass(this.element,"vzb-buttonlist-off")}});e.default=d},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i,r=function(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n]);return e.default=t,e}(n(1)),a=n(32);var s={_continuous:{_default:"#ffb600",0:"#8c30e8",25:"#30a3e8",50:"#30e85e",75:"#e2c75a",100:"#e83030"},_discrete:{_default:"#ffb600",0:"#4cd843",1:"#e83739",2:"#ff7f00",3:"#c027d4",4:"#d66425",5:"#0ab8d8",6:"#bcfa83",7:"#ff8684",8:"#ffb04b",9:"#f599f5",10:"#f4f459",11:"#7fb5ed"},_default:{_default:"#ffb600"}},o=((i=a)&&i.__esModule?i:{default:i}).default.extend({getClassDefaults:function(){return r.deepExtend(this._super(),{use:null,which:null,scaleType:null,palette:{},paletteHiddenKeys:[],paletteLabels:null,allow:{scales:["linear","log","genericLog","time","pow","ordinal"]}})},init:function(t,e,n,i){var a=this;this._type="color",this._super(t,e,n,i),this._hasDefaultColor=!1,this.on("hook_change",function(){if(!a._readyOnce&&!a._loadCall&&(a.palette&&0!==Object.keys(a.palette._data).length||a.paletteHiddenKeys.length)){var t=a.getDefaultPalette(),e=a.getPalette(),n={},i=a.paletteHiddenKeys;Object.keys(t).forEach(function(a){var s,o;i.includes(a)||e[a]&&(s=t[a],o=e[a],!(Array.isArray(s)||Array.isArray(o)?Array.isArray(s)&&Array.isArray(o)&&r.arrayEquals(s,o):d3.color(s).hex()==d3.color(o).hex()))||(n[a]=t[a])}),a.set("palette",n,!1,!1)}})},getColorShade:function(t){var e=this.getPalette();if(!t)return r.warn("getColorShade() is missing arguments");if(!r.isArray(e[t.colorID]))return"shade"==t.shadeID?d3.rgb(e[t.colorID]||this.scale(t.colorID)).darker(.5).toString():e[t.colorID];var n=this.getConceptprops().color,i=t.shadeID&&n&&n.shades&&n.shades[t.shadeID]?n.shades[t.shadeID]:0;return e[t.colorID][i]},isUserSelectable:function(){var t=this.getConceptprops().color;return null==t||null==t.selectable||t.selectable},setWhich:function(t){this.palette&&(this.palette._data={},this.set("paletteHiddenKeys",[],!1,!0)),this._super(t)},getColorlegendMarker:function(){return this.colorlegendMarker||(this.colorlegendMarker=this.getClosestModel("marker_colorlegend")),this.colorlegendMarker},setColor:function(t,e,n,i){var r=arguments.length>4&&void 0!==arguments[4]&&arguments[4];t&&(t=d3.color(t).hex());var a=void 0,s=t&&e?function(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}({},e,t):{};if(this.isDiscrete())(a=this.scale.range())[this.scale.domain().indexOf(e)]=t;else{var o=this.getPalette(),l=Object.keys(o),c=this.getDefaultPalette(),u=this.paletteHiddenKeys;if(null!==n&&(c[n]&&!u.includes(n)&&u.push(n),l.includes(n)&&(delete o[n],delete this.palette[n],this.palette._data[n].off(),delete this.palette._data[n]),e||(i=this.palette._default!==c._default,r=!0,s._default=this.palette._default,this.set("paletteHiddenKeys",u,!0,!0))),e&&u.includes(e)&&u.splice(u.indexOf(e),1),!e||this.palette[e]||n||this.palette.set(e,null,!1,!1),e&&t&&(o[e]=t),a=Object.keys(o).sort(function(t,e){return t-e}).map(function(t){return o[t]}),s[e]&&c[e]&&s[e]===c[e]&&(i=!1),!l.includes(e)||null!==n){var h=this._buildColorScale(this.scaleType,o).scale;this.scale.domain(h.domain())}}this.scale.range(a),this.palette.set(s,r,i)},mapValue:function(t){return null!=this.scale&&this.isDiscrete()&&this._hasDefaultColor&&-1==this.scale.domain().indexOf(t)&&(t="_default"),this._super(t)},getDefaultPalette:function(){var t=this.getConceptprops().color,e=void 0;return this.discreteDefaultPalette=!1,t&&t.palette?e=r.clone(t.palette):s[this.which]?e=r.clone(s[this.which]):"constant"===this.use?e=/^#([0-9a-f]{3}|[0-9a-f]{6})$/.test(this.which)?{_default:this.which}:r.clone(s._default):(e=r.clone(s[this.isDiscrete()?"_discrete":"_continuous"]),this.discreteDefaultPalette=!0),e},_getPaletteLabels:function(){var t=this.getConceptprops().color,e=null;return t&&t.paletteLabels&&(e=r.clone(t.paletteLabels)),e},getPaletteLabels:function(){return this.paletteLabels.getPlainObject()},getPalette:function(){if((!this.palette||0===Object.keys(this.palette._data).length)&&0===this.paletteHiddenKeys.length){var t=this.getDefaultPalette();this.set("palette",t,!1,!1),this.set("paletteHiddenKeys",[],!1,!0);var e=this._getPaletteLabels();this.set("paletteLabels",e,!1,!1)}var n=this.palette.getPlainObject();return"ordinal"!==this.scaleType&&delete n._default,n},buildScale:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.scaleType,e=this.getPalette(),n=this._buildColorScale(t,e),i=n.scaleType,r=n.scale;this.scale=r,this.scaleType=i},_buildColorScale:function(t,e){var n=Object.keys(e),i=r.values(e),a=void 0;if(this._hasDefaultColor=n.indexOf("_default")>-1,"time"==t){var o=this._space.time,l=o.splash?{min:o.parse(o.startOrigin),max:o.parse(o.endOrigin)}:{min:o.start,max:o.end};l.min||(l.min=new Date),l.max||(l.max=new Date);var c=l.max-l.min==0;i=(n=n.sort(function(t,e){return t-e})).map(function(t){return c?e[n[0]]:e[t]}),n=n.map(function(t){return l.min.valueOf()+t/100*(l.max.valueOf()-l.min.valueOf())}),a=d3.scaleUtc().domain(n).range(i).interpolate(d3.interpolateRgb.gamma(2.2))}else if(this.isDiscrete()){if(i=i.map(function(t){return r.isArray(t)?t[0]:t}),t="ordinal",this.discreteDefaultPalette){var u=r.extend({},s._discrete);delete u._default;var h=Object.keys(u);i=(n=[].concat(this.getUnique(this.which))).map(function(t,n){return e[t]||u[h[n%h.length]]})}a=d3["scale"+r.capitalize(t)]().domain(n).range(i).unknown(e._default)}else{var d=this.getLimits(this.which),f=[d.min,d.max],p=f[1]-f[0]==0;if(i=(n=n.sort(function(t,e){return t-e})).map(function(t){return p?e[n[0]]:e[t]}),n=n.map(function(t){return f[0]+t/100*(f[1]-f[0])}),d3.min(n)<=0&&d3.max(n)>=0&&"log"===t&&(t="genericLog"),"log"===t||"genericLog"===t){var v=d3.scaleGenericlog().domain(f).range(f).constant(d.minAbsNear0);n=n.map(function(t){return v.invert(t)})}(a=d3["scale"+r.capitalize(t)]().domain(n).range(i).interpolate(d3.interpolateRgb.gamma(2.2))).constant&&a.constant(d.minAbsNear0)}return{scale:a,scaleType:t}}});e.default=o},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i,r=function(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n]);return e.default=t,e}(n(1)),a=n(32);var s=((i=a)&&i.__esModule?i:{default:i}).default.extend({getClassDefaults:function(){return r.deepExtend(this._super(),{use:null,which:null,merge:!1,manualSorting:null,spaceRef:null,scaleType:"ordinal"})},init:function(t,e,n,i){this._type="model",this._super(t,e,n,i)},validate:function(){this.scale&&(this.scale=null),"property"!=this.use&&"constant"!=this.use&&(r.warn("group model: use must be 'property' or 'constant'. Resetting to property..."),this.use="property")},_receiveSyncModelUpdate:function(t){var e=t.getConceptprops().concept_type;["entity_set","entity_domain"].includes(e)&&"constant"!==this.use&&this._super(t)}});e.default=s},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i,r=function(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n]);return e.default=t,e}(n(1)),a=n(32);var s=((i=a)&&i.__esModule?i:{default:i}).default.extend({getClassDefaults:function(){return r.deepExtend(this._super(),{use:null,which:null})},init:function(t,e,n,i){this._type="label",this._super(t,e,n,i)},autoconfigureModel:function(t){!this.which&&this.autoconfig&&(t=this._parent.getAvailableConcept(this.autoconfig)||this._parent.getAvailableConcept({type:"entity_domain"})),this._super(t)}});e.default=s},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i,r=function(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n]);return e.default=t,e}(n(1)),a=n(57);var s=["ar","ar-SA","he","he-IL"],o=((i=a)&&i.__esModule?i:{default:i}).default.extend({getClassDefaults:function(){return r.deepExtend(this._super(),{id:"en",filePath:"assets/translation/"})},dataConnectedChildren:["id"],strings:{},init:function(t,e,n,i){this._type="locale",this._super(t,e,n,i)},_isLoading:function(){return!this._loadedOnce||this._loadCall},preloadData:function(){return this.loadData()},loadData:function(t){var e=this;this.setReady(!1),this._loadCall=!0;var n=[];return t&&t.dataConnectedChange&&r.forEach(this._root._data,function(t){"data"===t._type&&n.push(t.loadConceptProps())}),this.strings[this.id]||n.push(new Promise(function(t,n){r.d3json(e.filePath+e.id+".json",function(i,r){if(i)return n(i);e._handleNewStrings(r),t()})})),Promise.all(n).then(function(){return e.trigger("translate")}).catch(function(t){return e.handleLoadError(t)})},_handleNewStrings:function(t){this.strings[this.id]=this.strings[this.id]?r.extend(this.strings[this.id],t):t},getUIString:function(t){return this.strings&&this.strings[this.id]&&(this.strings[this.id][t]||""===this.strings[this.id][t])?this.strings[this.id][t]:(this.strings&&this.strings[this.id]||r.warn("Strings are not loaded for the "+this.id+" locale. Check if translation JSON is valid"),t)},getTFunction:function(){var t=this;return function(e){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return Object.keys(n).reduce(function(t,e){var i=new RegExp("{{"+e+"}}","g");return t.replace(i,n[e])},t.getUIString(e))}},isRTL:function(){return-1!==s.indexOf(this.id)}});e.default=o},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i,r=function(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n]);return e.default=t,e}(n(1)),a=n(32);var s=((i=a)&&i.__esModule?i:{default:i}).default.extend({getClassDefaults:function(){return r.deepExtend(this._super(),{use:null,which:null})},init:function(t,e,n,i){this._type="side",i.readyOnce=this.readyOnce,this.state={left:{},right:{}},this._super(t,e,n,i)},readyOnce:function(){if(this.spaceRef){var t=this._space[this.spaceRef].dataConnectedChildren.slice(0);t.splice(t.indexOf("show"),1),this._space[this.spaceRef].dataConnectedChildren=t}},switchSideState:function(){var t=this.state.left;this.state.left=this.state.right,this.state.right=t},clearSideState:function(){this.state={left:{},right:{}}}});e.default=s},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i,r=n(109),a=(i=r)&&i.__esModule?i:{default:i},s=function(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n]);return e.default=t,e}(n(1));var o=a.default.extend({getClassDefaults:function(){return s.deepExtend(this._super(),{use:null,which:null,domainMin:null,domainMax:null,zoomedMin:null,zoomedMax:null,fixBaseline:0,extent:[0,.85],scaleType:null,allow:{scales:["ordinal","linear","log","genericLog","pow"]}})},_type:"size",buildScale:function(){this._super(),"ordinal"!==this.scaleType&&this.scale.clamp(!0)}});e.default=o},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i,r=function(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n]);return e.default=t,e}(n(1)),a=n(32);var s={ALL:"all",_default:"none"},o=((i=a)&&i.__esModule?i:{default:i}).default.extend({getClassDefaults:function(){return r.deepExtend(this._super(),{use:null,which:null,merge:!1,spaceRef:null})},init:function(t,e,n,i){this._type="model",this._super(t,e,n,i)},validate:function(){this.scale&&(this.scale=null),"indicator"===this.use&&(r.warn("stack model: use must not be 'indicator'. Resetting use to 'constant' and which to '"+s._default),this.use="constant",this.which=s._default),"constant"===this.use&&-1==r.values(s).indexOf(this.which)&&(r.warn("stack model: the requested value '"+this.which+"' is not allowed. resetting to '"+s._default),this.which=s._default,this.spaceRef=null)},getPalettes:function(){return s},_receiveSyncModelUpdate:function(t){var e=t.getConceptprops().concept_type;["entity_set","entity_domain"].includes(e)&&"constant"!==this.use&&this._super(t)},buildScale:function(){}});e.default=o},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i,r=function(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n]);return e.default=t,e}(n(1)),a=n(57),s=(i=a)&&i.__esModule?i:{default:i};function o(t){if(Array.isArray(t)){for(var e=0,n=Array(t.length);e<t.length;e++)n[e]=t[e];return n}return Array.from(t)}Date.prototype.utc=Date.prototype.toUTCString;var l={year:{data:d3.time.format.utc("%Y"),ui:d3.time.format.utc("%Y")},month:{data:d3.time.format.utc("%Y-%m"),ui:d3.time.format.utc("%b %Y")},day:{data:d3.time.format.utc("%Y%m%d"),ui:d3.time.format.utc("%c")},hour:{data:d3.time.format.utc("%Y%m%dT%H"),ui:d3.time.format.utc("%b %d %Y, %H")},minute:{data:d3.time.format.utc("%Y%m%dT%H%M"),ui:d3.time.format.utc("%b %d %Y, %H:%M")},second:{data:d3.time.format.utc("%Y%m%dT%H%M%S"),ui:d3.time.format.utc("%b %d %Y, %H:%M:%S")},week:{data:u(),ui:u()},quarter:{data:h(),ui:h()}},c=s.default.extend({getClassDefaults:function(){return r.deepExtend(this._super(),{dim:null,value:null,start:null,end:null,startOrigin:null,endOrigin:null,startSelected:null,endSelected:null,playable:!0,playing:!1,loop:!1,pauseBeforeForecast:!0,showForecast:!0,endBeforeForecast:null,round:"round",delay:150,delayThresholdX2:90,delayThresholdX4:45,unit:"year",format:{data:null,ui:null},step:1,immediatePlay:!0,record:!1,offset:0})},objectLeafs:["autoconfig"],dataConnectedChildren:["startOrigin","endOrigin","dim"],init:function(t,e,n,i){this._type="time",this.hooksToListen=new Set([]),this._super(t,e,n,i);var r=this;this.initFormatters(),this.endBeforeForecast||this.set("endBeforeForecast",this.decrementTime(this.parse(this.formatDate(new Date))),null,!1),this.dragging=!1,this.postponePause=!1,this.allSteps={},this.delayAnimations=this.delay,this.on({"change:playing":function(){!0===r.playing?r._startPlaying():r._stopPlaying()},"change:format":function(){r.initFormatters()},"change:showForecast":function(){r.setReady(!1),r.checkTimeLimits()},"change:endBeforeForecast":function(){r.setReady(!1),r.checkTimeLimits()}})},initFormatters:function(){l[this.unit]&&(this.formatters=l[this.unit]),"string"==typeof this.format?this.formatters.data=this.formatters.ui=d3.time.format.utc(this.format):(this.format.data&&(this.formatters.data=d3.time.format.utc(this.format.data)),this.format.ui&&(this.formatters.ui=d3.time.format.utc(this.format.ui))),this.validateFormatting()},preloadData:function(){return this.dataSource=this.getClosestModel(this.data||"data"),this._super()},afterPreload:function(){this.autoconfigureModel()},_isLoading:function(){return![].concat(o(this.hooksToListen)).every(function(t){return t._ready})},autoconfigureModel:function(){if(!this.dim&&this.autoconfig){var t=this.dataSource.getConcept(this.autoconfig);t&&(this.dim=t.concept),r.printAutoconfigResult(this)}},setLinkWith:function(t){var e=this;this.hooksToListen.add(t),t.on("startLoading",function(){return e.setReady(!1)}),t.on("ready",this.checkTimeLimits.bind(this))},unsetLinkWith:function(t){var e=this;this.hooksToListen.delete(t),t.off("startLoading",function(){return e.setReady(!1)}),t.off("ready",this.checkTimeLimits.bind(this))},checkTimeLimits:function(){var t=this;if([].concat(o(this.hooksToListen)).every(function(t){return t._ready})){var e=[this.startOrigin],n=[this.endOrigin];this.showForecast||n.push(this.endBeforeForecast),this.hooksToListen.forEach(function(t){var i=t.getTimespan();if(i&&i.min&&i.max){if(!r.isDate(i.min)||!r.isDate(i.max))return r.warn("checkTimeLimits(): min-max for hook "+t._name+" look wrong: "+i.min+" "+i.max+". Expecting Date objects. Ensure that time is properly parsed in the data from reader");e.push(i.min),n.push(i.max)}});var i=d3.max(e),a=d3.min(n);i>a&&(r.warn("checkTimeLimits(): Availability of the indicator's data has no intersection. I give up and just return some valid time range where you'll find no data points. Enjoy!"),i=d3.min(e),a=d3.max(n));var s={};this.start-i==0&&(this.start||this.startOrigin)||(s.start=i),this.end-a==0&&(this.end||this.endOrigin)||(s.end=a),null==this.startSelected&&(s.startSelected=i),null==this.endSelected&&(s.endSelected=a),null==this.value&&(s.value=this.parse(this.formatDate(new Date))),this.setTreeFreezer(!0),this.set(s,!1,!1),(s.start||s.end)&&this.hooksToListen.forEach(function(e){e.which==t.dim&&e.buildScale()}),this.setTreeFreezer(!1),this.setReady()}},_formatToDates:function(){for(var t=["value"],e=["value","start","end","startSelected","endSelected","endBeforeForecast"],n=0;n<e.length;n++){var i=e[n];if(!r.isDate(this[i])){var a=this.parse(this[i]);this.set(i,a,null,-1!==t.indexOf(i))}}},formatDate:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"data";return-1===["data","ui"].indexOf(e)&&(r.warn("Time.formatDate type parameter ("+e+') invalid. Using "data".'),e="data"),null==t?null:this.formatters[e](t)},parse:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"data";return null==t?null:this.formatters[e].parse(t.toString())},findFormat:function(t){for(var e=Object.keys(l),n=0;n<e.length;n++){var i=l[e[n]].data.parse(t);if(i)return{unit:e[n],time:i,type:"data"};if(i=l[e[n]].ui.parse(t))return{unit:e[n],time:i,type:"ui"}}return null},validate:function(){null==this.start&&this.startOrigin&&this.set("start",this.startOrigin,null,!1),null==this.end&&this.endOrigin&&this.set("end",this.endOrigin,null,!1),this.formatters&&this.validateFormatting(),l[this.unit]||(r.warn(this.unit+' is not a valid time unit, using "year" instead.'),this.unit="year"),this.step<1&&(this.step=1),this.end<this.start&&null!=this.start&&this.set("end",new Date(this.start),null,!1),this.value<this.startSelected&&null!=this.value&&null!=this.startSelected&&this.set("value",new Date(this.startSelected),null,!1),this.value>this.endSelected&&null!=this.value&&null!=this.endSelected&&this.set("value",new Date(this.endSelected),null,!1),!1===this.splash&&((!this.startSelected||this.startSelected<this.start)&&null!=this.start&&this.set({startSelected:new Date(this.start)},null,!1),(!this.endSelected||this.endSelected>this.end)&&null!=this.end&&this.set({endSelected:new Date(this.end)},null,!1)),this.value<this.start&&null!=this.value&&null!=this.start?this.set("value",new Date(this.start),null,!1):this.value>this.end&&null!=this.value&&null!=this.end&&this.set("value",new Date(this.end),null,!1),!1===this.playable&&!0===this.playing&&this.set("playing",!1,null,!1)},validateFormatting:function(){r.isDate(this.start)&&r.isDate(this.end)&&r.isDate(this.value)&&r.isDate(this.startSelected)&&r.isDate(this.endSelected)&&r.isDate(this.endBeforeForecast)||this._formatToDates()},play:function(){this._startPlaying()},pause:function(t){t?this.postponePause=!0:this.playing&&(this.set("playing",!1,null,!1),this.set("value",this.value,!0,!0))},dragStart:function(){this.dragging=!0},dragStop:function(){this.dragging=!1},getRange:function(){var t=this.getIntervalAndStep();return d3["utc"+t.interval].range(this.start,this.end,t.step)},getIntervalAndStep:function(){var t=void 0,e=void 0;switch(this.unit){case"week":t="monday",e=this.step;break;case"quarter":t="month",e=3*this.step;break;default:t=this.unit,e=this.step}return{interval:r.capitalize(t),step:e}},getFilter:function(t){var e=t.splash,n=this.parse(this.startOrigin),i=this.parse(this.endOrigin),r=this.getDimension(),a=null;if(e)null!=this.value&&((a={})[r]=this.formatters.data(this.value));else{var s=void 0,o=void 0;null!=n&&(s=this.formatters.data(n)),null!=i&&(o=this.formatters.data(i)),(s||o)&&((a={})[r]={},s&&(a[r].$gte=s),o&&(a[r].$lte=o))}return a},getParser:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"data";return this.formatters[t].parse},getFormatter:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"data";return this.formatters[t]},getAllSteps:function(){if(!this.start||!this.end)return r.warn("getAllSteps(): invalid start/end time is detected: "+this.start+", "+this.end),[];var t=""+this.offset+this.start+this.end+this.step;if(this.allSteps[t])return this.allSteps[t];this.allSteps[t]=[];for(var e=this.getIntervalAndStep(),n=d3["utc"+e.interval].count(this.start,this.end)<this.offset?new Date(this.start):d3["utc"+e.interval].offset(this.start,this.offset);+n<=+this.end;){var i=this.getIntervalAndStep();this.allSteps[t].push(n),n=d3["utc"+i.interval].offset(n,i.step)}return this.allSteps[t]},snap:function(t){if(this.round){null==t&&(t="value");var e="round";"ceil"===this.round&&(e="ceil"),"floor"===this.round&&(e="floor");var n=this.getIntervalAndStep(),i=d3["utc"+n.interval][e](this[t]);this.value-i==0&&this.value-this.start!=0&&this.value-this.end!=0||this.set(t,i,!0)}},_startPlaying:function(){if(this.playable){this.value>=this.endSelected&&this.getModelObject("value").set(this.startSelected,null,!1),this.set("playing",!0,null,!1),this.playInterval(this.immediatePlay),this.trigger("play")}},playInterval:function(t){if(this.playing){var e=this;this.delayAnimations=this.delay,this.delay<this.delayThresholdX2&&(this.delayAnimations*=2),this.delay<this.delayThresholdX4&&(this.delayAnimations*=2);var n=t?1:this.delayAnimations;this._intervals.setInterval("playInterval_"+this._id,function(){if(e.value>=e.endSelected)e.loop?e.getModelObject("value").set(e.startSelected,null,!1):e.set("playing",!1,null,!1);else if(e._intervals.clearInterval("playInterval_"+e._id),e.postponePause||!e.playing)e.set("playing",!1,null,!1),e.postponePause=!1,e.getModelObject("value").set(e.value,!0,!0);else{var t=e.getIntervalAndStep();e.delay<e.delayThresholdX2&&(t.step*=2),e.delay<e.delayThresholdX4&&(t.step*=2);var n=d3["utc"+t.interval].offset(e.value,t.step);n>=e.endSelected?e.getModelObject("value").set(e.endSelected,null,!0):e.pauseBeforeForecast&&e.value<e.endBeforeForecast&&n>=e.endBeforeForecast?(e.set("playing",!1,null,!1),e.getModelObject("value").set(e.endBeforeForecast,null,!0)):e.getModelObject("value").set(n,null,!1),e.playInterval()}},n)}},incrementTime:function(t){var e=this.getIntervalAndStep();return d3["utc"+e.interval].offset(t,e.step)},decrementTime:function(t){var e=this.getIntervalAndStep();return d3["utc"+e.interval].offset(t,-e.step)},ceilTime:function(t){var e=this.getIntervalAndStep();return d3["utc"+e.interval].ceil(t)},_stopPlaying:function(){this._intervals.clearInterval("playInterval_"+this._id),this.trigger("pause")}});function u(){var t=function(t){return e(t)+"w"+n(t)};t.parse=function(t){var e=t.match(/^(\d{4})w(\d{2})$/);return e?i(e[1],e[2]):null};var e=function(t){return t instanceof Date||(t=new Date(+t)),new Date(+t+864e5*(4-(t.getUTCDay()||7))).getUTCFullYear()},n=function(t){t instanceof Date||(t=new Date(+t));var e=new Date(+t+864e5*(4-(t.getUTCDay()||7))),n=Math.ceil(((e.getTime()-e.setUTCMonth(0,1))/864e5+1)/7);return n<10?"0"+n:n},i=function(t,e){var n=parseInt(e),i=t,r=new Date;r.setUTCFullYear(i),r.setUTCMonth(0),r.setUTCDate(4);var a=7*n+1-((r.getUTCDay()||7)+4),s=l.year.data.parse(i);return s=new Date(s.getTime()+24*a*60*60*1e3)};return t}function h(){var t=function(t){return l.year.data(t)+"q"+e(t)};t.parse=function(t){var e=t.match(/^(\d{4})q(\d)$/);return e?n(e[1],e[2]):null};var e=function(t){return t instanceof Date||(t=new Date(+t)),1+(t.getUTCMonth()/3|0)},n=function(t,e){var n=3*parseInt(e)-2,i=t;return l.month.data.parse([i,(n<9?"0":"")+n].join("-"))};return t}e.default=c},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i,r=function(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n]);return e.default=t,e}(n(1)),a=n(49);var s=((i=a)&&i.__esModule?i:{default:i}).default.extend({screen_profiles:{small:{min_width:0,min_height:0},medium:{min_width:600,min_height:400},large:{min_width:900,min_height:520}},getClassDefaults:function(){return r.deepExtend(this._super(),{presentation:!1,sidebarCollapse:!1,buttons:[],chart:{showForecastOverlay:!1},dialogs:{dialog:{find:{enableSelectShowSwitch:!1}},popup:[],sidebar:[],moreoptions:[]},splash:!1})},init:function(t,e,n,i){this._type="ui",this._container=null,this._curr_profile="small",this._prev_size={},this.resizeHandler=this.resizeHandler.bind(this),window.addEventListener("resize",this.resizeHandler),i["change:presentation"]=this.updatePresentation.bind(this),this._super(t,e,n,i);var a;(a=/(?:iPad|iPhone|iPod).+OS\s+(\d+)_(\d+)/.exec(navigator.userAgent))&&+a[1]>=10&&+a[2]>2&&!window.MSStream&&(this.setSize=r.debounce(this.setSize,500))},resizeHandler:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};this._container&&this.setSize(t.force||!1)},setSize:function(t){var e=this,n=this._container.clientWidth,i=this._container.clientHeight;if(/^((?!chrome|android).)*safari/i.test(navigator.userAgent)&&navigator.userAgent.match(/iPhone/i)&&(this._container.style.top=0,this._container.clientWidth>this._container.clientHeight&&this._container.clientWidth<700)){var a=this._container.clientHeight,s=window.innerHeight;2<a-s&&a-s<=45&&(this._container.style.top="44px",document.body.scrollTop=44)}(t||!this._prev_size||this._prev_size.width!==n||this._prev_size.height!==i)&&n&&i&&(r.forEach(this.screen_profiles,function(t,a){r.removeClass(e._container,"vzb-"+a),n>=t.min_width&&i>=t.min_height&&(e._curr_profile=a)}),r.addClass(this._container,"vzb-"+this._curr_profile),r.classed(this._container,"vzb-portrait",n<i),r.classed(this._container,"vzb-landscape",!(n<i)),this._prev_size.width=n,this._prev_size.height=i,this.trigger("resize"))},setContainer:function(t){t.clientWidth&&t.clientHeight||r.warn("Vizabi is being initialised with a container of incorrect width or height. While this may be handled without a crash, it's not considered a healthy behavior. You should call Vizabi(placeholder,...) function when placeholder is not display:none and has some >0 !=auto width and height"),this._container=t,this.setSize(),this.updatePresentation()},updatePresentation:function(){r.classed(this._container,"vzb-presentation",this.presentation),this.trigger("resize")},getPresentationMode:function(){return this.presentation},setRTL:function(t){r.classed(this._container,"vzb-rtl",t)},currentProfile:function(){return this._curr_profile},clear:function(){window.removeEventListener("resize",this.resizeHandler)}});e.default=s},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.default=function(){return d3.scaleSymlog().constant(.1)}},function(t,e,n){"use strict";function i(t,e,n){var i,r,a,s=e?".onTap":".onLongTap";d3.select(t).on("touchstart"+s,function(t,e){i=d3.event.timeStamp,r=d3.event.changedTouches[0].screenX,a=d3.event.changedTouches[0].screenY}).on("touchend"+s,function(t,s){return r=Math.abs(r-d3.event.changedTouches[0].screenX),a=Math.abs(a-d3.event.changedTouches[0].screenY),r<5&&a<5?d3.event.timeStamp-i<500?e?e(t,s):void 0:n?n(t,s):void 0:void 0})}Object.defineProperty(e,"__esModule",{value:!0});var r=function(t){return this.each(function(){i(this,t)})},a=function(t){return this.each(function(){i(this,null,t)})};e.default={onTap:r,onLongTap:a},e.onTap=r,e.onLongTap=a},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i,r=function(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n]);return e.default=t,e}(n(1)),a=n(79);var s={TEXT_PARAMS:{TOP:11,LEFT:10,MAX_WIDTH:42,MAX_HEIGHT:16},THUMB_STROKE_WIDTH:4},o={small:{minRadiusPx:.5,maxRadiusEm:.05},medium:{minRadiusPx:1,maxRadiusEm:.05},large:{minRadiusPx:1,maxRadiusEm:.05}},l=((i=a)&&i.__esModule?i:{default:i}).default.extend({init:function(t,e){this.name="bubblesize";var n=r.extend({},s);this.options=r.extend(n,this.options||{});var i=r.extend({},o);this.profiles=r.extend(i,this.profiles||{}),this.model_expects=[{name:"submodel",type:"size"},{name:"locale",type:"locale"}];this.changeHandler=this.changeHandler.bind(this),this.readyHandler=this.readyHandler.bind(this),this.model_binds={"change:submodel.domainMin":this.changeHandler,"change:submodel.domainMax":this.changeHandler},this._setModel=r.throttle(this._setModel,50),this._super(t,e)},changeHandler:function(t,e){var n=this.model.submodel.extent||[this.options.EXTENT_MIN,this.options.EXTENT_MAX];this._updateLabels(n),this._super(t,e)},readyHandler:function(t){this._super(t),this._setLabelsText()},readyOnce:function(){this._super(),this.showArcs=!1!==this.model.submodel.showArcs,this.padding.bottom=this.options.BAR_WIDTH+this.options.TEXT_PARAMS.MAX_HEIGHT,this.showArcs&&this.sliderEl.selectAll(".vzb-bs-slider-thumb-arc").data([0,0]).enter().append("path").attr("class","vzb-bs-slider-thumb-arc"),this.sliderArcsEl=this.sliderEl.selectAll(".vzb-bs-slider-thumb-arc"),this.sliderLabelsWrapperEl=this.sliderEl.append("g"),this.sliderLabelsWrapperEl.selectAll("text").data([0,0]).enter().append("text").attr("class","vzb-bs-slider-thumb-label").attr("text-anchor",function(t,e){return e?"start":"end"}).attr("dy",function(t,e){return e?"-0.7em":"1.4em"}),this.sliderLabelsEl=this.sliderEl.selectAll("text.vzb-bs-slider-thumb-label"),this._setLabelsText()},ready:function(){this._super(),this._updateLabels()},getMinMaxBubbleRadius:function(){var t=this.root.getVizWidthHeight(),e=r.hypotenuse(t.width,t.height),n=this.profiles[this.getLayoutProfile()].minRadiusPx,i=this.profiles[this.getLayoutProfile()].maxRadiusEm*e;return n>i&&(i=n),{min:n,max:i}},_updateSize:function(){var t=this;this._super(),this.sliderLabelsWrapperEl.attr("transform",this.isRTL?"scale(-1,1)":null),this.sliderLabelsEl.attr("text-anchor",function(e,n){return(t.isRTL?!n:n)?"start":"end"})},_resize:function(){var t=this.getMinMaxBubbleRadius(),e=this.element.node().offsetWidth-2*t.max;this.padding.top=t.max+this.options.BAR_WIDTH,this.padding.left=.5*e,this.padding.right=.5*e,this.rescaler.range([2*t.min,2*t.max]),this._super()},_getComponentWidth:function(){return 2*this.getMinMaxBubbleRadius().max},_updateThumbs:function(t){this._updateArcs(t),this._updateLabels(t)},_updateArcs:function(t){if(this.showArcs){var e=this,n=d3.arc().outerRadius(function(t){return.5*e.rescaler(t)}).innerRadius(function(t){return.5*e.rescaler(t)}).startAngle(.5*-Math.PI).endAngle(.5*Math.PI);this.sliderArcsEl.data(t).attr("d",n).attr("transform",function(t){return"translate("+.5*e.rescaler(t)+",0)"})}},_updateLabels:function(t){var e=this,n=this;t&&this.sliderLabelsEl.data(t),this.sliderLabelsEl.attr("transform",function(t,i){e.options.TEXT_PARAMS.TOP;var r=e.options.TEXT_PARAMS.LEFT*(i?.5:-1)+n.rescaler(t);return"translate("+(n.isRTL?-1:1)*r+",0)"})},_setLabelsText:function(){var t=[];if("constant"===this.model.submodel.use)t=["",""];else{var e=this.model.submodel.getTickFormatter(),n=this.model.submodel.getScale().domain();t=[e(n[0]),e(n[1])]}this.sliderLabelsEl.text(function(e,n){return t[n]})}});e.default=l},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i,r=function(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n]);return e.default=t,e}(n(1)),a=n(79);var s={},o={small:{minLabelTextSize:7,maxLabelTextSize:21,defaultLabelTextSize:12},medium:{minLabelTextSize:7,maxLabelTextSize:30,defaultLabelTextSize:15},large:{minLabelTextSize:6,maxLabelTextSize:48,defaultLabelTextSize:20}},l=((i=a)&&i.__esModule?i:{default:i}).default.extend({init:function(t,e){this.name="sizeslider";var n=r.extend({},s);this.options=r.extend(n,this.options||{});var i=r.extend({},o);this.profiles=r.extend(i,this.profiles||{}),this.propertyName=t.propertyname,this.model_expects=[{name:"submodel",type:"size"},{name:"locale",type:"locale"}];this.changeHandler=this.changeHandler.bind(this),this.readyHandler=this.readyHandler.bind(this),this.model_binds={"change:submodel.domainMin":this.changeHandler,"change:submodel.domainMax":this.changeHandler},this._setModel=r.throttle(this._setModel,50),this._super(t,e)},changeHandler:function(t,e){var n=this.model.submodel.extent||[this.options.EXTENT_MIN,this.options.EXTENT_MAX];this._updateLabels(n),this._super(t,e)},readyHandler:function(t){this.modelUse=this.model.submodel.use;var e=this.model.submodel.extent||[this.options.EXTENT_MIN,this.options.EXTENT_MAX];if("constant"!=this.modelUse)this.sizeScaleMinMax=this.model.submodel.getScale().domain(),this.sliderEl.selectAll(".w").classed("vzb-hidden",!1),this.sliderEl.select(".selection").classed("vzb-hidden",!1),this.sliderEl.select(".overlay").classed("vzb-pointerevents-none",!1),this._setLabelsText();else if(this.sliderEl.selectAll(".w").classed("vzb-hidden",!0),this.sliderEl.select(".selection").classed("vzb-hidden",!0),this.sliderEl.select(".overlay").classed("vzb-pointerevents-none",!0),!this.model.submodel.which){var n=this.propertyActiveProfile;e[1]=(n.default-n.min)/(n.max-n.min),this.model.submodel.which="_default"}this._moveBrush(e)},readyOnce:function(){this._super();var t=this.options,e=t.BAR_WIDTH;this.propertyActiveProfile=this.getPropertyActiveProfile(),this.propertyScale=d3.scaleLinear().domain([t.EXTENT_MIN,t.EXTENT_MAX]).range([this.propertyActiveProfile.min,this.propertyActiveProfile.max]).clamp(!0),this.padding.top=this.propertyActiveProfile.max+1.25*e,this.translator=this.model.locale.getTFunction(),this.sliderLabelsWrapperEl=this.sliderEl.append("g"),this.sliderLabelsWrapperEl.selectAll("text").data([0,0]).enter().append("text").attr("class",function(t,e){return"vzb-szs-slider-thumb-label "+(e?"e":"w")}).attr("dy",1.25*-e+"px"),this.sliderLabelsEl=this.sliderEl.selectAll("text.vzb-szs-slider-thumb-label"),this.sizeScaleMinMax=this.model.submodel.getScale().domain(),this.sizeScaleMinMax&&this._setLabelsText(),this.model._ready&&this.readyHandler()},ready:function(){this._super(),this._updateLabels()},getPropertyActiveProfile:function(){var t=this.profiles[this.getLayoutProfile()];return{min:t["min"+this.propertyName],max:t["max"+this.propertyName],default:t["default"+this.propertyName]}},_updateSize:function(){var t=this;this._super(),this.sliderLabelsWrapperEl.attr("transform",this.isRTL?"scale(-1,1)":null),this.sliderLabelsEl.attr("text-anchor",function(e,n){return(t.isRTL?n:!n)?"start":"end"})},_resize:function(){this.propertyActiveProfile=this.getPropertyActiveProfile(),this.propertyScale.range([this.propertyActiveProfile.min,this.propertyActiveProfile.max]),this.padding.top=this.propertyActiveProfile.max+1.25*this.options.BAR_WIDTH,this._super()},_updateThumbs:function(t){this._updateLabels(t)},_updateLabels:function(t){var e=this;t&&this.sliderLabelsEl.data(t),this.sliderLabelsEl.attr("transform",function(t,n){var i=e.rescaler(n);return"translate("+(e.isRTL?-1:1)*i+",0)"}).attr("font-size",function(t,n){return e.propertyScale(t)}),"constant"===e.model.submodel.use&&this.sliderLabelsEl.text(function(t){return~~e.propertyScale(t)+(e.translator(e.ui.constantUnit)||"")})},_setLabelsText:function(){var t=[this.model.submodel.getTickFormatter()(this.sizeScaleMinMax[0]),this.model.submodel.getTickFormatter()(this.sizeScaleMinMax[1])];this.sliderLabelsEl.text(function(e,n){return t[n]})}});e.default=l},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i,r=l(n(1)),a=n(5),s=(i=a)&&i.__esModule?i:{default:i},o=l(n(21));function l(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n]);return e.default=t,e}var c=s.default.extend({init:function(t,e){var n=this;this.name=this.name||"gapminder-buttonlist",this.model_expects=[{name:"state",type:"model"},{name:"ui",type:"ui"},{name:"locale",type:"locale"}],this._available_buttons={find:{title:"buttons/find",icon:"search",required:!1},show:{title:"buttons/show",icon:"asterisk",required:!1},moreoptions:{title:"buttons/more_options",icon:"gear",required:!0},colors:{title:"buttons/colors",icon:"paintbrush",required:!1},mapcolors:{title:"buttons/mapcolors",icon:"paintbrush",required:!1},size:{title:"buttons/size",icon:"circle",required:!1},zoom:{title:"buttons/zoom",icon:"cursorPlus",required:!1},fullscreen:{title:"buttons/expand",icon:"expand",func:this.toggleFullScreen.bind(this),required:!0},trails:{title:"buttons/trails",icon:"trails",func:this.toggleBubbleTrails.bind(this),required:!1,statebind:"ui.chart.trails",statebindfunc:this.setBubbleTrails.bind(this)},forecast:{title:"buttons/forecast",icon:"forecast",func:this.toggleTimeForecast.bind(this),required:!1,statebind:"state.time.showForecast",statebindfunc:this.setTimeForecast.bind(this)},lock:{title:"buttons/lock",icon:"lock",func:this.toggleBubbleLock.bind(this),required:!1,statebind:"ui.chart.lockNonSelected",statebindfunc:this.setBubbleLock.bind(this)},inpercent:{title:"buttons/inpercent",icon:"percent",func:this.toggleInpercent.bind(this),required:!1,statebind:"ui.chart.inpercent",statebindfunc:this.setInpercent.bind(this)},presentation:{title:"buttons/presentation",icon:"presentation",func:this.togglePresentationMode.bind(this),required:!1,statebind:"ui.presentation",statebindfunc:this.setPresentationMode.bind(this)},sidebarcollapse:{title:"buttons/sidebar_collapse",icon:"angleDoubleLeft",func:this.toggleSidebarCollapse.bind(this),required:!0,statebind:"ui.sidebarCollapse",statebindfunc:this.setSidebarCollapse.bind(this),ignoreSize:!0},about:{title:"buttons/about",icon:"about",required:!1},axes:{title:"buttons/axes",icon:"axes",required:!1},axesmc:{title:"buttons/axesmc",icon:"axes",required:!1},stack:{title:"buttons/stack",icon:"stack",required:!1},side:{title:"buttons/side",icon:"side",required:!1},_default:{title:"Button",icon:"asterisk",required:!1}},this._active_comp=!1,this.model_binds={"change:state.marker.select":function(t){n._readyOnce&&(n.setBubbleTrails(),n.setBubbleLock(),n._toggleButtons())},"change:ui.chart":function(t,e){n._readyOnce&&(e.indexOf("lockActive")>-1||e.indexOf("lockUnavailable")>-1)&&n.setBubbleLock()}},t.ui.buttons.forEach(function(t){var e=n._available_buttons[t];e&&e.statebind&&(n.model_binds["change:"+e.statebind]=function(i){n._readyOnce&&e.statebindfunc(t,i.source.value)})}),this._super(t,e),this.validatePopupButtons(this.model.ui.buttons,this.model.ui.dialogs)},readyOnce:function(){var t=this;this.element=d3.select(this.placeholder),this.element.selectAll("div").remove(),this.root.findChildByName("gapminder-dialogs").on("close",function(e,n){t.setButtonActive(n.id,!1)});var e=(this.model.ui.dialogs||{}).sidebar||[],n=[].concat(this.model.ui.buttons);this.model.ui.buttons=n,this._addButtons(n,e),this._prev_body_overflow=document.body.style.overflow,this.setBubbleTrails(),this.setTimeForecast(),this.setBubbleLock(),this.setInpercent(),this.setPresentationMode(),this._toggleButtons()},proceedClick:function(t){var e=this.element.selectAll(".vzb-buttonlist-btn[data-btn='"+t+"']"),n=e.attr("class"),i=this._available_buttons[t];if(i&&i.func)i.func(t);else{var r=-1===n.indexOf("vzb-active");e.classed("vzb-active",r);var a={};a.id=t,a.active=r,this.trigger("click",a)}},validatePopupButtons:function(t,e){for(var n=this,i=e.popup,a=t.filter(function(t){return n._available_buttons[t]&&!n._available_buttons[t].func}),s=0,o=a.length;s<o;s++)if(-1==i.indexOf(a[s]))return r.error('Buttonlist: bad buttons config: "'+a[s]+'" is missing in popups list');return!1},_showAllButtons:function(){this.element.selectAll(".vzb-buttonlist-btn").each(function(t,e){d3.select(this).style("display","")})},_toggleButtons:function(){var t=this,e=this.parent.element.node?this.parent.element:d3.select(this.parent.element),n=(this.model.ui.dialogs||{}).sidebar||[];t._showAllButtons();var i=this.element.selectAll(".vzb-buttonlist-btn"),r=(this.element.node().getBoundingClientRect(),[]),a=[],s=80,o=80,l=this.element.node().getBoundingClientRect().width,c=this.element.node().getBoundingClientRect().height,u=0,h=0;i.filter(function(t){return!t.ignoreSize}).each(function(e,i){var l=e,c=d3.select(this),d=-1!==n.indexOf(l.id),f=parseInt(c.style("margin-top")),p=parseInt(c.style("margin-right")),v=parseInt(c.style("margin-left")),g=parseInt(c.style("margin-bottom"));s=c.node().getBoundingClientRect().width+p+v,o=c.node().getBoundingClientRect().height+f+g,c.classed("vzb-hidden")||(!d||"large"!==t.getLayoutProfile()||t.model.ui.sidebarCollapse?(u+=s,h+=o,l.required?a.push(c):r.push(c)):c.style("display","none"))});var d=u-l,f=h-c,p=1;e.classed("vzb-large")&&e.classed("vzb-dialog-expand-true")||e.classed("vzb-small")&&e.classed("vzb-portrait")?(d>0&&d<=10&&(l+=d),(p=Math.floor(l/s)-a.length)<0&&(p=0)):(f>0&&f<=10&&(c+=f),(p=Math.floor(c/o)-a.length)<0&&(p=0)),r.reverse();for(var v=[],g=0,m=r.length-p;g<m;g++)r[g].style("display","none"),v.push(r[g].attr("data-btn"));var b={};b.hiddenButtons=v,t.trigger("toggle",b)},_addButtons:function(t,e){var n=this;this._components_config=[];var i=[];if(t.length){for(var a=0;a<t.length;a++){var s=t[a],l=this._available_buttons[s]?s:"_default",c=r.clone(this._available_buttons[l]);"_default"==l&&(c.title="buttons/"+s),c.id=s,c.icon=o[c.icon],i.push(c)}var u=this.getTranslationFunction(!0);this.element.selectAll("button").data(i).enter().append("button").attr("class",function(t){var n="vzb-buttonlist-btn";return e.length>0&&e.indexOf(t.id)>-1&&(n+=" vzb-dialog-side-btn"),n}).attr("data-btn",function(t){return t.id}).html(function(t){return"<span class='vzb-buttonlist-btn-icon fa'>"+t.icon+"</span><span class='vzb-buttonlist-btn-title'>"+u(t.title)+"</span>"}),this.element.selectAll(".vzb-buttonlist-btn").on("click",function(){d3.event.preventDefault(),d3.event.stopPropagation();var t=d3.select(this).attr("data-btn");n.proceedClick(t)})}},scrollToEnd:function(){var t=0,e=d3.select(".vzb-tool");e.classed("vzb-portrait")&&e.classed("vzb-small")?(this.model.state.marker.select.length>0&&(t=this.element.node().scrollWidth),this.element.node().scrollLeft=t):(this.model.state.marker.select.length>0&&(t=this.element.node().scrollHeight),this.element.node().scrollTop=t)},resize:function(){if(!this.element.selectAll)return r.warn("buttonlist resize() aborted because element is not yet defined");"small"===this.getLayoutProfile()&&this.model.ui.presentation&&this.togglePresentationMode(),this._toggleButtons()},setButtonActive:function(t,e){this.element.selectAll(".vzb-buttonlist-btn[data-btn='"+t+"']").classed("vzb-active",e)},toggleSidebarCollapse:function(){this.model.ui.sidebarCollapse=!this.model.ui.sidebarCollapse,this.setSidebarCollapse()},setSidebarCollapse:function(){var t=d3.select(this.root.element);t.classed("vzb-dialog-expand-true")==this.model.ui.sidebarCollapse&&(t.classed("vzb-dialog-expand-true",!this.model.ui.sidebarCollapse),this.root.trigger("resize"))},toggleBubbleTrails:function(){this.model.ui.chart.trails=!this.model.ui.chart.trails,this.setBubbleTrails()},setBubbleTrails:function(){var t=(this.model.ui.chart||{}).trails;if(t||!1===t){var e=this.element.selectAll(".vzb-buttonlist-btn[data-btn='trails']");if(!e.node())return r.warn("setBubbleTrails: no button 'trails' found in DOM. doing nothing");e.classed("vzb-active-locked",t),e.classed("vzb-hidden",0==this.model.state.marker.select.length)}},toggleTimeForecast:function(){this.model.state.time.showForecast=!this.model.state.time.showForecast,this.setTimeForecast()},setTimeForecast:function(){var t=(this.model.state.time||{}).showForecast;if(t||!1===t){var e="forecast",n=this.element.selectAll(".vzb-buttonlist-btn[data-btn='"+e+"']");if(!n.node())return r.warn("setBubbleTrails: no button '"+e+"' found in DOM. doing nothing");n.classed("vzb-active-locked",t),n.classed("vzb-hidden",!this.model.state.time.endBeforeForecast)}},toggleBubbleLock:function(t){var e=(this.model.ui.chart||{}).lockActive;if(0!=this.model.state.marker.select.length||e){var n=this.model.ui.chart.lockNonSelected,i=this.model.state.time;n=n?0:i.formatDate(i.value),this.model.ui.chart.lockNonSelected=n,this.setBubbleLock()}},setBubbleLock:function(){var t=(this.model.ui.chart||{}).lockNonSelected,e=(this.model.ui.chart||{}).lockActive,n=(this.model.ui.chart||{}).lockUnavailable||!1;if(t||0===t){0===t||0!==this.model.state.marker.select.length||e||(t=this.model.ui.chart.lockNonSelected=0);var i=this.element.selectAll(".vzb-buttonlist-btn[data-btn='lock']");if(!i.node())return r.warn("setBubbleLock: no button 'lock' found in DOM. doing nothing");var a=this.model.locale.getTFunction();i.classed("vzb-unavailable",n),void 0===e?i.classed("vzb-hidden",0==this.model.state.marker.select.length):i.classed("vzb-hidden",!e),i.classed("vzb-active-locked",t),i.select(".vzb-buttonlist-btn-icon").html(o[t?"lock":"unlock"]),i.select(".vzb-buttonlist-btn-title>span").text(t||a("buttons/lock")).attr("data-vzb-translate",t?null:"buttons/lock")}},toggleInpercent:function(){this.model.ui.chart.inpercent=!this.model.ui.chart.inpercent,this.setInpercent()},setInpercent:function(){if(void 0!==(this.model.ui.chart||{}).inpercent){this.model.locale.getTFunction();this.element.selectAll(".vzb-buttonlist-btn[data-btn='inpercent']").classed("vzb-active-locked",this.model.ui.chart.inpercent)}},togglePresentationMode:function(){this.model.ui.presentation=!this.model.ui.presentation,this.setPresentationMode()},setPresentationMode:function(){this.model.locale.getTFunction();this.element.selectAll(".vzb-buttonlist-btn[data-btn='presentation']").classed("vzb-active-locked",this.model.ui.presentation)},toggleFullScreen:function(t,e){if(window){for(var n,i=this,a=i.placeholder,s=this.element.selectAll(".vzb-buttonlist-btn[data-btn='"+t+"']"),l=!this.model.ui.fullscreen,c=l?"hidden":this._prev_body_overflow;!r.hasClass(a,"vzb-placeholder");)a=(i=i.parent).placeholder;l?(this.resizeInExitHandler=!1,(n=a).requestFullscreen?n.requestFullscreen():n.msRequestFullscreen?n.msRequestFullscreen():n.mozRequestFullScreen?n.mozRequestFullScreen():n.webkitRequestFullscreen&&h()&&n.webkitRequestFullscreen(),function(t){if(!window)return;var e=window.document;this.exitFullscreenHandler=function(t){window&&(void 0!==window.document.webkitIsFullScreen?window.document.webkitIsFullScreen:void 0!==window.document.mozFullScreen?window.document.mozFullScreen:void 0!==window.document.msFullscreenElement&&window.document.msFullscreenElement)||(u.call(this),this.resizeInExitHandler?this.root.ui.resizeHandler():t())}.bind(this,t),e.addEventListener("webkitfullscreenchange",this.exitFullscreenHandler,!1),e.addEventListener("mozfullscreenchange",this.exitFullscreenHandler,!1),e.addEventListener("fullscreenchange",this.exitFullscreenHandler,!1),e.addEventListener("MSFullscreenChange",this.exitFullscreenHandler,!1)}.call(this,this.toggleFullScreen.bind(this,t,!0))):(this.resizeInExitHandler=!e,function(){document.exitFullscreen?document.exitFullscreen():document.msExitFullscreen?document.msExitFullscreen():document.mozCancelFullScreen?document.mozCancelFullScreen():document.webkitExitFullscreen&&h()?document.webkitExitFullscreen():(u.call(this),this.resizeInExitHandler=!1)}.call(this)),r.classed(a,"vzb-force-fullscreen",l),"undefined"!=typeof container&&r.classed(container,"vzb-container-fullscreen",l),this.model.ui.fullscreen=l;var d=this.model.locale.getTFunction();s.classed("vzb-active-locked",l),s.select(".vzb-buttonlist-btn-icon").html(o[l?"unexpand":"expand"]),s.select(".vzb-buttonlist-btn-title>span").text(d("buttons/"+(l?"unexpand":"expand"))).attr("data-vzb-translate","buttons/"+(l?"unexpand":"expand")),document.body.style.overflow=c,this.resizeInExitHandler||this.root.ui.resizeHandler()}}});function u(){var t=window.document;t.removeEventListener("webkitfullscreenchange",this.exitFullscreenHandler),t.removeEventListener("mozfullscreenchange",this.exitFullscreenHandler),t.removeEventListener("fullscreenchange",this.exitFullscreenHandler),t.removeEventListener("MSFullscreenChange",this.exitFullscreenHandler)}function h(){return!(navigator.vendor&&navigator.vendor.indexOf("Apple")>-1&&navigator.userAgent&&!navigator.userAgent.match("CriOS"))}e.default=c},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});s(n(1));var i,r=n(166),a=(i=r)&&i.__esModule?i:{default:i};s(n(21));function s(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n]);return e.default=t,e}var o=a.default.extend({init:function(t,e){this.name="gapminder-optionsbuttonlist",this._super(t,e)},readyOnce:function(){var t=this;Object.keys(this._available_buttons).forEach(function(e){var n=t._available_buttons[e];n.required=!n.required}),this.buttonListComp=this.root.findChildByName("gapminder-buttonlist"),this.buttonListComp.on("click",function(e,n){t.element.selectAll(".vzb-buttonlist-btn[data-btn='"+n.id+"']").classed("vzb-active",n.active)}),this.buttonListComp.on("toggle",function(e,n){t.element.selectAll(".vzb-buttonlist-btn").each(function(t){var e=d3.select(this),i=-1==n.hiddenButtons.indexOf(t.id);e.style("display",i?"none":""),i||0})}),this._super()},proceedClick:function(t){var e=this;this.buttonListComp.proceedClick(t),this.element.selectAll(".vzb-buttonlist-btn[data-btn='"+t+"']").datum().func&&setTimeout(function(){e.root.findChildByName("gapminder-dialogs").closeAllDialogs()},200)},_toggleButtons:function(){}});e.default=o},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i=function(){return function(t,e){if(Array.isArray(t))return t;if(Symbol.iterator in Object(t))return function(t,e){var n=[],i=!0,r=!1,a=void 0;try{for(var s,o=t[Symbol.iterator]();!(i=(s=o.next()).done)&&(n.push(s.value),!e||n.length!==e);i=!0);}catch(t){r=!0,a=t}finally{try{!i&&o.return&&o.return()}finally{if(r)throw a}}return n}(t,e);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}(),r=function(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n]);return e.default=t,e}(n(1)),a=c(n(5)),s=c(n(169)),o=c(n(114)),l=n(21);function c(t){return t&&t.__esModule?t:{default:t}}function u(t){if(Array.isArray(t)){for(var e=0,n=Array(t.length);e<t.length;e++)n[e]=t[e];return n}return Array.from(t)}var h=a.default.extend({init:function(t,e){var n=this;this.template='<div class="vzb-cl-outer"></div>',this.name="colorlegend",this.model_expects=[{name:"time",type:"time"},{name:"entities",type:"entities"},{name:"marker",type:"marker"},{name:"color",type:"color"},{name:"locale",type:"locale"},{name:"ui",type:"ui"}],this.model_binds={"change:color.scaleType":function(t,e){n._readyOnce&&!n.colorModel.isDiscrete()&&n.updateView()},"change:color.palette":function(t,e){!n._readyOnce||n.colorModel.isDiscrete()&&!n.frame&&"constant"===!n.colorModel.use||n.updateView()},"change:marker.highlight":function(t,e){n.colorModel.isDiscrete()&&n.model.marker.getFrame(n.model.time.value,function(t){if(t){var e=n.model.marker.getHighlighted(n.KEY);n.updateGroupsOpacity(e.map(function(e){return t[n.colorModel._name][e]}))}else n.updateGroupsOpacity()})},"change:time.start":function(t,e){n._readyOnce&&!n.model.time.splash&&n.colorModel.which==n.model.time.dim&&n.ready()},"change:time.end":function(t,e){n._readyOnce&&!n.model.time.splash&&n.colorModel.which==n.model.time.dim&&n.ready()},"translate:locale":function(){n._translateSelectDialog(n.translator),n.colorPicker.translate(n.translator),"constant"===n.colorModel.use&&n._translateListLegend()}},this._super(t,e)},readyOnce:function(){this.translator=this.model.locale.getTFunction(),d3.select(this.placeholder.parentNode).classed("vzb-dialog-scrollable",!0),this.colorModel=this.model.color,this.colorlegendMarker=this.colorModel.getClosestModel("marker_colorlegend"),this.colorlegendMarker&&this.colorlegendMarker.on("ready",this.ready.bind(this)),this._initDOMElements(),this.colorPicker=new s.default(r.isArray(this.root.element)?this.root.element:d3.select(this.root.element)),this.colorPicker.translate(this.translator),this._initSelectDialog()},_initDOMElements:function(){this.element=d3.select(this.element),this.wrapperEl=this.element.append("div").attr("class","vzb-cl-holder"),this.listColorsEl=this.wrapperEl.append("div").attr("class","vzb-cl-colorlist"),this.rainbowEl=this.wrapperEl.append("div").attr("class","vzb-cl-rainbow"),this.rainbowCanvasEl=this.rainbowEl.append("canvas"),this.minimapEl=this.wrapperEl.append("div").attr("class","vzb-cl-minimap"),this.rainbowLegendEl=this.wrapperEl.append("div").attr("class","vzb-cl-rainbow-legend"),this.rainbowLegendSVG=this.rainbowLegendEl.append("svg"),this.rainbowLegendG=this.rainbowLegendSVG.append("g"),this.rainbowLegendG.append("rect"),this.rainbowLegend=null,this.labelScaleEl=this.wrapperEl.append("div").attr("class","vzb-cl-labelscale"),this.labelScaleSVG=this.labelScaleEl.append("svg"),this.labelScaleG=this.labelScaleSVG.append("g"),this.subtitleDiv=this.wrapperEl.append("div").attr("class","vzb-cl-subtitle"),this.subtitleText=this.subtitleDiv.append("span").attr("class","vzb-cl-subtitle-text"),this.minimapSVG=this.minimapEl.append("svg"),this.minimapG=this.minimapSVG.append("g")},_initSelectDialog:function(){this.moreOptionsHint=this.wrapperEl.append("span").classed("vzb-cl-more-hint vzb-hidden",!0),this.selectDialog=this.wrapperEl.append("div").classed("vzb-cl-select-dialog vzb-hidden",!0),this._initSelectDialogItems(),this._translateSelectDialog(this.translator)},_initSelectDialogItems:function(){var t=this;this.selectDialogTitle=this.selectDialog.append("div").classed("vzb-cl-select-dialog-title",!0),this.selectDialog.append("div").classed("vzb-cl-select-dialog-close",!0).html(l.close).on("click",function(){return t._closeSelectDialog()}),this.selectAllButton=this.selectDialog.append("div").classed("vzb-cl-select-dialog-item",!0),this.removeElseButton=this.selectDialog.append("div").classed("vzb-cl-select-dialog-item",!0),this.editColorButton=this.selectDialog.append("div").classed("vzb-cl-select-dialog-item vzb-cl-select-dialog-item-moreoptions",!0),this.editColorButtonTooltip=this.editColorButton.append("div").classed("vzb-cl-select-dialog-item-tooltip",!0)},_translateSelectDialog:function(t){this.moreOptionsHint.text(t("hints/color/more")),this.selectAllButton.text("✅ "+t("dialogs/color/select-all")),this.removeElseButton.text("🗑️ "+t("dialogs/color/remove-else")),this.editColorButton.text("🎨 "+t("dialogs/color/edit-color")),this.editColorButtonTooltip.text(t("dialogs/color/edit-color-blocked-hint"))},_closeSelectDialog:function(){this.selectDialog.classed("vzb-hidden",!0)},_bindSelectDialogItems:function(){for(var t=this,e=arguments.length,n=Array(e),r=0;r<e;r++)n[r]=arguments[r];var a=i(n,3),s=a[1],o=a[2];this.selectDialogTitle.text(o[s].textContent),this.selectAllButton.on("click",function(){var e;(e=t._interact()).clickToSelect.apply(e,u(n)),t._closeSelectDialog()}),this.removeElseButton.on("click",function(){var e;(e=t._interact()).clickToShow.apply(e,u(n)),t._closeSelectDialog()}),this.editColorButton.on("click",function(){var e;(e=t._interact()).clickToChangeColor.apply(e,u(n)),t._closeSelectDialog()})},ready:function(){var t=this;if(this.KEYS=r.unique(this.model.marker._getAllDimensions({exceptType:"time"})),this.KEY=this.colorModel._getFirstDimension(),this.markerArray=this.model.marker.getKeys(),this.which=this.colorModel.which,this.canShowMap=!1,this.colorlegendMarkerArray=[],this.legendHasOwnModel=["entity_set","entity_domain"].includes(this.colorModel.getConceptprops().concept_type),this.legendHasOwnModel&&this.colorlegendMarker){if(!this.colorlegendMarker._ready)return;this.which=this.colorlegendMarker.getFirstEntityModel().getDimension(),this.colorlegendMarker.getFrame(this.model.time.value,function(e){if(!e)return r.warn("colorlegend received empty frame in ready()");t.frame=e,t.canShowMap=r.keys((t.frame||{}).hook_geoshape||{}).length,t.colorlegendMarkerArray=t.colorlegendMarker.getKeys(t.which),t.colorlegendMarkerArray.forEach(function(e){((t.frame||{}).hook_geoshape||{})[e[t.which]]||(t.canShowMap=!1)}),t.updateView(),t.updateGroupsOpacity()})}else this.updateView(),this.updateGroupsOpacity()},updateView:function(){if(!this.element.selectAll)return r.warn("colorlegend resize() aborted because element is not yet defined");var t=this.colorlegendMarker&&this.which==this.KEY&&r.comparePlainObjects(this.colorlegendMarker.getFirstEntityModel().getFilter(),this.model.entities.getFilter());this.subtitleDiv.classed("vzb-hidden",!0),this._updateRainbowLegend(!this.colorModel.isDiscrete()),this._updateListLegend(this.colorModel.isDiscrete()&&!this.canShowMap&&!t),this._updateMinimapLegend(this.colorModel.isDiscrete()&&this.canShowMap),this._updateSelectDialog()},_updateListLegend:function(t){var e=this;if(this.listColorsEl.classed("vzb-hidden",!t),t){var n=this.KEY,i=this,a=this.colorModel.getScale(),s=[];s=this.colorlegendMarkerArray.length?this.which==n?this.markerArray:this.colorlegendMarkerArray:a.domain().map(function(t){var n={};return n[e.which]=t,n});var o=this.listColorsEl.selectAll(".vzb-cl-option").data(r.unique(s,function(t){return t[e.which]}),function(t){return t[e.which]});o.exit().remove(),(o=o.enter().append("div").attr("class","vzb-cl-option").each(function(){d3.select(this).append("div").attr("class","vzb-cl-color-sample"),d3.select(this).append("div").attr("class","vzb-cl-color-legend")}).on("mouseover",i._interact().mouseover).on("mouseout",i._interact().mouseout).on("click",function(){var t;i.legendHasOwnModel?(e._bindSelectDialogItems.apply(e,arguments),e.selectDialog.classed("vzb-hidden",!1)):(t=e._interact()).clickToChangeColor.apply(t,arguments)}).merge(o)).each(function(t,e){d3.select(this).select(".vzb-cl-color-sample").style("background-color",a(t[i.which])).style("border","1px solid "+a(t[i.which]));var n=i.colorlegendMarker&&i.frame?i.frame.label[t[i.which]]:null;n||0===n||(n=t[i.which]),"constant"===i.colorModel.use&&(n=i.translator("indicator/_default/color")),d3.select(this).select(".vzb-cl-color-legend").text(n)})}},_translateListLegend:function(){this.listColorsEl.select(".vzb-cl-option .vzb-cl-color-legend").text(this.translator("indicator/_default/color"))},_updateMinimapLegend:function(t){var e=this;if(this.minimapEl.classed("vzb-hidden",!t),t){var n=this,i=this.colorModel.getScale(),r=this.minimapEl.append("div").attr("class","vzb-temp");this.minimapSVG.attr("viewBox",null),this.minimapSVG.selectAll("g").remove(),this.minimapG=this.minimapSVG.append("g"),this.minimapG.selectAll("path").data(this.colorlegendMarkerArray,function(t){return t[e.which]}).enter().append("path").on("mouseover",this._interact().mouseover).on("mouseout",this._interact().mouseout).on("click",function(){e._bindSelectDialogItems.apply(e,arguments),e.selectDialog.classed("vzb-hidden",!1)}).each(function(t){var e=n.frame.hook_geoshape[t[n.which]].trim();"<svg"==e.slice(0,4)&&(r.html(e),e=r.select("svg").select("path").attr("d")),d3.select(this).attr("d",e).style("fill",i(t[n.which])).append("title").text(n.frame.label[t[n.which]]),r.html("")});var a=this.minimapG.node().getBBox();this.minimapSVG.attr("viewBox","0 0 "+1.05*a.width+" "+1.05*a.height),r.remove()}},_updateRainbowLegend:function(t){var e=this,n=this;if(this.rainbowEl.classed("vzb-hidden",!t),this.labelScaleEl.classed("vzb-hidden",!t),this.rainbowLegendEl.classed("vzb-hidden",!t),t){var i=this.rainbowEl.node().getBoundingClientRect().width,a=Object.keys(this.colorModel.getPalette()).sort(function(t,e){return t-e}).map(parseFloat),s=this.colorModel.getScale(),l=6,c=void 0,u=void 0,h=this.colorModel.getTickFormatter(),d=null,f=this.colorModel.paletteLabels;if(f){d="optimistic",c=f.map(function(t){return parseFloat(t)});var p=d3.max(c);u=c.map(function(t){return t/p*i})}else{c=s.domain();var v=d3.max(a);u=a.map(function(t){return t/v*i})}d3.min(c)<=0&&d3.max(c)>=0&&"log"===this.colorModel.scaleType||this.colorModel.scaleType;this.labelScale=s.copy().interpolate(d3.interpolate).range(u);var g=parseInt(this.rainbowEl.style("left"),10)||0,m=parseInt(this.rainbowEl.style("right"),10)||g;this.labelScaleSVG.style("width",g+i+m+"px"),this.labelScaleG.attr("transform","translate("+g+",2)"),this.labelsAxis=(0,o.default)("bottom"),this.labelsAxis.scale(this.labelScale).tickSizeOuter(5).tickPadding(8).tickSizeMinor(3,-3).labelerOptions({scaleType:this.colorModel.scaleType,toolMargin:{right:m,left:g},showOuter:!1,formatter:h,bump:g,cssFontSize:"8px",fitIntoScale:d}),this.labelScaleG.call(this.labelsAxis),this.rainbowCanvasEl.attr("width",i).attr("height",1).style("width",i+"px").style("height","100%");for(var b,y=this.rainbowCanvasEl.node().getContext("2d"),_=y.createImageData(i,1),M=0,w=-1;M<i;++M)b=d3.rgb(s(this.labelScale.invert(M))),_.data[++w]=b.r,_.data[++w]=b.g,_.data[++w]=b.b,_.data[++w]=255;y.putImageData(_,0,0);var x=this.colorModel.getConceptprops(),S=r.getSubtitle(x.name,x.name_short);if(this.subtitleDiv.classed("vzb-hidden",""==S),this.subtitleText.text(S),"none"!==this.rainbowLegendEl.style("display")){var z=d3.extent(c);if(this.domainScale=this.labelScale.copy().domain(z).range(z),this.paletteScaleLinear=d3.scaleLinear().domain(z).range([0,100]),this.rainbowLegendSVG.style("width",g+i+m+"px"),this.rainbowLegendG.attr("transform","translate("+g+", 7)"),this.labelScaleEl.selectAll(".vzb-axis-value text").attr("dy","1.5em"),!z.includes(0))this.labelScaleG.selectAll(".tick text").filter(function(){return"0"===d3.select(this).text()}).style("cursor","pointer").on("dblclick",function(){var t=s(0),e=+n.paletteScaleLinear(n.domainScale(0));n.colorModel.setColor(t,""+e,null,!0,!0)});this.rainbowLegendG.select("rect").attr("width",i).attr("height",20).on("mousemove",function(){n.labelScaleG.call(n.labelsAxis.highlightValue(n.labelScale.invert(d3.mouse(this)[0])))}).on("mouseleave",function(){return n.labelScaleG.call(n.labelsAxis.highlightValue("none"))}).on("dblclick",function(){var t=d3.mouse(this)[0];t=t<=2*l?2*l:t>=i-2*l?i-2*l:t;var e=n.labelScale.invert(t),r=s(e),a=n.paletteScaleLinear(n.domainScale(e));n.colorModel.setColor(r,""+a,null,!0,!0)});var O=s.range(),k=d3.min(c)<0&&d3.max(c)>0?this.labelScale(0):null,E=c.map(function(t,n){return{val:t,i:n,value0:k,isEdgePoint:0===n||n===c.length-1,color:O[n],paletteKey:a[n],xMin:n-1<0?1:e.labelScale(c[n-1])+2*l,xMax:n+1>=c.length?i-1:e.labelScale(c[n+1])-2*l}}),T=d3.drag().on("start",function(t,e){for(var a=this.nextSibling;a;)this.parentNode.insertBefore(a,this),a=this.nextSibling;var s=d3.select(this),o=!1,c=null;t.isEdgePoint&&(c=s.clone().lower().classed("ghost",!0).style("opacity",.8)),s.classed("dragging",!0),d3.event.on("drag",function(t){if(d3.event.x<0)return;if(d3.event.x>i)return;if(d3.event.x<t.xMin||d3.event.x>t.xMax)return;o||0===d3.event.dx||(o=!0);t.x=d3.event.x,null!==t.value0&&(t.x=t.x<t.value0-3||t.x>t.value0+3?t.x:t.value0);if(s.attr("cx",t.x),o){var e=n.labelScale.invert(t.x),r=+n.paletteScaleLinear(n.domainScale(e));n.labelScaleG.call(n.labelsAxis.highlightValue(e)),n.colorModel.setColor(t.color,""+r,t.isEdgePoint?"-1":""+t.paletteKey,!1),t.val=e,t.isEdgePoint&&t.paletteKey!==r&&(t.isEdgePoint=!1),t.paletteKey=r}}).on("end",function(t){s.classed("dragging",!1),c&&c.remove();if(o){var e=null;t.x<2*l?e=t.x<l?0:2*l:t.x>i-2*l&&(e=t.x>i-l?i:i-2*l),r.defer(function(){if(null!==e){var i=n.labelScale.invert(e),r=+n.paletteScaleLinear(n.domainScale(i));n.colorModel.setColor(t.color,""+r,""+t.paletteKey,!1,!1),n.colorModel.setColor(t.color,""+r,""+t.paletteKey,!0,!0)}else n.colorModel.setColor(t.color,""+t.paletteKey,null,!0,!0)})}})}),P=!1,A=void 0;this.rainbowLegend=this.rainbowLegendG.selectAll("circle").data(E,function(t){return t.i}),this.rainbowLegend.exit().remove(),this.rainbowLegend=this.rainbowLegend.enter().append("circle").attr("r",l+"px").attr("stroke","#000").on("mouseenter",function(t){n.labelScaleG.call(n.labelsAxis.highlightValue(t.val))}).on("mouseleave",function(){n.labelScaleG.call(n.labelsAxis.highlightValue("none"))}).on("click",function(t,e){var i={pageX:d3.event.pageX,pageY:d3.event.pageY};A=setTimeout(function(){P?(clearTimeout(A),P=!1):n._interact().clickToChangeColor(t,e,i)},500)}).on("dblclick",function(t){P=!0,t.isEdgePoint||r.defer(function(){n.colorModel.setColor(null,null,""+t.paletteKey,!0,!0)})}).call(T).merge(this.rainbowLegend),this.rainbowLegend.each(function(t,e){d3.select(this).attr("fill",t.color),d3.select(this).attr("cx",t.x=n.labelScale(t.val))})}}},_updateSelectDialog:function(){var t=this.colorModel.isUserSelectable();this.editColorButtonTooltip.classed("vzb-hidden",t),this.editColorButton.classed("vzb-cl-select-dialog-item-disabled",!t),this.selectDialog.classed("vzb-hidden",!0)},_highlight:function(t){r.getProp(this,["model","ui","chart","superhighlightOnMinimapHover"])?this.model.marker.setSuperHighlight(t):this.model.marker.setHighlight(t)},_unhighlight:function(){r.getProp(this,["model","ui","chart","superhighlightOnMinimapHover"])?this.model.marker.clearSuperHighlighted():this.model.marker.clearHighlighted()},_interact:function(){var t=this,e=this.KEYS,n=this.KEY,i=this.which;return{mouseover:function(e,a){if(t.moreOptionsHint.classed("vzb-hidden",!1),t.colorModel.isDiscrete()){d3.select(this);var s=e[i];if("indicator"==t.colorModel.use)t.model.marker.getFrame(t.model.time.value,function(e){if(e){var n=Object.keys(e[t.colorModel._name]).filter(function(n){return e[t.colorModel._name][n]==s}).reduce(function(t,e){return t[e]=!0,t},{});t._highlight(t.markerArray.filter(function(e){return n[r.getKey(e,t.colorModel.getDataKeys())]}))}});else if("property"==t.colorModel.use){var o=t.colorModel.getValidItems().filter(function(e){return e[t.colorModel.which]==s}).reduce(function(t,e){return t[e[n]]=!0,t},{});t._highlight(t.markerArray.filter(function(t){return o[t[n]]}))}}},mouseout:function(e,n){t.moreOptionsHint.classed("vzb-hidden",!0),t.colorModel.isDiscrete()&&t._unhighlight()},clickToChangeColor:function(e,n){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:d3.event;if(t.colorModel.isUserSelectable()){var a=t.colorModel.getPalette(),s=t.colorModel.getDefaultPalette(),o=(d3.select(this),t.colorModel.isDiscrete()?e[i]:e.paletteKey);t.colorPicker.colorOld(a[o]).colorDef(s[o]).callback(function(e,n){return t.colorModel.setColor(e,""+o,null,n,n)}).fitToScreen([r.pageX,r.pageY]).show(!0)}},clickToShow:function(e,n){if(t.colorModel.isDiscrete()){d3.select(this),e[i];var a=t.model.entities.show[i]&&t.model.entities.show[i].$in?r.clone(t.model.entities.show[i].$in):[],s=a.indexOf(e[i]);-1!==s?a.splice(s,1):a.push(e[i]);var o={};a.length>0&&(o[i]={$in:a}),t.model.entities.set({show:o})}},clickToSelect:function(a,s){if(t.colorModel.isDiscrete()){d3.select(this);var o=a[i],l=t.colorModel.getValidItems().filter(function(e){return e[t.colorModel.which]==o}).reduce(function(t,e){return t[e[n]]=!0,t},{}),c=t.markerArray.filter(function(t){return l[t[n]]}).map(function(t){return r.clone(t,e)});c.filter(function(e){return t.model.marker.isSelected(e)}).length==c.length?t.model.marker.clearSelected():t.model.marker.setSelect(c)}}}},resize:function(){this.updateView(),this.colorPicker.resize(d3.select(".vzb-colorpicker-svg"))},updateGroupsOpacity:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],e=this,n=this.colorlegendMarker||{},i=n.opacityRegular||.8,r=n.opacityHighlightDim||.5,a=e.canShowMap?".vzb-cl-minimap path":".vzb-cl-colorlist .vzb-cl-option .vzb-cl-color-sample";this.wrapperEl.selectAll(a).style("opacity",function(n){return t.length?t.indexOf(n[e.which])>-1?1:r:i})}});e.default=h},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i=function(){function t(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}return function(e,n,i){return n&&t(e.prototype,n),i&&t(e,i),e}}(),r=n(1);var a={INVISIBLE:"vzb-invisible",COLOR_POINTER:"vzb-colorpicker-pointer",COLOR_BUTTON:"vzb-colorpicker-cell",COLOR_DEFAULT:"vzb-colorpicker-default",COLOR_SAMPLE:"vzb-colorpicker-sample",COLOR_PICKER:"vzb-colorpicker-svg",COLOR_CIRCLE:"vzb-colorpicker-circle",COLOR_CIRCLES:"vzb-colorpicker-circles",COLOR_SEGMENT:"vzb-colorpicker-segment",COLOR_BACKGR:"vzb-colorpicker-background"},s=function(){function t(e){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this._container=e,this._wrapper=this._container.select("."+a.COLOR_PICKER),this._init()}return i(t,[{key:"_init",value:function(){this._initVariables(),this._initCircles(),this._style(),this.resize(this._svg)}},{key:"_initVariables",value:function(){this._maxWidth=280,this._maxHeight=323,this._colorOld="#000",this._colorDef="#000",this._colorWhite="#f8f8f8",this._colorBlack="#444",this._margin={top:.1,bottom:.1,left:.1,right:.1},this._initSvg();var t=getComputedStyle(this._svg.node()),e=t.width,n=t.height;this._width=this.constructor.px2num(e),this._height=this.constructor.px2num(n),this._maxRadius=this._width/2*(1-this._margin.left-this._margin.right),this._nCellsH=30,this._minH=0,this._nCellsL=8,this._minL=.4,this._satConstant=.8,this._outerL=.3,this._firstAngleSat=0,this._minRadius=12,this._arc=d3.arc(),this._pie=d3.pie().sort(null).value(function(t){return 1}),this._colorPointer=null,this._showColorPicker=!1,this._sampleRect=null,this._sampleText=null,this._callback=function(t){return console.info("Color picker callback example. Setting color to "+t)},this._colorData=this._generateColorData()}},{key:"_generateColorData",value:function(){for(var t=this._minL,e=this._minH,n=this._nCellsL,i=this._nCellsH,r=this._firstAngleSat,a=this._satConstant,s=this._outerL,o=this._colorWhite,l=this._colorBlack,c=[],u=0;u<n;u++){var h=t+(1-t)/n*u;c.push([]);for(var d=0;d<=i;d++){var f=360*(e+(1-e)/i*d);c[u].push({fill:d3.hsl(f,0===d?r:a,0===u?s:h).hex(),stroke:0===u?o:l})}}return c}},{key:"_initSvg",value:function(){var t=this;this._wrapper=this._container.append("div").style("position","absolute").style("top","0").style("left","0").style("width","100%").style("max-width",this._maxWidth+"px").style("height","100%").style("max-height",this._maxHeight+"px").style("z-index",9999).attr("class",a.COLOR_PICKER+" vzb-dialog-shadow").classed(a.INVISIBLE,!this._showColorPicker).on("mouseout",function(){return t._cellHover(t._colorOld)}),this._svg=this._wrapper.append("svg").style("width","100%").style("height","100%")}},{key:"_initCircles",value:function(){var t=this,e=this._svg,n=this._maxHeight,i=this._width,r=this._height,s=this._margin,o=this._colorData,l=this._nCellsL,c=this._minRadius,u=this._maxRadius,h=this._colorWhite,d=this._colorBlack;e.append("rect").attr("width",i).attr("height",n).attr("class",a.COLOR_BACKGR).on("mouseover",function(){return t._cellHover(t._colorOld)}).on("click",function(){d3.event.stopPropagation(),t._changeColor(t._colorOld),t.show(!1)});var f=u+i*s.left,p=u+r*s.top,v=e.append("g").attr("class",a.COLOR_CIRCLES).attr("transform","translate("+f+", "+p+")");e.append("rect").attr("class",a.COLOR_SAMPLE).attr("width",i/2).attr("height",r*s.top/2),this._sampleRect=e.append("rect").attr("class",a.COLOR_SAMPLE).attr("width",i/2).attr("x",i/2).attr("height",r*s.top/2),e.append("text").attr("x",i*s.left).attr("y",r*s.top/2).attr("dy","1.3em").attr("class",a.COLOR_SAMPLE).style("text-anchor","start"),this._sampleText=e.append("text").attr("x",i*(1-s.right)).attr("y",r*s.top/2).attr("dy","1.3em").attr("class",a.COLOR_SAMPLE).style("text-anchor","end"),e.append("text").attr("x",.1*i).attr("y",r*(1-s.bottom)).attr("dy","1.2em").attr("class","vzb-default-label").style("text-anchor","start").text("default"),e.append("circle").attr("class",a.COLOR_DEFAULT+" "+a.COLOR_BUTTON).attr("r",i*s.left/2).attr("cx",i*s.left*1.5).attr("cy",r*(1-1.5*s.bottom)).on("mouseover",function(){d3.select(this).style("stroke",d),g._cellHover(g._colorDef)}).on("mouseout",function(){d3.select(this).style("stroke","none")});var g=this;v.selectAll("."+a.COLOR_CIRCLE).data(o).enter().append("g").attr("class",a.COLOR_CIRCLE).each(function(t,e){g._arc.outerRadius(c+(u-c)/l*(l-e)).innerRadius(c+(u-c)/l*(l-e-1)),d3.select(this).selectAll("."+a.COLOR_SEGMENT).data(g._pie(t)).enter().append("g").attr("class",a.COLOR_SEGMENT).append("path").attr("class",a.COLOR_BUTTON).attr("d",g._arc).style("fill",function(t){return t.data.fill}).style("stroke",function(t){return t.data.fill}).on("mouseover",function(t){g._cellHover(t.data.fill,this)}).on("mouseout",function(){return g._cellUnhover()})}),v.append("circle").datum({data:{fill:h,stroke:d}}).attr("r",c).attr("fill",h).attr("class",a.COLOR_BUTTON).on("mouseover",function(){d3.select(this).style("stroke",d),g._cellHover(h)}).on("mouseout",function(){d3.select(this).style("stroke","none")}),this._colorPointer=v.append("path").attr("class",a.COLOR_POINTER+" "+a.INVISIBLE),e.selectAll("."+a.COLOR_BUTTON).on("click",function(e){d3.event.stopPropagation(),t._changeColor(e?e.data.fill:t._colorDef,!0),t.show(!1)})}},{key:"_style",value:function(){var t=this._svg,e=this._colorWhite;t.select("."+a.COLOR_BACKGR).style("fill","white"),t.select("."+a.COLOR_POINTER).style("stroke-width",2).style("stroke",e).style("pointer-events","none").style("fill","none"),t.selectAll("."+a.COLOR_BUTTON).style("cursor","pointer"),t.selectAll("text").style("pointer-events","none").style("fill","#D9D9D9").style("font-size","0.7em").style("text-transform","uppercase"),t.selectAll("circle."+a.COLOR_BUTTON).style("stroke-width",2),t.selectAll("rect."+a.COLOR_SAMPLE).style("pointer-events","none")}},{key:"_cellHover",value:function(t,e){null!=e&&this._colorPointer.classed(a.INVISIBLE,!1).attr("d",d3.select(e).attr("d")).style("stroke",d3.select(e).datum().data.stroke||_colorWhite),this._sampleRect.style("fill",t),this._sampleText.text(t);var n=(0,r.isTouchDevice)();this._changeColor(t,n),n&&this.show(!1)}},{key:"_changeColor",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]&&arguments[1];this._callback(t,e)}},{key:"_cellUnhover",value:function(){this._colorPointer.classed(a.INVISIBLE,!0)}},{key:"resize",value:function(t){if(arguments.length){if(void 0!==t){var e=this._margin,n=t,i=getComputedStyle(n.node()),r=i.width,s=i.height,o=this.constructor.px2num(r),l=this.constructor.px2num(s),c=o/2*(1-e.left-e.right),u=n.select("."+a.COLOR_DEFAULT),h=n.select(".vzb-default-label"),d=n.select("."+a.COLOR_CIRCLES),f=c+l*e.top,p=(1+.5*e.top)*l*.5,v=c+o*e.left,g=f>p?p:f;d.attr("transform","translate("+v+", "+g+")"),u.attr("cx",o*e.left*1.5).attr("cy",l*(1-1.5*e.bottom)),h.attr("x",.1*o).attr("y",l*(1-e.bottom))}return this.fitToScreen()}}},{key:"fitToScreen",value:function(t){var e=this._container.node().getBoundingClientRect(),n=void 0,i=void 0,r=getComputedStyle(this._wrapper.node()),a=r.width,s=r.height,o=r.right,l=r.top,c=this.constructor.px2num(a),u=this.constructor.px2num(s);t?(n=t[0]-e.left,i=t[1]-e.top):(n=e.width-this.constructor.px2num(o)-c,i=this.constructor.px2num(l));var h={left:""};return.8*e.width<=c?h.right=.5*(e.width-c)+"px":n+c>e.width?h.right=Math.min(.1*e.width,20)+"px":h.right=e.width-n-c+"px",h.right&&this._wrapper.style("right",h.right),.8*e.height<=u?h.top=.5*(e.height-u)+"px":i+1.2*u>e.height?h.top=.9*e.height-u+"px":h.top=i+"px",h.top&&this._wrapper.style("top",h.top),this._wrapper.style("left",h.left),this}},{key:"show",value:function(t){if(!arguments.length)return this._showColorPicker;null==this._svg&&console.warn("Color picker is missing SVG element. Was init sequence performed?"),this._showColorPicker="toggle"==t?!this._showColorPicker:t,this._showColorPicker||(this._callback=function(){}),this._wrapper.classed(a.INVISIBLE,!this._showColorPicker)}},{key:"_getOrSet",value:function(t,e){return t="_"+t,arguments.length>1?(this[t]=e,this):this[t]}},{key:"nCellsH",value:function(){return this._getOrSet.apply(this,["nCellsH"].concat(Array.prototype.slice.call(arguments)))}},{key:"minH",value:function(){return this._getOrSet.apply(this,["minH"].concat(Array.prototype.slice.call(arguments)))}},{key:"nCellsL",value:function(){return this._getOrSet.apply(this,["nCellsL"].concat(Array.prototype.slice.call(arguments)))}},{key:"minL",value:function(){return this._getOrSet.apply(this,["minL"].concat(Array.prototype.slice.call(arguments)))}},{key:"outerL",value:function(){return this._getOrSet.apply(this,["outerL"].concat(Array.prototype.slice.call(arguments)))}},{key:"satConstant",value:function(){return this._getOrSet.apply(this,["satConstant"].concat(Array.prototype.slice.call(arguments)))}},{key:"firstAngleSat",value:function(){return this._getOrSet.apply(this,["firstAngleSat"].concat(Array.prototype.slice.call(arguments)))}},{key:"minRadius",value:function(){return this._getOrSet.apply(this,["minRadius"].concat(Array.prototype.slice.call(arguments)))}},{key:"margin",value:function(){return this._getOrSet.apply(this,["margin"].concat(Array.prototype.slice.call(arguments)))}},{key:"callback",value:function(){return this._getOrSet.apply(this,["callback"].concat(Array.prototype.slice.call(arguments)))}},{key:"colorDef",value:function(t){return arguments.length?(void 0!==t&&(this._colorDef=t),null==this._svg&&console.warn("Color picker is missing SVG element. Was init sequence performed?"),this._svg.select("."+a.COLOR_DEFAULT).style("fill",this._colorDef),this):this._colorDef}},{key:"translate",value:function(t){return"function"==typeof t&&this._svg.select(".vzb-default-label").text(t("colorpicker/default")),this}},{key:"colorOld",value:function(t){return arguments.length?(this._colorOld=t,null==this._svg&&console.warn("Color picker is missing SVG element. Was init sequence performed?"),this._svg.select("rect."+a.COLOR_SAMPLE).style("fill",this._colorOld),this._svg.select("text."+a.COLOR_SAMPLE).text(this._colorOld),this):this._colorOld}}],[{key:"px2num",value:function(t){return parseFloat(t)||0}}]),t}();e.default=s},function(t,e){t.exports='<div class="vzb-show-list vzb-accordion">\n  \x3c!-- list will be placed here --\x3e\n</div>\n'},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});!function(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n]);e.default=t}(n(1));var i=s(n(12)),r=s(n(113)),a=(s(n(152)),s(n(110)));function s(t){return t&&t.__esModule?t:{default:t}}var o=i.default.extend("about",{init:function(t,e){this.name="about",this._super(t,e)},readyOnce:function(){var t=r.default.version,e=new Date(parseInt(r.default.build));this.element=d3.select(this.element),this.element.select(".vzb-about-text0").html("This chart is made with Vizabi,"),this.element.select(".vzb-about-text1").html("a project by <a href='http://gapminder.org' target='_blank'>Gapminder Foundation</a>"),this.element.select(".vzb-about-version").html("<a href='https://github.com/Gapminder/vizabi/releases/tag/v"+t+"' target='_blank'>Version: "+t+"</a>"),this.element.select(".vzb-about-updated").html("Build: "+d3.time.format("%Y-%m-%d at %H:%M")(e)),this.element.select(".vzb-about-report").html("<a href='https://getsatisfaction.com/gapminder/' target='_blank'>Report a problem</a>"),this.element.select(".vzb-about-credits").html("<a href='https://github.com/Gapminder/vizabi/graphs/contributors' target='_blank'>Contributors</a>");var n=a.default,i={},s=this.root.versionInfo;i.version=s?s.version:"N/A",i.build=s?d3.time.format("%Y-%m-%d at %H:%M")(new Date(parseInt(s.build))):"N/A",i.name=this.root.name;var o=this.element.select(".vzb-about-tool");o.html(""),o.append("p").text("Tool: "+i.name),o.append("p").text("-version: "+i.version),o.append("p").text("-build: "+i.build);var l=n.instances.map(function(t){var e={},n=t.readerObject.versionInfo;return e.version=n?n.version:"N/A",e.build=n?d3.time.format("%Y-%m-%d at %H:%M")(new Date(parseInt(n.build))):"N/A",e.name=t.readerObject._name,e}),c=this.element.select(".vzb-about-readers").selectAll(".vzb-about-reader").data(l);c.exit().remove(),(c=c.enter().append("p").attr("class","vzb-about-reader")).append("p").text(function(t){return t.name}),c.append("p").text(function(t){return"-version: "+t.version}),c.append("p").text(function(t){return"-build: "+t.build});var u=n.instances.map(function(t){return t.getDatasetName()}),h=this.element.select(".vzb-about-datasets").selectAll(".vzb-about-dataset").data(u);h.exit().remove(),(h=h.enter().append("p").attr("class","vzb-about-dataset")).append("p").text(function(t){return t})}});e.default=o},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});(function(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n]);e.default=t})(n(1)),s(n(5));var i=s(n(12)),r=s(n(51)),a=s(n(173));function s(t){return t&&t.__esModule?t:{default:t}}var o=i.default.extend("axes",{init:function(t,e){this.name="axes";this.components=[{component:r.default,placeholder:".vzb-xaxis-selector",model:["state.time","state.marker.axis_x","locale"]},{component:a.default,placeholder:".vzb-xaxis-minmax",model:["state.marker","state.time","locale"],markerID:"axis_x",ui:{selectDomainMinMax:!1,selectZoomedMinMax:!0}},{component:r.default,placeholder:".vzb-yaxis-selector",model:["state.time","state.marker.axis_y","locale"]},{component:a.default,placeholder:".vzb-yaxis-minmax",model:["state.marker","state.time","locale"],markerID:"axis_y",ui:{selectDomainMinMax:!1,selectZoomedMinMax:!0}}],this._super(t,e)}});e.default=o},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i,r=function(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n]);return e.default=t,e}(n(1)),a=n(5);function s(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}var o=((i=a)&&i.__esModule?i:{default:i}).default.extend({init:function(t,e){var i,a=this;this.name="gapminder-minmaxinputs",this.template=n(426),this.model_expects=[{name:"marker",type:"marker"},{name:"time",type:"time"},{name:"locale",type:"locale"}],this.markerID=t.markerID,t.markerID||r.warn("minmaxinputs.js complains on 'markerID' property: "+t.markerID),this.model_binds=(s(i={"translate:locale":function(){a.updateView()}},"change:marker."+this.markerID,function(){a.updateView()}),s(i,"ready",function(){a.updateView()}),i),this._super(t,e),this.ui=r.extend({selectDomainMinMax:!1,selectZoomedMinMax:!1},this.ui.getPlainObject())},ready:function(){this.updateView()},readyOnce:function(){var t=this;this.element=d3.select(this.element),this.el_domain_labelMin=this.element.select(".vzb-mmi-domainmin-label"),this.el_domain_labelMax=this.element.select(".vzb-mmi-domainmax-label"),this.el_domain_fieldMin=this.element.select(".vzb-mmi-domainmin"),this.el_domain_fieldMax=this.element.select(".vzb-mmi-domainmax"),this.el_break=this.element.select(".vzb-mmi-break"),this.el_zoomed_labelMin=this.element.select(".vzb-mmi-zoomedmin-label"),this.el_zoomed_labelMax=this.element.select(".vzb-mmi-zoomedmax-label"),this.el_zoomed_fieldMin=this.element.select(".vzb-mmi-zoomedmin"),this.el_zoomed_fieldMax=this.element.select(".vzb-mmi-zoomedmax"),t.el_domain_fieldMin.on("change",function(){t._setModel("domainMin",this.value)}),t.el_domain_fieldMax.on("change",function(){t._setModel("domainMax",this.value)}),t.el_zoomed_fieldMin.on("change",function(){t._setModel("zoomedMin",this.value)}),t.el_zoomed_fieldMax.on("change",function(){t._setModel("zoomedMax",this.value)}),this.element.selectAll("input").on("keypress",function(){13==d3.event.which&&document.activeElement.blur()})},updateView:function(){var t=this;this.translator=this.model.locale.getTFunction(),this.el_domain_labelMin.text(this.translator("hints/min")+":"),this.el_domain_labelMax.text(this.translator("hints/max")+":"),this.el_zoomed_labelMin.text(this.translator("hints/min")+":"),this.el_zoomed_labelMax.text(this.translator("hints/max")+":"),this.el_domain_labelMin.classed("vzb-hidden",!this.ui.selectDomainMinMax),this.el_domain_labelMax.classed("vzb-hidden",!this.ui.selectDomainMinMax),this.el_domain_fieldMin.classed("vzb-hidden",!this.ui.selectDomainMinMax),this.el_domain_fieldMax.classed("vzb-hidden",!this.ui.selectDomainMinMax),this.el_break.classed("vzb-hidden",!(this.ui.selectDomainMinMax&&this.ui.selectZoomedMinMax)),this.el_zoomed_labelMin.classed("vzb-hidden",!this.ui.selectZoomedMinMax),this.el_zoomed_labelMax.classed("vzb-hidden",!this.ui.selectZoomedMinMax),this.el_zoomed_fieldMin.classed("vzb-hidden",!this.ui.selectZoomedMinMax),this.el_zoomed_fieldMax.classed("vzb-hidden",!this.ui.selectZoomedMinMax);var e=function(e){return e||0===e?r.isDate(e)?t.model.time.formatDate(e):d3.format(".2r")(e):e},n=this.model.marker[this.markerID],i=n.getScale().domain();this.el_domain_fieldMin.property("value",e(d3.min(i))),this.el_domain_fieldMax.property("value",e(d3.max(i))),this.el_zoomed_fieldMin.property("value",e(n.getZoomedMin())),this.el_zoomed_fieldMax.property("value",e(n.getZoomedMax()))},_setModel:function(t,e){this.model.marker[this.markerID][t]=r.strToFloat(e)}});e.default=o},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});(function(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n]);e.default=t})(n(1)),s(n(5));var i=s(n(12)),r=s(n(168)),a=s(n(51));function s(t){return t&&t.__esModule?t:{default:t}}var o=i.default.extend("colors",{init:function(t,e){this.name="colors",this.components=[{component:a.default,placeholder:".vzb-caxis-selector",model:["state.time","state.marker.color","locale"],showHoverValues:!0},{component:r.default,placeholder:".vzb-clegend-container",model:["state.time","state.entities","state.marker","state.marker.color","locale","ui"]}],this._super(t,e)}});e.default=o},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i=a(n(12)),r=function(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n]);return e.default=t,e}(n(1));function a(t){return t&&t.__esModule?t:{default:t}}var s=a(n(5)).default.extend({init:function(t,e){this.name="gapminder-dialogs",this._curr_dialog_index=20,this.model_expects=[{name:"state",type:"model"},{name:"ui",type:"ui"},{name:"locale",type:"locale"}];var n=i.default.getCollection();this._available_dialogs=Object.keys(n).reduce(function(t,e){var i=n[e];return i.prototype.isDialog&&!e.startsWith("_")&&(t[e]={dialog:i}),t},{}),this._super(t,e)},domReady:function(){var t=(this.model.ui.dialogs||{}).popup||[],e=(this.model.ui.dialogs||{}).sidebar||[];this.rootEl=this.root.element instanceof Array?this.root.element:d3.select(this.root.element),!0===e&&(e=t,(this.model.ui.dialogs||{}).sidebar=e),0===e.length||this.model.ui.sidebarCollapse||this.rootEl.classed("vzb-dialog-expand-true",!0),this.dialog_popup=t,this.dialog_sidebar=e},readyOnce:function(){var t=this;if(this.element=d3.select(this.placeholder),this.element.selectAll("div").remove(),r.isTouchDevice()&&this.element.classed("vzb-no-hover",!0),this._addDialogs(this.dialog_popup,this.dialog_sidebar),r.defer(function(){t.trigger("resize")}),0!==this.dialog_popup.length){this.root.findChildByName("gapminder-buttonlist").on("click",function(e,n){t._available_dialogs[n.id]&&(n.active?t.openDialog(n.id):t.closeDialog(n.id))});var e=this.element.selectAll(".vzb-top-dialog").filter(function(e){return t.dialog_popup.indexOf(e.id)>-1});e.select(".vzb-top-dialog>.vzb-dialog-modal>.vzb-dialog-buttons>[data-click='closeDialog']").on("click",function(e,n){t.closeDialog(e.id)}),e.select(".vzb-top-dialog>.vzb-dialog-modal>[data-click='pinDialog']").on("click",function(e,n){t.pinDialog(e.id)}),this.rootEl.node().addEventListener("click",function(){t.closeAllDialogs()}),this.rootEl.on("mousedown",function(e){if(this._active_comp){for(var n=d3.event.target,i=!0;n;){if(n.classList.contains("vzb-dialog-modal")){i=!1;break}n=n.parentElement}i&&t.closeAllDialogs()}})}this.element.on("click",function(){d3.event.stopPropagation()})},resize:function(){if(!this.element.selectAll)return r.warn("dialogs resize() aborted because element is not yet defined");var t=this,e=this.getLayoutProfile();this.element.selectAll(".vzb-top-dialog").each(function(n){var i=d3.select(this),r=i.attr("class").replace(" vzb-popup","").replace(" vzb-sidebar","");"large"===e&&t.dialog_sidebar.indexOf(n.id)>-1?(r+=t.model.ui.sidebarCollapse?" vzb-popup":" vzb-sidebar",t.model.ui.sidebarCollapse||i.style("z-index",null)):t.dialog_popup.indexOf(n.id)>-1&&(r+=" vzb-popup"),i.attr("class",r)})},_addDialogs:function(t,e){this.getLayoutProfile();var n=[];n=t?n.concat(t):n,n=e?n.concat(e):n,n=r.unique(n),this._components_config=[];var i=[];if(n.length){for(var a=0;a<n.length;a++){var s=n[a],o=this._available_dialogs[s];if(o&&o.dialog){var l=this._components_config;l.push({component:o.dialog,placeholder:'.vzb-dialogs-dialog[data-dlg="'+s+'"]',model:["state","ui","locale"]}),o.component=l.length-1}o.id=s,i.push(o)}this.element.selectAll("div").data(i).enter().append("div").attr("data-dlg",function(t){return t.id}).attr("class","vzb-top-dialog vzb-dialogs-dialog vzb-dialog-shadow"),this.loadSubComponents();var c=this;r.forEach(this.components,function(t){t.render(),c.on("resize",function(){t.trigger("resize")}),t.on("dragstart",function(){c.bringForward(t.name)}),t.on("close",function(){this.placeholderEl.each(function(t){var e={};e.id=t.id,c.trigger("close",e)})})})}},bringForward:function(t){this.element.select(".vzb-popup.vzb-dialogs-dialog[data-dlg='"+t+"']").style("z-index",this._curr_dialog_index),this._curr_dialog_index+=10},openDialog:function(t){var e="small"===this.getLayoutProfile();this.closeAllDialogs(e);var n=this.element.selectAll(".vzb-popup.vzb-dialogs-dialog[data-dlg='"+t+"']");this._active_comp=this.components[this._available_dialogs[t].component],this._active_comp.beforeOpen(),n.classed("vzb-active",!0),this.bringForward(t),this._active_comp.open()},pinDialog:function(t){var e=this.element.select(".vzb-popup.vzb-dialogs-dialog[data-dlg='"+t+"']");this._available_dialogs[t].ispin?(e.classed("pinned",!1),this._available_dialogs[t].ispin=!1):(e.classed("pinned",!0),this._available_dialogs[t].ispin=!0)},closeDialog:function(t){var e=this.element.selectAll(".vzb-popup.vzb-dialogs-dialog[data-dlg='"+t+"']");this._active_comp=this.components[this._available_dialogs[t].component],this._active_comp&&!this._active_comp.isOpen||(this._available_dialogs[t].ispin&&this.pinDialog(t),this._active_comp&&this._active_comp.beforeClose(),e.classed("vzb-active",!1),this._active_comp&&this._active_comp.close(),this._active_comp=!1)},closeAllDialogs:function(t){var e=this,n=t?".vzb-popup.vzb-dialogs-dialog.vzb-active":".vzb-popup.vzb-dialogs-dialog.vzb-active:not(.pinned)";this.element.selectAll(n).each(function(t){e.closeDialog(t.id)})}});e.default=s},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i=function(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n]);return e.default=t,e}(n(1)),r=l(n(12)),a=l(n(115)),s=l(n(63)),o=l(n(51));function l(t){return t&&t.__esModule?t:{default:t}}var c=r.default.extend("find",{init:function(t,e){this.name="find";var n=this;this.components=[{component:a.default,placeholder:".vzb-dialog-panel-show",model:["state","locale"]},{component:s.default,placeholder:".vzb-dialog-bubbleopacity",model:["state.marker","locale"],arg:"opacitySelectDim"}],this.enableSelectShowSwitch=((t.ui.dialogs.dialog||{}).find||{}).enableSelectShowSwitch||!1,this.panelMode=((t.ui.dialogs.dialog||{}).find||{}).panelMode||"find",this.enablePicker=((t.ui.dialogs.dialog||{}).find||{}).enablePicker,this.enablePicker&&this.components.push({component:o.default,placeholder:".vzb-find-filter-selector",model:["state.time","state.marker","locale"]}),this.model_binds={"change:state.marker.select":function(t){n.items.order(),n.selectDataPoints(),n.showHideButtons()},"change:state.time.playing":function(t){n.model.state.time.playing||(n.time=n.model.state.time.value,n.model.state.marker.getFrame(n.time,function(t,e){!t||n.time-e||n.redrawDataPoints(t)}))},"change:state.time.value":function(t){(n.placeholderEl.classed("vzb-active")||n.placeholderEl.classed("vzb-sidebar"))&&(n.time=n.model.state.time.value,n.model.state.marker.getFrame(n.time,function(t){t&&n.redrawDataPoints(t)}))},"change:ui.dialogs.dialog.find.enableSelectShowSwitch":function(e){n._readyOnce&&(n.enableSelectShowSwitch=((t.ui.dialogs.dialog||{}).find||{}).enableSelectShowSwitch||!1,n.element.select(".vzb-dialog-title-switch .vzb-switch-slider").classed("vzb-hidden",!n.enableSelectShowSwitch),n.element.select(".vzb-dialog-title-switch").style("pointer-events",n.enableSelectShowSwitch?"auto":"none"))},"translate:locale":function(){n._readyOnce&&n.input_search.attr("placeholder",n.translator("placeholder/search")+"...")}},this._super(t,e)},readyOnce:function(){this._super(),this.panelComps={find:this,show:this.findChildByName("show")},this.titleSwitch=this.element.select(".vzb-dialog-title-switch input"),this.panelsEl=this.contentEl.selectAll(".vzb-dialog-content"),this.list=this.element.select(".vzb-find-list"),this.input_search=this.element.select(".vzb-find-search"),this.deselect_all=this.element.select(".vzb-find-deselect"),this.opacity_nonselected=this.element.select(".vzb-dialog-bubbleopacity"),this.element.select(".vzb-dialog-title-switch .vzb-switch-slider").classed("vzb-hidden",!this.enableSelectShowSwitch),this.element.select(".vzb-dialog-title-switch").style("pointer-events",this.enableSelectShowSwitch?"auto":"none"),this.element.select(".vzb-find-filter-selector").classed("vzb-hidden",!this.enablePicker),this.element.select(".vzb-dialog-title").classed("vzb-title-two-rows",this.enablePicker),this.KEY=this.model.state.entities.getDimension();var t=this;this.titleSwitch.on("change",function(){t.panelMode=t.titleSwitch.property("checked")?"show":"find",t.panelsEl.classed("vzb-active",!1),t.contentEl.select(".vzb-dialog-panel-"+t.panelMode).classed("vzb-active",!0),t.panelComps[t.panelMode].showHideSearch(),t._buttonAdjust(),t.panelComps[t.panelMode].showHideButtons()}),this.titleSwitch.property("checked","find"!==this.panelMode),this.titleSwitch.dispatch("change"),this.input_search.on("keyup",function(){13==d3.event.keyCode&&"select all"==t.input_search.node().value&&(t.input_search.node().value="",i.isTouchDevice()||t.model.state.marker.clearHighlighted(),t.model.state.marker.selectAll(),i.defer(function(){return t.panelComps[t.panelMode].showHideSearch()}))}),this.input_search.on("input",function(){t.panelComps[t.panelMode].showHideSearch()}),d3.select(this.input_search.node().parentNode).on("reset",function(){i.defer(function(){return t.panelComps[t.panelMode].showHideSearch()})}).on("submit",function(){return d3.event.preventDefault(),!1}),this.deselect_all.on("click",function(){t.deselectMarkers()}),this.buttonsEl.select(".vzb-dialog-button[data-click='closeDialog']").on("click.panel",function(){return t.panelComps[t.panelMode].closeClick()}),this.translator=this.model.locale.getTFunction(),this.input_search.attr("placeholder",this.translator("placeholder/search")+"..."),this.root.on("ready",function(){t.ready()})},getPanelMode:function(){return this.panelMode},_buttonAdjust:function(){this.buttonsEl.selectAll(".vzb-dialog-buttons > :not([data-dialogtype])").classed("vzb-hidden",!0),this.buttonsEl.selectAll("[data-panel="+this.panelMode+"]").classed("vzb-hidden",!1)},open:function(){var t=this;this._super(),this.input_search.node().value="",this.showHideSearch(),this.time=this.model.state.time.value,this.model.state.marker.getFrame(this.time,function(e){e&&t.redrawDataPoints(e)})},ready:function(){this._super();var t=this;this.KEYS=i.unique(this.model.state.marker._getAllDimensions({exceptType:"time"}));this.importantHooks=t.model.state.marker.getImportantHooks(),this.time=this.model.state.time.value,this.model.state.marker.getFrame(this.time,function(e){if(e){var n=t.model.state.marker.getKeys().map(function(n){return n.brokenData=!1,n.name=t.model.state.marker.getCompoundLabelText(n,e),n});n.sort(function(t,e){return t.name<e.name?-1:1}),t.list.html(""),t.items=t.list.selectAll(".vzb-find-item").data(n).enter().append("div").attr("class","vzb-find-item vzb-dialog-checkbox"),t.items.append("input").attr("type","checkbox").attr("class","vzb-find-item").attr("id",function(e,n){return"-find-"+n+"-"+t._id}).on("change",function(e){i.isTouchDevice()||t.model.state.marker.clearHighlighted(),t.model.state.marker.selectMarker(e),i.isTouchDevice()||e.brokenData||t.model.state.marker.highlightMarker(e)}),t.items.append("label").attr("for",function(e,n){return"-find-"+n+"-"+t._id}).text(function(t){return t.name}).attr("title",function(t){return this.offsetWidth<this.scrollWidth?t.name:null}).on("mouseover",function(e){i.isTouchDevice()||e.brokenData||t.model.state.marker.highlightMarker(e)}).on("mouseout",function(e){i.isTouchDevice()||t.model.state.marker.clearHighlighted()}),i.preventAncestorScrolling(t.element.select(".vzb-dialog-scrollable")),t.redrawDataPoints(e),t.selectDataPoints(),t.showHideSearch(),t.showHideButtons()}})},redrawDataPoints:function(t){var e=this,n=this.KEYS;e.items.each(function(r){var a=d3.select(this).select("label");r.brokenData=!1,i.forEach(e.importantHooks,function(a){if("constant"!=e.model.state.marker[a].use){var s=t[a];if(s){var o=s[i.getKey(r,n)];return o||0===o?void 0:(r.brokenData=!0,!1)}}});var s=this.offsetWidth<this.scrollWidth?r.name:"";a.classed("vzb-find-item-brokendata",r.brokenData).attr("title",s+(r.brokenData?(s?" | ":"")+e.model.state.time.formatDate(e.time)+": "+e.translator("hints/nodata"):""))})},selectDataPoints:function(){this.KEY;var t=this.model.state.marker;this.items.selectAll("input").property("checked",function(e){var n=t.isSelected(e);return d3.select(this.parentNode).classed("vzb-checked",n),n});var e=this.list.selectAll(".vzb-checked").classed("vzb-separator",!1).lower().nodes()[0];d3.select(e).classed("vzb-separator",!0),this.contentEl.node().scrollTop=0},showHideSearch:function(){if("find"===this.getPanelMode()){var t=this.input_search.node().value||"";t=t.toLowerCase(),this.list.selectAll(".vzb-find-item").classed("vzb-hidden",function(e){return-1===(e.name||"").toString().toLowerCase().indexOf(t)})}},showHideButtons:function(){if("find"===this.getPanelMode()){var t=!!this.model.state.marker.select.length;this.deselect_all.classed("vzb-hidden",!t),this.opacity_nonselected.classed("vzb-hidden",!t),t&&this.findChildByName("singlehandleslider").trigger("resize")}},deselectMarkers:function(){this.model.state.marker.clearSelected()},transitionEnd:function(t){this._super(t),i.isTouchDevice()||this.input_search.node().focus()},closeClick:function(){}});e.default=c},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});(function(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n]);e.default=t})(n(1)),a(n(5));var i=a(n(12)),r=a(n(63));function a(t){return t&&t.__esModule?t:{default:t}}var s=i.default.extend("grouping",{init:function(t,e){this.name="grouping",this.groupStops=[1,5,10,15],this.components=[{component:r.default,placeholder:".vzb-dialog-placeholder",model:["state.entities_age","locale"],arg:"grouping",properties:{snapValue:!0,suppressInput:!0,domain:this.groupStops}}],this._super(t,e)},readyOnce:function(){this._super(),this.element.select(".vzb-dialog-groups").selectAll(".vzb-dialog-groups-title").data(this.groupStops).enter().append("span").attr("class",".vzb-dialog-groups-title").text(function(t){return t})}});e.default=s},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});(function(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n]);e.default=t})(n(1)),o(n(5));var i=o(n(12)),r=o(n(165)),a=o(n(51)),s=o(n(52));function o(t){return t&&t.__esModule?t:{default:t}}var l=i.default.extend("label",{init:function(t,e){this.name="label",this.components=[{component:r.default,placeholder:".vzb-dialog-sizeslider",model:["state.marker.size_label","locale"],propertyname:"LabelTextSize",ui:{constantUnit:"unit/pixels"}},{component:a.default,placeholder:".vzb-saxis-selector",model:["state.time","state.marker.size_label","locale"],showHoverValues:!0},{component:s.default,placeholder:".vzb-removelabelbox-switch",model:["ui.chart","locale"],checkbox:"removeLabelBox",submodel:"labels"}],this._super(t,e)}});e.default=l},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i=function(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n]);return e.default=t,e}(n(1)),r=(s(n(5)),s(n(12))),a=s(n(167));function s(t){return t&&t.__esModule?t:{default:t}}var o=r.default.extend("moreoptions",{init:function(t,e){this.name="moreoptions",this.components=[{component:a.default,placeholder:".vzb-dialog-options-buttonlist",model:["state","ui","locale"]}],this._super(t,e)},readyOnce:function(){this._super();var t=this;this.accordionEl=this.contentEl.select(".vzb-accordion"),this.on("dragend",function(){t._setMaxHeight()});var e=(this.model.ui.dialogs||{}).popup||[],n=(this.model.ui.dialogs||{}).moreoptions||[];(!0===n&&(n=e,(this.model.ui.dialogs||{}).moreoptions=n),this._addDialogs(n),this.accordionEl)&&this.accordionEl.selectAll(".vzb-accordion-section").select(".vzb-dialog-title>span:first-child").on("click",function(e){t.components[e.component].element;var n=t.components[e.component].placeholderEl,i=t.accordionEl.select(".vzb-accordion-active");i&&i.classed("vzb-accordion-active",!1),n.node()!==i.node()&&(n.classed("vzb-accordion-active",!0),t.transitionEvents.forEach(function(i){n.on(i,function(){t.transitionEvents.forEach(function(t){n.on(t,null)}),t.components[e.component].trigger("resize")})}))})},_addDialogs:function(t){this._components_config=[];var e=[];if(t.length){for(var n=0;n<t.length;n++)if("moreoptions"!==t[n]){var r=t[n],a=i.deepClone(this.parent._available_dialogs[r]);if(a&&a.dialog){var s=this._components_config;s.push({component:a.dialog,placeholder:'.vzb-dialogs-dialog[data-dlg="'+r+'"]',model:["state","ui","locale"]}),a.component=s.length-1,a.id=r,e.push(a)}}this.accordionEl.selectAll("div").data(e).enter().append("div").attr("class",function(t){return"vzb-dialogs-dialog vzb-moreoptions vzb-accordion-section"}).attr("data-dlg",function(t){return t.id}),this.loadSubComponents();var o=this;i.forEach(this.components,function(t){t.render(),o.on("resize",function(){t.trigger("resize")})})}}});e.default=o},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});(function(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n]);e.default=t})(n(1)),a(n(5));var i=a(n(12)),r=a(n(63));function a(t){return t&&t.__esModule?t:{default:t}}var s=i.default.extend("opacity",{init:function(t,e){this.name="opacity",this.components=[{component:r.default,placeholder:".vzb-dialog-bubbleopacity-regular",model:["state.marker","locale"],arg:"opacityRegular"},{component:r.default,placeholder:".vzb-dialog-bubbleopacity-selectdim",model:["state.marker","locale"],arg:"opacitySelectDim"}],this._super(t,e)}});e.default=s},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});(function(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n]);e.default=t})(n(1)),a(n(5));var i=a(n(12)),r=a(n(52));function a(t){return t&&t.__esModule?t:{default:t}}var s=i.default.extend("presentation",{init:function(t,e){this.name="presentation",this.components=[{component:r.default,placeholder:".vzb-presentationmode-switch",model:["ui","locale"],checkbox:"presentation"},{component:r.default,placeholder:".vzb-decorations-switch",model:["ui.chart.decorations","locale"],checkbox:"enabled"}],this._super(t,e)}});e.default=s},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i=function(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n]);return e.default=t,e}(n(1)),r=(s(n(5)),s(n(12))),a=s(n(51));s(n(52));function s(t){return t&&t.__esModule?t:{default:t}}var o=r.default.extend("side",{init:function(t,e){this.name="side";var n=this;this.model_binds={"change:ui.chart.flipSides":function(t){n._readyOnce&&(n.updateState(),n.redraw())}},this.components=[{component:a.default,placeholder:".vzb-side-selector",model:["state.time","state.marker.side","locale"],showHoverValues:!1}],this._super(t,e)},readyOnce:function(){this._super(),this.listLeft=this.element.select(".vzb-side-list-left"),this.listRight=this.element.select(".vzb-side-list-right"),this.switchSides=this.element.select(".vzb-side-switch-sides"),this.TIMEDIM=this.model.state.time.getDimension(),this.state={};var t=this;this.switchSides.on("click",function(){t.model.ui.chart.flipSides=!t.model.ui.chart.flipSides}),this.model.state.marker.side.getEntity().on("change:show",function(){t.updateState(),t.redraw()}),this.root.on("ready",function(){t.redraw()})},ready:function(){this._super();var t=this.model.state.marker.side.getEntity();if(this.KEY=t.getDimension(),this.labelNames=this.model.state.marker.getLabelHookNames(),"constant"!==this.model.state.marker.side.use&&!(t.show[this.KEY]||{}).$in){var e=this.model.state.marker.side.getUnique(this.model.state.marker.side.which).filter(function(t){return null!==t}).sort(d3.ascending).slice(0,2);if(e.length>0){var n=Object.assign({},t.show);n[this.KEY]={$in:e},t.set("show",n)}}this.updateState(),this.redraw(),i.preventAncestorScrolling(this.element.select(".vzb-dialog-scrollable"))},updateState:function(){var t=this,e=this.model.state.marker.side.getEntity().getDimension(),n=this.model.state.marker.side;if(this.state.right={},this.state.left={},n.state.left[e]&&n.state.right[e])this.state.left[e]=n.state.left[e],this.state.right[e]=n.state.right[e];else{var i=this.model.state.marker.getKeys(e),r=[],a=!!this.model.state.marker.side.getEntity().show[e];if((r=i.filter(function(e){return!a||t.model.state.marker.side.getEntity().isShown(e)}).map(function(t){return t[e]})).length>2&&(r.length=2),r.length>1){var s=this.ui.chart.flipSides?d3.ascending:d3.descending;r.sort(s)}this.state.right={},this.state.right[e]=r[0],this.state.left={},this.state.left[e]=r[1]?r[1]:r[0]}var o="constant"==this.model.state.marker.side.use;this.listLeft.classed("vzb-hidden",o),this.listRight.classed("vzb-hidden",o),this.switchSides.classed("vzb-hidden",o||this.state.left[e]==this.state.right[e])},redraw:function(){var t=this,e=this.labelNames,n=this.KEY;this.translator=this.model.locale.getTFunction(),t.model.state.marker.side.getEntity().dim&&this.model.state.marker.getFrame(this.model.state.time.value,function(r){if(r){var a=[],s=t.model.state.marker.side.getConceptprops();"entity_set"==s.concept_type?a.push.apply(a,function(t){if(Array.isArray(t)){for(var e=0,n=Array(t.length);e<t.length;e++)n[e]=t[e];return n}return Array.from(t)}(t.model.state.marker.side.getEntity().getEntitySets("data")[s.concept][0].map(function(t){var e={};return e[n]=t[s.concept],e.label=t.name,e}))):i.forEach(r[e[n]],function(t,e){var i={};i[n]=e,i.label=t,a.push(i)}),a.sort(function(t,e){return t.label<e.label?-1:1}),t.listLeft.html(""),t.listRight.html(""),t.createList(t.listLeft,"left",a),t.createList(t.listRight,"right",a)}})},createList:function(t,e,n){var i=this,r=this.model.state.marker.side.getEntity().getDimension(),a=t.selectAll(".vzb-side-item").data(n).enter().append("div").attr("class","vzb-side-item vzb-dialog-radio");a.append("input").attr("type","radio").attr("name",e+"-"+i._id).attr("class","vzb-side-item").attr("id",function(t){return"-side-"+e+"-"+t[r]+"-"+i._id}).property("checked",function(t){return i.state[e][r]===t[r]}).on("change",function(t,n){var r=i.model.state.marker.side.getEntity(),a=r.getDimension(),s="left"==e?"right":"left",o=i.model.state.marker.side;o.state[e][a]=t[a],o.state[s][a]=i.state[s][a];var l=[];if(r.isShown(t)||l.push(t),t[a]===i.state[s][a]||r.isShown(i.state[s])||l.push(i.state[s]),i.state[e][a]!==i.state[s][a]&&r.isShown(i.state[e])&&l.push(i.state[e]),t[a]!==i.state[s][a]){var c=[t[a],i.state[s][a]],u=i.ui.chart.flipSides?d3.ascending:d3.descending;c.sort(u),c["left"==e?0:1]==t[a]&&(i.model.state.marker.side.switchSideState(),i.ui.chart.flipSides=!i.ui.chart.flipSides)}l.length&&r.showEntity(l)}),a.append("label").attr("for",function(t){return"-side-"+e+"-"+t[i.KEY]+"-"+i._id}).text(function(t){return t.label})}});e.default=o},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i=function(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n]);return e.default=t,e}(n(1)),r=(o(n(5)),o(n(12))),a=o(n(164)),s=o(n(51));function o(t){return t&&t.__esModule?t:{default:t}}var l=r.default.extend("size",{init:function(t,e){this.name="size";var n=this;this.model_binds={"change:state.marker.size.which":function(t){n._readyOnce&&n.updateSubtitle()},"translate:locale":function(){n._readyOnce&&n.updateSubtitle()}},this.components=[{component:s.default,placeholder:".vzb-saxis-selector",model:["state.time","state.marker.size","locale"],showHoverValues:!0}],t.ui.chart&&0===t.ui.chart.sizeSelectorActive||this.components.push({component:a.default,placeholder:".vzb-dialog-bubblesize",model:["state.marker.size","locale"],ui:{show_button:!1}}),this._super(t,e)},readyOnce:function(){this._super(),this.updateSubtitle()},updateSubtitle:function(){var t=this.model.state.marker.size.getConceptprops(),e=i.getSubtitle(t.name,t.name_short);this.element.select(".vzb-dialog-subtitle").text(e)}});e.default=l},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i=function(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n]);return e.default=t,e}(n(1)),r=(o(n(5)),o(n(12))),a=o(n(63)),s=o(n(52));function o(t){return t&&t.__esModule?t:{default:t}}var l=r.default.extend("speed",{init:function(t,e){this.name="speed",this.components=[{component:a.default,placeholder:".vzb-speed-slider",model:["state.time","locale"],arg:"delay",properties:{domain:[1200,900,450,200,150,100],roundDigits:0}},{component:s.default,placeholder:".vzb-showforecast-switch",model:["state.time","locale"],checkbox:"showForecast"},{component:s.default,placeholder:".vzb-pausebeforeforecast-switch",model:["state.time","locale"],checkbox:"pauseBeforeForecast"},{component:s.default,placeholder:".vzb-showstripedpatternwhenforecast-switch",model:["ui.chart","locale"],checkbox:"showForecastOverlay"}],this._super(t,e)},readyOnce:function(){this._super();var t=this;this.timeFormatExampleEl=this.element.select(".vzb-timeformatexample-label"),this.forecastFieldEl=this.element.select(".vzb-endbeforeforecast-field").on("keypress",function(){13!=d3.event.charCode&&13!=d3.event.keyCode||(d3.event.preventDefault(),this.blur())}).on("change",function(){var e=t.model.state.time.parse(this.value);i.isDate(e)&&(t.model.state.time.endBeforeForecast=e)}),this.updateView()},updateView:function(){this.forecastFieldEl.property("value",this.model.state.time.formatDate(this.model.state.time.endBeforeForecast)),this.timeFormatExampleEl.text(this.model.state.time.formatDate(new Date))}});e.default=l},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});(function(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n]);e.default=t})(n(1)),a(n(5));var i=a(n(12)),r=a(n(186));function a(t){return t&&t.__esModule?t:{default:t}}var s=i.default.extend("stack",{init:function(t,e){this.name="stack";var n=this;this.components=[{component:r.default,placeholder:".vzb-dialog-draggablelist",model:["state.marker.group","state.marker.color","locale","ui.chart"],groupID:"manualSorting",isEnabled:"manualSortingEnabled",dataArrFn:n.manualSorting.bind(n),lang:""}],this.model_binds={"change:state.marker.group":function(t){n._ready&&n.updateView()}},this._super(t,e)},readyOnce:function(){this._super();var t=this;this.group=this.model.state.marker.group,this.stack=this.model.state.marker.stack,this.howToStackEl=this.element.select(".vzb-howtostack").selectAll("input").on("change",function(){t.setModel("stack",d3.select(this).node().value)}),this.howToMergeEl=this.element.select(".vzb-howtomerge").selectAll("input").on("change",function(){t.setModel("merge",d3.select(this).node().value)}),this.updateView()},ready:function(){if(this._super(),!this.model.state.marker.color.isDiscrete()){if("property"==this.stack.use)return void this.setModel("stack","none");if(this.group.merge)return void this.setModel("merge","none")}this.updateView()},updateView:function(){var t=this;this.howToStackEl.property("checked",function(){return"none"===d3.select(this).node().value?"none"===t.stack.which:"bycolor"===d3.select(this).node().value?t.stack.which===t.model.state.marker.color.which:"all"===d3.select(this).node().value?"all"===t.stack.which:void 0}).attr("disabled",function(){return"none"===d3.select(this).node().value?null:"all"===d3.select(this).node().value?null:"bycolor"===d3.select(this).node().value?"property"!==t.model.state.marker.color.use||null:void 0}),t.model.ui.chart.manualSortingEnabled="all"==t.stack.which,this.howToMergeEl.property("checked",function(){return"none"===d3.select(this).node().value?!t.group.merge&&!t.stack.merge:"grouped"===d3.select(this).node().value?t.group.merge:"stacked"===d3.select(this).node().value?t.stack.merge:void 0}).attr("disabled",function(){return"none"===d3.select(this).node().value?null:"grouped"===d3.select(this).node().value?"none"===t.stack.which||"property"!==t.model.state.marker.color.use||null:"stacked"===d3.select(this).node().value?"all"!==t.stack.which||null:void 0})},manualSorting:function(t){var e=arguments.length>1&&void 0!==arguments[1]&&arguments[1];if(0===arguments.length)return this.model.state.marker.group.manualSorting;this.model.state.marker.group.set({manualSorting:t},!1,e)},setModel:function(t,e){var n={stack:{},group:{}};if("merge"===t)switch(e){case"none":n.group.merge=!1,n.stack.merge=!1;break;case"grouped":n.group.merge=!0,n.stack.merge=!1;break;case"stacked":n.group.merge=!1,n.stack.merge=!0}if("stack"===t){switch(e){case"all":n.stack.use="constant",n.stack.which="all";break;case"none":n.stack.use="constant",n.stack.which="none";break;case"bycolor":n.stack.use="property",n.stack.which=this.model.state.marker.color.which,n.stack.spaceRef=this.model.state.marker.color.spaceRef}"none"===e&&this.group.merge&&(n.group.merge=!1),"all"!==e&&this.stack.merge&&(n.stack.merge=!1)}this.model.state.marker.set(n)}});e.default=s},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i,r=function(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n]);return e.default=t,e}(n(1)),a=n(5);var s=((i=a)&&i.__esModule?i:{default:i}).default.extend({init:function(t,e){this.template='<span class="vzb-dl-holder"><ul class="vzb-draggable list vzb-dialog-scrollable"></ul></span>';var n=this;this.name="draggableList",this.dataArrFn=t.dataArrFn,this.lang=t.lang,this.model_expects=[{name:"group",type:"model"},{name:"color",type:"color"},{name:"locale",type:"locale"},{name:"chart",type:"model"}],this.groupID=t.groupID,this.isEnabled=t.isEnabled,this.draggable=!0,t.groupID||r.warn("draggablelist.js complains on 'groupID' property: "+t.groupID),this.model_binds={"translate:locale":function(t){n.updateView()},"change:group.which":function(t){n.updateView()}},this.model_binds["change:group."+this.groupID]=function(t){n.updateView()},this.model_binds["change:chart."+this.isEnabled]=function(t){n.draggable=n.model.chart[n.isEnabled],n.updateView()},this._super(t,e),this.updateData=r.debounce(this.updateData,1e3),this.itemDragger=d3.drag().on("start",function(t,e){!n.dataUpdateFlag&&n.draggable&&(d3.event.sourceEvent.stopPropagation(),n.parentBoundRect=n.element.node().getBoundingClientRect(),n.element.selectAll("div").each(function(e,i){var r=this.getBoundingClientRect();e._y=r.top,e._top=0,t.data===e.data&&(e._height=r.height,n.selectedNode=this)}),d3.select(n.selectedNode).classed("dragged",!0))}).on("drag",function(t,e){if(!n.dataUpdateFlag&&n.draggable){t._top+=d3.event.dy;var i=t._y+t._top;i>n.parentBoundRect.top&&i+t._height<n.parentBoundRect.top+n.parentBoundRect.height&&n.itemsEl.style("top",function(n,r){var a=0;return r<e&&n._y+.5*t._height>i?a=t._height:r>e&&n._y-.5*t._height<i&&(a=-t._height),r!=e&&(n._top=a),n._top+"px"})}}).on("end",function(t,e){!n.dataUpdateFlag&&n.draggable&&n.getData()})},ready:function(){this.updateView(),this.itemsEl=this.element.selectAll("div"),this.itemsEl.call(this.itemDragger);this.itemsEl.select("li").on("mouseover",function(){d3.select(this).classed("hover",!0)}).on("mouseout",function(){d3.select(this).classed("hover",!1)}).on("touchstart",function(){d3.event.preventDefault()})},updateView:function(){var t=this,e=t.model.color.getColorlegendMarker().label.getItems(),n=r.keys(e),i=n.slice().sort(),a=(this.dataArrFn()||[]).slice().sort();!1===r.arrayEquals(i,a)&&this.dataArrFn(n),this.items=this.element.selectAll("div").data(function(){return(t.dataArrFn()||[]).map(function(t){return{data:t}})}),this.items.exit().remove(),this.items=this.items.enter().append("div").each(function(){var t=d3.select(this).append("li");t.append("span").classed("label-circle",!0),t.append("span").classed("label-text",!0)}).merge(this.items);var s=this.model.color.getScale();this.items.select("li").each(function(t){var n=t.data,i=d3.select(this);i.classed("hover",!1).attr("data",n),i.select(".label-circle").style("background",s(n)),i.select(".label-text").text(e[n])});var o=!!t.draggable||null;this.element.selectAll("div").style("top","").attr("draggable",o).classed("dragged",!1),this.dataUpdateFlag=!1},getData:function(){var t;t=this.element.selectAll("div").data().sort(function(t,e){return t._y+t._top-(e._y+e._top)}).map(function(t){return t.data}),r.arrayEquals(this.dataArrFn(),t)?this.updateView():(this.dataUpdateFlag=!0,this.updateData(t,!0))},updateData:function(t,e){this.dataArrFn(t,e)},readyOnce:function(){this.element=d3.select(this.element).select(".list")}});e.default=s},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});(function(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n]);e.default=t})(n(1)),a(n(5));var i=a(n(12)),r=a(n(52));function a(t){return t&&t.__esModule?t:{default:t}}var s=i.default.extend("technical",{init:function(t,e){this.name="technical",this.components=[{component:r.default,placeholder:".vzb-advancedshowandselect-switch",model:["ui.dialogs.dialog.find","locale"],checkbox:"enableSelectShowSwitch"}],this._super(t,e)}});e.default=s},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i=a(n(12)),r=a(n(189));function a(t){return t&&t.__esModule?t:{default:t}}var s=i.default.extend("timedisplay",{init:function(t,e){var n=this;this.name="timedisplay",this.model_binds={"change:state.time.value":function(){n.updateTime()}},this._super(t,e)},ready:function(){this.updateTime()},readyOnce:function(){this._super(),this.timeLabel=new r.default(this.element.select(".vzb-timedisplay")),this.timeLabel.setConditions({widthRatio:1,heightRatio:1}),this.resize()},resize:function(){this.timeLabel&&this.timeLabel.resize(this.contentEl.style("width"),this.contentEl.style("height"))},updateTime:function(){var t=this.model.state.time;this.time_1=null==this.time?t.value:this.time,this.time=t.value;var e=t.playing&&this.time-this.time_1>0?t.delayAnimations:0;this.timeLabel.setText(t.formatDate(this.time,"ui"),e)}});e.default=s},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i,r=n(31),a=(i=r)&&i.__esModule?i:{default:i};e.default=a.default.extend({init:function(t,e){this.context=t,this.context.classed("vzb-dynamic-background",!0),this.width=0,this.height=0,this.topOffset=0,this.leftOffset=0,this.bottomOffset=0,this.rightOffset=0,this.textWidth=0,this.textHeight=0,this.widthRatio=.9,this.heightRatio=.9,this.xAlign="center",this.yAlign="center",this.element=this.context.append("text").style("font-size","20px"),this._sample=this.context.append("text").style("font-size","20px").style("opacity",0),e&&this.setConditions(e)},setConditions:function(t){return!isNaN(parseFloat(t.rightOffset))&&isFinite(t.rightOffset)&&(this.rightOffset=t.rightOffset),!isNaN(parseFloat(t.leftOffset))&&isFinite(t.leftOffset)&&(this.leftOffset=t.leftOffset),!isNaN(parseFloat(t.topOffset))&&isFinite(t.topOffset)&&(this.topOffset=t.topOffset),!isNaN(parseFloat(t.bottomOffset))&&isFinite(t.bottomOffset)&&(this.bottomOffset=t.bottomOffset),t.xAlign&&(this.xAlign=t.xAlign),t.yAlign&&(this.yAlign=t.yAlign),!isNaN(parseFloat(t.widthRatio))&&t.widthRatio>0&&t.widthRatio<=1&&(this.widthRatio=t.widthRatio),!isNaN(parseFloat(t.heightRatio))&&t.heightRatio>0&&t.heightRatio<=1&&(this.heightRatio=t.heightRatio),this},resize:function(t,e,n,i){this.width=parseInt(t,10)||0,this.height=parseInt(e,10)||0,n&&(this.topOffset=n),i&&(this.leftOffset=i),this._resizeText()},setText:function(t){var e=this,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,i=function(){e._sample.text(t),e._resizeText(),e.element.text(t)},r=function(){clearTimeout(e._text.timeout),delete e._text};return n?(this._text&&(this._text.callback(),r()),this._text={callback:i,timeout:setTimeout(function(){i(),r()},n)}):(this._text&&r(),i()),this},_resizeText:function(){var t=this._sample.node().getBBox();if(!(t.width&&t.height&&this.width&&this.height))return this;var e=this.width*this.widthRatio/t.width,n=this.height*this.heightRatio/t.height;switch(this.scalar=Math.min(e,n),this.element.attr("transform","scale("+this.scalar+")"),this.textHeight=t.height*this.scalar,this.textWidth=t.width*this.scalar,this.yAlign){case"bottom":case"center":this.context.select("text").attr("dy",".325em");break;case"top":this.context.select("text").attr("dy","0")}return this.context.attr("transform","translate("+this._getLeftOffset()+","+this._getTopOffset()+")"),this},_getLeftOffset:function(){switch(this.xAlign){case"right":return this.width-this.textWidth/2-this.rightOffset;case"left":return this.textWidth/2+this.leftOffset;default:return this.width/2}},_getTopOffset:function(){switch(this.yAlign){case"top":return this.textHeight/2+this.topOffset;case"bottom":return this.height-this.textHeight/2-this.bottomOffset;default:return this.height/2}}})},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});(function(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n]);e.default=t})(n(1)),s(n(5));var i=s(n(12)),r=s(n(191)),a=s(n(52));function s(t){return t&&t.__esModule?t:{default:t}}var o=i.default.extend("zoom",{init:function(t,e){this.name="zoom",this.components=[{component:r.default,placeholder:".vzb-dialog-zoom-buttonlist",model:["state","ui","locale"]},{component:a.default,placeholder:".vzb-panwitharrow-switch",model:["ui","locale"],checkbox:"panWithArrow"},{component:a.default,placeholder:".vzb-zoomonscrolling-switch",model:["ui","locale"],checkbox:"zoomOnScrolling"},{component:a.default,placeholder:".vzb-adaptminmaxzoom-switch",model:["ui","locale"],checkbox:"adaptMinMaxZoom"}],this._super(t,e)}});e.default=o},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i,r=l(n(1)),a=n(5),s=(i=a)&&i.__esModule?i:{default:i},o=l(n(21));function l(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n]);return e.default=t,e}var c=s.default.extend({init:function(t,e){var n=this;this.name="gapminder-zoombuttonlist",this.model_expects=[{name:"state",type:"model"},{name:"ui",type:"ui"},{name:"locale",type:"locale"}],this._available_buttons={arrow:{title:"buttons/cursorarrow",icon:"cursorArrow",func:this.toggleCursorMode.bind(this),required:!0,statebind:"ui.cursorMode",statebindfunc:this.setCursorMode.bind(this)},plus:{title:"buttons/cursorplus",icon:"cursorPlus",func:this.toggleCursorMode.bind(this),required:!0,statebind:"ui.cursorMode",statebindfunc:this.setCursorMode.bind(this)},minus:{title:"buttons/cursorminus",icon:"cursorMinus",func:this.toggleCursorMode.bind(this),required:!0,statebind:"ui.cursorMode",statebindfunc:this.setCursorMode.bind(this)},hand:{title:"buttons/cursorhand",icon:"cursorHand",func:this.toggleCursorMode.bind(this),required:!0,statebind:"ui.cursorMode",statebindfunc:this.setCursorMode.bind(this)},hundredpercent:{title:"buttons/hundredpercent",icon:"hundredPercent",func:this.toggleHundredPercent.bind(this),required:!0}},this.model_binds={},Object.keys(this._available_buttons).forEach(function(t){var e=n._available_buttons[t];e&&e.statebind&&(n.model_binds["change:"+e.statebind]=function(n){e.statebindfunc(t,n.source.value)})}),this._super(t,e)},readyOnce:function(){this.element=d3.select(this.placeholder),this.element.selectAll("div").remove(),this._addButtons(Object.keys(this._available_buttons),[]),this.setCursorMode("arrow")},_addButtons:function(t,e){var n=this;this._components_config=[];var i=[];if(t.length){for(var a=0;a<t.length;a++){var s=t[a],l=this._available_buttons[s]?s:"_default",c=r.clone(this._available_buttons[l]);c.id=s,c.icon=o[c.icon],i.push(c)}var u=this.getTranslationFunction(!0);this.element.selectAll("button").data(i).enter().append("button").attr("class",function(t){var n="vzb-buttonlist-btn";return e.length>0&&e.indexOf(t.id)>-1&&(n+=" vzb-dialog-side-btn"),n}).attr("data-btn",function(t){return t.id}).html(function(t){return"<span class='vzb-buttonlist-btn-icon fa'>"+t.icon+"</span><span class='vzb-buttonlist-btn-title'>"+u(t.title)+"</span>"}),this.element.selectAll(".vzb-buttonlist-btn").on("click",function(){d3.event.preventDefault(),d3.event.stopPropagation();var t=d3.select(this).attr("data-btn");n.proceedClick(t)})}},proceedClick:function(t){var e=this.element.selectAll(".vzb-buttonlist-btn[data-btn='"+t+"']"),n=e.attr("class"),i=this._available_buttons[t];if(i&&i.func)i.func(t);else{var r=-1===n.indexOf("vzb-active");e.classed("vzb-active",r);var a={};a.id=t,a.active=r,this.trigger("click",a)}},setButtonActive:function(t,e){this.element.selectAll(".vzb-buttonlist-btn[data-btn='"+t+"']").classed("vzb-active",e)},toggleCursorMode:function(t){var e=t;this.model.ui.set("cursorMode",e,!1,!1)},setCursorMode:function(t){var e=this.model.ui.cursorMode?this.model.ui.cursorMode:"arrow";this.element.selectAll(".vzb-buttonlist-btn").classed("vzb-active",function(t){return t.id==e})},toggleHundredPercent:function(t){this.root.trigger("resetZoom")}});e.default=c},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),n(193),n(395);var i,r=n(396),a=(i=r)&&i.__esModule?i:{default:i};n(441),e.default=a.default,t.exports=a.default},function(t,e,n){"use strict";(function(t){if(n(194),n(391),n(392),t._babelPolyfill)throw new Error("only one instance of babel-polyfill is allowed");t._babelPolyfill=!0;var e="defineProperty";function i(t,n,i){t[n]||Object[e](t,n,{writable:!0,configurable:!0,value:i})}i(String.prototype,"padLeft","".padStart),i(String.prototype,"padRight","".padEnd),"pop,reverse,shift,keys,values,entries,indexOf,every,some,forEach,map,filter,find,findIndex,includes,join,slice,concat,push,splice,unshift,sort,lastIndexOf,reduce,reduceRight,copyWithin,fill".split(",").forEach(function(t){[][t]&&i(Array,t,Function.call.bind([][t]))})}).call(this,n(80))},function(t,e,n){n(195),n(198),n(199),n(200),n(201),n(202),n(203),n(204),n(205),n(206),n(207),n(208),n(209),n(210),n(211),n(212),n(213),n(214),n(215),n(216),n(217),n(218),n(219),n(220),n(221),n(222),n(223),n(224),n(225),n(226),n(227),n(228),n(229),n(230),n(231),n(232),n(233),n(234),n(235),n(236),n(237),n(238),n(239),n(240),n(241),n(242),n(243),n(244),n(245),n(246),n(247),n(248),n(249),n(250),n(251),n(252),n(253),n(254),n(255),n(256),n(257),n(258),n(259),n(260),n(261),n(262),n(263),n(264),n(265),n(266),n(267),n(268),n(269),n(270),n(271),n(272),n(273),n(275),n(276),n(278),n(279),n(280),n(281),n(282),n(283),n(284),n(286),n(287),n(288),n(289),n(290),n(291),n(292),n(293),n(294),n(295),n(296),n(297),n(298),n(101),n(299),n(135),n(300),n(136),n(301),n(302),n(303),n(304),n(305),n(139),n(141),n(142),n(306),n(307),n(308),n(309),n(310),n(311),n(312),n(313),n(314),n(315),n(316),n(317),n(318),n(319),n(320),n(321),n(322),n(323),n(324),n(325),n(326),n(327),n(328),n(329),n(330),n(331),n(332),n(333),n(334),n(335),n(336),n(337),n(338),n(339),n(340),n(341),n(342),n(343),n(344),n(345),n(346),n(347),n(348),n(349),n(350),n(351),n(352),n(353),n(354),n(355),n(356),n(357),n(358),n(359),n(360),n(361),n(362),n(363),n(364),n(365),n(366),n(367),n(368),n(369),n(370),n(371),n(372),n(373),n(374),n(375),n(376),n(377),n(378),n(379),n(380),n(381),n(382),n(383),n(384),n(385),n(386),n(387),n(388),n(389),n(390),t.exports=n(22)},function(t,e,n){"use strict";var i=n(3),r=n(17),a=n(9),s=n(0),o=n(15),l=n(36).KEY,c=n(4),u=n(58),h=n(53),d=n(39),f=n(7),p=n(117),v=n(82),g=n(197),m=n(66),b=n(2),y=n(6),_=n(18),M=n(27),w=n(38),x=n(42),S=n(120),z=n(19),O=n(10),k=n(40),E=z.f,T=O.f,P=S.f,A=i.Symbol,C=i.JSON,L=C&&C.stringify,D=f("_hidden"),I=f("toPrimitive"),F={}.propertyIsEnumerable,j=u("symbol-registry"),R=u("symbols"),N=u("op-symbols"),q=Object.prototype,B="function"==typeof A,H=i.QObject,V=!H||!H.prototype||!H.prototype.findChild,W=a&&c(function(){return 7!=x(T({},"a",{get:function(){return T(this,"a",{value:7}).a}})).a})?function(t,e,n){var i=E(q,e);i&&delete q[e],T(t,e,n),i&&t!==q&&T(q,e,i)}:T,U=function(t){var e=R[t]=x(A.prototype);return e._k=t,e},Y=B&&"symbol"==typeof A.iterator?function(t){return"symbol"==typeof t}:function(t){return t instanceof A},G=function(t,e,n){return t===q&&G(N,e,n),b(t),e=M(e,!0),b(n),r(R,e)?(n.enumerable?(r(t,D)&&t[D][e]&&(t[D][e]=!1),n=x(n,{enumerable:w(0,!1)})):(r(t,D)||T(t,D,w(1,{})),t[D][e]=!0),W(t,e,n)):T(t,e,n)},K=function(t,e){b(t);for(var n,i=g(e=_(e)),r=0,a=i.length;a>r;)G(t,n=i[r++],e[n]);return t},X=function(t){var e=F.call(this,t=M(t,!0));return!(this===q&&r(R,t)&&!r(N,t))&&(!(e||!r(this,t)||!r(R,t)||r(this,D)&&this[D][t])||e)},Q=function(t,e){if(t=_(t),e=M(e,!0),t!==q||!r(R,e)||r(N,e)){var n=E(t,e);return!n||!r(R,e)||r(t,D)&&t[D][e]||(n.enumerable=!0),n}},$=function(t){for(var e,n=P(_(t)),i=[],a=0;n.length>a;)r(R,e=n[a++])||e==D||e==l||i.push(e);return i},J=function(t){for(var e,n=t===q,i=P(n?N:_(t)),a=[],s=0;i.length>s;)!r(R,e=i[s++])||n&&!r(q,e)||a.push(R[e]);return a};B||(o((A=function(){if(this instanceof A)throw TypeError("Symbol is not a constructor!");var t=d(arguments.length>0?arguments[0]:void 0),e=function(n){this===q&&e.call(N,n),r(this,D)&&r(this[D],t)&&(this[D][t]=!1),W(this,t,w(1,n))};return a&&V&&W(q,t,{configurable:!0,set:e}),U(t)}).prototype,"toString",function(){return this._k}),z.f=Q,O.f=G,n(43).f=S.f=$,n(60).f=X,n(65).f=J,a&&!n(35)&&o(q,"propertyIsEnumerable",X,!0),p.f=function(t){return U(f(t))}),s(s.G+s.W+s.F*!B,{Symbol:A});for(var Z="hasInstance,isConcatSpreadable,iterator,match,replace,search,species,split,toPrimitive,toStringTag,unscopables".split(","),tt=0;Z.length>tt;)f(Z[tt++]);for(var et=k(f.store),nt=0;et.length>nt;)v(et[nt++]);s(s.S+s.F*!B,"Symbol",{for:function(t){return r(j,t+="")?j[t]:j[t]=A(t)},keyFor:function(t){if(!Y(t))throw TypeError(t+" is not a symbol!");for(var e in j)if(j[e]===t)return e},useSetter:function(){V=!0},useSimple:function(){V=!1}}),s(s.S+s.F*!B,"Object",{create:function(t,e){return void 0===e?x(t):K(x(t),e)},defineProperty:G,defineProperties:K,getOwnPropertyDescriptor:Q,getOwnPropertyNames:$,getOwnPropertySymbols:J}),C&&s(s.S+s.F*(!B||c(function(){var t=A();return"[null]"!=L([t])||"{}"!=L({a:t})||"{}"!=L(Object(t))})),"JSON",{stringify:function(t){for(var e,n,i=[t],r=1;arguments.length>r;)i.push(arguments[r++]);if(n=e=i[1],(y(e)||void 0!==t)&&!Y(t))return m(e)||(e=function(t,e){if("function"==typeof n&&(e=n.call(this,t,e)),!Y(e))return e}),i[1]=e,L.apply(C,i)}}),A.prototype[I]||n(14)(A.prototype,I,A.prototype.valueOf),h(A,"Symbol"),h(Math,"Math",!0),h(i.JSON,"JSON",!0)},function(t,e,n){t.exports=n(58)("native-function-to-string",Function.toString)},function(t,e,n){var i=n(40),r=n(65),a=n(60);t.exports=function(t){var e=i(t),n=r.f;if(n)for(var s,o=n(t),l=a.f,c=0;o.length>c;)l.call(t,s=o[c++])&&e.push(s);return e}},function(t,e,n){var i=n(0);i(i.S,"Object",{create:n(42)})},function(t,e,n){var i=n(0);i(i.S+i.F*!n(9),"Object",{defineProperty:n(10).f})},function(t,e,n){var i=n(0);i(i.S+i.F*!n(9),"Object",{defineProperties:n(119)})},function(t,e,n){var i=n(18),r=n(19).f;n(29)("getOwnPropertyDescriptor",function(){return function(t,e){return r(i(t),e)}})},function(t,e,n){var i=n(11),r=n(20);n(29)("getPrototypeOf",function(){return function(t){return r(i(t))}})},function(t,e,n){var i=n(11),r=n(40);n(29)("keys",function(){return function(t){return r(i(t))}})},function(t,e,n){n(29)("getOwnPropertyNames",function(){return n(120).f})},function(t,e,n){var i=n(6),r=n(36).onFreeze;n(29)("freeze",function(t){return function(e){return t&&i(e)?t(r(e)):e}})},function(t,e,n){var i=n(6),r=n(36).onFreeze;n(29)("seal",function(t){return function(e){return t&&i(e)?t(r(e)):e}})},function(t,e,n){var i=n(6),r=n(36).onFreeze;n(29)("preventExtensions",function(t){return function(e){return t&&i(e)?t(r(e)):e}})},function(t,e,n){var i=n(6);n(29)("isFrozen",function(t){return function(e){return!i(e)||!!t&&t(e)}})},function(t,e,n){var i=n(6);n(29)("isSealed",function(t){return function(e){return!i(e)||!!t&&t(e)}})},function(t,e,n){var i=n(6);n(29)("isExtensible",function(t){return function(e){return!!i(e)&&(!t||t(e))}})},function(t,e,n){var i=n(0);i(i.S+i.F,"Object",{assign:n(121)})},function(t,e,n){var i=n(0);i(i.S,"Object",{is:n(122)})},function(t,e,n){var i=n(0);i(i.S,"Object",{setPrototypeOf:n(86).set})},function(t,e,n){"use strict";var i=n(54),r={};r[n(7)("toStringTag")]="z",r+""!="[object z]"&&n(15)(Object.prototype,"toString",function(){return"[object "+i(this)+"]"},!0)},function(t,e,n){var i=n(0);i(i.P,"Function",{bind:n(123)})},function(t,e,n){var i=n(10).f,r=Function.prototype,a=/^\s*function ([^ (]*)/;"name"in r||n(9)&&i(r,"name",{configurable:!0,get:function(){try{return(""+this).match(a)[1]}catch(t){return""}}})},function(t,e,n){"use strict";var i=n(6),r=n(20),a=n(7)("hasInstance"),s=Function.prototype;a in s||n(10).f(s,a,{value:function(t){if("function"!=typeof this||!i(t))return!1;if(!i(this.prototype))return t instanceof this;for(;t=r(t);)if(this.prototype===t)return!0;return!1}})},function(t,e,n){var i=n(0),r=n(125);i(i.G+i.F*(parseInt!=r),{parseInt:r})},function(t,e,n){var i=n(0),r=n(126);i(i.G+i.F*(parseFloat!=r),{parseFloat:r})},function(t,e,n){"use strict";var i=n(3),r=n(17),a=n(24),s=n(88),o=n(27),l=n(4),c=n(43).f,u=n(19).f,h=n(10).f,d=n(55).trim,f=i.Number,p=f,v=f.prototype,g="Number"==a(n(42)(v)),m="trim"in String.prototype,b=function(t){var e=o(t,!1);if("string"==typeof e&&e.length>2){var n,i,r,a=(e=m?e.trim():d(e,3)).charCodeAt(0);if(43===a||45===a){if(88===(n=e.charCodeAt(2))||120===n)return NaN}else if(48===a){switch(e.charCodeAt(1)){case 66:case 98:i=2,r=49;break;case 79:case 111:i=8,r=55;break;default:return+e}for(var s,l=e.slice(2),c=0,u=l.length;c<u;c++)if((s=l.charCodeAt(c))<48||s>r)return NaN;return parseInt(l,i)}}return+e};if(!f(" 0o1")||!f("0b1")||f("+0x1")){f=function(t){var e=arguments.length<1?0:t,n=this;return n instanceof f&&(g?l(function(){v.valueOf.call(n)}):"Number"!=a(n))?s(new p(b(e)),n,f):b(e)};for(var y,_=n(9)?c(p):"MAX_VALUE,MIN_VALUE,NaN,NEGATIVE_INFINITY,POSITIVE_INFINITY,EPSILON,isFinite,isInteger,isNaN,isSafeInteger,MAX_SAFE_INTEGER,MIN_SAFE_INTEGER,parseFloat,parseInt,isInteger".split(","),M=0;_.length>M;M++)r(p,y=_[M])&&!r(f,y)&&h(f,y,u(p,y));f.prototype=v,v.constructor=f,n(15)(i,"Number",f)}},function(t,e,n){"use strict";var i=n(0),r=n(25),a=n(127),s=n(89),o=1..toFixed,l=Math.floor,c=[0,0,0,0,0,0],u="Number.toFixed: incorrect invocation!",h=function(t,e){for(var n=-1,i=e;++n<6;)i+=t*c[n],c[n]=i%1e7,i=l(i/1e7)},d=function(t){for(var e=6,n=0;--e>=0;)n+=c[e],c[e]=l(n/t),n=n%t*1e7},f=function(){for(var t=6,e="";--t>=0;)if(""!==e||0===t||0!==c[t]){var n=String(c[t]);e=""===e?n:e+s.call("0",7-n.length)+n}return e},p=function(t,e,n){return 0===e?n:e%2==1?p(t,e-1,n*t):p(t*t,e/2,n)};i(i.P+i.F*(!!o&&("0.000"!==8e-5.toFixed(3)||"1"!==.9.toFixed(0)||"1.25"!==1.255.toFixed(2)||"1000000000000000128"!==(0xde0b6b3a7640080).toFixed(0))||!n(4)(function(){o.call({})})),"Number",{toFixed:function(t){var e,n,i,o,l=a(this,u),c=r(t),v="",g="0";if(c<0||c>20)throw RangeError(u);if(l!=l)return"NaN";if(l<=-1e21||l>=1e21)return String(l);if(l<0&&(v="-",l=-l),l>1e-21)if(n=(e=function(t){for(var e=0,n=t;n>=4096;)e+=12,n/=4096;for(;n>=2;)e+=1,n/=2;return e}(l*p(2,69,1))-69)<0?l*p(2,-e,1):l/p(2,e,1),n*=4503599627370496,(e=52-e)>0){for(h(0,n),i=c;i>=7;)h(1e7,0),i-=7;for(h(p(10,i,1),0),i=e-1;i>=23;)d(1<<23),i-=23;d(1<<i),h(1,1),d(2),g=f()}else h(0,n),h(1<<-e,0),g=f()+s.call("0",c);return g=c>0?v+((o=g.length)<=c?"0."+s.call("0",c-o)+g:g.slice(0,o-c)+"."+g.slice(o-c)):v+g}})},function(t,e,n){"use strict";var i=n(0),r=n(4),a=n(127),s=1..toPrecision;i(i.P+i.F*(r(function(){return"1"!==s.call(1,void 0)})||!r(function(){s.call({})})),"Number",{toPrecision:function(t){var e=a(this,"Number#toPrecision: incorrect invocation!");return void 0===t?s.call(e):s.call(e,t)}})},function(t,e,n){var i=n(0);i(i.S,"Number",{EPSILON:Math.pow(2,-52)})},function(t,e,n){var i=n(0),r=n(3).isFinite;i(i.S,"Number",{isFinite:function(t){return"number"==typeof t&&r(t)}})},function(t,e,n){var i=n(0);i(i.S,"Number",{isInteger:n(128)})},function(t,e,n){var i=n(0);i(i.S,"Number",{isNaN:function(t){return t!=t}})},function(t,e,n){var i=n(0),r=n(128),a=Math.abs;i(i.S,"Number",{isSafeInteger:function(t){return r(t)&&a(t)<=9007199254740991}})},function(t,e,n){var i=n(0);i(i.S,"Number",{MAX_SAFE_INTEGER:9007199254740991})},function(t,e,n){var i=n(0);i(i.S,"Number",{MIN_SAFE_INTEGER:-9007199254740991})},function(t,e,n){var i=n(0),r=n(126);i(i.S+i.F*(Number.parseFloat!=r),"Number",{parseFloat:r})},function(t,e,n){var i=n(0),r=n(125);i(i.S+i.F*(Number.parseInt!=r),"Number",{parseInt:r})},function(t,e,n){var i=n(0),r=n(129),a=Math.sqrt,s=Math.acosh;i(i.S+i.F*!(s&&710==Math.floor(s(Number.MAX_VALUE))&&s(1/0)==1/0),"Math",{acosh:function(t){return(t=+t)<1?NaN:t>94906265.62425156?Math.log(t)+Math.LN2:r(t-1+a(t-1)*a(t+1))}})},function(t,e,n){var i=n(0),r=Math.asinh;i(i.S+i.F*!(r&&1/r(0)>0),"Math",{asinh:function t(e){return isFinite(e=+e)&&0!=e?e<0?-t(-e):Math.log(e+Math.sqrt(e*e+1)):e}})},function(t,e,n){var i=n(0),r=Math.atanh;i(i.S+i.F*!(r&&1/r(-0)<0),"Math",{atanh:function(t){return 0==(t=+t)?t:Math.log((1+t)/(1-t))/2}})},function(t,e,n){var i=n(0),r=n(90);i(i.S,"Math",{cbrt:function(t){return r(t=+t)*Math.pow(Math.abs(t),1/3)}})},function(t,e,n){var i=n(0);i(i.S,"Math",{clz32:function(t){return(t>>>=0)?31-Math.floor(Math.log(t+.5)*Math.LOG2E):32}})},function(t,e,n){var i=n(0),r=Math.exp;i(i.S,"Math",{cosh:function(t){return(r(t=+t)+r(-t))/2}})},function(t,e,n){var i=n(0),r=n(91);i(i.S+i.F*(r!=Math.expm1),"Math",{expm1:r})},function(t,e,n){var i=n(0);i(i.S,"Math",{fround:n(130)})},function(t,e,n){var i=n(0),r=Math.abs;i(i.S,"Math",{hypot:function(t,e){for(var n,i,a=0,s=0,o=arguments.length,l=0;s<o;)l<(n=r(arguments[s++]))?(a=a*(i=l/n)*i+1,l=n):a+=n>0?(i=n/l)*i:n;return l===1/0?1/0:l*Math.sqrt(a)}})},function(t,e,n){var i=n(0),r=Math.imul;i(i.S+i.F*n(4)(function(){return-5!=r(4294967295,5)||2!=r.length}),"Math",{imul:function(t,e){var n=+t,i=+e,r=65535&n,a=65535&i;return 0|r*a+((65535&n>>>16)*a+r*(65535&i>>>16)<<16>>>0)}})},function(t,e,n){var i=n(0);i(i.S,"Math",{log10:function(t){return Math.log(t)*Math.LOG10E}})},function(t,e,n){var i=n(0);i(i.S,"Math",{log1p:n(129)})},function(t,e,n){var i=n(0);i(i.S,"Math",{log2:function(t){return Math.log(t)/Math.LN2}})},function(t,e,n){var i=n(0);i(i.S,"Math",{sign:n(90)})},function(t,e,n){var i=n(0),r=n(91),a=Math.exp;i(i.S+i.F*n(4)(function(){return-2e-17!=!Math.sinh(-2e-17)}),"Math",{sinh:function(t){return Math.abs(t=+t)<1?(r(t)-r(-t))/2:(a(t-1)-a(-t-1))*(Math.E/2)}})},function(t,e,n){var i=n(0),r=n(91),a=Math.exp;i(i.S,"Math",{tanh:function(t){var e=r(t=+t),n=r(-t);return e==1/0?1:n==1/0?-1:(e-n)/(a(t)+a(-t))}})},function(t,e,n){var i=n(0);i(i.S,"Math",{trunc:function(t){return(t>0?Math.floor:Math.ceil)(t)}})},function(t,e,n){var i=n(0),r=n(41),a=String.fromCharCode,s=String.fromCodePoint;i(i.S+i.F*(!!s&&1!=s.length),"String",{fromCodePoint:function(t){for(var e,n=[],i=arguments.length,s=0;i>s;){if(e=+arguments[s++],r(e,1114111)!==e)throw RangeError(e+" is not a valid code point");n.push(e<65536?a(e):a(55296+((e-=65536)>>10),e%1024+56320))}return n.join("")}})},function(t,e,n){var i=n(0),r=n(18),a=n(8);i(i.S,"String",{raw:function(t){for(var e=r(t.raw),n=a(e.length),i=arguments.length,s=[],o=0;n>o;)s.push(String(e[o++])),o<i&&s.push(String(arguments[o]));return s.join("")}})},function(t,e,n){"use strict";n(55)("trim",function(t){return function(){return t(this,3)}})},function(t,e,n){"use strict";var i=n(67)(!0);n(92)(String,"String",function(t){this._t=String(t),this._i=0},function(){var t,e=this._t,n=this._i;return n>=e.length?{value:void 0,done:!0}:(t=i(e,n),this._i+=t.length,{value:t,done:!1})})},function(t,e,n){"use strict";var i=n(0),r=n(67)(!1);i(i.P,"String",{codePointAt:function(t){return r(this,t)}})},function(t,e,n){"use strict";var i=n(0),r=n(8),a=n(94),s="".endsWith;i(i.P+i.F*n(95)("endsWith"),"String",{endsWith:function(t){var e=a(this,t,"endsWith"),n=arguments.length>1?arguments[1]:void 0,i=r(e.length),o=void 0===n?i:Math.min(r(n),i),l=String(t);return s?s.call(e,l,o):e.slice(o-l.length,o)===l}})},function(t,e,n){"use strict";var i=n(0),r=n(94);i(i.P+i.F*n(95)("includes"),"String",{includes:function(t){return!!~r(this,t,"includes").indexOf(t,arguments.length>1?arguments[1]:void 0)}})},function(t,e,n){var i=n(0);i(i.P,"String",{repeat:n(89)})},function(t,e,n){"use strict";var i=n(0),r=n(8),a=n(94),s="".startsWith;i(i.P+i.F*n(95)("startsWith"),"String",{startsWith:function(t){var e=a(this,t,"startsWith"),n=r(Math.min(arguments.length>1?arguments[1]:void 0,e.length)),i=String(t);return s?s.call(e,i,n):e.slice(n,n+i.length)===i}})},function(t,e,n){"use strict";n(16)("anchor",function(t){return function(e){return t(this,"a","name",e)}})},function(t,e,n){"use strict";n(16)("big",function(t){return function(){return t(this,"big","","")}})},function(t,e,n){"use strict";n(16)("blink",function(t){return function(){return t(this,"blink","","")}})},function(t,e,n){"use strict";n(16)("bold",function(t){return function(){return t(this,"b","","")}})},function(t,e,n){"use strict";n(16)("fixed",function(t){return function(){return t(this,"tt","","")}})},function(t,e,n){"use strict";n(16)("fontcolor",function(t){return function(e){return t(this,"font","color",e)}})},function(t,e,n){"use strict";n(16)("fontsize",function(t){return function(e){return t(this,"font","size",e)}})},function(t,e,n){"use strict";n(16)("italics",function(t){return function(){return t(this,"i","","")}})},function(t,e,n){"use strict";n(16)("link",function(t){return function(e){return t(this,"a","href",e)}})},function(t,e,n){"use strict";n(16)("small",function(t){return function(){return t(this,"small","","")}})},function(t,e,n){"use strict";n(16)("strike",function(t){return function(){return t(this,"strike","","")}})},function(t,e,n){"use strict";n(16)("sub",function(t){return function(){return t(this,"sub","","")}})},function(t,e,n){"use strict";n(16)("sup",function(t){return function(){return t(this,"sup","","")}})},function(t,e,n){var i=n(0);i(i.S,"Date",{now:function(){return(new Date).getTime()}})},function(t,e,n){"use strict";var i=n(0),r=n(11),a=n(27);i(i.P+i.F*n(4)(function(){return null!==new Date(NaN).toJSON()||1!==Date.prototype.toJSON.call({toISOString:function(){return 1}})}),"Date",{toJSON:function(t){var e=r(this),n=a(e);return"number"!=typeof n||isFinite(n)?e.toISOString():null}})},function(t,e,n){var i=n(0),r=n(274);i(i.P+i.F*(Date.prototype.toISOString!==r),"Date",{toISOString:r})},function(t,e,n){"use strict";var i=n(4),r=Date.prototype.getTime,a=Date.prototype.toISOString,s=function(t){return t>9?t:"0"+t};t.exports=i(function(){return"0385-07-25T07:06:39.999Z"!=a.call(new Date(-5e13-1))})||!i(function(){a.call(new Date(NaN))})?function(){if(!isFinite(r.call(this)))throw RangeError("Invalid time value");var t=this,e=t.getUTCFullYear(),n=t.getUTCMilliseconds(),i=e<0?"-":e>9999?"+":"";return i+("00000"+Math.abs(e)).slice(i?-6:-4)+"-"+s(t.getUTCMonth()+1)+"-"+s(t.getUTCDate())+"T"+s(t.getUTCHours())+":"+s(t.getUTCMinutes())+":"+s(t.getUTCSeconds())+"."+(n>99?n:"0"+s(n))+"Z"}:a},function(t,e,n){var i=Date.prototype,r=i.toString,a=i.getTime;new Date(NaN)+""!="Invalid Date"&&n(15)(i,"toString",function(){var t=a.call(this);return t==t?r.call(this):"Invalid Date"})},function(t,e,n){var i=n(7)("toPrimitive"),r=Date.prototype;i in r||n(14)(r,i,n(277))},function(t,e,n){"use strict";var i=n(2),r=n(27);t.exports=function(t){if("string"!==t&&"number"!==t&&"default"!==t)throw TypeError("Incorrect hint");return r(i(this),"number"!=t)}},function(t,e,n){var i=n(0);i(i.S,"Array",{isArray:n(66)})},function(t,e,n){"use strict";var i=n(23),r=n(0),a=n(11),s=n(131),o=n(96),l=n(8),c=n(97),u=n(98);r(r.S+r.F*!n(69)(function(t){Array.from(t)}),"Array",{from:function(t){var e,n,r,h,d=a(t),f="function"==typeof this?this:Array,p=arguments.length,v=p>1?arguments[1]:void 0,g=void 0!==v,m=0,b=u(d);if(g&&(v=i(v,p>2?arguments[2]:void 0,2)),void 0==b||f==Array&&o(b))for(n=new f(e=l(d.length));e>m;m++)c(n,m,g?v(d[m],m):d[m]);else for(h=b.call(d),n=new f;!(r=h.next()).done;m++)c(n,m,g?s(h,v,[r.value,m],!0):r.value);return n.length=m,n}})},function(t,e,n){"use strict";var i=n(0),r=n(97);i(i.S+i.F*n(4)(function(){function t(){}return!(Array.of.call(t)instanceof t)}),"Array",{of:function(){for(var t=0,e=arguments.length,n=new("function"==typeof this?this:Array)(e);e>t;)r(n,t,arguments[t++]);return n.length=e,n}})},function(t,e,n){"use strict";var i=n(0),r=n(18),a=[].join;i(i.P+i.F*(n(59)!=Object||!n(26)(a)),"Array",{join:function(t){return a.call(r(this),void 0===t?",":t)}})},function(t,e,n){"use strict";var i=n(0),r=n(85),a=n(24),s=n(41),o=n(8),l=[].slice;i(i.P+i.F*n(4)(function(){r&&l.call(r)}),"Array",{slice:function(t,e){var n=o(this.length),i=a(this);if(e=void 0===e?n:e,"Array"==i)return l.call(this,t,e);for(var r=s(t,n),c=s(e,n),u=o(c-r),h=new Array(u),d=0;d<u;d++)h[d]="String"==i?this.charAt(r+d):this[r+d];return h}})},function(t,e,n){"use strict";var i=n(0),r=n(13),a=n(11),s=n(4),o=[].sort,l=[1,2,3];i(i.P+i.F*(s(function(){l.sort(void 0)})||!s(function(){l.sort(null)})||!n(26)(o)),"Array",{sort:function(t){return void 0===t?o.call(a(this)):o.call(a(this),r(t))}})},function(t,e,n){"use strict";var i=n(0),r=n(30)(0),a=n(26)([].forEach,!0);i(i.P+i.F*!a,"Array",{forEach:function(t){return r(this,t,arguments[1])}})},function(t,e,n){var i=n(6),r=n(66),a=n(7)("species");t.exports=function(t){var e;return r(t)&&("function"!=typeof(e=t.constructor)||e!==Array&&!r(e.prototype)||(e=void 0),i(e)&&null===(e=e[a])&&(e=void 0)),void 0===e?Array:e}},function(t,e,n){"use strict";var i=n(0),r=n(30)(1);i(i.P+i.F*!n(26)([].map,!0),"Array",{map:function(t){return r(this,t,arguments[1])}})},function(t,e,n){"use strict";var i=n(0),r=n(30)(2);i(i.P+i.F*!n(26)([].filter,!0),"Array",{filter:function(t){return r(this,t,arguments[1])}})},function(t,e,n){"use strict";var i=n(0),r=n(30)(3);i(i.P+i.F*!n(26)([].some,!0),"Array",{some:function(t){return r(this,t,arguments[1])}})},function(t,e,n){"use strict";var i=n(0),r=n(30)(4);i(i.P+i.F*!n(26)([].every,!0),"Array",{every:function(t){return r(this,t,arguments[1])}})},function(t,e,n){"use strict";var i=n(0),r=n(132);i(i.P+i.F*!n(26)([].reduce,!0),"Array",{reduce:function(t){return r(this,t,arguments.length,arguments[1],!1)}})},function(t,e,n){"use strict";var i=n(0),r=n(132);i(i.P+i.F*!n(26)([].reduceRight,!0),"Array",{reduceRight:function(t){return r(this,t,arguments.length,arguments[1],!0)}})},function(t,e,n){"use strict";var i=n(0),r=n(64)(!1),a=[].indexOf,s=!!a&&1/[1].indexOf(1,-0)<0;i(i.P+i.F*(s||!n(26)(a)),"Array",{indexOf:function(t){return s?a.apply(this,arguments)||0:r(this,t,arguments[1])}})},function(t,e,n){"use strict";var i=n(0),r=n(18),a=n(25),s=n(8),o=[].lastIndexOf,l=!!o&&1/[1].lastIndexOf(1,-0)<0;i(i.P+i.F*(l||!n(26)(o)),"Array",{lastIndexOf:function(t){if(l)return o.apply(this,arguments)||0;var e=r(this),n=s(e.length),i=n-1;for(arguments.length>1&&(i=Math.min(i,a(arguments[1]))),i<0&&(i=n+i);i>=0;i--)if(i in e&&e[i]===t)return i||0;return-1}})},function(t,e,n){var i=n(0);i(i.P,"Array",{copyWithin:n(133)}),n(37)("copyWithin")},function(t,e,n){var i=n(0);i(i.P,"Array",{fill:n(100)}),n(37)("fill")},function(t,e,n){"use strict";var i=n(0),r=n(30)(5),a=!0;"find"in[]&&Array(1).find(function(){a=!1}),i(i.P+i.F*a,"Array",{find:function(t){return r(this,t,arguments.length>1?arguments[1]:void 0)}}),n(37)("find")},function(t,e,n){"use strict";var i=n(0),r=n(30)(6),a="findIndex",s=!0;a in[]&&Array(1)[a](function(){s=!1}),i(i.P+i.F*s,"Array",{findIndex:function(t){return r(this,t,arguments.length>1?arguments[1]:void 0)}}),n(37)(a)},function(t,e,n){n(44)("Array")},function(t,e,n){var i=n(3),r=n(88),a=n(10).f,s=n(43).f,o=n(68),l=n(61),c=i.RegExp,u=c,h=c.prototype,d=/a/g,f=/a/g,p=new c(d)!==d;if(n(9)&&(!p||n(4)(function(){return f[n(7)("match")]=!1,c(d)!=d||c(f)==f||"/a/i"!=c(d,"i")}))){c=function(t,e){var n=this instanceof c,i=o(t),a=void 0===e;return!n&&i&&t.constructor===c&&a?t:r(p?new u(i&&!a?t.source:t,e):u((i=t instanceof c)?t.source:t,i&&a?l.call(t):e),n?this:h,c)};for(var v=function(t){t in c||a(c,t,{configurable:!0,get:function(){return u[t]},set:function(e){u[t]=e}})},g=s(u),m=0;g.length>m;)v(g[m++]);h.constructor=c,c.prototype=h,n(15)(i,"RegExp",c)}n(44)("RegExp")},function(t,e,n){"use strict";n(136);var i=n(2),r=n(61),a=n(9),s=/./.toString,o=function(t){n(15)(RegExp.prototype,"toString",t,!0)};n(4)(function(){return"/a/b"!=s.call({source:"a",flags:"b"})})?o(function(){var t=i(this);return"/".concat(t.source,"/","flags"in t?t.flags:!a&&t instanceof RegExp?r.call(t):void 0)}):"toString"!=s.name&&o(function(){return s.call(this)})},function(t,e,n){"use strict";var i=n(2),r=n(8),a=n(103),s=n(70);n(71)("match",1,function(t,e,n,o){return[function(n){var i=t(this),r=void 0==n?void 0:n[e];return void 0!==r?r.call(n,i):new RegExp(n)[e](String(i))},function(t){var e=o(n,t,this);if(e.done)return e.value;var l=i(t),c=String(this);if(!l.global)return s(l,c);var u=l.unicode;l.lastIndex=0;for(var h,d=[],f=0;null!==(h=s(l,c));){var p=String(h[0]);d[f]=p,""===p&&(l.lastIndex=a(c,r(l.lastIndex),u)),f++}return 0===f?null:d}]})},function(t,e,n){"use strict";var i=n(2),r=n(11),a=n(8),s=n(25),o=n(103),l=n(70),c=Math.max,u=Math.min,h=Math.floor,d=/\$([$&`']|\d\d?|<[^>]*>)/g,f=/\$([$&`']|\d\d?)/g;n(71)("replace",2,function(t,e,n,p){return[function(i,r){var a=t(this),s=void 0==i?void 0:i[e];return void 0!==s?s.call(i,a,r):n.call(String(a),i,r)},function(t,e){var r=p(n,t,this,e);if(r.done)return r.value;var h=i(t),d=String(this),f="function"==typeof e;f||(e=String(e));var g=h.global;if(g){var m=h.unicode;h.lastIndex=0}for(var b=[];;){var y=l(h,d);if(null===y)break;if(b.push(y),!g)break;""===String(y[0])&&(h.lastIndex=o(d,a(h.lastIndex),m))}for(var _,M="",w=0,x=0;x<b.length;x++){y=b[x];for(var S=String(y[0]),z=c(u(s(y.index),d.length),0),O=[],k=1;k<y.length;k++)O.push(void 0===(_=y[k])?_:String(_));var E=y.groups;if(f){var T=[S].concat(O,z,d);void 0!==E&&T.push(E);var P=String(e.apply(void 0,T))}else P=v(S,d,z,O,E,e);z>=w&&(M+=d.slice(w,z)+P,w=z+S.length)}return M+d.slice(w)}];function v(t,e,i,a,s,o){var l=i+t.length,c=a.length,u=f;return void 0!==s&&(s=r(s),u=d),n.call(o,u,function(n,r){var o;switch(r.charAt(0)){case"$":return"$";case"&":return t;case"`":return e.slice(0,i);case"'":return e.slice(l);case"<":o=s[r.slice(1,-1)];break;default:var u=+r;if(0===u)return n;if(u>c){var d=h(u/10);return 0===d?n:d<=c?void 0===a[d-1]?r.charAt(1):a[d-1]+r.charAt(1):n}o=a[u-1]}return void 0===o?"":o})}})},function(t,e,n){"use strict";var i=n(2),r=n(122),a=n(70);n(71)("search",1,function(t,e,n,s){return[function(n){var i=t(this),r=void 0==n?void 0:n[e];return void 0!==r?r.call(n,i):new RegExp(n)[e](String(i))},function(t){var e=s(n,t,this);if(e.done)return e.value;var o=i(t),l=String(this),c=o.lastIndex;r(c,0)||(o.lastIndex=0);var u=a(o,l);return r(o.lastIndex,c)||(o.lastIndex=c),null===u?-1:u.index}]})},function(t,e,n){"use strict";var i=n(68),r=n(2),a=n(62),s=n(103),o=n(8),l=n(70),c=n(102),u=n(4),h=Math.min,d=[].push,f=!u(function(){RegExp(4294967295,"y")});n(71)("split",2,function(t,e,n,u){var p;return p="c"=="abbc".split(/(b)*/)[1]||4!="test".split(/(?:)/,-1).length||2!="ab".split(/(?:ab)*/).length||4!=".".split(/(.?)(.?)/).length||".".split(/()()/).length>1||"".split(/.?/).length?function(t,e){var r=String(this);if(void 0===t&&0===e)return[];if(!i(t))return n.call(r,t,e);for(var a,s,o,l=[],u=(t.ignoreCase?"i":"")+(t.multiline?"m":"")+(t.unicode?"u":"")+(t.sticky?"y":""),h=0,f=void 0===e?4294967295:e>>>0,p=new RegExp(t.source,u+"g");(a=c.call(p,r))&&!((s=p.lastIndex)>h&&(l.push(r.slice(h,a.index)),a.length>1&&a.index<r.length&&d.apply(l,a.slice(1)),o=a[0].length,h=s,l.length>=f));)p.lastIndex===a.index&&p.lastIndex++;return h===r.length?!o&&p.test("")||l.push(""):l.push(r.slice(h)),l.length>f?l.slice(0,f):l}:"0".split(void 0,0).length?function(t,e){return void 0===t&&0===e?[]:n.call(this,t,e)}:n,[function(n,i){var r=t(this),a=void 0==n?void 0:n[e];return void 0!==a?a.call(n,r,i):p.call(String(r),n,i)},function(t,e){var i=u(p,t,this,e,p!==n);if(i.done)return i.value;var c=r(t),d=String(this),v=a(c,RegExp),g=c.unicode,m=(c.ignoreCase?"i":"")+(c.multiline?"m":"")+(c.unicode?"u":"")+(f?"y":"g"),b=new v(f?c:"^(?:"+c.source+")",m),y=void 0===e?4294967295:e>>>0;if(0===y)return[];if(0===d.length)return null===l(b,d)?[d]:[];for(var _=0,M=0,w=[];M<d.length;){b.lastIndex=f?M:0;var x,S=l(b,f?d:d.slice(M));if(null===S||(x=h(o(b.lastIndex+(f?0:M)),d.length))===_)M=s(d,M,g);else{if(w.push(d.slice(_,M)),w.length===y)return w;for(var z=1;z<=S.length-1;z++)if(w.push(S[z]),w.length===y)return w;M=_=x}}return w.push(d.slice(_)),w}]})},function(t,e,n){"use strict";var i,r,a,s,o=n(35),l=n(3),c=n(23),u=n(54),h=n(0),d=n(6),f=n(13),p=n(45),v=n(46),g=n(62),m=n(104).set,b=n(105)(),y=n(106),_=n(137),M=n(72),w=n(138),x=l.TypeError,S=l.process,z=S&&S.versions,O=z&&z.v8||"",k=l.Promise,E="process"==u(S),T=function(){},P=r=y.f,A=!!function(){try{var t=k.resolve(1),e=(t.constructor={})[n(7)("species")]=function(t){t(T,T)};return(E||"function"==typeof PromiseRejectionEvent)&&t.then(T)instanceof e&&0!==O.indexOf("6.6")&&-1===M.indexOf("Chrome/66")}catch(t){}}(),C=function(t){var e;return!(!d(t)||"function"!=typeof(e=t.then))&&e},L=function(t,e){if(!t._n){t._n=!0;var n=t._c;b(function(){for(var i=t._v,r=1==t._s,a=0,s=function(e){var n,a,s,o=r?e.ok:e.fail,l=e.resolve,c=e.reject,u=e.domain;try{o?(r||(2==t._h&&F(t),t._h=1),!0===o?n=i:(u&&u.enter(),n=o(i),u&&(u.exit(),s=!0)),n===e.promise?c(x("Promise-chain cycle")):(a=C(n))?a.call(n,l,c):l(n)):c(i)}catch(t){u&&!s&&u.exit(),c(t)}};n.length>a;)s(n[a++]);t._c=[],t._n=!1,e&&!t._h&&D(t)})}},D=function(t){m.call(l,function(){var e,n,i,r=t._v,a=I(t);if(a&&(e=_(function(){E?S.emit("unhandledRejection",r,t):(n=l.onunhandledrejection)?n({promise:t,reason:r}):(i=l.console)&&i.error&&i.error("Unhandled promise rejection",r)}),t._h=E||I(t)?2:1),t._a=void 0,a&&e.e)throw e.v})},I=function(t){return 1!==t._h&&0===(t._a||t._c).length},F=function(t){m.call(l,function(){var e;E?S.emit("rejectionHandled",t):(e=l.onrejectionhandled)&&e({promise:t,reason:t._v})})},j=function(t){var e=this;e._d||(e._d=!0,(e=e._w||e)._v=t,e._s=2,e._a||(e._a=e._c.slice()),L(e,!0))},R=function(t){var e,n=this;if(!n._d){n._d=!0,n=n._w||n;try{if(n===t)throw x("Promise can't be resolved itself");(e=C(t))?b(function(){var i={_w:n,_d:!1};try{e.call(t,c(R,i,1),c(j,i,1))}catch(t){j.call(i,t)}}):(n._v=t,n._s=1,L(n,!1))}catch(t){j.call({_w:n,_d:!1},t)}}};A||(k=function(t){p(this,k,"Promise","_h"),f(t),i.call(this);try{t(c(R,this,1),c(j,this,1))}catch(t){j.call(this,t)}},(i=function(t){this._c=[],this._a=void 0,this._s=0,this._d=!1,this._v=void 0,this._h=0,this._n=!1}).prototype=n(47)(k.prototype,{then:function(t,e){var n=P(g(this,k));return n.ok="function"!=typeof t||t,n.fail="function"==typeof e&&e,n.domain=E?S.domain:void 0,this._c.push(n),this._a&&this._a.push(n),this._s&&L(this,!1),n.promise},catch:function(t){return this.then(void 0,t)}}),a=function(){var t=new i;this.promise=t,this.resolve=c(R,t,1),this.reject=c(j,t,1)},y.f=P=function(t){return t===k||t===s?new a(t):r(t)}),h(h.G+h.W+h.F*!A,{Promise:k}),n(53)(k,"Promise"),n(44)("Promise"),s=n(22).Promise,h(h.S+h.F*!A,"Promise",{reject:function(t){var e=P(this);return(0,e.reject)(t),e.promise}}),h(h.S+h.F*(o||!A),"Promise",{resolve:function(t){return w(o&&this===s?k:this,t)}}),h(h.S+h.F*!(A&&n(69)(function(t){k.all(t).catch(T)})),"Promise",{all:function(t){var e=this,n=P(e),i=n.resolve,r=n.reject,a=_(function(){var n=[],a=0,s=1;v(t,!1,function(t){var o=a++,l=!1;n.push(void 0),s++,e.resolve(t).then(function(t){l||(l=!0,n[o]=t,--s||i(n))},r)}),--s||i(n)});return a.e&&r(a.v),n.promise},race:function(t){var e=this,n=P(e),i=n.reject,r=_(function(){v(t,!1,function(t){e.resolve(t).then(n.resolve,i)})});return r.e&&i(r.v),n.promise}})},function(t,e,n){"use strict";var i=n(143),r=n(48);n(73)("WeakSet",function(t){return function(){return t(this,arguments.length>0?arguments[0]:void 0)}},{add:function(t){return i.def(r(this,"WeakSet"),t,!0)}},i,!1,!0)},function(t,e,n){"use strict";var i=n(0),r=n(74),a=n(107),s=n(2),o=n(41),l=n(8),c=n(6),u=n(3).ArrayBuffer,h=n(62),d=a.ArrayBuffer,f=a.DataView,p=r.ABV&&u.isView,v=d.prototype.slice,g=r.VIEW;i(i.G+i.W+i.F*(u!==d),{ArrayBuffer:d}),i(i.S+i.F*!r.CONSTR,"ArrayBuffer",{isView:function(t){return p&&p(t)||c(t)&&g in t}}),i(i.P+i.U+i.F*n(4)(function(){return!new d(2).slice(1,void 0).byteLength}),"ArrayBuffer",{slice:function(t,e){if(void 0!==v&&void 0===e)return v.call(s(this),t);for(var n=s(this).byteLength,i=o(t,n),r=o(void 0===e?n:e,n),a=new(h(this,d))(l(r-i)),c=new f(this),u=new f(a),p=0;i<r;)u.setUint8(p++,c.getUint8(i++));return a}}),n(44)("ArrayBuffer")},function(t,e,n){var i=n(0);i(i.G+i.W+i.F*!n(74).ABV,{DataView:n(107).DataView})},function(t,e,n){n(33)("Int8",1,function(t){return function(e,n,i){return t(this,e,n,i)}})},function(t,e,n){n(33)("Uint8",1,function(t){return function(e,n,i){return t(this,e,n,i)}})},function(t,e,n){n(33)("Uint8",1,function(t){return function(e,n,i){return t(this,e,n,i)}},!0)},function(t,e,n){n(33)("Int16",2,function(t){return function(e,n,i){return t(this,e,n,i)}})},function(t,e,n){n(33)("Uint16",2,function(t){return function(e,n,i){return t(this,e,n,i)}})},function(t,e,n){n(33)("Int32",4,function(t){return function(e,n,i){return t(this,e,n,i)}})},function(t,e,n){n(33)("Uint32",4,function(t){return function(e,n,i){return t(this,e,n,i)}})},function(t,e,n){n(33)("Float32",4,function(t){return function(e,n,i){return t(this,e,n,i)}})},function(t,e,n){n(33)("Float64",8,function(t){return function(e,n,i){return t(this,e,n,i)}})},function(t,e,n){var i=n(0),r=n(13),a=n(2),s=(n(3).Reflect||{}).apply,o=Function.apply;i(i.S+i.F*!n(4)(function(){s(function(){})}),"Reflect",{apply:function(t,e,n){var i=r(t),l=a(n);return s?s(i,e,l):o.call(i,e,l)}})},function(t,e,n){var i=n(0),r=n(42),a=n(13),s=n(2),o=n(6),l=n(4),c=n(123),u=(n(3).Reflect||{}).construct,h=l(function(){function t(){}return!(u(function(){},[],t)instanceof t)}),d=!l(function(){u(function(){})});i(i.S+i.F*(h||d),"Reflect",{construct:function(t,e){a(t),s(e);var n=arguments.length<3?t:a(arguments[2]);if(d&&!h)return u(t,e,n);if(t==n){switch(e.length){case 0:return new t;case 1:return new t(e[0]);case 2:return new t(e[0],e[1]);case 3:return new t(e[0],e[1],e[2]);case 4:return new t(e[0],e[1],e[2],e[3])}var i=[null];return i.push.apply(i,e),new(c.apply(t,i))}var l=n.prototype,f=r(o(l)?l:Object.prototype),p=Function.apply.call(t,f,e);return o(p)?p:f}})},function(t,e,n){var i=n(10),r=n(0),a=n(2),s=n(27);r(r.S+r.F*n(4)(function(){Reflect.defineProperty(i.f({},1,{value:1}),1,{value:2})}),"Reflect",{defineProperty:function(t,e,n){a(t),e=s(e,!0),a(n);try{return i.f(t,e,n),!0}catch(t){return!1}}})},function(t,e,n){var i=n(0),r=n(19).f,a=n(2);i(i.S,"Reflect",{deleteProperty:function(t,e){var n=r(a(t),e);return!(n&&!n.configurable)&&delete t[e]}})},function(t,e,n){"use strict";var i=n(0),r=n(2),a=function(t){this._t=r(t),this._i=0;var e,n=this._k=[];for(e in t)n.push(e)};n(93)(a,"Object",function(){var t,e=this._k;do{if(this._i>=e.length)return{value:void 0,done:!0}}while(!((t=e[this._i++])in this._t));return{value:t,done:!1}}),i(i.S,"Reflect",{enumerate:function(t){return new a(t)}})},function(t,e,n){var i=n(19),r=n(20),a=n(17),s=n(0),o=n(6),l=n(2);s(s.S,"Reflect",{get:function t(e,n){var s,c,u=arguments.length<3?e:arguments[2];return l(e)===u?e[n]:(s=i.f(e,n))?a(s,"value")?s.value:void 0!==s.get?s.get.call(u):void 0:o(c=r(e))?t(c,n,u):void 0}})},function(t,e,n){var i=n(19),r=n(0),a=n(2);r(r.S,"Reflect",{getOwnPropertyDescriptor:function(t,e){return i.f(a(t),e)}})},function(t,e,n){var i=n(0),r=n(20),a=n(2);i(i.S,"Reflect",{getPrototypeOf:function(t){return r(a(t))}})},function(t,e,n){var i=n(0);i(i.S,"Reflect",{has:function(t,e){return e in t}})},function(t,e,n){var i=n(0),r=n(2),a=Object.isExtensible;i(i.S,"Reflect",{isExtensible:function(t){return r(t),!a||a(t)}})},function(t,e,n){var i=n(0);i(i.S,"Reflect",{ownKeys:n(145)})},function(t,e,n){var i=n(0),r=n(2),a=Object.preventExtensions;i(i.S,"Reflect",{preventExtensions:function(t){r(t);try{return a&&a(t),!0}catch(t){return!1}}})},function(t,e,n){var i=n(10),r=n(19),a=n(20),s=n(17),o=n(0),l=n(38),c=n(2),u=n(6);o(o.S,"Reflect",{set:function t(e,n,o){var h,d,f=arguments.length<4?e:arguments[3],p=r.f(c(e),n);if(!p){if(u(d=a(e)))return t(d,n,o,f);p=l(0)}if(s(p,"value")){if(!1===p.writable||!u(f))return!1;if(h=r.f(f,n)){if(h.get||h.set||!1===h.writable)return!1;h.value=o,i.f(f,n,h)}else i.f(f,n,l(0,o));return!0}return void 0!==p.set&&(p.set.call(f,o),!0)}})},function(t,e,n){var i=n(0),r=n(86);r&&i(i.S,"Reflect",{setPrototypeOf:function(t,e){r.check(t,e);try{return r.set(t,e),!0}catch(t){return!1}}})},function(t,e,n){"use strict";var i=n(0),r=n(64)(!0);i(i.P,"Array",{includes:function(t){return r(this,t,arguments.length>1?arguments[1]:void 0)}}),n(37)("includes")},function(t,e,n){"use strict";var i=n(0),r=n(146),a=n(11),s=n(8),o=n(13),l=n(99);i(i.P,"Array",{flatMap:function(t){var e,n,i=a(this);return o(t),e=s(i.length),n=l(i,0),r(n,i,i,e,0,1,t,arguments[1]),n}}),n(37)("flatMap")},function(t,e,n){"use strict";var i=n(0),r=n(146),a=n(11),s=n(8),o=n(25),l=n(99);i(i.P,"Array",{flatten:function(){var t=arguments[0],e=a(this),n=s(e.length),i=l(e,0);return r(i,e,e,n,0,void 0===t?1:o(t)),i}}),n(37)("flatten")},function(t,e,n){"use strict";var i=n(0),r=n(67)(!0);i(i.P,"String",{at:function(t){return r(this,t)}})},function(t,e,n){"use strict";var i=n(0),r=n(147),a=n(72),s=/Version\/10\.\d+(\.\d+)?( Mobile\/\w+)? Safari\//.test(a);i(i.P+i.F*s,"String",{padStart:function(t){return r(this,t,arguments.length>1?arguments[1]:void 0,!0)}})},function(t,e,n){"use strict";var i=n(0),r=n(147),a=n(72),s=/Version\/10\.\d+(\.\d+)?( Mobile\/\w+)? Safari\//.test(a);i(i.P+i.F*s,"String",{padEnd:function(t){return r(this,t,arguments.length>1?arguments[1]:void 0,!1)}})},function(t,e,n){"use strict";n(55)("trimLeft",function(t){return function(){return t(this,1)}},"trimStart")},function(t,e,n){"use strict";n(55)("trimRight",function(t){return function(){return t(this,2)}},"trimEnd")},function(t,e,n){"use strict";var i=n(0),r=n(28),a=n(8),s=n(68),o=n(61),l=RegExp.prototype,c=function(t,e){this._r=t,this._s=e};n(93)(c,"RegExp String",function(){var t=this._r.exec(this._s);return{value:t,done:null===t}}),i(i.P,"String",{matchAll:function(t){if(r(this),!s(t))throw TypeError(t+" is not a regexp!");var e=String(this),n="flags"in l?String(t.flags):o.call(t),i=new RegExp(t.source,~n.indexOf("g")?n:"g"+n);return i.lastIndex=a(t.lastIndex),new c(i,e)}})},function(t,e,n){n(82)("asyncIterator")},function(t,e,n){n(82)("observable")},function(t,e,n){var i=n(0),r=n(145),a=n(18),s=n(19),o=n(97);i(i.S,"Object",{getOwnPropertyDescriptors:function(t){for(var e,n,i=a(t),l=s.f,c=r(i),u={},h=0;c.length>h;)void 0!==(n=l(i,e=c[h++]))&&o(u,e,n);return u}})},function(t,e,n){var i=n(0),r=n(148)(!1);i(i.S,"Object",{values:function(t){return r(t)}})},function(t,e,n){var i=n(0),r=n(148)(!0);i(i.S,"Object",{entries:function(t){return r(t)}})},function(t,e,n){"use strict";var i=n(0),r=n(11),a=n(13),s=n(10);n(9)&&i(i.P+n(75),"Object",{__defineGetter__:function(t,e){s.f(r(this),t,{get:a(e),enumerable:!0,configurable:!0})}})},function(t,e,n){"use strict";var i=n(0),r=n(11),a=n(13),s=n(10);n(9)&&i(i.P+n(75),"Object",{__defineSetter__:function(t,e){s.f(r(this),t,{set:a(e),enumerable:!0,configurable:!0})}})},function(t,e,n){"use strict";var i=n(0),r=n(11),a=n(27),s=n(20),o=n(19).f;n(9)&&i(i.P+n(75),"Object",{__lookupGetter__:function(t){var e,n=r(this),i=a(t,!0);do{if(e=o(n,i))return e.get}while(n=s(n))}})},function(t,e,n){"use strict";var i=n(0),r=n(11),a=n(27),s=n(20),o=n(19).f;n(9)&&i(i.P+n(75),"Object",{__lookupSetter__:function(t){var e,n=r(this),i=a(t,!0);do{if(e=o(n,i))return e.set}while(n=s(n))}})},function(t,e,n){var i=n(0);i(i.P+i.R,"Map",{toJSON:n(149)("Map")})},function(t,e,n){var i=n(0);i(i.P+i.R,"Set",{toJSON:n(149)("Set")})},function(t,e,n){n(76)("Map")},function(t,e,n){n(76)("Set")},function(t,e,n){n(76)("WeakMap")},function(t,e,n){n(76)("WeakSet")},function(t,e,n){n(77)("Map")},function(t,e,n){n(77)("Set")},function(t,e,n){n(77)("WeakMap")},function(t,e,n){n(77)("WeakSet")},function(t,e,n){var i=n(0);i(i.G,{global:n(3)})},function(t,e,n){var i=n(0);i(i.S,"System",{global:n(3)})},function(t,e,n){var i=n(0),r=n(24);i(i.S,"Error",{isError:function(t){return"Error"===r(t)}})},function(t,e,n){var i=n(0);i(i.S,"Math",{clamp:function(t,e,n){return Math.min(n,Math.max(e,t))}})},function(t,e,n){var i=n(0);i(i.S,"Math",{DEG_PER_RAD:Math.PI/180})},function(t,e,n){var i=n(0),r=180/Math.PI;i(i.S,"Math",{degrees:function(t){return t*r}})},function(t,e,n){var i=n(0),r=n(151),a=n(130);i(i.S,"Math",{fscale:function(t,e,n,i,s){return a(r(t,e,n,i,s))}})},function(t,e,n){var i=n(0);i(i.S,"Math",{iaddh:function(t,e,n,i){var r=t>>>0,a=n>>>0;return(e>>>0)+(i>>>0)+((r&a|(r|a)&~(r+a>>>0))>>>31)|0}})},function(t,e,n){var i=n(0);i(i.S,"Math",{isubh:function(t,e,n,i){var r=t>>>0,a=n>>>0;return(e>>>0)-(i>>>0)-((~r&a|~(r^a)&r-a>>>0)>>>31)|0}})},function(t,e,n){var i=n(0);i(i.S,"Math",{imulh:function(t,e){var n=+t,i=+e,r=65535&n,a=65535&i,s=n>>16,o=i>>16,l=(s*a>>>0)+(r*a>>>16);return s*o+(l>>16)+((r*o>>>0)+(65535&l)>>16)}})},function(t,e,n){var i=n(0);i(i.S,"Math",{RAD_PER_DEG:180/Math.PI})},function(t,e,n){var i=n(0),r=Math.PI/180;i(i.S,"Math",{radians:function(t){return t*r}})},function(t,e,n){var i=n(0);i(i.S,"Math",{scale:n(151)})},function(t,e,n){var i=n(0);i(i.S,"Math",{umulh:function(t,e){var n=+t,i=+e,r=65535&n,a=65535&i,s=n>>>16,o=i>>>16,l=(s*a>>>0)+(r*a>>>16);return s*o+(l>>>16)+((r*o>>>0)+(65535&l)>>>16)}})},function(t,e,n){var i=n(0);i(i.S,"Math",{signbit:function(t){return(t=+t)!=t?t:0==t?1/t==1/0:t>0}})},function(t,e,n){"use strict";var i=n(0),r=n(22),a=n(3),s=n(62),o=n(138);i(i.P+i.R,"Promise",{finally:function(t){var e=s(this,r.Promise||a.Promise),n="function"==typeof t;return this.then(n?function(n){return o(e,t()).then(function(){return n})}:t,n?function(n){return o(e,t()).then(function(){throw n})}:t)}})},function(t,e,n){"use strict";var i=n(0),r=n(106),a=n(137);i(i.S,"Promise",{try:function(t){var e=r.f(this),n=a(t);return(n.e?e.reject:e.resolve)(n.v),e.promise}})},function(t,e,n){var i=n(34),r=n(2),a=i.key,s=i.set;i.exp({defineMetadata:function(t,e,n,i){s(t,e,r(n),a(i))}})},function(t,e,n){var i=n(34),r=n(2),a=i.key,s=i.map,o=i.store;i.exp({deleteMetadata:function(t,e){var n=arguments.length<3?void 0:a(arguments[2]),i=s(r(e),n,!1);if(void 0===i||!i.delete(t))return!1;if(i.size)return!0;var l=o.get(e);return l.delete(n),!!l.size||o.delete(e)}})},function(t,e,n){var i=n(34),r=n(2),a=n(20),s=i.has,o=i.get,l=i.key,c=function(t,e,n){if(s(t,e,n))return o(t,e,n);var i=a(e);return null!==i?c(t,i,n):void 0};i.exp({getMetadata:function(t,e){return c(t,r(e),arguments.length<3?void 0:l(arguments[2]))}})},function(t,e,n){var i=n(141),r=n(150),a=n(34),s=n(2),o=n(20),l=a.keys,c=a.key,u=function(t,e){var n=l(t,e),a=o(t);if(null===a)return n;var s=u(a,e);return s.length?n.length?r(new i(n.concat(s))):s:n};a.exp({getMetadataKeys:function(t){return u(s(t),arguments.length<2?void 0:c(arguments[1]))}})},function(t,e,n){var i=n(34),r=n(2),a=i.get,s=i.key;i.exp({getOwnMetadata:function(t,e){return a(t,r(e),arguments.length<3?void 0:s(arguments[2]))}})},function(t,e,n){var i=n(34),r=n(2),a=i.keys,s=i.key;i.exp({getOwnMetadataKeys:function(t){return a(r(t),arguments.length<2?void 0:s(arguments[1]))}})},function(t,e,n){var i=n(34),r=n(2),a=n(20),s=i.has,o=i.key,l=function(t,e,n){if(s(t,e,n))return!0;var i=a(e);return null!==i&&l(t,i,n)};i.exp({hasMetadata:function(t,e){return l(t,r(e),arguments.length<3?void 0:o(arguments[2]))}})},function(t,e,n){var i=n(34),r=n(2),a=i.has,s=i.key;i.exp({hasOwnMetadata:function(t,e){return a(t,r(e),arguments.length<3?void 0:s(arguments[2]))}})},function(t,e,n){var i=n(34),r=n(2),a=n(13),s=i.key,o=i.set;i.exp({metadata:function(t,e){return function(n,i){o(t,e,(void 0!==i?r:a)(n),s(i))}}})},function(t,e,n){var i=n(0),r=n(105)(),a=n(3).process,s="process"==n(24)(a);i(i.G,{asap:function(t){var e=s&&a.domain;r(e?e.bind(t):t)}})},function(t,e,n){"use strict";var i=n(0),r=n(3),a=n(22),s=n(105)(),o=n(7)("observable"),l=n(13),c=n(2),u=n(45),h=n(47),d=n(14),f=n(46),p=f.RETURN,v=function(t){return null==t?void 0:l(t)},g=function(t){var e=t._c;e&&(t._c=void 0,e())},m=function(t){return void 0===t._o},b=function(t){m(t)||(t._o=void 0,g(t))},y=function(t,e){c(t),this._c=void 0,this._o=t,t=new _(this);try{var n=e(t),i=n;null!=n&&("function"==typeof n.unsubscribe?n=function(){i.unsubscribe()}:l(n),this._c=n)}catch(e){return void t.error(e)}m(this)&&g(this)};y.prototype=h({},{unsubscribe:function(){b(this)}});var _=function(t){this._s=t};_.prototype=h({},{next:function(t){var e=this._s;if(!m(e)){var n=e._o;try{var i=v(n.next);if(i)return i.call(n,t)}catch(t){try{b(e)}finally{throw t}}}},error:function(t){var e=this._s;if(m(e))throw t;var n=e._o;e._o=void 0;try{var i=v(n.error);if(!i)throw t;t=i.call(n,t)}catch(t){try{g(e)}finally{throw t}}return g(e),t},complete:function(t){var e=this._s;if(!m(e)){var n=e._o;e._o=void 0;try{var i=v(n.complete);t=i?i.call(n,t):void 0}catch(t){try{g(e)}finally{throw t}}return g(e),t}}});var M=function(t){u(this,M,"Observable","_f")._f=l(t)};h(M.prototype,{subscribe:function(t){return new y(t,this._f)},forEach:function(t){var e=this;return new(a.Promise||r.Promise)(function(n,i){l(t);var r=e.subscribe({next:function(e){try{return t(e)}catch(t){i(t),r.unsubscribe()}},error:i,complete:n})})}}),h(M,{from:function(t){var e="function"==typeof this?this:M,n=v(c(t)[o]);if(n){var i=c(n.call(t));return i.constructor===e?i:new e(function(t){return i.subscribe(t)})}return new e(function(e){var n=!1;return s(function(){if(!n){try{if(f(t,!1,function(t){if(e.next(t),n)return p})===p)return}catch(t){if(n)throw t;return void e.error(t)}e.complete()}}),function(){n=!0}})},of:function(){for(var t=0,e=arguments.length,n=new Array(e);t<e;)n[t]=arguments[t++];return new("function"==typeof this?this:M)(function(t){var e=!1;return s(function(){if(!e){for(var i=0;i<n.length;++i)if(t.next(n[i]),e)return;t.complete()}}),function(){e=!0}})}}),d(M.prototype,o,function(){return this}),i(i.G,{Observable:M}),n(44)("Observable")},function(t,e,n){var i=n(3),r=n(0),a=n(72),s=[].slice,o=/MSIE .\./.test(a),l=function(t){return function(e,n){var i=arguments.length>2,r=!!i&&s.call(arguments,2);return t(i?function(){("function"==typeof e?e:Function(e)).apply(this,r)}:e,n)}};r(r.G+r.B+r.F*o,{setTimeout:l(i.setTimeout),setInterval:l(i.setInterval)})},function(t,e,n){var i=n(0),r=n(104);i(i.G+i.B,{setImmediate:r.set,clearImmediate:r.clear})},function(t,e,n){for(var i=n(101),r=n(40),a=n(15),s=n(3),o=n(14),l=n(56),c=n(7),u=c("iterator"),h=c("toStringTag"),d=l.Array,f={CSSRuleList:!0,CSSStyleDeclaration:!1,CSSValueList:!1,ClientRectList:!1,DOMRectList:!1,DOMStringList:!1,DOMTokenList:!0,DataTransferItemList:!1,FileList:!1,HTMLAllCollection:!1,HTMLCollection:!1,HTMLFormElement:!1,HTMLSelectElement:!1,MediaList:!0,MimeTypeArray:!1,NamedNodeMap:!1,NodeList:!0,PaintRequestList:!1,Plugin:!1,PluginArray:!1,SVGLengthList:!1,SVGNumberList:!1,SVGPathSegList:!1,SVGPointList:!1,SVGStringList:!1,SVGTransformList:!1,SourceBufferList:!1,StyleSheetList:!0,TextTrackCueList:!1,TextTrackList:!1,TouchList:!1},p=r(f),v=0;v<p.length;v++){var g,m=p[v],b=f[m],y=s[m],_=y&&y.prototype;if(_&&(_[u]||o(_,u,d),_[h]||o(_,h,m),l[m]=d,b))for(g in i)_[g]||a(_,g,i[g],!0)}},function(t,e,n){(function(e){!function(e){"use strict";var n,i=Object.prototype,r=i.hasOwnProperty,a="function"==typeof Symbol?Symbol:{},s=a.iterator||"@@iterator",o=a.asyncIterator||"@@asyncIterator",l=a.toStringTag||"@@toStringTag",c="object"==typeof t,u=e.regeneratorRuntime;if(u)c&&(t.exports=u);else{(u=e.regeneratorRuntime=c?t.exports:{}).wrap=_;var h="suspendedStart",d="suspendedYield",f="executing",p="completed",v={},g={};g[s]=function(){return this};var m=Object.getPrototypeOf,b=m&&m(m(A([])));b&&b!==i&&r.call(b,s)&&(g=b);var y=S.prototype=w.prototype=Object.create(g);x.prototype=y.constructor=S,S.constructor=x,S[l]=x.displayName="GeneratorFunction",u.isGeneratorFunction=function(t){var e="function"==typeof t&&t.constructor;return!!e&&(e===x||"GeneratorFunction"===(e.displayName||e.name))},u.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,S):(t.__proto__=S,l in t||(t[l]="GeneratorFunction")),t.prototype=Object.create(y),t},u.awrap=function(t){return{__await:t}},z(O.prototype),O.prototype[o]=function(){return this},u.AsyncIterator=O,u.async=function(t,e,n,i){var r=new O(_(t,e,n,i));return u.isGeneratorFunction(e)?r:r.next().then(function(t){return t.done?t.value:r.next()})},z(y),y[l]="Generator",y[s]=function(){return this},y.toString=function(){return"[object Generator]"},u.keys=function(t){var e=[];for(var n in t)e.push(n);return e.reverse(),function n(){for(;e.length;){var i=e.pop();if(i in t)return n.value=i,n.done=!1,n}return n.done=!0,n}},u.values=A,P.prototype={constructor:P,reset:function(t){if(this.prev=0,this.next=0,this.sent=this._sent=n,this.done=!1,this.delegate=null,this.method="next",this.arg=n,this.tryEntries.forEach(T),!t)for(var e in this)"t"===e.charAt(0)&&r.call(this,e)&&!isNaN(+e.slice(1))&&(this[e]=n)},stop:function(){this.done=!0;var t=this.tryEntries[0].completion;if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function(t){if(this.done)throw t;var e=this;function i(i,r){return o.type="throw",o.arg=t,e.next=i,r&&(e.method="next",e.arg=n),!!r}for(var a=this.tryEntries.length-1;a>=0;--a){var s=this.tryEntries[a],o=s.completion;if("root"===s.tryLoc)return i("end");if(s.tryLoc<=this.prev){var l=r.call(s,"catchLoc"),c=r.call(s,"finallyLoc");if(l&&c){if(this.prev<s.catchLoc)return i(s.catchLoc,!0);if(this.prev<s.finallyLoc)return i(s.finallyLoc)}else if(l){if(this.prev<s.catchLoc)return i(s.catchLoc,!0)}else{if(!c)throw new Error("try statement without catch or finally");if(this.prev<s.finallyLoc)return i(s.finallyLoc)}}}},abrupt:function(t,e){for(var n=this.tryEntries.length-1;n>=0;--n){var i=this.tryEntries[n];if(i.tryLoc<=this.prev&&r.call(i,"finallyLoc")&&this.prev<i.finallyLoc){var a=i;break}}a&&("break"===t||"continue"===t)&&a.tryLoc<=e&&e<=a.finallyLoc&&(a=null);var s=a?a.completion:{};return s.type=t,s.arg=e,a?(this.method="next",this.next=a.finallyLoc,v):this.complete(s)},complete:function(t,e){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&e&&(this.next=e),v},finish:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var n=this.tryEntries[e];if(n.finallyLoc===t)return this.complete(n.completion,n.afterLoc),T(n),v}},catch:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var n=this.tryEntries[e];if(n.tryLoc===t){var i=n.completion;if("throw"===i.type){var r=i.arg;T(n)}return r}}throw new Error("illegal catch attempt")},delegateYield:function(t,e,i){return this.delegate={iterator:A(t),resultName:e,nextLoc:i},"next"===this.method&&(this.arg=n),v}}}function _(t,e,n,i){var r=e&&e.prototype instanceof w?e:w,a=Object.create(r.prototype),s=new P(i||[]);return a._invoke=function(t,e,n){var i=h;return function(r,a){if(i===f)throw new Error("Generator is already running");if(i===p){if("throw"===r)throw a;return C()}for(n.method=r,n.arg=a;;){var s=n.delegate;if(s){var o=k(s,n);if(o){if(o===v)continue;return o}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if(i===h)throw i=p,n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);i=f;var l=M(t,e,n);if("normal"===l.type){if(i=n.done?p:d,l.arg===v)continue;return{value:l.arg,done:n.done}}"throw"===l.type&&(i=p,n.method="throw",n.arg=l.arg)}}}(t,n,s),a}function M(t,e,n){try{return{type:"normal",arg:t.call(e,n)}}catch(t){return{type:"throw",arg:t}}}function w(){}function x(){}function S(){}function z(t){["next","throw","return"].forEach(function(e){t[e]=function(t){return this._invoke(e,t)}})}function O(t){function n(e,i,a,s){var o=M(t[e],t,i);if("throw"!==o.type){var l=o.arg,c=l.value;return c&&"object"==typeof c&&r.call(c,"__await")?Promise.resolve(c.__await).then(function(t){n("next",t,a,s)},function(t){n("throw",t,a,s)}):Promise.resolve(c).then(function(t){l.value=t,a(l)},s)}s(o.arg)}var i;"object"==typeof e.process&&e.process.domain&&(n=e.process.domain.bind(n)),this._invoke=function(t,e){function r(){return new Promise(function(i,r){n(t,e,i,r)})}return i=i?i.then(r,r):r()}}function k(t,e){var i=t.iterator[e.method];if(i===n){if(e.delegate=null,"throw"===e.method){if(t.iterator.return&&(e.method="return",e.arg=n,k(t,e),"throw"===e.method))return v;e.method="throw",e.arg=new TypeError("The iterator does not provide a 'throw' method")}return v}var r=M(i,t.iterator,e.arg);if("throw"===r.type)return e.method="throw",e.arg=r.arg,e.delegate=null,v;var a=r.arg;return a?a.done?(e[t.resultName]=a.value,e.next=t.nextLoc,"return"!==e.method&&(e.method="next",e.arg=n),e.delegate=null,v):a:(e.method="throw",e.arg=new TypeError("iterator result is not an object"),e.delegate=null,v)}function E(t){var e={tryLoc:t[0]};1 in t&&(e.catchLoc=t[1]),2 in t&&(e.finallyLoc=t[2],e.afterLoc=t[3]),this.tryEntries.push(e)}function T(t){var e=t.completion||{};e.type="normal",delete e.arg,t.completion=e}function P(t){this.tryEntries=[{tryLoc:"root"}],t.forEach(E,this),this.reset(!0)}function A(t){if(t){var e=t[s];if(e)return e.call(t);if("function"==typeof t.next)return t;if(!isNaN(t.length)){var i=-1,a=function e(){for(;++i<t.length;)if(r.call(t,i))return e.value=t[i],e.done=!1,e;return e.value=n,e.done=!0,e};return a.next=a}}return{next:C}}function C(){return{value:n,done:!0}}}("object"==typeof e?e:"object"==typeof window?window:"object"==typeof self?self:this)}).call(this,n(80))},function(t,e,n){n(393),t.exports=n(22).RegExp.escape},function(t,e,n){var i=n(0),r=n(394)(/[\\^$*+?.()|[\]{}]/g,"\\$&");i(i.S,"RegExp",{escape:function(t){return r(t)}})},function(t,e){t.exports=function(t,e){var n=e===Object(e)?function(t){return e[t]}:e;return function(e){return String(e).replace(t,n)}}},function(t,e,n){"use strict";n.r(e),n.d(e,"Headers",function(){return c}),n.d(e,"Request",function(){return g}),n.d(e,"Response",function(){return b}),n.d(e,"DOMException",function(){return _}),n.d(e,"fetch",function(){return M});var i={searchParams:"URLSearchParams"in self,iterable:"Symbol"in self&&"iterator"in Symbol,blob:"FileReader"in self&&"Blob"in self&&function(){try{return new Blob,!0}catch(t){return!1}}(),formData:"FormData"in self,arrayBuffer:"ArrayBuffer"in self};if(i.arrayBuffer)var r=["[object Int8Array]","[object Uint8Array]","[object Uint8ClampedArray]","[object Int16Array]","[object Uint16Array]","[object Int32Array]","[object Uint32Array]","[object Float32Array]","[object Float64Array]"],a=ArrayBuffer.isView||function(t){return t&&r.indexOf(Object.prototype.toString.call(t))>-1};function s(t){if("string"!=typeof t&&(t=String(t)),/[^a-z0-9\-#$%&'*+.^_`|~]/i.test(t))throw new TypeError("Invalid character in header field name");return t.toLowerCase()}function o(t){return"string"!=typeof t&&(t=String(t)),t}function l(t){var e={next:function(){var e=t.shift();return{done:void 0===e,value:e}}};return i.iterable&&(e[Symbol.iterator]=function(){return e}),e}function c(t){this.map={},t instanceof c?t.forEach(function(t,e){this.append(e,t)},this):Array.isArray(t)?t.forEach(function(t){this.append(t[0],t[1])},this):t&&Object.getOwnPropertyNames(t).forEach(function(e){this.append(e,t[e])},this)}function u(t){if(t.bodyUsed)return Promise.reject(new TypeError("Already read"));t.bodyUsed=!0}function h(t){return new Promise(function(e,n){t.onload=function(){e(t.result)},t.onerror=function(){n(t.error)}})}function d(t){var e=new FileReader,n=h(e);return e.readAsArrayBuffer(t),n}function f(t){if(t.slice)return t.slice(0);var e=new Uint8Array(t.byteLength);return e.set(new Uint8Array(t)),e.buffer}function p(){return this.bodyUsed=!1,this._initBody=function(t){var e;this._bodyInit=t,t?"string"==typeof t?this._bodyText=t:i.blob&&Blob.prototype.isPrototypeOf(t)?this._bodyBlob=t:i.formData&&FormData.prototype.isPrototypeOf(t)?this._bodyFormData=t:i.searchParams&&URLSearchParams.prototype.isPrototypeOf(t)?this._bodyText=t.toString():i.arrayBuffer&&i.blob&&((e=t)&&DataView.prototype.isPrototypeOf(e))?(this._bodyArrayBuffer=f(t.buffer),this._bodyInit=new Blob([this._bodyArrayBuffer])):i.arrayBuffer&&(ArrayBuffer.prototype.isPrototypeOf(t)||a(t))?this._bodyArrayBuffer=f(t):this._bodyText=t=Object.prototype.toString.call(t):this._bodyText="",this.headers.get("content-type")||("string"==typeof t?this.headers.set("content-type","text/plain;charset=UTF-8"):this._bodyBlob&&this._bodyBlob.type?this.headers.set("content-type",this._bodyBlob.type):i.searchParams&&URLSearchParams.prototype.isPrototypeOf(t)&&this.headers.set("content-type","application/x-www-form-urlencoded;charset=UTF-8"))},i.blob&&(this.blob=function(){var t=u(this);if(t)return t;if(this._bodyBlob)return Promise.resolve(this._bodyBlob);if(this._bodyArrayBuffer)return Promise.resolve(new Blob([this._bodyArrayBuffer]));if(this._bodyFormData)throw new Error("could not read FormData body as blob");return Promise.resolve(new Blob([this._bodyText]))},this.arrayBuffer=function(){return this._bodyArrayBuffer?u(this)||Promise.resolve(this._bodyArrayBuffer):this.blob().then(d)}),this.text=function(){var t,e,n,i=u(this);if(i)return i;if(this._bodyBlob)return t=this._bodyBlob,e=new FileReader,n=h(e),e.readAsText(t),n;if(this._bodyArrayBuffer)return Promise.resolve(function(t){for(var e=new Uint8Array(t),n=new Array(e.length),i=0;i<e.length;i++)n[i]=String.fromCharCode(e[i]);return n.join("")}(this._bodyArrayBuffer));if(this._bodyFormData)throw new Error("could not read FormData body as text");return Promise.resolve(this._bodyText)},i.formData&&(this.formData=function(){return this.text().then(m)}),this.json=function(){return this.text().then(JSON.parse)},this}c.prototype.append=function(t,e){t=s(t),e=o(e);var n=this.map[t];this.map[t]=n?n+", "+e:e},c.prototype.delete=function(t){delete this.map[s(t)]},c.prototype.get=function(t){return t=s(t),this.has(t)?this.map[t]:null},c.prototype.has=function(t){return this.map.hasOwnProperty(s(t))},c.prototype.set=function(t,e){this.map[s(t)]=o(e)},c.prototype.forEach=function(t,e){for(var n in this.map)this.map.hasOwnProperty(n)&&t.call(e,this.map[n],n,this)},c.prototype.keys=function(){var t=[];return this.forEach(function(e,n){t.push(n)}),l(t)},c.prototype.values=function(){var t=[];return this.forEach(function(e){t.push(e)}),l(t)},c.prototype.entries=function(){var t=[];return this.forEach(function(e,n){t.push([n,e])}),l(t)},i.iterable&&(c.prototype[Symbol.iterator]=c.prototype.entries);var v=["DELETE","GET","HEAD","OPTIONS","POST","PUT"];function g(t,e){var n,i,r=(e=e||{}).body;if(t instanceof g){if(t.bodyUsed)throw new TypeError("Already read");this.url=t.url,this.credentials=t.credentials,e.headers||(this.headers=new c(t.headers)),this.method=t.method,this.mode=t.mode,this.signal=t.signal,r||null==t._bodyInit||(r=t._bodyInit,t.bodyUsed=!0)}else this.url=String(t);if(this.credentials=e.credentials||this.credentials||"same-origin",!e.headers&&this.headers||(this.headers=new c(e.headers)),this.method=(n=e.method||this.method||"GET",i=n.toUpperCase(),v.indexOf(i)>-1?i:n),this.mode=e.mode||this.mode||null,this.signal=e.signal||this.signal,this.referrer=null,("GET"===this.method||"HEAD"===this.method)&&r)throw new TypeError("Body not allowed for GET or HEAD requests");this._initBody(r)}function m(t){var e=new FormData;return t.trim().split("&").forEach(function(t){if(t){var n=t.split("="),i=n.shift().replace(/\+/g," "),r=n.join("=").replace(/\+/g," ");e.append(decodeURIComponent(i),decodeURIComponent(r))}}),e}function b(t,e){e||(e={}),this.type="default",this.status=void 0===e.status?200:e.status,this.ok=this.status>=200&&this.status<300,this.statusText="statusText"in e?e.statusText:"OK",this.headers=new c(e.headers),this.url=e.url||"",this._initBody(t)}g.prototype.clone=function(){return new g(this,{body:this._bodyInit})},p.call(g.prototype),p.call(b.prototype),b.prototype.clone=function(){return new b(this._bodyInit,{status:this.status,statusText:this.statusText,headers:new c(this.headers),url:this.url})},b.error=function(){var t=new b(null,{status:0,statusText:""});return t.type="error",t};var y=[301,302,303,307,308];b.redirect=function(t,e){if(-1===y.indexOf(e))throw new RangeError("Invalid status code");return new b(null,{status:e,headers:{location:t}})};var _=self.DOMException;try{new _}catch(t){(_=function(t,e){this.message=t,this.name=e;var n=Error(t);this.stack=n.stack}).prototype=Object.create(Error.prototype),_.prototype.constructor=_}function M(t,e){return new Promise(function(n,r){var a=new g(t,e);if(a.signal&&a.signal.aborted)return r(new _("Aborted","AbortError"));var s=new XMLHttpRequest;function o(){s.abort()}s.onload=function(){var t,e,i={status:s.status,statusText:s.statusText,headers:(t=s.getAllResponseHeaders()||"",e=new c,t.replace(/\r?\n[\t ]+/g," ").split(/\r?\n/).forEach(function(t){var n=t.split(":"),i=n.shift().trim();if(i){var r=n.join(":").trim();e.append(i,r)}}),e)};i.url="responseURL"in s?s.responseURL:i.headers.get("X-Request-URL");var r="response"in s?s.response:s.responseText;n(new b(r,i))},s.onerror=function(){r(new TypeError("Network request failed"))},s.ontimeout=function(){r(new TypeError("Network request failed"))},s.onabort=function(){r(new _("Aborted","AbortError"))},s.open(a.method,a.url,!0),"include"===a.credentials?s.withCredentials=!0:"omit"===a.credentials&&(s.withCredentials=!1),"responseType"in s&&i.blob&&(s.responseType="blob"),a.headers.forEach(function(t,e){s.setRequestHeader(e,t)}),a.signal&&(a.signal.addEventListener("abort",o),s.onreadystatechange=function(){4===s.readyState&&a.signal.removeEventListener("abort",o)}),s.send(void 0===a._bodyInit?null:a._bodyInit)})}M.polyfill=!0,self.fetch||(self.fetch=M,self.Headers=c,self.Request=g,self.Response=b)},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i=g(n(108)),r=v(n(1)),a=g(n(152)),s=g(n(31)),o=g(n(5)),l=g(n(49)),c=g(n(111)),u=g(n(50)),h=g(n(113)),d=v(n(21)),f=g(n(162)),p=n(163);function v(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n]);return e.default=t,e}function g(t){return t&&t.__esModule?t:{default:t}}var m=function t(e,n,i){var s=a.default.get(e);if(s){var o=new s(n,i);return t._instances[o._id]=o,o}r.error('Tool "'+e+'" was not found.')};m._instances={},m._globals=h.default,m.clearInstances=function(t){if(t)m._instances[t]=void 0;else{for(var e in m._instances)m._instances[e].clear();m._instances={}}};var b=(0,i.default)(n(403));r.forEach(b,function(t,e){c.default.register(e,t)});var y=(0,i.default)(n(405),1);function _(t,e,n){return function(){var i=n.apply(e,arguments);return i===e?t:i}}r.forEach(y,function(t,e){o.default.register(e,t)}),(0,i.default)(n(432)),m.helpers=(0,i.default)(n(433)),m.iconset=d,d3.rebind=function(t,e){for(var n=1,i=void 0,r=arguments.length;++n<r;)t[i=arguments[n]]=_(t,e,e[i]);return t},d3.time={},d3.time.scale=d3.scaleTime,d3.time.scale.utc=d3.scaleUtc,d3.time.format=function(t){var e=d3.timeFormat(t);return e.parse=d3.timeParse(t),e},d3.time.format.utc=function(t){var e=d3.utcFormat(t);return e.parse=d3.utcParse(t),e},d3.time.format.iso=function(t){var e=d3.isoFormat(t);return e.parse=d3.isoParse(t),e},d3.scaleGenericlog=f.default,d3.selection.prototype.onTap=p.onTap,d3.selection.prototype.onLongTap=p.onLongTap,m.Class=s.default,m.Tool=a.default,m.Component=o.default,m.Model=l.default,m.Reader=c.default,m.Events=u.default,m.utils=r,e.default=m},function(t,e){t.exports={linear:function(t,e,n,i,r){return+n+(r-t)/(e-t)*(i-n)},exp:function(t,e,n,i,r){return Math.exp((Math.log(n)*(e-r)-Math.log(i)*(t-r))/(e-t))},stepBefore:function(t,e,n,i,r){return i},stepAfter:function(t,e,n,i,r){return n},stepMiddle:function(t,e,n,i,r){return r<(t+e)/2?n:i}}},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i,r=n(31);var a=((i=r)&&i.__esModule?i:{default:i}).default.extend({init:function(){this.intervals={}},setInterval:function(t){function e(e,n,i){return t.apply(this,arguments)}return e.toString=function(){return t.toString()},e}(function(t,e,n){this.clearInterval(t),this.intervals[t]=setInterval(e,n)}),clearInterval:function(t){function e(e){return t.apply(this,arguments)}return e.toString=function(){return t.toString()},e}(function(t){t?this.intervals[t]&&(clearInterval(this.intervals[t]),delete this.intervals[t]):this.clearAllIntervals()}),clearAllIntervals:function(){for(var t in this.intervals)this.clearInterval(t)}});e.default=a},function(t,e,n){var i={"./axis":109,"./axis.js":109,"./color":153,"./color.js":153,"./data":110,"./data.js":110,"./dataconnected":57,"./dataconnected.js":57,"./entities":112,"./entities.js":112,"./group":154,"./group.js":154,"./hook":32,"./hook.js":32,"./label":155,"./label.js":155,"./locale":156,"./locale.js":156,"./marker":78,"./marker.js":78,"./side":157,"./side.js":157,"./size":158,"./size.js":158,"./stack":159,"./stack.js":159,"./time":160,"./time.js":160,"./ui":161,"./ui.js":161};function r(t){var e=a(t);return n(e)}function a(t){if(!n.o(i,t)){var e=new Error("Cannot find module '"+t+"'");throw e.code="MODULE_NOT_FOUND",e}return i[t]}r.keys=function(){return Object.keys(i)},r.resolve=a,t.exports=r,r.id=399},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.DataStorage=e.Storage=void 0;var i,r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},a=function(){function t(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}return function(e,n,i){return n&&t(e.prototype,n),i&&t(e,i),e}}(),s=function(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n]);return e.default=t,e}(n(1)),o=n(31);(i=o)&&i.__esModule;function l(t,e,n,i){return s.hashCode([t.select.key,t.where,t.from,t.join,t.dataset,t.version,t.language,e,n,i])}function c(t,e,n){var i=e[0]+" - "+e[e.length-1]+" ("+e.length+")";return n&&(i=i+"_"+n.join()),i}var u=e.Storage=function(){function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.queryIds={},this.queries={},this._collection={},this._collectionPromises={}}return a(t,[{key:"loadFromReader",value:function(t,e,n){var i=l(t,n._basepath,n._lastModified,n._name);return this.queries[i]||(this.queries[i]=this.queryQueue(n,i)),this.queries[i].getPromise(t,e)}},{key:"getDataId",value:function(t,e,n){var i=l(t,e._basepath,e._lastModified,e._name);return!!this.queries[i]&&this.queries[i].getDataId(t,n)}},{key:"queryQueue",value:function(t,e){var n=this,i=function(t,e){return 0==Object.keys(e).filter(function(n){return e[n]!==t[n]}).length&&(0==Object.keys(t).length||0!=Object.keys(e).length)};return new function(){this.readerObject=t,this.queries=[],this.query=null,this.parsers=null,this.defer={},this.getPromise=function(t,e){var n=this,a=function(n){if(0==t.select.value.filter(function(t){return-1==n.query.select.value.indexOf(t)}).length&&i(n.parsers,e))return{v:n.defer.promise}},o=!0,l=!1,c=void 0;try{for(var u,h=this.queries[Symbol.iterator]();!(o=(u=h.next()).done);o=!0){var d=a(u.value);if("object"===(void 0===d?"undefined":r(d)))return d.v}}catch(t){l=!0,c=t}finally{try{!o&&h.return&&h.return()}finally{if(l)throw c}}return this.query?(this.query.select.value=this.query.select.value?s.unique(this.query.select.value.concat(t.select.value)):[],s.extend(this.parsers,e)):(this.query=t,this.parsers=e),s.debounce(function(){n.runQuery()},10)(),this.defer.promise&&this.defer.promise instanceof Promise||(this.defer.promise=new Promise(function(t,e){n.defer.resolve=t,n.defer.reject=e})),this.defer.promise},this.runQuery=function(){this.query&&(this.queries.push(this.reader(this.query,this.parsers,this.defer)),this.query=null,this.parsers=null,this.defer={})},this.getDataId=function(t,e){var n=function(n){if((!t.select.value||0==t.select.value.filter(function(t){return-1==n.query.select.value.indexOf(t)}).length)&&i(n.parsers,e)&&n.dataId)return{v:n.dataId}},a=!0,s=!1,o=void 0;try{for(var l,c=this.queries[Symbol.iterator]();!(a=(l=c.next()).done);a=!0){var u=n(l.value);if("object"===(void 0===u?"undefined":r(u)))return u.v}}catch(t){s=!0,o=t}finally{try{!a&&c.return&&c.return()}finally{if(s)throw o}}return!1},this.reader=function(t,e,i){var r=this,a=t.grouping?s.clone(t,null,["grouping"]):t;return new function(){var o=this;this.defer=i,this.query=t,this.parsers=e,this.dataId=null;(t.select.key.includes(null)?Promise.resolve([]):r.readerObject.read(a,this.parsers)).then(function(e){o.checkQueryResponse(t,e),o.dataId=s.hashCode([a,r.readerObject._basepath]),n._collection[o.dataId]={},n._collectionPromises[o.dataId]={};var i=n._collection[o.dataId];i.data=e,i.valid={},i.nested={},i.unique={},i.timespan={},i.limits={},i.frames={},i.haveNoDataPointsPerKey={},i.query=t,o.defer.resolve(o.dataId)}).catch(function(t){o.defer.reject(t)}),this.checkQueryResponse=function(t,e){var n=this;if(0==e.length&&s.warn("Reader for data source '"+this._name+"' returned empty array for query:",JSON.stringify(t,null,2)),e.length>0){for(var i=(t.select.key||[]).concat(t.select.value||[]),r=e.length-1;r>=0;r--){for(var a=i.length-1;a>=0;a--)(e[r][i[a]]||0===e[r][i[a]])&&i.splice(a,1);if(!i.length)break}i.forEach(function(i){if(-1==t.select.key.indexOf(i))s.warn("Reader result: Column '"+i+"' is missing from '"+t.from+"' data, but it might be ok");else{s.error("Reader result: Key column '"+i+"' is missing from '"+t.from+"' response",JSON.stringify(t));var r=new Error;r.name="reader/error/keyColumnMissingInReaderResult",r.message="Reader result: Key column '"+i+"' is missing from '"+t.from+"' response",r.details=i,r.ddfql=t,n.defer.reject(r),console.log(e)}})}}}}}}},{key:"aggregateData",value:function(t,e,n,i){if(Object.keys(e.grouping).every(function(t){return 1===e.grouping[t].grouping}))return Promise.resolve(t);var r=l(e,n._basepath,n._lastModified,n._name),a=s.hashCode([e,n._basepath]);if(!this._collection[a]||this._collection[a]._queryMergeId!==r){for(var o=e.grouping=e.grouping,c=e.select.key,u=e.select.value.filter(function(t){return"measure"===i[t].concept_type}),h="datapoints"===e.from?c.concat(e.animatable):c.slice(0),d=Object.keys(o||{}).filter(function(t){return-1!==h.indexOf(t)&&-1!==c.indexOf(t)&&o[t].grouping>1}),f=d.reduce(function(t,e){return n=o[e].grouping,t[e]=function(t){return~~(+t/n)*n},t;var n},{}),p=d3.nest(),v=0;v<h.length;v++)p=p.key(function(t,e){return e?function(n){return e(n[t])}:function(e){return e[t]}}(h[v],f[h[v]]));d.length&&(p=p.rollup(function(t){var e=Object.assign({},t[0]);return d.forEach(function(t){return e[t]=f[t](e[t])}),u.forEach(function(n){return e[n]=d3.sum(t,function(t){return+t[n]})}),[e]})),this._collection[a]={},this._collectionPromises[a]={};var g=this._collection[a];g.data=s.nestArrayToValues(p.entries(this._collection[t].data)),g.valid={},g.nested={},g.unique={},g.timespan={},g.limits={},g.frames={},g.haveNoDataPointsPerKey={},g.query=e,g._queryMergeId=r}return Promise.resolve(a)}},{key:"getData",value:function(t,e,n,i){if(!e||"data"==e)return this._collection[t].data;if("query"==e)return this._collection[t].query;if(!n)return this._collection[t][e];var r="string"==typeof n?n:JSON.stringify(n);if(this._collection[t][e][r])return this._collection[t][e][r];switch(e){case"unique":this._collection[t][e][r]=this._getUnique(t,n);break;case"valid":this._collection[t][e][r]=this._getValid(t,n);break;case"timespan":this._collection[t][e][r]=this._getTimespan(t,n);break;case"limits":this._collection[t][e][r]=this._getLimits(t,n);break;case"nested":this._collection[t][e][r]=this._getNested(t,n)}return this._collection[t][e][r]}},{key:"_getTimespan",value:function(t,e){var n=this._collection[t].query.animatable,i=this._collection[t].data.filter(function(t){return t[e]||0===t[e]}).map(function(t){return t[n]});return 0==i.length&&s.warn("_getTimespan() was unable to work with an empty array of valid datapoints"),{min:d3.min(i),max:d3.max(i)}}},{key:"_getValid",value:function(t,e){return this._collection[t].data.filter(function(t){return t[e]||0===t[e]})}},{key:"_getLimits",value:function(t,e){for(var n=this._collection[t].data.reduce(function(t,n){var i=s.isDate(n[e])?n[e]:parseFloat(n[e]);return isNaN(i)||t.push(i),t},[]),i=n[0],r=i,a=Math.abs(n.find(function(t){return 0!=t})),o={},l=0;l<n.length;l+=1){var c=n[l];c<i?i=c:c>r&&(r=c),c>0&&c<a?a=c:c<0&&c>-a&&(a=-c)}return o.min=i||0,o.max=r||100,o.minAbsNear0=a||(0===i?r:i),o}},{key:"_getUnique",value:function(t,e){var n=void 0,i=this._collection[t].data;if(s.isArray(e)){var r=i.map(function(t){return s.clone(t,e)});n=s.unique(r,function(t){return JSON.stringify(t)})}else{var a=i.map(function(t){return t[e]});n=s.unique(a)}return n}},{key:"_getNested",value:function(t,e){for(var n=d3.nest(),i=0;i<e.length;i++)n=n.key(function(t){return function(e){return e[t]}}(e[i]));return s.nestArrayToObjWithFlatKeys(n.entries(this._collection[t].data))}},{key:"getFrames",value:function(t,e,n,i){var r=this,a=c(0,e,n);return this._collectionPromises[t][a]||(this._collectionPromises[t][a]={queue:this.framesQueue(e,a),promise:null}),this._collectionPromises[t][a]&&this._collectionPromises[t][a].promise instanceof Promise?this._collectionPromises[t][a].promise:(this._collectionPromises[t][a].promise=new Promise(function(o,l){t||l(s.warn("Data.js 'get' method doesn't like the dataId you gave it: "+t)),r._getFrames(t,a,e,n,i).then(function(e){r._collection[t].frames[a]=e,o(r._collection[t].frames[a])})}),this._collectionPromises[t][a].promise)}},{key:"getFrame",value:function(t,e,n,i){var r=this,a=c(0,e,i);return new Promise(function(e,i){r._collection[t].frames[a]&&r._collection[t].frames[a][n]?e(r._collection[t].frames[a]):r._collectionPromises[t][a].queue.forceFrame(n,function(){e(r._collection[t].frames[a])})})}},{key:"listenFrame",value:function(t,e,n,i){var r=c(0,e,n);if(this._collectionPromises[t][r].queue.defaultCallbacks.push(function(e){i(t,e)}),this._collection[t].frames[r]){var a=e.reduce(function(t,e){return t[e]=e,t},{});s.forEach(this._collection[t].frames[r],function(e,n){i(t,a[n])})}}},{key:"_muteAllQueues",value:function(t){s.forEach(this._collectionPromises,function(e,n){s.forEach(e,function(e,n){1==e.queue.isActive&&e.queue.whatId!=t&&e.queue.mute()})})}},{key:"_checkForcedQueuesExists",value:function(){s.forEach(this._collectionPromises,function(t,e){s.forEach(t,function(t,e){t.queue.forcedQueue.length>0&&t.queue.unMute()})})}},{key:"_unmuteQueue",value:function(){s.forEach(this._collectionPromises,function(t,e){s.forEach(t,function(t,e){0==t.queue.isActive&&t.queue.unMute()})})}},{key:"framesQueue",value:function(t,e){var n=this;return new function(){this.defaultCallbacks=[],this.callbacks={},this.forcedQueue=[],this.isActive=!0,this.delayedAction=null,this.whatId=e,this.queue=t.slice(0);var i=this;this.queue.splice(0,0,this.queue.splice(this.queue.length-1,1)[0]),this.key=0,this.mute=function(){this.isActive=!1,this.delayedAction=Promise.resolve.bind(Promise)},this.unMute=function(){this.isActive=!0,"function"==typeof this.delayedAction&&this.delayedAction(),this.delayedAction=null,0==this.forcedQueue.length&&0==this.queue.length&&n._unmuteQueue()},this.frameComplete=function(t){var e=void 0;if(i.defaultCallbacks.length>0)for(e=0;e<i.defaultCallbacks.length;e++)i.defaultCallbacks[e](t);if(i.callbacks[t]&&i.callbacks[t].length>0)for(e=0;e<i.callbacks[t].length;e++)i.callbacks[t][e]()},this._waitingForActivation=function(){var t=this;return new Promise(function(e,n){if(t.isActive)return e();t.delayedAction=e})},this._getNextFrameName=function(){var t=null;return this.forcedQueue.length>0||this.queue.length>0?this.forcedQueue.length>0?t=this.forcedQueue.shift():(0==this.forcedQueue.length&&this.key>=this.queue.length-1&&(this.key=0),t=this.queue.splice(this.key,1).pop()):n._unmuteQueue(),t},this.checkForcedFrames=function(){this.forcedQueue.length>0||n._checkForcedQueuesExists()},this.getNext=function(){var t=this;return new Promise(function(e,n){t.checkForcedFrames(),t.isActive?e(t._getNextFrameName()):t._waitingForActivation().then(function(){e(t._getNextFrameName())})})},this.forceFrame=function(t,e){if(this.callbacks[t])this.callbacks[t].push(e);else{var i=function(t,e){for(var n=e.toString(),i=-1,r=0,a=t.length;r<a;r++)if(t[r].toString()==n){i=r;break}return i}(this.queue,t);-1!==i?(this.forcedQueue.unshift(this.queue.splice(i,1).pop()),n._muteAllQueues(this.whatId),this.unMute(),"function"==typeof e&&("object"!==r(this.callbacks[t])&&(this.callbacks[t]=[]),this.callbacks[t].push(e)),this.key=i):"object"===r(this.callbacks[t])?this.callbacks[t].push(e):this.callbacks[t]=[e]}}}}},{key:"_getFrames",value:function(t,e,n,i,r){var a=this;return a._collection[t].frames[e]||(a._collection[t].frames[e]={}),new Promise(function(o,l){r||s.warn("_getFrames in data.js is missing indicatorsDB, it's needed for gap filling"),n||s.warn("_getFrames in data.js is missing framesArray, it's needed so much");var c=a._collection[t].query.animatable,u=a._collection[t].query.select.key.slice(0);c&&-1!=u.indexOf(c)&&u.splice(u.indexOf(c),1);var h={},d=void 0,f=void 0,p=void 0,v=void 0,g=void 0,m=a.getData(t,"nested",u.concat([c]),r),b=Object.keys(m);i=i||b.map(function(t){return JSON.parse(t).join(",")});var y=a._collection[t].query,_=y.select.value.filter(function(t){return"_default"!==t}),M=_.length,w=void 0,x=void 0,S=void 0,z=void 0,O=void 0;for(S=0;S<i.length;S++)for(h[i[S]]={},O=0;O<M;O++)h[i[S]][_[O]]=null;for(O=0;O<M;O++)a._collection[t].haveNoDataPointsPerKey[_[O]]={};a._collectionPromises[t][e].queue.getNext().then(function(n){n&&function t(n,i,l,k){var E={};if("datapoints"!==y.from){var T=a._collection[l].data;for(O=0;O<M;O++)E[_[O]]={};for(var P=0;P<T.length;P++){var A=T[P];for(O=0;O<M;O++)E[_[O]][A[u[0]]]=A[_[O]],null==A[_[O]]&&(a._collection[l].haveNoDataPointsPerKey[_[O]][JSON.stringify([A[u[0]]])]=T.length)}}else{for(O=0;O<M;O++)E[_[O]]={};for(S=0;S<i.length;S++)for(w=i[S],x=b[S],O=0;O<M;O++)if(z=_[O],v=r[z]?r[z].interpolation:null,m[x]&&m[x][n]&&(m[x][n][0][z]||0===m[x][n][0][z]))E[z][w]=m[x][n][0][z];else if("none"===v||!1===y.gapfill)E[z][w]=null;else{if(null===(d=h[w][z])){var C=Object.keys(m[x]);d=new Array(C.length),f=0;for(var L=0,D=C.length;L<D;L++)((p=m[x][C[L]])[0][z]||0===p[0][z])&&(d[f++]=p[0]);d.length=f,h[w][z]=0===f?[]:d,0==d.length&&(a._collection[l].haveNoDataPointsPerKey[z][x]=d.length)}d&&d.length>0&&(g=null,E[z][w]=s.interpolatePoint(d,void 0,z,g,c,n,v))}}a._collection[l].frames[e][n]=E,"function"==typeof k&&k(n),a._collectionPromises[l][e].queue.getNext().then(function(n){n?s.defer(function(){t(n,i,l,a._collectionPromises[l][e].queue.frameComplete)}):o(a._collection[l].frames[e])})}(n,i,t,a._collectionPromises[t][e].queue.frameComplete)})})}}]),t}();e.DataStorage=new u},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i=function(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n]);return e.default=t,e}(n(1));function r(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}var a={model:null,dimensionModels:new Map,updateDimensionModels:function(){var t=this;this.dimensionModels.clear(),i.forEach(this.model.state._data,function(e,n){void 0!==e.dim&&t.dimensionModels.set(n,e)})},getDimensionModelsForSpace:function(t,e){var n=this;this.updateDimensionModels();var i=[],a=Object.keys(t).reduce(function(n,r){return"entities"==t[r]._type&&(e.includes(t[r].dim)?n[t[r].dim]=r:i.push(r)),n},{});return e.map(function(e,s){var o=void 0;if(n.model.dataManager.isConceptType(e,"time"))t[o="time"].dim=e;else{if(a[e])return a[e];if(void 0!==(o=i.shift()))t[o].setDimension(e);else{var l=r({},o="entities_"+e,{dim:e});n.model.state.set(l)}}return o})}};e.default=function(t){var e=Object.create(a);return e.model=t,e}},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i=function(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n]);return e.default=t,e}(n(1));var r={model:null,dataModels:new Map,getDataModels:function(){return this.updateDataModels(),this.dataModels},updateDataModels:function(){var t=this;this.dataModels.clear(),i.forEach(this.model._data,function(e,n){"data"==e._type&&t.dataModels.set(n,e)})},isConceptType:function(t,e){this.updateDataModels();var n=!0,i=!1,r=void 0;try{for(var a,s=this.dataModels.values()[Symbol.iterator]();!(n=(a=s.next()).done);n=!0){var o=a.value;if(o.conceptDictionary[t]&&o.conceptDictionary[t].concept_type==e)return!0}}catch(t){i=!0,r=t}finally{try{!n&&s.return&&s.return()}finally{if(i)throw r}}return!1},getConceptProperty:function(t,e){this.updateDataModels();var n=!0,i=!1,r=void 0;try{for(var a,s=this.dataModels.values()[Symbol.iterator]();!(n=(a=s.next()).done);n=!0){var o=a.value.getConceptprops(t);if(o&&o[e])return o[e]}}catch(t){i=!0,r=t}finally{try{!n&&s.return&&s.return()}finally{if(i)throw r}}return"Concept not found"},getCollectionFromKey:function(t){return t.length>1?"datapoints":"concept"==t[0]?"concepts":"entities"},getAvailabilityForMarkerKey:function(t){var e=this,n=new Map,i=function(t,i){var r=e.createKeyString(["key","value"],t),a=i.getConceptprops();n.set(r,{key:t.key.map(function(t){return a[t]}),value:a[t.value],dataSource:i})},r=function(e){e.dataAvailability.datapoints.forEach(function(n){t.length==n.key.size&&t.every(function(t){return n.key.has(t)})&&i({key:Array.from(n.key),value:n.value},e)}),e.dataAvailability.entities.forEach(function(n){null!=n.value&&t.forEach(function(t){n.key.has(t)&&-1===n.value.indexOf("is--")&&i({key:[t],value:n.value},e)})})},a=!0,s=!1,o=void 0;try{for(var l,c=this.dataModels.values()[Symbol.iterator]();!(a=(l=c.next()).done);a=!0){r(l.value)}}catch(t){s=!0,o=t}finally{try{!a&&c.return&&c.return()}finally{if(s)throw o}}return Array.from(n.values())},getAvailableDataForKey:function(t){var e=arguments.length>1&&void 0!==arguments[1]&&arguments[1];this.updateDataModels(),Array.isArray(t)||(t=[t]);var n=this.getCollectionFromKey(t),i=[],r=!0,a=!1,s=void 0;try{for(var o,l=this.dataModels.values()[Symbol.iterator]();!(r=(o=l.next()).done);r=!0){var c=o.value,u=function(n,r){n.size!==t.length||!t.every(function(t){return n.has(t)})||e&&r!==e||i.push({data:c._name,key:t,value:r})},h=!0,d=!1,f=void 0;try{for(var p,v=((c.dataAvailability||{})[n]||[])[Symbol.iterator]();!(h=(p=v.next()).done);h=!0){var g=p.value;u(g.key,g.value)}}catch(t){d=!0,f=t}finally{try{!h&&v.return&&v.return()}finally{if(d)throw f}}}}catch(t){a=!0,s=t}finally{try{!r&&l.return&&l.return()}finally{if(a)throw s}}return i},getDimensionValues:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},i=Object.assign({select:{key:[t],value:e},from:"entities"},n);return Promise.all([].concat(function(t){if(Array.isArray(t)){for(var e=0,n=Array(t.length);e<t.length;e++)n[e]=t[e];return n}return Array.from(t)}(this.getDataModels().values())).filter(function(e){return e.getConceptprops(t)}).map(function(t){return t.load(i,void 0,!0).then(function(e){return t.getData(e).map(function(e){return e.dataSourceName=t._name,e})})}))},getTags:function(t){var e=this;return this.getDimensionValues("tag",["name","parent"],{language:t}).then(function(t){return e.mergeResults(t,["tag"])})},concatResults:function(t){return t.reduce(function(t,e){return t.concat(e)})},mergeResults:function(t,e){var n=this,i=new Map;return t.forEach(function(t){t.forEach(function(t){var r=n.createKeyString(e,t);i.has(r)||i.set(r,t)})}),Array.from(i.values())},createKeyString:function(t,e){return t.map(function(t){return e[t]}).join(",")}};e.default=function(t){var e=Object.create(r);return e.model=t,e}},function(t,e,n){var i={"./inline/inline.js":404};function r(t){var e=a(t);return n(e)}function a(t){if(!n.o(i,t)){var e=new Error("Cannot find module '"+t+"'");throw e.code="MODULE_NOT_FOUND",e}return i[t]}r.keys=function(){return Object.keys(i)},r.resolve=a,t.exports=r,r.id=403},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i,r=n(111);var a=((i=r)&&i.__esModule?i:{default:i}).default.extend({_name:"inline",init:function(t){this._data=t.data||[{}]},load:function(){return Promise.resolve({columns:Object.keys(this._data[0]),rows:this._data})},versionInfo:{version:"0.40.14",build:1551875890651}});e.default=a},function(t,e,n){var i={"./brushslider/brushslider.js":79,"./brushslider/bubblesize/bubblesize.js":164,"./brushslider/singlehandleslider/singlehandleslider.js":63,"./brushslider/sizeslider/sizeslider.js":165,"./buttonlist/buttonlist.js":166,"./buttonlist/optionsbuttonlist/optionsbuttonlist.js":167,"./colorlegend/colorlegend.js":168,"./datanotes/datanotes.js":407,"./datawarning/datawarning.js":408,"./dialogs/_dialog.js":12,"./dialogs/about/about.js":171,"./dialogs/axes/axes.js":172,"./dialogs/colors/colors.js":174,"./dialogs/dialogs.js":175,"./dialogs/find/find.js":176,"./dialogs/find/show.js":115,"./dialogs/grouping/grouping.js":177,"./dialogs/label/label.js":178,"./dialogs/moreoptions/moreoptions.js":179,"./dialogs/opacity/opacity.js":180,"./dialogs/presentation/presentation.js":181,"./dialogs/side/side.js":182,"./dialogs/size/size.js":183,"./dialogs/speed/speed.js":184,"./dialogs/stack/stack.js":185,"./dialogs/technical/technical.js":187,"./dialogs/timedisplay/timedisplay.js":188,"./dialogs/zoom/zoom.js":190,"./draggablelist/draggablelist.js":186,"./indicatorpicker/indicatorpicker.js":51,"./minmaxinputs/minmaxinputs.js":173,"./simplecheckbox/simplecheckbox.js":52,"./steppedspeedslider/steppedspeedslider.js":427,"./timeslider/timeslider.js":429,"./treemenu/treemenu.js":431,"./zoombuttonlist/zoombuttonlist.js":191};function r(t){var e=a(t);return n(e)}function a(t){if(!n.o(i,t)){var e=new Error("Cannot find module '"+t+"'");throw e.code="MODULE_NOT_FOUND",e}return i[t]}r.keys=function(){return Object.keys(i)},r.resolve=a,t.exports=r,r.id=405},function(t,e){t.exports='<div class="vzb-slider-holder">\n\t<svg class="vzb-slider-svg">\n\t\t<g class="vzb-slider-wrap">\n\t\t\t<g class="vzb-slider">\n\t\t\t</g>\n\t\t</g>\n\t</svg>\n</div>\n'},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i,r=function(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n]);return e.default=t,e}(n(1)),a=n(5),s=(i=a)&&i.__esModule?i:{default:i},o=n(21);var l=s.default.extend({init:function(t,e){var n=this;this.name="gapminder-datanotes",this.model_expects=[{name:"marker",type:"marker"},{name:"locale",type:"locale"}],this.context=e,this.model_binds={"translate:locale":function(t){n._ready&&n._readyOnce&&n.ready()}},this._super(t,e),this.close=this.close.bind(this),this.hidden=!0,this.showNotes=!1,this.pinned=!1,this.left=0,this.top=0,this.hookName=null,this.newHookName=null},ready:function(){this.setValues()},readyOnce:function(){var t=this;this.translator=this.model.locale.getTFunction(),this.element=d3.select(this.placeholder),this.element.selectAll("div").remove();var e=this.element;e.append("div").html(o.close).on("click",function(){d3.event.stopPropagation(),t.close()}).select("svg").attr("width","0px").attr("height","0px").attr("class","vzb-data-notes-close").classed("vzb-hidden",!0),e.append("div").attr("class","vzb-data-notes-body vzb-dialog-scrollable"),e.append("div").attr("class","vzb-data-notes-link")},resize:function(){this.close()},close:function(){this.hidden||this.pin(!1).hide()},setHook:function(t){return this._readyOnce?this.pinned?(this.newHookName=t,this):(this.hookName&&this.model.marker[this.hookName].off("change:which",this.close),this.hookName=this.newHookName=t,this.model.marker[this.hookName].on("change:which",this.close),this.setValues(),this):this},setValues:function(){if(this.hookName){var t=this.model.marker[this.hookName].getConceptprops();if(this.element.select(".vzb-data-notes-body").classed("vzb-hidden",!t.description).text(r.replaceNumberSpacesToNonBreak(t.description)||""),this.element.select(".vzb-data-notes-link").classed("vzb-hidden",!t.sourceLink),t.sourceLink){var e=this.translator("hints/source"),n=t.sourceName||"";this.element.select(".vzb-data-notes-link").html("<span>"+(n?e+": ":"")+'<a href="'+r.normaliseLink(t.sourceLink)+'" target="_blank">'+(n||e)+"</a></span>")}this.showNotes=t.sourceLink||t.description}},setPos:function(t,e,n){if(this.left=t,this.top=e,this.pinned&&!n)return this;var i=this.parent.element.offsetHeight,r=this.element.node().offsetWidth,a=this.element.node().offsetHeight,s=void 0,o=void 0,l=this.left-r,c=this.top;return l<10&&(l=10,s=!0),c+a+10>i&&(c=i-a-10,o=!0),s&&o&&(c=this.top-a-30),this.element.style("top",c+"px"),this.element.style("left",l+"px"),this},pin:function(t){return this.hidden?this:(this.pinned=!this.pinned,null!=t&&(this.pinned=t),this.element.select(".vzb-data-notes-close").classed("vzb-hidden",!this.pinned),this.element.classed("vzb-data-notes-pinned",this.pinned),this.hookName!=this.newHookName&&this.setHook(this.newHookName),this.element.select(".vzb-data-notes-body").node().scrollTop=0,this.showNotes?this.setPos(this.left,this.top,!0):this.hide())},toggle:function(t){return this.pinned||!this.hookName?this:(null==t&&(t=!this.hidden),this.hidden=t,this.element.classed("vzb-hidden",this.hidden||!this.showNotes),this)},show:function(){return this.toggle(!1)},hide:function(){return this.toggle(!0)}});e.default=l},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});!function(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n]);e.default=t}(n(1));var i,r=n(5),a=(i=r)&&i.__esModule?i:{default:i},s=n(21);var o=!0,l=a.default.extend({init:function(t,e){var n=this;this.name="gapminder-datawarning",this.model_expects=[{name:"locale",type:"locale"}],this.context=e,this.model_binds={"translate:locale":function(t){n._ready&&n.redraw()}},this._super(t,e)},ready:function(){this.redraw()},readyOnce:function(){var t=this;this.element=d3.select(this.placeholder),this.element.selectAll("div").remove(),this.element.append("div").attr("class","vzb-data-warning-background").on("click",function(){t.toggle(!0)}),this.container=this.element.append("div").attr("class","vzb-data-warning-box"),this.container.append("div").html(s.close).on("click",function(){t.toggle()}).select("svg").attr("width","0px").attr("height","0px").attr("class","vzb-data-warning-close"),this.container.append("div").attr("class","vzb-data-warning-link").html(s.warn).append("div"),this.container.append("div").attr("class","vzb-data-warning-title"),this.container.append("div").attr("class","vzb-data-warning-body vzb-dialog-scrollable")},redraw:function(){this.translator=this.model.locale.getTFunction(),this.container.select(".vzb-data-warning-link div").text(this.translator("hints/dataWarning"));var t=this.translator("datawarning/title/"+this.parent.name);this.container.select(".vzb-data-warning-title").html(t).classed("vzb-hidden",!t||t=="datawarning/title/"+this.parent.name),this.container.select(".vzb-data-warning-body").html(this.translator("datawarning/body/"+this.parent.name))},toggle:function(t){null==t&&(t=!o),o=t,this.element.classed("vzb-hidden",o);var e=this;this.parent.components.forEach(function(t){t.element.classed("vzb-blur",t!=e&&!o)})}});e.default=l},function(t,e,n){var i={"./about/about.html":410,"./axes/axes.html":411,"./colors/colors.html":412,"./find/find.html":413,"./find/show.html":170,"./grouping/grouping.html":414,"./label/label.html":415,"./moreoptions/moreoptions.html":416,"./opacity/opacity.html":417,"./presentation/presentation.html":418,"./side/side.html":419,"./size/size.html":420,"./speed/speed.html":421,"./stack/stack.html":422,"./technical/technical.html":423,"./timedisplay/timedisplay.html":424,"./zoom/zoom.html":425};function r(t){var e=a(t);return n(e)}function a(t){if(!n.o(i,t)){var e=new Error("Cannot find module '"+t+"'");throw e.code="MODULE_NOT_FOUND",e}return i[t]}r.keys=function(){return Object.keys(i)},r.resolve=a,t.exports=r,r.id=409},function(t,e){t.exports='<div class=\'vzb-dialog-modal\'>\n  <div class="vzb-dialog-title"> \n      <%=t ("buttons/about") %>\n  </div>\n      \n  <div class="vzb-dialog-content">\n      <p class="vzb-about-text0"></p>\n      <p class="vzb-about-text1"></p>\n      <br/>\n      <p class="vzb-about-version"></p>\n      <p class="vzb-about-updated"></p>\n      <br/>\n      <p class="vzb-about-report"></p>\n      <br/>\n      <p class="vzb-about-credits"></p>\n      <br/>\n      <p class="vzb-about-tool"></p>\n      <br/>\n      <p class="vzb-about-datasets"><span>Datasets:</span></p>\n      <br/>\n      <p class="vzb-about-readers"><span>Readers:</span></p>\n  </div>\n      \n  <div class="vzb-dialog-buttons">\n    <div data-click="closeDialog" class="vzb-dialog-button vzb-label-primary">\n      <%=t ("buttons/ok") %>\n    </div>\n  </div>\n      \n\n</div>\n'},function(t,e){t.exports='<div class=\'vzb-dialog-modal\'>\n    <span class="thumb-tack-class thumb-tack-class-ico-pin fa" data-dialogtype="axes" data-click="pinDialog"></span>\n    <span class="thumb-tack-class thumb-tack-class-ico-drag fa" data-dialogtype="axes" data-click="dragDialog"></span>\n    <div class="vzb-dialog-title"><%=t ("buttons/axes") %></div>\n    <div class="vzb-dialog-content">\n      <p class="vzb-dialog-sublabel"> <%=t ("buttons/axis_x") %> <span class="vzb-xaxis-selector"></span> </p>\n      <div class="vzb-xaxis-minmax vzb-dialog-paragraph"></div>\n      <p class="vzb-dialog-sublabel"> <%=t ("buttons/axis_y") %> <span class="vzb-yaxis-selector"></span> </p>\n      <div class="vzb-yaxis-minmax vzb-dialog-paragraph"></div>\n    </div>\n    <div class="vzb-dialog-buttons">\n      <div data-click="closeDialog" class="vzb-dialog-button vzb-label-primary"><%=t ( "buttons/ok") %></div>\n    </div>\n</div>'},function(t,e){t.exports='<div class=\'vzb-dialog-modal\'>\n  <span class="thumb-tack-class thumb-tack-class-ico-pin fa" data-dialogtype="colors" data-click="pinDialog"></span>\n  <span class="thumb-tack-class thumb-tack-class-ico-drag fa" data-dialogtype="colors" data-click="dragDialog"></span>\n  \n  <div class="vzb-dialog-title">\n      <%=t ("buttons/colors") %>\n      <span class="vzb-caxis-selector"></span>\n  </div>\n  \n  \n  \n  <div class="vzb-dialog-content vzb-dialog-scrollable">\n    <div class="vzb-clegend-container"></div>\n  </div>\n\n  <div class="vzb-dialog-buttons">\n    <div data-click="closeDialog" class="vzb-dialog-button vzb-label-primary">\n      <%=t ("buttons/ok") %>\n    </div>\n  </div>\n\n</div>\n'},function(t,e){t.exports='<div class=\'vzb-dialog-modal\'>\n  <span class="thumb-tack-class thumb-tack-class-ico-pin fa" data-dialogtype="find" data-click="pinDialog"></span>\n  <span class="thumb-tack-class thumb-tack-class-ico-drag fa" data-dialogtype="find" data-click="dragDialog"></span>\n  <div class="vzb-dialog-title">\n    <label class="vzb-dialog-title-switch">\n      <input type="checkbox">\n      <span class="vzb-switch-slider round"></span>\n      <span class="vzb-switch-off"><%=t ("dialogs/find") %></span>\n      <span class="vzb-switch-on"><%=t ("buttons/show") %></span>\n    </label>\n    <span class="vzb-dialog-content vzb-find-filter">\n      <form novalidate>\n        <input class="vzb-find-search" type="search" required/>\n        <button class="vzb-cancel-button" type="reset"></button>\n      </form>\n    </span>\n    <span class="vzb-find-filter-selector"></span>\n  </div>\n  \n  <div class="vzb-dialog-content vzb-dialog-content-fixed vzb-dialog-scrollable">\n      <div class="vzb-dialog-content vzb-dialog-scrollable vzb-dialog-panel vzb-dialog-panel-find vzb-active">\n        <div class="vzb-find-list">\n          \x3c!-- list will be placed here --\x3e\n        </div>\n      </div>\n\n      <div class="vzb-dialog-content vzb-dialog-scrollable vzb-dialog-panel vzb-dialog-panel-show">\n      </div>\n  </div>\n\n  <div class="vzb-dialog-buttons">\n    <div class="vzb-dialog-bubbleopacity vzb-dialog-control" data-panel="find"></div>\n    <div class="vzb-dialog-button vzb-find-deselect" data-panel="find">\n      <%=t ("buttons/deselect") %>\n    </div>\n    <div class="vzb-dialog-button vzb-show-deselect" data-panel="show">\n      <%=t ("buttons/reset") %>\n    </div>\n    <div class="vzb-dialog-button vzb-show-apply" data-panel="show">\n      <%=t ("buttons/apply") %>\n    </div>\n      \n    <div data-dialogtype="find" data-click="closeDialog" class="vzb-dialog-button vzb-label-primary">\n      <%=t ("buttons/ok") %>\n    </div>\n  </div>  \n\n</div>\n'},function(t,e){t.exports='<div class=\'vzb-dialog-modal\'>\n  <div class="vzb-dialog-title"> \n      <%=t ("buttons/grouping") %>\n  </div>\n      \n  <div class="vzb-dialog-content">\n    <div class="vzb-dialog-groups"></div>\n    <div class="vzb-dialog-placeholder"></div>\n  </div>\n\n  <div class="vzb-dialog-buttons">\n    <div data-click="closeDialog" class="vzb-dialog-button vzb-label-primary">\n      <%=t ("buttons/ok") %>\n    </div>\n  </div>\n</div>\n'},function(t,e){t.exports='<div class=\'vzb-dialog-modal\'>\n  <span class="thumb-tack-class thumb-tack-class-ico-pin fa" data-dialogtype="label" data-click="pinDialog"></span>\n  <span class="thumb-tack-class thumb-tack-class-ico-drag fa" data-dialogtype="label" data-click="dragDialog"></span>\n  <div class="vzb-dialog-title"> \n      <%=t ("buttons/label") %>\n  </div>\n      \n      \n  <div class="vzb-dialog-content">\n    <span class="vzb-saxis-selector"></span>\n    <div class="vzb-dialog-sizeslider"></div>\n    <div class="vzb-removelabelbox-switch"></div>\n  </div>\n\n  <div class="vzb-dialog-buttons">\n    <div data-click="closeDialog" class="vzb-dialog-button vzb-label-primary">\n      <%=t ("buttons/ok") %>\n    </div>\n  </div>\n\n</div>\n'},function(t,e){t.exports='<div class=\'vzb-dialog-modal\'>\n  <span class="thumb-tack-class thumb-tack-class-ico-pin fa" data-dialogtype="moreoptions" data-click="pinDialog"></span>\n  <span class="thumb-tack-class thumb-tack-class-ico-drag fa" data-dialogtype="moreoptions" data-click="dragDialog"></span>\n\n\n  <div class="vzb-dialog-title">\n    <%=t ("buttons/more_options") %>\n  </div>\n\n  <div class="vzb-dialog-content vzb-dialog-scrollable">\n    <div class=\'vzb-dialog-options-buttonlist\'>\n    </div>\n    <div class="vzb-accordion">\n    </div>\n  </div>\n\n  <div class="vzb-dialog-buttons">\n    <div data-click="closeDialog" class="vzb-dialog-button vzb-label-primary">\n      <%=t ("buttons/ok") %>\n    </div>\n  </div>\n\n</div>'},function(t,e){t.exports='<div class=\'vzb-dialog-modal\'>\n  <div class="vzb-dialog-title"> \n      <%=t ("buttons/opacity") %>\n  </div>\n      \n  <div class="vzb-dialog-content">\n      <p class="vzb-dialog-sublabel">\n        <%=t ("buttons/opacityRegular") %>\n      </p>\n      <div class="vzb-dialog-bubbleopacity-regular"></div>\n\n      <p class="vzb-dialog-sublabel">\n        <%=t ("buttons/opacityNonselect") %>\n      </p>\n      <div class="vzb-dialog-bubbleopacity-selectdim"></div>\n    </div>\n  </div>\n\n</div>\n'},function(t,e){t.exports='<div class=\'vzb-dialog-modal\'>\n  <div class="vzb-dialog-title"> \n      <%=t ("dialogs/presentation") %>\n  </div>\n      \n  <div class="vzb-dialog-content">\n      <div class="vzb-presentationmode-switch"></div>\n      <div class="vzb-decorations-switch"></div>\n  </div>\n\n</div>\n'},function(t,e){t.exports='<div class=\'vzb-dialog-modal\'>\n  <span class="thumb-tack-class thumb-tack-class-ico-pin fa" data-dialogtype="side" data-click="pinDialog"></span>\n  <span class="thumb-tack-class thumb-tack-class-ico-drag fa" data-dialogtype="side" data-click="dragDialog"></span>\n  <div class="vzb-dialog-title">\n    <%=t ("buttons/side") %>\n    <span class="vzb-side-selector"></span>\n  </div>\n  \n  <div class="vzb-dialog-content vzb-dialog-scrollable">\n    <div class="vzb-side-list vzb-side-list-left">\n      \x3c!-- list will be placed here --\x3e\n    </div>\n    <div class="vzb-side-list vzb-side-list-right">\n      \x3c!-- list will be placed here --\x3e\n    </div>\n  </div>\n\n  <div class="vzb-dialog-buttons">\n    <div class="vzb-dialog-button vzb-label-primary vzb-side-switch-sides">\n      <%=t ("buttons/leftright") %>\n    </div>\n\n    <div data-click="closeDialog" class="vzb-dialog-button vzb-label-primary">\n      <%=t ("buttons/ok") %>\n    </div>\n  </div>\n\n</div>\n'},function(t,e){t.exports='<div class=\'vzb-dialog-modal\'>\n  <span class="thumb-tack-class thumb-tack-class-ico-pin fa" data-dialogtype="size" data-click="pinDialog"></span>\n  <span class="thumb-tack-class thumb-tack-class-ico-drag fa" data-dialogtype="size" data-click="dragDialog"></span>\n  <div class="vzb-dialog-title"> \n      <%=t ("buttons/size") %>\n      <span class="vzb-saxis-selector"></span>\n  </div>\n      \n      \n  <div class="vzb-dialog-content">\n    <div class="vzb-dialog-bubblesize"></div>\n    <span class="vzb-dialog-subtitle">teststs</span>\n  </div>\n\n  <div class="vzb-dialog-buttons">\n    <div data-click="closeDialog" class="vzb-dialog-button vzb-label-primary">\n      <%=t ("buttons/ok") %>\n    </div>\n  </div>\n\n</div>\n'},function(t,e){t.exports='<div class=\'vzb-dialog-modal\'>\n  <div class="vzb-dialog-title"> \n      <%=t ("buttons/time") %>\n  </div>\n      \n  <div class="vzb-dialog-content">\n    <p class="vzb-dialog-sublabel"><%=t ("hints/speed") %></p>\n      \n    <form class="vzb-dialog-paragraph">\n      <div class="vzb-speed-slider"></div>\n    </form>\n    \n    <p class="vzb-dialog-sublabel"><%=t ("hints/forecastoptions") %></p>\n    <form class="vzb-dialog-paragraph">\n      <div class="vzb-showforecast-switch"></div>\n      <div class="vzb-pausebeforeforecast-switch"></div>\n      <div class="vzb-showstripedpatternwhenforecast-switch"></div>\n      <div>\n        <span><%=t ("hints/endbeforeforecast") %></span>\n        <input type="text" class="vzb-endbeforeforecast-field" name="endbeforeforecast"/>\n      </div>\n      <div>\n        <span class="vzb-timeformatexample-hint"><%=t ("hints/timeformatexample") %>:</span>\n        <span class="vzb-timeformatexample-label"></span>\n      </div>\n    </form>\n  </div>\n</div>\n'},function(t,e){t.exports='<div class=\'vzb-dialog-modal\'>\n    <span class="thumb-tack-class thumb-tack-class-ico-pin fa" data-dialogtype="stack" data-click="pinDialog"></span>\n    <span class="thumb-tack-class thumb-tack-class-ico-drag fa" data-dialogtype="stack" data-click="dragDialog"></span>\n    <div class="vzb-dialog-title"><%=t ("buttons/stack") %></div>\n        \n    <div class="vzb-dialog-content vzb-dialog-scrollable">\n        \n        \x3c!--p class="vzb-dialog-sublabel"> <%=t ( "hints/mount/howtostack") %></p--\x3e\n        <form class="vzb-howtostack vzb-dialog-paragraph">\n            <label> <input type="radio" name="stack" value="none"> <%=t ("mount/stacking/none") %> </label>\n            <label> <input type="radio" name="stack" value="bycolor"> <%=t ("mount/stacking/color") %> </label>\n            <label> <input type="radio" name="stack" value="all"> <%=t ("mount/stacking/world") %> </label>\n        </form>\n        \n        <form class="vzb-howtomerge vzb-dialog-paragraph">\n            <p class="vzb-dialog-sublabel"> <%=t ("hints/mount/howtomerge") %> </p>\n            <label> <input type="radio" name="merge" value="none"> <%=t ("mount/merging/none") %> </label>\n            <label> <input type="radio" name="merge" value="grouped"> <%=t ("mount/merging/color") %> </label>\n            <label> <input type="radio" name="merge" value="stacked"> <%=t ("mount/merging/world") %> </label>\n        </form>\n        \n        <form class="vzb-manual-sorting">\n            <p class="vzb-dialog-sublabel"> <%=t ("mount/manualSorting") %> </p>\n            <div class="vzb-dialog-draggablelist vzb-dialog-control"></div>\n        </form>\n                \n    </div>\n\n    <div class="vzb-dialog-buttons">\n        <div data-click="closeDialog" class="vzb-dialog-button vzb-label-primary"><%=t ("buttons/ok") %></div>\n    </div>\n\n</div>'},function(t,e){t.exports='<div class=\'vzb-dialog-modal\'>\n  <div class="vzb-dialog-title"> \n      <%=t ("dialogs/technical") %>\n  </div>\n      \n  <div class="vzb-dialog-content">\n      <div class="vzb-advancedshowandselect-switch"></div>\n  </div>\n\n</div>\n'},function(t,e){t.exports='<div class="vzb-dialog-modal">\n  <div class="vzb-dialog-content vzb-dialog-content-fixed">\n    <svg>\n      <g class="vzb-timedisplay"></g>\n    </svg>\n  </div>\n  <div class="vzb-dialog-buttons"></div>\n</div>\n'},function(t,e){t.exports='<div class=\'vzb-dialog-modal\'>\n  <span class="thumb-tack-class thumb-tack-class-ico-pin fa" data-dialogtype="label" data-click="pinDialog"></span>\n  <span class="thumb-tack-class thumb-tack-class-ico-drag fa" data-dialogtype="label" data-click="dragDialog"></span>\n  <div class="vzb-dialog-title"> \n    <%=t ("buttons/zoom") %>\n    <div class="vzb-dialog-zoom-buttonlist"></div>\n  </div>\n      \n      \n  <div class="vzb-dialog-content">\n    <div class="vzb-panwitharrow-switch"></div>\n    <div class="vzb-zoomonscrolling-switch"></div>\n    <div class="vzb-adaptminmaxzoom-switch"></div>\n  </div>\n\n  <div class="vzb-dialog-buttons">\n    <div data-click="closeDialog" class="vzb-dialog-button vzb-label-primary">\n      <%=t ("buttons/ok") %>\n    </div>\n  </div>\n\n</div>\n'},function(t,e){t.exports='<div class="vzb-mmi-holder">\n\n    <span class="vzb-mmi-domainmin-label"></span>\n    <input type="text" class="vzb-mmi-domainmin" name="min">\n    <span class="vzb-mmi-domainmax-label"></span>\n    <input type="text" class="vzb-mmi-domainmax" name="max">\n\n    <br class="vzb-mmi-break"/>\n\n    <span class="vzb-mmi-zoomedmin-label"></span>\n    <input type="text" class="vzb-mmi-zoomedmin" name="min">\n    <span class="vzb-mmi-zoomedmax-label"></span>\n    <input type="text" class="vzb-mmi-zoomedmax" name="max">\n    \n</div>'},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i,r=n(5),a=(i=r)&&i.__esModule?i:{default:i},s=n(1);var o=a.default.extend({init:function(t,e){var i=this;this.name="steppedSpeedSlider",this.template=n(428),this.config=Object.assign({triangleWidth:10,triangleHeight:10,height:31,lineWidth:10,domain:[1,2,3,4,5,6],range:[1200,900,450,200,150,100]},t),this.config.height-=this.config.triangleHeight/2,this.model_expects=[{name:"time",type:"time"},{name:"locale",type:"locale"}],this.model_binds={"change:time.delay":function(){i.redraw()}},this.setDelay=(0,s.throttle)(this.setDelay,50),this._super(t,e)},readyOnce:function(){var t=this.config,e=t.domain,n=t.range,i=t.height;this.element=d3.select(this.element),this.svg=this.element.select("svg"),this.axisScale=d3.scaleLog().domain(d3.extent(e)).range([i,0]),this.delayScale=d3.scaleLinear().domain(e).range(n),this.initTriangle(),this.initAxis(),this.redraw()},initAxis:function(){var t=this,e=this.config,n=e.lineWidth,i=e.triangleWidth,r=e.triangleHeight,a=e.height,o=d3.axisLeft().scale(this.axisScale).tickFormat(function(){return""}).tickSizeInner(n).tickSizeOuter(0),l=i+n/2,c=r/2;this.svg.on("mousedown",function(){var e=d3.event.offsetY,n=Math.max(0,Math.min(e-c,a));t.setDelay(Math.round(t.delayScale(t.axisScale.invert(n))),!0,!0)}).select(".vzb-stepped-speed-slider-axis").attr("transform","translate("+l+", "+c+")").call(o),this.drag=d3.drag().on("drag",function(){var e=d3.event.dy,n=(0,s.transform)(t.slide.node()).translateY,i=Math.max(0,Math.min(e+n,a));t.setDelay(Math.round(t.delayScale(t.axisScale.invert(i)))),t.redraw(i)}).on("end",function(){t.setDelay(t.model.time.delay,!0,!0)}),this.svg.call(this.drag)},initTriangle:function(){var t=this.config;t.triangleWidth,t.triangleHeight,t.lineWidth;this.slide=this.svg.select(".vzb-stepped-speed-slider-triangle"),this.slide.append("g").append("path").attr("d",this.getTrianglePath())},getTrianglePath:function(){var t=this.config,e=t.triangleHeight;return"M "+t.triangleWidth+","+e/2+" 0,"+e+" 0,0 z"},setDelay:function(t){var e=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];this.model.time.set("delay",t,e,n)},redraw:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.axisScale(this.delayScale.invert(this.model.time.delay));this.slide.attr("transform","translate(0, "+t+")")}});e.default=o},function(t,e){t.exports='<div class="vzb-stepped-speed-slider">\n  <svg>\n    <g class="vzb-stepped-speed-slider-triangle"></g>\n    <g class="vzb-stepped-speed-slider-axis"></g>\n  </svg>\n</div>\n'},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i=function(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n]);return e.default=t,e}(n(1)),r=s(n(5)),a=s(n(114));function s(t){return t&&t.__esModule?t:{default:t}}var o={small:{margin:{top:7,right:15,bottom:10,left:60},radius:8,label_spacing:5},medium:{margin:{top:0,right:15,bottom:10,left:50},radius:9,label_spacing:5},large:{margin:{top:-5,right:15,bottom:10,left:75},radius:11,label_spacing:8}},l={medium:{margin:{top:9}},large:{margin:{}}},c=r.default.extend({init:function(t,e){this.name="gapminder-timeslider",this.template=this.template||n(430),this.prevPosition=null,this.model_expects=[{name:"time",type:"time"},{name:"marker",type:"marker"},{name:"ui",type:"ui"}];var r=this;this.model_binds={"change:time":function(t,e){if(r.slide){if(-1!==["time.start","time.end"].indexOf(e)){if(!r.xScale)return;r.changeLimits()}r._optionClasses(),r.model.time.dragging||r._setHandle(r.model.time.playing)}},"change:time.start":function(t,e){r.slide&&(r.model.time.dragging||r._setHandle(r.model.time.playing),r.ready())},"change:time.end":function(t,e){r.slide&&(r.model.time.dragging||r._setHandle(r.model.time.playing),r.ready())},"change:time.offset":function(t,e){r.slide&&(r._updateProgressBar(),r.model.marker.listenFramesQueue(null,function(t){r._updateProgressBar(t)}))},"change:time.startSelected":function(t,e){r.slide&&r.updateSelectedStartLimiter()},"change:time.endSelected":function(t,e){r.slide&&r.updateSelectedEndLimiter()},"change:marker.select":function(t,e){r.setSelectedLimits()}},this._super(t,e),this.profiles=i.deepClone(o),this.presentationProfileChanges=i.deepClone(l),(this.model.ui.chart||{}).margin&&this.model.on("change:ui.chart.margin",function(t,e){var n=r.getLayoutProfile();"small"!==n&&(r.profiles[n].margin.left=r.model.ui.chart.margin.left);r.slide&&r.updateSize()}),this.ui=i.extend({show_ticks:!1,show_value:!1,show_value_when_drag_play:!0,show_button:!0,axis_aligned:!1},t.ui.getPlainObject(),this.ui),this.width=0,this.height=0,this.availableTimeFrames=[],this.completedTimeFrames=[],this.getValueWidth=i.memoize(this.getValueWidth),this._setTime=i.throttle(this._setTime,50)},readyOnce:function(){var t=this;this.element=i.isArray(this.element)?this.element:d3.select(this.element),this.slider_outer=this.element.select(".vzb-ts-slider"),this.slider=this.slider_outer.select("g"),this.axis=this.element.select(".vzb-ts-slider-axis"),this.select=this.element.select(".vzb-ts-slider-select"),this.progressBar=this.element.select(".vzb-ts-slider-progress"),this.slide=this.element.select(".vzb-ts-slider-slide"),this.forecastBoundary=this.element.select(".vzb-ts-slider-forecastboundary"),this.handle=this.element.select(".vzb-ts-slider-handle"),this.valueText=this.element.select(".vzb-ts-slider-value"),this.playButtons=this.element.select(".vzb-ts-btns"),this.element.select(".vzb-ts-btn-play").on("click",function(){t.model.time.play()}),this.element.select(".vzb-ts-btn-pause").on("click",function(){t.model.time.pause("soft")}),this.forecastBoundary.on("click",function(){t._setTime(t.model.time.endBeforeForecast)}),this.xScale=d3.scaleUtc().clamp(!0),this.xAxis=(0,a.default)("bottom"),this.valueText.classed("stroke",!0),this.slider.style("paint-order").length||(this.slider.insert("text",".vzb-ts-slider-value").attr("class","vzb-ts-slider-value stroke"),this.valueText.classed("stroke",!1)),this.valueText=this.element.selectAll(".vzb-ts-slider-value"),this.valueText.attr("text-anchor","middle").attr("dy","-0.7em");var e=t._getBrushed(),n=t._getBrushedEnd();this.brush=d3.drag().on("start drag",function(){e.call(this)}).on("end",function(){n.call(this)}),this.slide.call(this.brush),this.slider_outer.on("mousewheel",function(){if(t.model.time.dragging)return d3.event.stopPropagation(),d3.event.preventDefault(),d3.event.returnValue=!1,!1}),this._setSelectedLimitsId=0,this.model.time.startSelected>this.model.time.start&&t.updateSelectedStartLimiter(),this.model.time.endSelected<this.model.time.end&&t.updateSelectedEndLimiter(),this.parent.on("myEvent",function(e,n){var i=t.getLayoutProfile(),r=t.profiles[i];n.profile&&n.profile.margin&&(r.margin=n.profile.margin),t.element.select(".vzb-ts-slider-wrapper").style("right",n.mRight-r.margin.right+"px"),t.updateSize([0,n.rangeMax])}),this.on("resize",function(){t.updateSize()})},ready:function(){if(!this.model.time.splash){if(!this.model.time._ready)return i.warn("TODO timeslider is fired ready event while time model is not ready yet! how come?");var t=this;this.element.classed("vzb-ts-loading",!1),this.changeLimits(),this.changeTime(),this.updateSize(),t._updateProgressBar(),t.model.marker.listenFramesQueue(null,function(e){t._updateProgressBar(e)}),t.setSelectedLimits(!0)}},changeLimits:function(){var t=this.model.time.start,e=this.model.time.end;this.xScale.domain([t,e]),this.xAxis.tickValues([t,e]).tickFormat(this.model.time.getFormatter())},changeTime:function(){this.model.time.value;this._optionClasses()},updateSize:function(t){if(!this.model.time.splash){this.model.time.pause(),this.profile=this.getActiveProfile(this.profiles,this.presentationProfileChanges);var e=parseInt(this.slider_outer.style("width"),10)||0,n=parseInt(this.slider_outer.style("height"),10)||0;if(!n||!e)return i.warn("time slider resize() aborted because element is too small or has display:none");this.width=e-this.profile.margin.left-this.profile.margin.right,this.height=n-this.profile.margin.bottom-this.profile.margin.top;this.slider.attr("transform","translate("+this.profile.margin.left+","+this.profile.margin.top+")"),this.xScale.range(t||[0,this.width]),this.slide.attr("transform","translate(0,"+this.height/2+")").attr("x1",this.xScale.range()[0]).attr("x2",this.xScale.range()[1]).style("stroke-width",2*this.profile.radius+"px"),this.xAxis=this.xAxis.scale(this.xScale).tickSizeInner(0).tickSizeOuter(0).tickPadding(this.profile.label_spacing).tickSizeMinor(0,0),this.axis.attr("transform","translate(0,"+this.height/2+")").call(this.xAxis),this.select.attr("transform","translate(0,"+this.height/2+")"),this.progressBar.attr("transform","translate(0,"+this.height/2+")"),this.slide.select(".background").attr("height",this.height),this.handle.attr("transform","translate(0,"+this.height/2+")").attr("r",this.profile.radius),this.sliderWidth=this.slider.node().getBoundingClientRect().width;var r=this.model.time.end>this.model.time.endBeforeForecast;this.forecastBoundary.classed("vzb-hidden",!r),r&&this.forecastBoundary.attr("transform","translate(0,"+this.height/2+")").attr("x1",this.xScale(this.model.time.endBeforeForecast)-this.profile.radius/2).attr("x2",this.xScale(this.model.time.endBeforeForecast)+this.profile.radius/2).attr("y1",this.profile.radius).attr("y2",this.profile.radius),this.resizeSelectedLimiters(),this._resizeProgressBar(),this._setHandle(),this.playButtons.style("width",this.profile.margin.left+"px")}},setSelectedLimits:function(t){var e=this;this._setSelectedLimitsId++;var n=this._setSelectedLimitsId,r=e.model.marker.select;if(0!=r.length){var a=i.unique(this.model.marker._getAllDimensions({exceptType:"time"})),s=[];i.forEach(r,function(t){s.push(e.model.marker.getEntityLimits(i.getKey(t,a)))}),Promise.all(s).then(function(r){if(n==e._setSelectedLimitsId){var a=r.shift(),s=a.min,o=a.max;i.forEach(r,function(t){s-t.min>0&&(s=t.min),o-t.max<0&&(o=t.max)}),e.model.time.set({startSelected:d3.max([s,new Date(e.model.time.start)]),endSelected:d3.min([o,new Date(e.model.time.end)])},t,!1)}})}else null!=e.model.time.start&&null!=e.model.time.end&&e.model.time.set({startSelected:new Date(e.model.time.start),endSelected:new Date(e.model.time.end)},null,!1)},updateSelectedStartLimiter:function(){this.select.select("#clip-start-"+this._id).remove(),this.select.select(".selected-start").remove(),this.model.time.startSelected&&this.model.time.startSelected>this.model.time.start&&(this.select.append("clipPath").attr("id","clip-start-"+this._id).append("rect"),this.select.append("path").attr("clip-path","url("+location.pathname+"#clip-start-"+this._id+")").classed("selected-start",!0),this.resizeSelectedLimiters())},updateSelectedEndLimiter:function(){this.select.select("#clip-end-"+this._id).remove(),this.select.select(".selected-end").remove(),this.model.time.endSelected&&this.model.time.endSelected<this.model.time.end&&(this.select.append("clipPath").attr("id","clip-end-"+this._id).append("rect"),this.select.append("path").attr("clip-path","url("+location.pathname+"#clip-end-"+this._id+")").classed("selected-end",!0),this.resizeSelectedLimiters())},resizeSelectedLimiters:function(){this.select.select(".selected-start").attr("d","M0,0H"+this.xScale(this.model.time.startSelected)),this.select.select("#clip-start-"+this._id).select("rect").attr("x",-this.height/2).attr("y",-this.height/2).attr("height",this.height).attr("width",this.xScale(this.model.time.startSelected)+this.height/2),this.select.select(".selected-end").attr("d","M"+this.xScale(this.model.time.endSelected)+",0H"+this.xScale(this.model.time.end)),this.select.select("#clip-end-"+this._id).select("rect").attr("x",this.xScale(this.model.time.endSelected)).attr("y",-this.height/2).attr("height",this.height).attr("width",this.xScale(this.model.time.end)-this.xScale(this.model.time.endSelected)+this.height/2)},_resizeProgressBar:function(){var t=this;this.progressBar.selectAll("path").each(function(e){d3.select(this).attr("d","M"+t.xScale(e[0])+",0H"+t.xScale(e[1]))})},_updateProgressBar:function(t){var e=this;if(t){if(-1!=e.completedTimeFrames.indexOf(t))return;e.completedTimeFrames.push(t);var n=e.model.time.incrementTime(t),i=e.model.time.decrementTime(t);if(n>e.model.time.end){if(t-e.model.time.end!=0)return;n=t,t=i}if(0==e.availableTimeFrames.length||e.availableTimeFrames[e.availableTimeFrames.length-1][1]<t)e.availableTimeFrames.push([t,n]);else if(n<e.availableTimeFrames[0][0])e.availableTimeFrames.unshift([t,n]);else for(var r=0;r<e.availableTimeFrames.length;r++){if(t-e.availableTimeFrames[r][1]==0){r+1<e.availableTimeFrames.length&&n-e.availableTimeFrames[r+1][0]==0?(e.availableTimeFrames[r][1]=e.availableTimeFrames[r+1][1],e.availableTimeFrames.splice(r+1,1)):e.availableTimeFrames[r][1]=n;break}if(n-e.availableTimeFrames[r][0]==0){e.availableTimeFrames[r][0]=t;break}if(t-e.availableTimeFrames[r][1]>0&&n-e.availableTimeFrames[r+1][0]<0){e.availableTimeFrames.splice(r+1,0,[t,n]);break}}var a=void 0;e.availableTimeFrames.some(function(t,n){if(!(t[0]-e.stepLimits[0]||t[1]-e.stepLimits[1]))return a=n,!0})&&(e.availableTimeFrames=e.availableTimeFrames.slice(a,1))}else{var s=e.model.time.getAllSteps();e.stepLimits=[s[0],s[s.length-1]],e.availableTimeFrames=[],e.completedTimeFrames=[]}var o=this.progressBar.selectAll("path").data(e.availableTimeFrames);o.exit().remove(),o.enter().append("path").attr("class","domain").merge(o).each(function(t){d3.select(this).attr("d","M"+e.xScale(t[0])+",0H"+e.xScale(t[1])).classed("rounded",1==e.availableTimeFrames.length)})},getValueWidth:function(t,e){return this.valueText.node().getBoundingClientRect().width},_getBrushed:function(){var t=this;return function(){t.model.time.playing&&t.model.time.set("playing",!1,null,!1),t._optionClasses(),t.element.classed("vzb-ts-dragging",!0);var e=void 0;if(d3.event.sourceEvent){d3.event.sourceEvent.preventDefault(),t.model.time.dragStart();var n=i.roundStep(Math.round(d3.mouse(this)[0]),1),r=t.width,a=t.model.time.end>t.model.time.endBeforeForecast,s=t.xScale(t.model.time.endBeforeForecast),o=.5*t.handle.attr("r");n>r?n=r:n<0?n=0:Math.abs(n-s)<o&&!d3.event.sourceEvent.shiftKey&&a&&(n=s),e=t.xScale.invert(n),t.handle.attr("cx",n),t.valueText.attr("transform","translate("+n+","+t.height/2+")"),t.valueText.text(t.model.time.formatDate(e,"ui"))}e-t.model.time.value!=0&&t._setTime(e)}},_getBrushedEnd:function(){var t=this;return function(){t._setTime.recallLast(),t.element.classed("vzb-ts-dragging",!1),t.model.time.dragStop(),t.model.time.snap()}},_setHandle:function(t){var e=this.model.time.value,n=this.xScale(e);this.element.classed("vzb-ts-disabled",this.model.time.end<=this.model.time.start),null==this.prevPosition&&(this.prevPosition=n);var i=n>this.prevPosition?this.model.time.delayAnimations:0;t?(this.handle.attr("cx",this.prevPosition).transition().duration(i).ease(d3.easeLinear).attr("cx",n),this.valueText.attr("transform","translate("+this.prevPosition+","+this.height/2+")").transition("text").delay(i).text(this.model.time.formatDate(e,"ui")),this.valueText.transition().duration(i).ease(d3.easeLinear).attr("transform","translate("+n+","+this.height/2+")")):(this.handle.interrupt().attr("cx",n),this.valueText.interrupt().interrupt("text").transition("text"),this.valueText.attr("transform","translate("+n+","+this.height/2+")").text(this.model.time.formatDate(e,"ui"))),this.prevPosition=n},_setTime:function(t){var e=!this.model.time.dragging&&!this.model.time.playing;this.model.time.getModelObject("value").set(t,!1,e)},_optionClasses:function(){var t=this.ui.show_ticks,e=this.ui.show_value,n=this.ui.show_value_when_drag_play,i=this.ui.axis_aligned,r=this.ui.show_button&&this.model.time.playable;this.xAxis.labelerOptions({scaleType:"time",removeAllLabels:!t,limitMaxTickNumber:3,showOuter:!1,toolMargin:{left:10,right:10,top:0,bottom:30},fitIntoScale:"optimistic"}),this.element.classed("vzb-ts-hide-play-button",!r),this.element.classed("vzb-playing",this.model.time.playing),this.element.classed("vzb-ts-show-value",e),this.element.classed("vzb-ts-show-value-when-drag-play",n),this.element.classed("vzb-ts-axis-aligned",i)}});e.default=c},function(t,e){t.exports='<div class="vzb-timeslider vzb-ts-loading">\n  <div class="vzb-ts-slider-wrapper">\n    <svg class="vzb-ts-slider">\n      <g>\n        <g class="vzb-ts-slider-axis"></g>\n        <g class="vzb-ts-slider-progress"></g>\n        <g class="vzb-ts-slider-select"></g>\n        <line class="vzb-ts-slider-forecastboundary"></line>\n        <circle class="vzb-ts-slider-handle"></circle>\n        <text class="vzb-ts-slider-value"></text>\n        <line class="vzb-ts-slider-slide"></line>\n      </g>\n      </svg>\n  </div>\n\n  \x3c!-- SVG VIZABI ICONS\n       source: https://github.com/encharm/Font-Awesome-SVG-PNG/ --\x3e\n  <div class="vzb-ts-btns">\n    <button class="vzb-ts-btn-loading vzb-ts-btn">\n      <div class=\'vzb-loader\'></div>\n    </button>\n    <button class="vzb-ts-btn-play vzb-ts-btn">\n      <svg class="vzb-icon vzb-icon-play" viewBox="3 3 42 42"\n           xmlns="http://www.w3.org/2000/svg">\n        <path xmlns="http://www.w3.org/2000/svg" d="M24 4C12.95 4 4 12.95 4 24s8.95 20 20 20 20-8.95 20-20S35.05 4 24 4zm-4 29V15l12 9-12 9z"/>\n      </svg>\n    </button>\n    <button class="vzb-ts-btn-pause vzb-ts-btn">\n      <svg class="vzb-icon vzb-icon-pause" viewBox="3 3 42 42"\n           xmlns="http://www.w3.org/2000/svg">\n        <path xmlns="http://www.w3.org/2000/svg" d="M24 4C12.95 4 4 12.95 4 24s8.95 20 20 20 20-8.95 20-20S35.05 4 24 4zm-2 28h-4V16h4v16zm8 0h-4V16h4v16z"/>\n      </svg>\n    </button>\n  </div>\n</div>\n'},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i=function(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n]);return e.default=t,e}(n(1)),r=l(n(5)),a=l(n(31)),s=(l(n(32)),l(n(78))),o=n(21);function l(t){return t&&t.__esModule?t:{default:t}}var c={wrapper:"vzb-treemenu-wrap",wrapper_outer:"vzb-treemenu-wrap-outer",background:"vzb-treemenu-background",close:"vzb-treemenu-close",search:"vzb-treemenu-search",list:"vzb-treemenu-list",list_outer:"vzb-treemenu-list-outer",list_item:"vzb-treemenu-list-item",list_item_leaf:"vzb-treemenu-list-item-leaf",leaf:"vzb-treemenu-leaf",leaf_content:"vzb-treemenu-leaf-content",leaf_content_item:"vzb-treemenu-leaf-content-item",leaf_content_item_title:"vzb-treemenu-leaf-content-item-title",leaf_content_item_descr:"vzb-treemenu-leaf-content-item-descr",leaf_content_item_helptranslate:"vzb-treemenu-leaf-content-item-helptranslate",hasChild:"vzb-treemenu-list-item-children",list_item_label:"vzb-treemenu-list-item-label",list_top_level:"vzb-treemenu-list-top",search_wrap:"vzb-treemenu-search-wrap",isSpecial:"vzb-treemenu-list-item-special",hidden:"vzb-hidden",title:"vzb-treemenu-title",scaletypes:"vzb-treemenu-scaletypes",scaletypesDisabled:"vzb-treemenu-scaletypes-disabled",scaletypesActive:"vzb-treemenu-scaletypes-active",alignYt:"vzb-align-y-top",alignYb:"vzb-align-y-bottom",alignXl:"vzb-align-x-left",alignXr:"vzb-align-x-right",alignXc:"vzb-align-x-center",menuHorizontal:"vzb-treemenu-horizontal",menuVertical:"vzb-treemenu-vertical",absPosVert:"vzb-treemenu-abs-pos-vert",absPosHoriz:"vzb-treemenu-abs-pos-horiz",menuOpenLeftSide:"vzb-treemenu-open-left-side",noTransition:"notransition"},u={MOUSE_LOCS:[],MOUSE_LOCS_TRACKED:3,DELAY:200,TOLERANCE:150,LAST_DELAY_LOC:null,TIMEOUT:null,SEARCH_PROPERTY:"id",SUBMENUS:"children",SEARCH_MIN_STR:1,RESIZE_TIMEOUT:null,MOBILE_BREAKPOINT:400,CURRENT_PATH:[],MIN_COL_WIDTH:60,MENU_DIRECTION:1,MAX_MENU_WIDTH:320,MENU_OPEN_LEFTSIDE:!1},h=a.default.extend({init:function(t,e,n){var i=this;this.parent=t,this.entity=e,this.OPTIONS=n,this.width=this.OPTIONS.MIN_COL_WIDTH,this.direction=this.OPTIONS.MENU_DIRECTION,this._setDirectionClass(),this.menuItems=[];var r=void 0;return this.entity.empty()?this:(this.entity.each(function(){r=d3.selectAll(this.childNodes).filter(function(){return d3.select(this).classed(c.list)})}),r.empty()&&(r=this.entity),e.selectAll("."+c.list_item).filter(function(){return this.parentNode==r.node()}).each(function(){i.addSubmenu(d3.select(this))}),!this.menuItems.length&&this.isActive()&&this.buildLeaf(),this)},setWidth:function(t,e,n){if(this.width!=t&&this.entity.node()){if(this.width=t,(this.entity.classed(c.list_top_level)||this.entity.classed("active"))&&1==this.direction&&(n?this.entity.style("width",this.width+"px"):this.entity.transition().delay(0).duration(100).style("width",this.width+"px")),this.entity.classed(c.list_top_level)&&this.entity.selectAll("."+c.leaf).style("width",this.width-1+"px"),e)for(var i=0;i<this.menuItems.length;i++)this.menuItems[i].setWidth(this.width,e,n);return this}},setDirection:function(t,e){if(this.direction=t,this.entity.style("width","").style("height",""),e)for(var n=0;n<this.menuItems.length;n++)this.menuItems[n].setDirection(this.direction,e);return this._setDirectionClass(),this},_setDirectionClass:function(){1==this.direction?(this.entity.classed(c.menuVertical,!1),this.entity.classed(c.menuHorizontal,!0)):(this.entity.classed(c.menuHorizontal,!1),this.entity.classed(c.menuVertical,!0))},addSubmenu:function(t){this.menuItems.push(new d(this,t,this.OPTIONS))},open:function(){var t=this,e=this;return this.isActive()||(e.parent.parentMenu.openSubmenuNow=!0,this.closeNeighbors(function(){1==e.direction?(t.menuItems.length||e.buildLeaf(),e._openHorizontal(),e.calculateMissingWidth(0)):e._openVertical()}),e.parent.parentMenu.openSubmenuNow=!1),this},calculateMissingWidth:function(t,e){var n=this;this.entity.classed(c.list_top_level)?t>this.OPTIONS.MAX_MENU_WIDTH&&"function"==typeof e&&e(t-this.OPTIONS.MAX_MENU_WIDTH):this.parent.parentMenu.calculateMissingWidth(t+this.width,function(t){t>0?n.reduceWidth(t,function(t){"function"==typeof e&&e(t)}):"function"==typeof e&&e(t)})},restoreWidth:function(t,e,n){if(e)this.parent.parentMenu.restoreWidth(t,!1,n);else if(t<=0)"function"==typeof n&&n();else if(this.entity.classed(c.list_top_level))"function"==typeof n&&n();else{var i=this.entity.node().offsetWidth,r=Math.min(t,this.width);if(i<r){var a=i/r*250;this.entity.transition().delay(0).duration(a).style("width",r+"px").on("end",function(){}),this.parent.parentMenu.restoreWidth(t-r,!1,n)}else this.parent.parentMenu.restoreWidth(t,!1,n)}},reduceWidth:function(t,e){var n=this,i=this.entity.node().offsetWidth;if(i<=this.OPTIONS.MIN_COL_WIDTH)e(t-n.width+i);else{var r=Math.max(this.OPTIONS.MIN_COL_WIDTH,n.width-t),a=250/(n.width/r);this.entity.transition().delay(0).duration(a).style("width",r+"px").on("end",function(){e(t-n.width+r)})}},_openHorizontal:function(){var t=this;t.entity.classed("active",!0).transition().delay(0).duration(250).style("width",t.width+"px").on("end",function(){t.marqueeToggle(!0)})},_openVertical:function(){var t=this;t.entity.style("height","0px"),t.entity.transition().delay(0).duration(250).style("height",36*t.menuItems.length+"px").on("end",function(){t.entity.style("height","auto"),t.marqueeToggle(!0),t.scrollToFitView()}),t.entity.classed("active",!0)},closeAllChildren:function(t){for(var e=0,n=0;n<this.menuItems.length;n++)this.menuItems[n].isActive()&&(++e,this.menuItems[n].submenu.close(function(){0==--e&&"function"==typeof t&&t()}));0==e&&"function"==typeof t&&t()},closeNeighbors:function(t){this.parent?this.parent.closeNeighbors(t):t()},close:function(t){var e=this;this.closeAllChildren(function(){1==e.direction?e._closeHorizontal(t):e._closeVertical(t)})},_closeHorizontal:function(t){this.entity.node().offsetWidth;var e=this,n=e.parent.parentMenu.openSubmenuNow;e.entity.transition().delay(0).duration(20).style("width","0px").on("end",function(){e.marqueeToggle(!1),e.entity.classed("active",!1),n?"function"==typeof t&&t():e.restoreWidth(e.OPTIONS.MAX_MENU_WIDTH,!0,function(){"function"==typeof t&&t()})})},_closeVertical:function(t){var e=this;e.entity.transition().delay(0).duration(100).style("height","0px").on("end",function(){e.marqueeToggle(!1),e.entity.classed("active",!1),"function"==typeof t&&t()})},isActive:function(){return this.entity.classed("active")},hasActiveParentNeighbour:function(){return this.menuItems.filter(function(t){return t.isActive()}).some(function(t){return!!d3.select(t.entity).node().classed(c.hasChild)})},marqueeToggle:function(t){for(var e=0;e<this.menuItems.length;e++)this.menuItems[e].marqueeToggle(t)},marqueeToggleAll:function(t){for(var e=0;e<this.menuItems.length;e++)this.menuItems[e].marqueeToggleAll(t)},findItemById:function(t){for(var e=0;e<this.menuItems.length;e++){if(this.menuItems[e].entity.data().id==t)return this.menuItems[e];if(this.menuItems[e].submenu){var n=this.menuItems[e].submenu.findItemById(t);if(n)return n}}return null},getTopMenu:function(){return this.parent?this.parent.parentMenu.getTopMenu():this},scrollToFitView:function(){var t,e=this.getTopMenu().entity.node().parentNode,n=this.entity.node().parentNode,i=e.getBoundingClientRect(),r=n.getBoundingClientRect(),a=r.top-i.top;if(a+r.height>i.height){var s=r.height>i.height?i.height-10:r.height+10,o=e.scrollTop+s-i.height+a;d3.select(e).transition().duration(100).tween("scrolltoptween",(t=o,function(){var n=d3.interpolateNumber(this.scrollTop,t);return function(t){e.scrollTop=n(t)}}))}},buildLeaf:function(){var t=this.entity.datum();this.entity.selectAll("div").data([t]).enter().append("div").classed(c.leaf+" "+c.leaf_content+" vzb-dialog-scrollable",!0).style("width",this.width+"px").each(function(t){var e=d3.select(this);e.append("span").classed(c.leaf_content_item+" "+c.leaf_content_item_title,!0).text(i.replaceNumberSpacesToNonBreak(t.name)||""),e.append("span").classed(c.leaf_content_item+" "+c.leaf_content_item_descr,!0).text(i.replaceNumberSpacesToNonBreak(t.description)||""),e.append("span").classed(c.leaf_content_item+" "+c.leaf_content_item_helptranslate,!0).classed("vzb-invisible",!t.translateContributionLink).html('<a href="'+t.translateContributionLink+'" target="_blank">'+t.translateContributionText+"</a>")})}}),d=a.default.extend({init:function(t,e,n){var r=this;this.parentMenu=t,this.entity=e;var a=e.select("."+c.list_outer);return a.node()&&(this.submenu=new h(this,a,n)),this.entity.select("."+c.list_item_label).call(function(t){i.isTouchDevice()?t.onTap(function(t){if((d3.event.stopPropagation(),2==r.parentMenu.direction)&&!r.entity.select("."+c.list_item_label).attr("children"))return;r.toggleSubmenu()}):t.on("mouseenter",function(){1!=r.parentMenu.direction||d3.select(this).attr("children")?r.parentMenu.hasActiveParentNeighbour()||r.closeNeighbors():r.openSubmenu(),r.marqueeToggle(!0)}).on("click.item",function(){if(d3.event.stopPropagation(),1==r.parentMenu.direction)r.openSubmenu();else{if(!d3.select(this).attr("children"))return;r.toggleSubmenu()}})}),this},setWidth:function(t,e,n){return this.submenu&&e&&this.submenu.setWidth(t,e,n),this},setDirection:function(t,e){return this.submenu&&e&&this.submenu.setDirection(t,e),this},toggleSubmenu:function(){this.submenu&&(this.submenu.isActive()?this.submenu.close():this.submenu.open())},openSubmenu:function(){this.submenu?this.submenu.open():this.closeNeighbors()},closeNeighbors:function(t){this.parentMenu.closeAllChildren(t)},isActive:function(){return this.submenu&&this.submenu.isActive()},marqueeToggleAll:function(t){this.entity.selectAll("."+c.list_item_label).each(function(){var e=d3.select(this).select("span"),n=d3.select(this.parentNode);if(n.classed("marquee",!1),e.style("width",""),t&&e.node().scrollWidth>e.node().offsetWidth){e.attr("data-content",e.text());var i=30+e.node().scrollWidth;e.style("width",i+"px"),n.classed("marquee",!0)}})},marqueeToggle:function(t){var e=this.entity.select("."+c.list_item_label).select("span");if(this.entity.classed("marquee",!1),e.style("width",""),t&&e.node().scrollWidth>e.node().offsetWidth){e.attr("data-content",e.text());var n=30+e.node().scrollWidth;e.style("width",n+"px"),this.entity.classed("marquee",!0)}}}),f=r.default.extend({indicatorsTree:function(t){return arguments.length?(this._indicatorsTree=t,this):this._indicatorsTree},callback:function(t){return arguments.length?(this._callback=t,this):this._callback},markerID:function(t){return arguments.length?(this._markerID=t,this.targetModel(this.model.marker[this._markerID]),this):this._markerID},showWhenReady:function(t){return arguments.length?(this._showWhenReady=t,this):this._showWhenReady},scaletypeSelectorDisabled:function(t){return arguments.length?(this._scaletypeSelectorDisabled=t,this):this._scaletypeSelectorDisabled},title:function(t){return arguments.length?(this._title=t,this):this._title},targetModel:function(t){return arguments.length?(this._targetModel&&this._targetModel.off("change",this.change),this._targetModel=t,this._targetModel.on("change",this.change),this._targetModel.isHook()&&(this._targetProp="which"),this._targetModel instanceof s.default&&(this._targetProp="space"),this):this._targetModel},targetProp:function(t){return arguments.length?(this._targetProp=t,this):this._targetProp},alignX:function(t){return arguments.length?(this._alignX=t,this):this._alignX},alignY:function(t){return arguments.length?(this._alignY=t,this):this._alignY},top:function(t){return arguments.length?(this._top=t,this):this._top},left:function(t){return arguments.length?(this._left=t,this):this._left},init:function(t,e){this.name="gapminder-treemenu",this.model_expects=[{name:"marker",type:"marker"},{name:"time",type:"time"},{name:"locale",type:"locale"},{name:"ui",type:"ui"}],this.context=e,this.menuEntity=null,this._super(t,e),this._callback=function(t){console.log("Indicator selector: stub callback fired. New indicator is ",t)},this._alignX="center",this._alignY="center",this.OPTIONS=i.deepClone(u),this.change=this.change.bind(this)},change:function(t,e){(-1!=e.indexOf("."+this._targetProp)||this._targetModel.isHook()&&-1!=e.indexOf(".scaleType"))&&this.updateView()},ready:function(){this.model.marker._root.dataManager.getTags(this.model.locale.id).then(this._buildIndicatorsTree.bind(this)).then(this.updateView.bind(this))},readyOnce:function(){this.element=d3.select(this.placeholder);var t=this;this.element.selectAll("div").remove(),this.element.append("div").attr("class",c.background).on("click",function(){d3.event.stopPropagation(),t.toggle()}),this.wrapperOuter=this.element.append("div").classed(c.wrapper_outer,!0).classed(c.noTransition,!0),this.wrapper=this.wrapperOuter.append("div").classed(c.wrapper,!0).classed(c.noTransition,!0).classed("vzb-dialog-scrollable",!0),this.wrapper.on("click",function(){d3.event.stopPropagation()}),this.wrapper.append("div").attr("class",c.close).html(o.close).on("click",function(){d3.event.stopPropagation(),t.toggle()}).select("svg").attr("width","0px").attr("height","0px").attr("class",c.close+"-icon"),this.wrapper.append("div").classed(c.scaletypes,!0).append("span"),this.wrapper.append("div").classed(c.title,!0).append("span"),this.wrapper.append("div").classed(c.search_wrap,!0).append("input").classed(c.search,!0).attr("type","search").attr("id",c.search),d3.select("body").on("mousemove",t._mousemoveDocument),this.wrapper.on("mouseleave",function(){}),this.translator=this.model.locale.getTFunction(),t._enableSearch(),t.resize()},_buildIndicatorsTree:function(t){var e=this;!0!==t&&t||(t=[]);var n=this,r="_root",a=n.model.marker._root.dataManager.getDataModels(),s=1==a.size?"spread":"root",o={};o._root={id:r,children:[]},o.advanced={id:"advanced",name:this.translator("treemenu/advanced"),type:"folder",children:[]},o._root.children.push(o.advanced),o.other_datasets={id:"other_datasets",name:this.translator("treemenu/other_datasets"),type:"folder",children:[]},o._root.children.push(o.other_datasets),t.forEach(function(t){o[t.tag]={id:t.tag,name:t.name,type:"folder",children:[]}});var l={};a.forEach(function(t){var n=i.getProp(e.model.ui,["treemenu","folderStrategyByDataset",t._name]),r=null;n||(n=s),n.includes(":")&&(r=n.split(":")[1],n=n.split(":")[0]),o[t._name]={id:t._name,name:t.getDatasetName(),type:"dataset",children:[]},"folder"==n&&o[r]?o[r].children.push(o[t._name]):"spread"==n?o[t._name]=o._root:o._root.children.push(o[t._name]),l[t._name]=n});var c=o._root;t.forEach(function(t){t.parent&&o[t.parent]?o[t.parent].children.push(o[t.tag]):"spread"==l[t.dataSourceName]?o._root.children.push(o[t.tag]):o[t.dataSourceName].children.push(o[t.tag])});var u=this.model.marker.space.length>1;return this.model.marker.getAvailableData().forEach(function(t){var e=t.value;if(e&&"_none"!=e.tags){e.tags||(e.tags=t.dataSource._name||r);var a="_default"==e.concept?"constant":t.key.length>1||"time"===e.concept_type?"indicator":"property",s={id:e.concept,key:t.key,name:e.name,name_catalog:e.name_catalog,description:e.description,dataSource:t.dataSource._name,translateContributionLink:t.dataSource.translateContributionLink,use:a};if(u&&1==t.key.length&&"_default"!=e.concept&&"time"!=e.concept_type){var l=t.key[0].concept+"_properties";if(!o[l]){var c=t.key[0];o[l]={id:l,name:c.name+" properties",type:"folder",children:[]},o._root.children.push(o[l])}o[l].children.push(s)}else e.tags.split(",").forEach(function(t){t=t.trim(),o[t]?o["_root"===t&&"_default"!=e.concept&&"time"!=e.concept_type?s.dataSource:t].children.push(s):(n.consoleGroupOpen||(console.groupCollapsed("Some tags were not found, so indicators went under menu root"),n.consoleGroupOpen=!0),i.warn("tag '"+t+"' for indicator '"+s.id+"'"),o._root.children.push(s))})}}),this.model.marker.getAvailableSpaces().forEach(function(t,e){c.children.push({id:e,name:t.map(function(t){return t.name}).join(", "),name_catalog:t.map(function(t){return t.name}).join(", "),description:"no description",dataSource:"All data sources",type:"space"})}),n.consoleGroupOpen&&(console.groupEnd(),delete n.consoleGroupOpen),this._sortChildren(c),this.indicatorsTree(c),Promise.resolve()},_sortChildren:function(t,e){var n=this;t.children&&(t.children.sort(i.firstBy()(function(t,e){return t="dataset"===t.type?1:0,(e="dataset"===e.type?1:0)-t}).thenBy(function(t,e){return(t=t.children?1:0)-(e=e.children?1:0)}).thenBy(function(t,n){if(!e){if("time"==t.id)return-1;if("time"==n.id)return 1;if("other_datasets"==t.id)return 1;if("other_datasets"==n.id)return-1;if("advanced"==t.id)return 1;if("advanced"==n.id)return-1;if("_default"==t.id)return 1;if("_default"==n.id)return-1}return(t.name_catalog||t.name)>(n.name_catalog||n.name)?1:-1})),t.children.forEach(function(t){n._sortChildren(t,!0)}))},resize:function(){this.profiles={small:{col_width:200},medium:{col_width:200},large:{col_width:200}};var t=this._top,e=this._left;if(!this.wrapper)return i.warn("treemenu resize() abort because container is undefined");this.wrapper.classed(c.noTransition,!0),this.wrapper.node().scrollTop=0,this.activeProfile=this.profiles[this.getLayoutProfile()],this.OPTIONS.IS_MOBILE="small"===this.getLayoutProfile(),this.menuEntity&&(this.menuEntity.setWidth(this.activeProfile.col_width,!0,!0),this.OPTIONS.IS_MOBILE?2!=this.menuEntity.direction&&(this.menuEntity.setDirection(2,!0),this.OPTIONS.MENU_DIRECTION=2):1!=this.menuEntity.direction&&(this.menuEntity.setDirection(1,!0),this.OPTIONS.MENU_DIRECTION=1)),this.width=this.element.node().offsetWidth,this.height=this.element.node().offsetHeight;var n=this.wrapperOuter.node().getBoundingClientRect(),r=n.width,a=n.height;if(r)if(this.OPTIONS.IS_MOBILE)this.clearPos();else{(t||e)&&(this.wrapperOuter.node().offsetTop<10&&this.wrapperOuter.style("top","10px"),this.height-this.wrapperOuter.node().offsetTop-a<0&&(a>this.height&&(a=this.height-20),this.wrapperOuter.style("top",this.height-a-10+"px"),this.wrapperOuter.style("bottom","auto")),t&&(t=this.wrapperOuter.node().offsetTop));var s=void 0;s=this.wrapperOuter.classed(c.alignYb)?this.wrapperOuter.node().offsetTop+this.wrapperOuter.node().offsetHeight:this.height-this.wrapperOuter.node().offsetTop,this.wrapper.style("max-height",s-10+"px"),this.wrapperOuter.classed(c.alignXc,"center"===this._alignX),this.wrapperOuter.style("margin-left","center"===this._alignX?"-"+r/2+"px":null),"center"===this._alignX?this.OPTIONS.MAX_MENU_WIDTH=this.width/2-.5*r-10:this.OPTIONS.MAX_MENU_WIDTH=this.width-this.wrapperOuter.node().offsetLeft-r-10;var o=this.activeProfile.col_width+2*this.OPTIONS.MIN_COL_WIDTH,l=this.wrapperOuter.node().offsetLeft;this.OPTIONS.MENU_OPEN_LEFTSIDE=this.OPTIONS.MAX_MENU_WIDTH<o&&l>this.OPTIONS.MAX_MENU_WIDTH+10,this.OPTIONS.MENU_OPEN_LEFTSIDE?(l<o+10&&(l=o+10),this.OPTIONS.MAX_MENU_WIDTH=l-10):this.OPTIONS.MAX_MENU_WIDTH<o&&(l-=o-this.OPTIONS.MAX_MENU_WIDTH,this.OPTIONS.MAX_MENU_WIDTH=o),e?e=l:l!=this.wrapperOuter.node().offsetLeft&&(this.wrapperOuter.style("left","auto"),this.wrapperOuter.style("right",this.width-l-n.width+"px")),this._top=t,this._left=e,(e||t)&&this.setPos(),this.wrapperOuter.classed("vzb-treemenu-open-left-side",!this.OPTIONS.IS_MOBILE&&this.OPTIONS.MENU_OPEN_LEFTSIDE)}return this.wrapper.node().offsetHeight,this.wrapper.classed(c.noTransition,!1),this.setHorizontalMenuHeight(),this},toggle:function(){this.setHiddenOrVisible(!this.element.classed(c.hidden))},setHiddenOrVisible:function(t){var e=this;return this.element.classed(c.hidden,t),this.wrapper.classed(c.noTransition,t),t?(this.clearPos(),this.menuEntity.marqueeToggle(!1)):(this.setPos(),!i.isTouchDevice()&&this.focusSearch(),this.resize(),this.scrollToSelected()),this.parent.components.forEach(function(n){"gapminder-dialogs"==n.name?d3.select(n.placeholder.parentNode).classed("vzb-blur",!t):n.element.classed?n.element.classed("vzb-blur",n!=e&&!t):d3.select(n.element).classed("vzb-blur",n!=e&&!t)}),this.width=e.element.node().offsetWidth,this},scrollToSelected:function(){if(this.selectedNode){var t=this,e=function(t,e){t.scrollTop=0;var n=t.getBoundingClientRect(),i=e.getBoundingClientRect().bottom-n.top-t.offsetHeight+10;t.scrollTop=i};if(2==this.menuEntity.direction)e(this.wrapper.node(),this.selectedNode),t.menuEntity.marqueeToggleAll(!0);else{this.menuEntity.findItemById(d3.select(this.selectedNode).data().id).submenu.calculateMissingWidth(0,function(){t.menuEntity.marqueeToggleAll(!0)});for(var n=this.selectedNode;!i.hasClass(n,c.list_top_level);)"LI"==n.tagName&&e(i.hasClass(n.parentNode,c.list_top_level)?n.parentNode.parentNode:n.parentNode,n),n=n.parentNode}}},setPos:function(){var t=this._top,e=this._left,n=this.wrapperOuter.node().getBoundingClientRect();if(t&&(this.wrapperOuter.style("top",t+"px"),this.wrapperOuter.style("bottom","auto"),this.wrapperOuter.classed(c.absPosVert,t)),e){var i=this.element.node().offsetWidth-e-n.width;i=i<10?10:i,this.wrapperOuter.style("right",i+"px"),this.wrapperOuter.style("left","auto"),this.wrapperOuter.classed(c.absPosHoriz,i)}},clearPos:function(){this._top="",this._left="",this.wrapperOuter.attr("style",""),this.wrapperOuter.classed(c.absPosVert,""),this.wrapperOuter.classed(c.absPosHoriz,""),this.wrapperOuter.classed(c.menuOpenLeftSide,""),this.wrapper.style("max-height","")},setHorizontalMenuHeight:function(){var t=null;if(this.menuEntity&&1==this.OPTIONS.MENU_DIRECTION&&this.menuEntity.menuItems.length){var e=parseInt(this.menuEntity.menuItems[0].entity.style("height"),10)||0,n=e*this._maxChildCount,i=Math.max(this.menuEntity.menuItems.length,3)*e+this.menuEntity.entity.node().offsetTop+parseInt(this.wrapper.style("padding-bottom"),10);t=Math.max(n,i)+"px"}this.wrapper.classed(c.noTransition,!0),this.wrapper.node().offsetHeight,this.wrapper.style("height",t),this.wrapper.node().offsetHeight,this.wrapper.classed(c.noTransition,!1)},_enableSearch:function(){var t=this,e=this.wrapper.select("."+c.search),n=!1,r=i.debounce(function(){var r=e.node().value;(n||""!=r)&&(n=""!=r,r.length>=t.OPTIONS.SEARCH_MIN_STR?t.redraw(function(e){var n={_id:"root",children:[]},r=function(e,n,i){var r=n[i].name;return!r&&t.translator&&(r=t.translator("indicator/"+n[i][t.OPTIONS.SEARCH_PROPERTY]+"/"+t._targetModel._type)||t.translator("indicator/"+n[i][t.OPTIONS.SEARCH_PROPERTY])),r&&r.toLowerCase().indexOf(e.toLowerCase())>=0};return function i(a){for(var s=t.OPTIONS.SUBMENUS,o=0;o<a.length;o++){var l;(l=r(e,a,o))&&n.children.push(a[o]),!l&&a[o][s]&&i(a[o][s])}}(t.dataFiltered.children),n.children=i.unique(n.children,function(t){return t.id}),n}(r),!0):t.redraw())},250);e.on("input",r)},_selectIndicator:function(t){this._callback(this._targetProp,t),this.toggle()},redraw:function(t,e){var n=this,r=n._targetModel.isHook(),a=void 0,o=void 0,l={};i.forEach(this.model.marker._root._data,function(t){"data"===t._type&&i.deepExtend(l,t.getConceptprops())});var u=n._targetModel._type;e?a=t:(null==t&&(t=this._indicatorsTree),r?(o=i.keys(l).filter(function(t){if(n._targetModel.allow&&n._targetModel.allow.names){if(-1!=n._targetModel.allow.names.indexOf("!"+t))return!1;if(-1!=n._targetModel.allow.names.indexOf(t))return!0;if(n._targetModel.allow.namesOnlyThese)return!1}if(!n._targetModel.allow||!n._targetModel.allow.scales)return!0;if("*"==n._targetModel.allow.scales[0])return!0;if(!l[t].scales)return!0;for(var e=l[t].scales.length-1;e>=0;e--)if(n._targetModel.allow.scales.indexOf(l[t].scales[e])>-1)return!0;return!1}),a=i.pruneTree(t,function(t){return o.indexOf(t.id)>-1})):n._targetModel instanceof s.default?(o=t.children.map(function(t){return t.id}),a=i.pruneTree(t,function(t){return"space"==t.type})):(o=i.keys(l),a=i.pruneTree(t,function(t){return o.indexOf(t.id)>-1})),this.dataFiltered=a),this.wrapper.select("ul").remove();var d="";d=this._title||""===this._title?this._title:this.translator(n._targetModel instanceof s.default?n._targetModel._root._name+"/"+n._targetModel._name:"buttons/"+(r?n._targetModel._name:u+"/"+n._targetProp)),this.element.select("."+c.title).select("span").text(d),this.element.select("."+c.search).attr("placeholder",this.translator("placeholder/search")+"..."),this._maxChildCount=0;var f=n.translator("hints/nodescr");if(this.OPTIONS.IS_MOBILE?this.OPTIONS.MENU_DIRECTION=2:this.OPTIONS.MENU_DIRECTION=1,this.selectedNode=null,function t(e,r,a){if(r.children){n._maxChildCount=Math.max(n._maxChildCount,r.children.length);var s=(a?e:e.append("div").classed(c.list_outer,!0)).append("ul").classed(c.list,!a).classed(c.list_top_level,a).classed("vzb-dialog-scrollable",!0).selectAll("li").data(r.children,function(t){return t.id}).enter().append("li");s.append("span").classed(c.list_item_label,!0).attr("children",function(t){return t.children?"true":null}).attr("type",function(t){return t.type?t.type:null}).on("click",function(t){d3.select(this).attr("children")||(d3.event.stopPropagation(),n._selectIndicator({concept:t.id,key:t.key,dataSource:t.dataSource,use:t.use}))}).append("span").text(function(t){var e="_default"===t.id?n.translator("indicator/_default/"+u):t.name_catalog||t.name||t.id;return e||""===e||i.warn("translation missing: NAME of "+t.id),e||""}),s.classed(c.list_item,!0).classed(c.hasChild,function(t){return t.children}).classed(c.isSpecial,function(t){return t.special}).each(function(e){var r=d3.select(this);if(e.children||("_default"===e.id&&(e.name=n.translator("indicator/_default/"+u),e.description=n.translator("description/_default/"+u)),e.description||(e.description=f),e.translateContributionText=n.translator("dialogs/helptranslate"),r.append("div").attr("class",c.menuHorizontal+" "+c.list_outer+" "+c.list_item_leaf).on("click",function(t){n._selectIndicator({concept:t.id,key:t.key,dataSource:t.dataSource,use:t.use})})),e.id==n._targetModel[n._targetProp]){var s=void 0;if(n.selectedNode&&a)for(s=n.selectedNode.parentNode,d3.select(n.selectedNode).select("."+c.list_item_leaf).classed("active",!1);!i.hasClass(s,c.list_top_level);)"UL"==s.tagName&&d3.select(s.parentNode).classed("active",!1),s=s.parentNode;if(!n.selectedNode||a){for(s=this.parentNode,d3.select(this).classed("item-active",!0).select("."+c.list_item_leaf).classed("active",!0);!i.hasClass(s,c.list_top_level);)"UL"==s.tagName&&d3.select(s.parentNode).classed("active",!0),"LI"==s.tagName&&d3.select(s).classed("item-active",!0),s=s.parentNode;n.selectedNode=this}}t(r,e)})}}(this.wrapper,a,!0),this.menuEntity=new h(null,this.wrapper.selectAll("."+c.list_top_level),this.OPTIONS),this.menuEntity&&this.menuEntity.setDirection(this.OPTIONS.MENU_DIRECTION),this.menuEntity&&this.menuEntity.setWidth(this.activeProfile.col_width,!0,!0),this.setHorizontalMenuHeight(),!e){var p="_default";if(o.indexOf(this._targetModel[n._targetProp])>-1&&(p=this._targetModel[n._targetProp]),l[p]||i.error("Concept properties of "+p+" are missing from the set, or the set is empty. Put a breakpoint here and check what you have in indicatorsDB"),!l[p].scales)return this.element.select("."+c.scaletypes).classed(c.hidden,!0),!0;var v=r?l[p].scales.filter(function(t){return!n._targetModel.allow||!n._targetModel.allow.scales||("*"==n._targetModel.allow.scales[0]||n._targetModel.allow.scales.indexOf(t)>-1)}):[];if(0==v.length)this.element.select("."+c.scaletypes).classed(c.hidden,!0);else{var g=this.element.select("."+c.scaletypes).classed(c.hidden,!1).selectAll("span").data(v,function(t){return t});g.exit().remove(),g=g.enter().append("span").on("click",function(t){d3.event.stopPropagation(),n._setModel("scaleType",t)}).merge(g);var m=n._targetModel.scaleType;g.classed(c.scaletypesDisabled,v.length<2||n._scaletypeSelectorDisabled).classed(c.scaletypesActive,function(t){return(t==m||"log"===t&&"genericLog"===m)&&v.length>1}).text(function(t){return n.translator("scaletype/"+t)})}}return this},updateView:function(){if(this._targetModel){this.wrapperOuter.classed(c.absPosVert,this._top),this.wrapperOuter.classed(c.alignYt,"top"===this._alignY),this.wrapperOuter.classed(c.alignYb,"bottom"===this._alignY),this.wrapperOuter.classed(c.absPosHoriz,this._left),this.wrapperOuter.classed(c.alignXl,"left"===this._alignX),this.wrapperOuter.classed(c.alignXr,"right"===this._alignX);var t=this._setModel.bind(this);return this.callback(t).redraw(),this._ready&&this._showWhenReady&&this.setHiddenOrVisible(!1).showWhenReady(!1),this.wrapper.select("."+c.search).node().value="",this}},focusSearch:function(){var t=!(arguments.length>0&&void 0!==arguments[0])||arguments[0],e=this.wrapper.select("."+c.search).node();t?e.focus():e.blur()},_setModel:function(t,e){var n=this._targetModel;"which"==t&&n.setWhich(e),"scaleType"==t&&n.setScaleType(e),"space"==t&&n.setSpace(e.concept.split(","))}});e.default=f},function(t,e,n){var i={"./_dialog.js":12,"./about/about.js":171,"./axes/axes.js":172,"./colors/colors.js":174,"./dialogs.js":175,"./find/find.js":176,"./find/show.js":115,"./grouping/grouping.js":177,"./label/label.js":178,"./moreoptions/moreoptions.js":179,"./opacity/opacity.js":180,"./presentation/presentation.js":181,"./side/side.js":182,"./size/size.js":183,"./speed/speed.js":184,"./stack/stack.js":185,"./technical/technical.js":187,"./timedisplay/timedisplay.js":188,"./zoom/zoom.js":190};function r(t){var e=a(t);return n(e)}function a(t){if(!n.o(i,t)){var e=new Error("Cannot find module '"+t+"'");throw e.code="MODULE_NOT_FOUND",e}return i[t]}r.keys=function(){return Object.keys(i)},r.resolve=a,t.exports=r,r.id=432},function(t,e,n){var i={"./d3.axisWithLabelPicker.js":114,"./d3.collisionResolver.js":434,"./d3.colorPicker.js":169,"./d3.dynamicBackground.js":189,"./d3.genericLogScale.js":162,"./d3.geoProjection.js":435,"./d3.touchEvents.js":163,"./labels.js":436,"./requireAll.js":108,"./svgexport.js":438,"./textEllipsis.js":439,"./topojson.js":440};function r(t){var e=a(t);return n(e)}function a(t){if(!n.o(i,t)){var e=new Error("Cannot find module '"+t+"'");throw e.code="MODULE_NOT_FOUND",e}return i[t]}r.keys=function(){return Object.keys(i)},r.resolve=a,t.exports=r,r.id=433},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.default=function(){return function(){var t=300,e=0;function n(n){if(null!=i)if(null!=r)if(null!=s)if(null!=h){e=.8*n.node().getBBox().height;for(var a=n.filter(function(t){return l(t,o)}).sort(function(t,e){return d3.ascending(t.valueY,e.valueY)}).data(),c={},u=0;u<a.length-1;u++){var d=a[u],f=a[u+1];if(d.shiftY||(d.shiftY=0),f.shiftY=0,!(f.valueY-d.valueY-d.shiftY>=e)){var p=0;d.valueY>e&&(0==u?p=Math.min(e,d.valueY):d.valueY-a[u-1].valueY+a[u-1].shiftY>e&&(p=Math.min(e,d.valueY-a[u-1].valueY+a[u-1].shiftY))),d.upperAvailable=p;var v=0;f.valueY<r&&(u==a.length-2?v=Math.min(e,r-f.valueY):a[u+2].valueY-f.valueY>e&&(v=Math.min(e,a[u+2].valueY-f.valueY))),f.underAvailable=v;var g=e-(f.valueY-d.valueY-d.shiftY);c[d[h]]={},c[f[h]]={},p>=g/2&&v>=g/2?(d.shiftY=-g/2,f.shiftY=g/2):p>=g/2?(f.shiftY=v,d.shiftY=-Math.min(p,g-v)):v>=g/2?(d.shiftY-=p,f.shiftY=Math.min(v,g-p)):(d.shiftY=-p,f.shiftY=v),c[d[h]].valueY=d.valueY+d.shiftY,c[f[h]].valueY=f.valueY+f.shiftY}}n.each(function(e,n){c[e[h]]&&c[e[h]].valueY&&d3.select(this).selectAll(i).transition().duration(t).attr("transform","translate(0,"+c[e[h]].valueY+")")})}else console.warn("D3 collision resolver stopped: missing a key for data. Example: key = 'geo' ");else console.warn("D3 collision resolver stopped: missing pointer within data objects. Example: value = 'valueY' ");else console.warn("D3 collision resolver stopped: missing height of the canvas");else console.warn("D3 collision resolver stopped: missing a CSS slector")}var i=null;n.selector=function(t){return arguments.length?(i=t,n):i};var r=null;n.height=function(t){return arguments.length?(r=t,n):r};var a=d3.scaleLinear().domain([0,1]).range([0,1]);n.scale=function(t){return arguments.length?(a=t,n):a};var s=null;n.value=function(t){return arguments.length?(s=t,n):s};var o=null;n.time=function(t){return arguments.length?(o=t,n):o};var l=function(){return!0};n.filter=function(t){return arguments.length?(l=t,n):l};var c=null;n.fixed=function(t){return arguments.length?(c=t,n):c};var u=null;n.handleResult=function(t){return arguments.length?(u=t,n):u};var h=null;return n.KEY=function(t){return arguments.length?(h=t,n):h},n}()}},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.default=function(){function t(t,n){return{type:"Feature",id:t.id,properties:t.properties,geometry:e(t.geometry,n)}}function e(t,n){if(!t)return null;if("GeometryCollection"===t.type)return{type:"GeometryCollection",geometries:object.geometries.map(function(t){return e(t,n)})};if(!l.hasOwnProperty(t.type))return null;var i=l[t.type];return d3.geoUstream(t,n(i)),i.result()}d3.geoProject=function(t,i){var r=i.stream;if(!r)throw new Error("not yet supported");return(t&&n.hasOwnProperty(t.type)?n[t.type]:e)(t,r)};var n={Feature:t,FeatureCollection:function(e,n){return{type:"FeatureCollection",features:e.features.map(function(e){return t(e,n)})}}},i=[],r=[],a={point:function(t,e){i.push([t,e])},result:function(){var t=i.length?i.length<2?{type:"Point",coordinates:i[0]}:{type:"MultiPoint",coordinates:i}:null;return i=[],t}},s={lineStart:c,point:function(t,e){i.push([t,e])},lineEnd:function(){i.length&&(r.push(i),i=[])},result:function(){var t=r.length?r.length<2?{type:"LineString",coordinates:r[0]}:{type:"MultiLineString",coordinates:r}:null;return r=[],t}},o={polygonStart:c,lineStart:c,point:function(t,e){i.push([t,e])},lineEnd:function(){var t=i.length;if(t){do{i.push(i[0].slice())}while(++t<4);r.push(i),i=[]}},polygonEnd:c,result:function(){if(!r.length)return null;var t=[],e=[];return r.forEach(function(n){!function(t){if((e=t.length)<4)return!1;var e,n=0,i=t[e-1][1]*t[0][0]-t[e-1][0]*t[0][1];for(;++n<e;)i+=t[n-1][1]*t[n][0]-t[n-1][0]*t[n][1];return i<=0}(n)?e.push(n):t.push([n])}),e.forEach(function(e){var n=e[0];t.some(function(t){return!!function(t,e){for(var n=e[0],i=e[1],r=!1,a=0,s=t.length,o=s-1;a<s;o=a++){var l=t[a],c=l[0],u=l[1],h=t[o],d=h[0],f=h[1];u>i^f>i&&n<(d-c)*(i-u)/(f-u)+c&&(r=!r)}return r}(t[0],n)&&(t.push(e),!0)})||t.push([e])}),r=[],t.length?t.length>1?{type:"MultiPolygon",coordinates:t}:{type:"Polygon",coordinates:t[0]}:null}},l={Point:a,MultiPoint:a,LineString:s,MultiLineString:s,Polygon:o,MultiPolygon:o,Sphere:o};function c(){}var u=1e-6,h=u*u,d=Math.PI,f=d/2,p=Math.sqrt(d),v=d/180,g=180/d;function m(t){return t>0?1:t<0?-1:0}function b(t){return t>1?f:t<-1?-f:Math.asin(t)}function y(t){return t>1?0:t<-1?d:Math.acos(t)}function _(t){return t>0?Math.sqrt(t):0}var M=d3.geoProjection,w=d3.geoProjectionMutator;function x(t){var e=Math.tan(.5*t),n=2*Math.log(Math.cos(.5*t))/(e*e);function i(t,e){var i=Math.cos(t),r=Math.cos(e),a=Math.sin(e),s=r*i,o=-((1-s?Math.log(.5*(1+s))/(1-s):-.5)+n/(1+s));return[o*r*Math.sin(t),o*a]}return i.invert=function(e,i){var r,a=Math.sqrt(e*e+i*i),s=-.5*t,o=50;if(!a)return[0,0];do{var l=.5*s,c=Math.cos(l),h=Math.sin(l),d=Math.tan(l),f=Math.log(1/c);s-=r=(2/d*f-n*d-a)/(-f/(h*h)+1-n/(2*c*c))}while(Math.abs(r)>u&&--o>0);var p=Math.sin(s);return[Math.atan2(e*p,a*Math.cos(s)),b(i*p/a)]},i}function S(t,e){var n,i=Math.cos(e),r=(n=y(i*Math.cos(t/=2)))?n/Math.sin(n):1;return[2*i*Math.sin(t)*r,Math.sin(e)*r]}function z(t){var e=Math.sin(t),n=Math.cos(t),i=t>0?1:-1,r=Math.tan(i*t),a=(1+e-n)/2;function s(t,s){var o=Math.cos(s),l=Math.cos(t/=2);return[(1+o)*Math.sin(t),(i*s>-Math.atan2(l,r)-.001?0:10*-i)+a+Math.sin(s)*n-(1+o)*e*l]}return s.invert=function(t,s){var o=0,l=0,c=50;do{var h=Math.cos(o),d=Math.sin(o),f=Math.cos(l),p=Math.sin(l),v=1+f,g=v*d-t,m=a+p*n-v*e*h-s,b=.5*v*h,y=-d*p,_=.5*e*v*d,M=n*f+e*h*p,w=y*_-M*b,x=.5*(m*y-g*M)/w,S=(g*_-m*b)/w;o-=x,l-=S}while((Math.abs(x)>u||Math.abs(S)>u)&&--c>0);return i*l>-Math.atan2(Math.cos(o),r)-.001?[2*o,l]:null},s}function O(t){return.5*(Math.exp(t)-Math.exp(-t))}function k(t){return.5*(Math.exp(t)+Math.exp(-t))}function E(t,e){var n=Math.tan(e/2),i=_(1-n*n),r=1+i*Math.cos(t/=2),a=Math.sin(t)*i/r,s=n/r,o=a*a,l=s*s;return[4/3*a*(3+o-3*l),4/3*s*(3+3*o-l)]}d3.geoInterrupt=function(t){var e,n=[[[[-d,0],[0,f],[d,0]]],[[[-d,0],[0,-f],[d,0]]]];function i(e,i){for(var r=i<0?-1:1,a=n[+(i<0)],s=0,o=a.length-1;s<o&&e>a[s][2][0];++s);var l=t(e-a[s][1][0],i);return l[0]+=t(a[s][1][0],r*i>r*a[s][0][1]?a[s][0][1]:i)[0],l}t.invert&&(i.invert=function(r,a){for(var s=e[+(a<0)],l=n[+(a<0)],c=0,u=s.length;c<u;++c){var h=s[c];if(h[0][0]<=r&&r<h[1][0]&&h[0][1]<=a&&a<h[1][1]){var d=t.invert(r-t(l[c][1][0],0)[0],a);return d[0]+=l[c][1][0],o(i(d[0],d[1]),[r,a])?d:null}}});var r=d3.geoProjection(i),a=r.stream;function s(t,e){for(var n,i,r,a=-1,s=t.length,o=t[0],l=[];++a<s;){i=((n=t[a])[0]-o[0])/e,r=(n[1]-o[1])/e;for(var c=0;c<e;++c)l.push([o[0]+c*i,o[1]+c*r]);o=n}return l.push(n),l}function o(t,e){return Math.abs(t[0]-e[0])<u&&Math.abs(t[1]-e[1])<u}return r.stream=function(t){var e=r.rotate(),i=a(t),o=(r.rotate([0,0]),a(t));return r.rotate(e),i.sphere=function(){d3.geoStream(function(){for(var t=1e-6,e=[],i=0,r=n[0].length;i<r;++i){var a=n[0][i],o=180*a[0][0]/d,l=180*a[0][1]/d,c=180*a[1][1]/d,u=180*a[2][0]/d,h=180*a[2][1]/d;e.push(s([[o+t,l+t],[o+t,c-t],[u-t,c-t],[u-t,h+t]],30))}for(var i=n[1].length-1;i>=0;--i){var a=n[1][i],o=180*a[0][0]/d,l=180*a[0][1]/d,c=180*a[1][1]/d,u=180*a[2][0]/d,h=180*a[2][1]/d;e.push(s([[u-t,h-t],[u-t,c+t],[o+t,c+t],[o+t,l-t]],30))}return{type:"Polygon",coordinates:[d3.merge(e)]}}(),o)},i},r.lobes=function(i){return arguments.length?(n=i.map(function(t){return t.map(function(t){return[[t[0][0]*d/180,t[0][1]*d/180],[t[1][0]*d/180,t[1][1]*d/180],[t[2][0]*d/180,t[2][1]*d/180]]})}),e=n.map(function(e){return e.map(function(e){var n,i=t(e[0][0],e[0][1])[0],r=t(e[2][0],e[2][1])[0],a=t(e[1][0],e[0][1])[1],s=t(e[1][0],e[1][1])[1];return a>s&&(n=a,a=s,s=n),[[i,a],[r,s]]})}),r):n.map(function(t){return t.map(function(t){return[[180*t[0][0]/d,180*t[0][1]/d],[180*t[1][0]/d,180*t[1][1]/d],[180*t[2][0]/d,180*t[2][1]/d]]})})},r},(d3.geoAiry=function(){var t=f,e=w(x),n=e(t);return n.radius=function(n){return arguments.length?e(t=n*d/180):t/d*180},n}).raw=x,S.invert=function(t,e){if(!(t*t+4*e*e>d*d+u)){var n=t,i=e,r=25;do{var a,s=Math.sin(n),o=Math.sin(n/2),l=Math.cos(n/2),c=Math.sin(i),h=Math.cos(i),f=Math.sin(2*i),p=c*c,v=h*h,g=o*o,m=1-v*l*l,b=m?y(h*l)*Math.sqrt(a=1/m):a=0,_=2*b*h*o-t,M=b*c-e,w=a*(v*g+b*h*l*p),x=a*(.5*s*f-2*b*c*o),S=.25*a*(f*o-b*c*v*s),z=a*(p*l+b*g*h),O=x*S-z*w;if(!O)break;var k=(M*x-_*z)/O,E=(_*S-M*w)/O;n-=k,i-=E}while((Math.abs(k)>u||Math.abs(E)>u)&&--r>0);return[n,i]}},(d3.geoAitoff=function(){return M(S)}).raw=S,(d3.geoArmadillo=function(){var t=d/9,e=t>0?1:-1,n=Math.tan(e*t),i=w(z),r=i(t),a=r.stream;return r.parallel=function(r){return arguments.length?(n=Math.tan((e=(t=r*d/180)>0?1:-1)*t),i(t)):t/d*180},r.stream=function(i){var s=r.rotate(),o=a(i),l=(r.rotate([0,0]),a(i));return r.rotate(s),o.sphere=function(){l.polygonStart(),l.lineStart();for(var i=-180*e;e*i<180;i+=90*e)l.point(i,90*e);for(;e*(i-=t)>=-180;)l.point(i,e*-Math.atan2(Math.cos(i*v/2),n)*g);l.lineEnd(),l.polygonEnd()},o},r}).raw=z,E.invert=function(t,e){if(e*=3/8,!(t*=3/8)&&Math.abs(e)>1)return null;var n=1+t*t+e*e,i=Math.sqrt(.5*(n-Math.sqrt(n*n-4*e*e))),r=b(i)/3,a=i?function(t){return Math.log(t+_(t*t-1))}(Math.abs(e/i))/3:function(t){return Math.log(t+_(t*t+1))}(Math.abs(t))/3,s=Math.cos(r),o=k(a),l=o*o-s*s;return[2*m(t)*Math.atan2(O(a)*s,.25-l),2*m(e)*Math.atan2(o*Math.sin(r),.25+l)]},(d3.geoAugust=function(){return M(E)}).raw=E;var T=Math.log(1+Math.SQRT2);function P(t,e){var n=Math.abs(e);return n<d/4?[t,Math.log(Math.tan(d/4+e/2))]:[t*Math.cos(n)*(2*Math.SQRT2-1/Math.sin(n)),m(e)*(2*Math.SQRT2*(n-d/4)-Math.log(Math.tan(n/2)))]}P.invert=function(t,e){if((i=Math.abs(e))<T)return[t,2*Math.atan(Math.exp(e))-f];var n,i,r=Math.sqrt(8),a=d/4,s=25;do{var o=Math.cos(a/2),l=Math.tan(a/2);a-=n=(r*(a-d/4)-Math.log(l)-i)/(r-.5*o*o/l)}while(Math.abs(n)>h&&--s>0);return[t/(Math.cos(a)*(r-1/Math.sin(a))),m(e)*a]},(d3.geoBaker=function(){return M(P)}).raw=P;var A=d3.geoAzimuthalEquidistant.raw;function C(t){var e=2*d/t;function n(t,n){var i=A(t,n);if(Math.abs(t)>f){var r=Math.atan2(i[1],i[0]),a=Math.sqrt(i[0]*i[0]+i[1]*i[1]),s=e*Math.round((r-f)/e)+f,o=Math.atan2(Math.sin(r-=s),2-Math.cos(r));r=s+b(d/a*Math.sin(o))-o,i[0]=a*Math.cos(r),i[1]=a*Math.sin(r)}return i}return n.invert=function(t,n){var i=Math.sqrt(t*t+n*n);if(i>f){var r=Math.atan2(n,t),a=e*Math.round((r-f)/e)+f,s=r>a?-1:1,o=i*Math.cos(a-r),l=1/Math.tan(s*Math.acos((o-d)/Math.sqrt(d*(d-2*o)+i*i)));r=a+2*Math.atan((l+s*Math.sqrt(l*l-3))/3),t=i*Math.cos(r),n=i*Math.sin(r)}return A.invert(t,n)},n}function L(t){return function(e){var n,i=t*Math.sin(e),r=30;do{e-=n=(e+Math.sin(e)-i)/(1+Math.cos(e))}while(Math.abs(n)>u&&--r>0);return e/2}}function D(t,e,n){var i=L(n);function r(n,r){return[t*n*Math.cos(r=i(r)),e*Math.sin(r)]}return r.invert=function(i,r){var a=b(r/e);return[i/(t*Math.cos(a)),b((2*a+Math.sin(2*a))/n)]},r}(d3.geoBerghaus=function(){var t=5,e=w(C),n=e(t),i=n.stream,r=.01,a=-Math.cos(r*v),s=Math.sin(r*v);return n.lobes=function(n){return arguments.length?e(t=+n):t},n.stream=function(e){var o=n.rotate(),l=i(e),c=(n.rotate([0,0]),i(e));return n.rotate(o),l.sphere=function(){c.polygonStart(),c.lineStart();for(var e=0,n=360/t,i=2*d/t,o=90-180/t,l=f;e<t;++e,o-=n,l-=i)c.point(Math.atan2(s*Math.cos(l),a)*g,b(s*Math.sin(l))*g),o<-90?(c.point(-90,-180-o-r),c.point(-90,-180-o+r)):(c.point(90,o+r),c.point(90,o-r));c.lineEnd(),c.polygonEnd()},l},n}).raw=C;var I=L(d),F=D(Math.SQRT2/f,Math.SQRT2,d);function j(t,e){var n=2.00276,i=I(e);return[n*t/(1/Math.cos(e)+1.11072/Math.cos(i)),(e+Math.SQRT2*Math.sin(i))/n]}function R(t){var e=0,n=w(t),i=n(e);return i.parallel=function(t){return arguments.length?n(e=t*d/180):e/d*180},i}function N(t,e){return[t*Math.cos(e),e]}function q(t){if(!t)return N;var e=1/Math.tan(t);function n(n,i){var r=e+t-i,a=r?n*Math.cos(i)/r:r;return[r*Math.sin(a),e-r*Math.cos(a)]}return n.invert=function(n,i){var r=Math.sqrt(n*n+(i=e-i)*i),a=e+t-r;return[r/Math.cos(a)*Math.atan2(n,i),a]},n}(d3.geoMollweide=function(){return M(F)}).raw=F,j.invert=function(t,e){var n,i,r=2.00276,a=r*e,s=e<0?-d/4:d/4,o=25;do{i=a-Math.SQRT2*Math.sin(s),s-=n=(Math.sin(2*s)+2*s-d*Math.sin(i))/(2*Math.cos(2*s)+2+d*Math.cos(i)*Math.SQRT2*Math.cos(s))}while(Math.abs(n)>u&&--o>0);return i=a-Math.SQRT2*Math.sin(s),[t*(1/Math.cos(i)+1.11072/Math.cos(s))/r,i]},(d3.geoBoggs=function(){return M(j)}).raw=j,N.invert=function(t,e){return[t/Math.cos(e),e]},(d3.geoSinusoidal=function(){return M(N)}).raw=N,(d3.geoBonne=function(){return R(q).parallel(45)}).raw=q;var B=D(1,4/d,d);function H(t){for(var e,n=(t=t.map(function(t){return[t[0],t[1],Math.sin(t[1]),Math.cos(t[1])]}))[2],i=0;i<3;++i,n=e)e=t[i],n.v=V(e[1]-n[1],n[3],n[2],e[3],e[2],e[0]-n[0]),n.point=[0,0];var r=W(t[0].v[0],t[2].v[0],t[1].v[0]),a=W(t[0].v[0],t[1].v[0],t[2].v[0]),s=d-r;t[2].point[1]=0,t[0].point[0]=-(t[1].point[0]=.5*t[0].v[0]);var o=[t[2].point[0]=t[0].point[0]+t[2].v[0]*Math.cos(r),2*(t[0].point[1]=t[1].point[1]=t[2].v[0]*Math.sin(r))];return function(e,n){for(var i=Math.sin(n),r=Math.cos(n),l=new Array(3),c=0;c<3;++c){var u=t[c];if(l[c]=V(n-u[1],u[3],u[2],r,i,e-u[0]),!l[c][0])return u.point;l[c][1]=U(l[c][1]-u.v[1])}var h=o.slice();for(c=0;c<3;++c){var d=2==c?0:c+1,f=W(t[c].v[0],l[c][0],l[d][0]);l[c][1]<0&&(f=-f),c?1==c?(f=a-f,h[0]-=l[c][0]*Math.cos(f),h[1]-=l[c][0]*Math.sin(f)):(f=s-f,h[0]+=l[c][0]*Math.cos(f),h[1]+=l[c][0]*Math.sin(f)):(h[0]+=l[c][0]*Math.cos(f),h[1]-=l[c][0]*Math.sin(f))}return h[0]/=3,h[1]/=3,h}}function V(t,e,n,i,r,a){var s,o=Math.cos(a);if(Math.abs(t)>1||Math.abs(a)>1)s=y(n*r+e*i*o);else{var l=Math.sin(.5*t),c=Math.sin(.5*a);s=2*b(Math.sqrt(l*l+e*i*c*c))}return Math.abs(s)>u?[s,Math.atan2(i*Math.sin(a),e*r-n*i*o)]:[0,0]}function W(t,e,n){return y(.5*(t*t+e*e-n*n)/(t*e))}function U(t){return t-2*d*Math.floor((t+d)/(2*d))}function Y(t){return[t[0]*v,t[1]*v]}function G(t,e){var n=_(1-Math.sin(e));return[2/p*t*n,p*(1-n)]}function K(t){var e=Math.tan(t);function n(t,n){return[t,(t?t/Math.sin(t):1)*(Math.sin(n)*Math.cos(t)-e*Math.cos(n))]}return n.invert=e?function(t,n){t&&(n*=Math.sin(t)/t);var i=Math.cos(t);return[t,2*Math.atan2(Math.sqrt(i*i+e*e-n*n)-i,e-n)]}:function(t,e){return[t,b(t?e*Math.tan(t)/t:e)]},n}function X(t,e){var n=Math.sqrt(3);return[n*t*(2*Math.cos(2*e/3)-1)/p,n*p*Math.sin(e/3)]}function Q(t){var e=Math.cos(t);function n(t,n){return[t*e,Math.sin(n)/e]}return n.invert=function(t,n){return[t/e,b(n*e)]},n}function $(t){var e=Math.cos(t);function n(t,n){return[t*e,(1+e)*Math.tan(.5*n)]}return n.invert=function(t,n){return[t/e,2*Math.atan(n/(1+e))]},n}function J(t,e){var n=Math.sqrt(8/(3*d));return[n*t*(1-Math.abs(e)/d),n*e]}function Z(t,e){var n=Math.sqrt(4-3*Math.sin(Math.abs(e)));return[2/Math.sqrt(6*d)*t*n,m(e)*Math.sqrt(2*d/3)*(2-n)]}function tt(t,e){var n=Math.sqrt(d*(4+d));return[2/n*t*(1+Math.sqrt(1-4*e*e/(d*d))),4/n*e]}function et(t,e){var n=(2+f)*Math.sin(e);e/=2;for(var i=0,r=1/0;i<10&&Math.abs(r)>u;i++){var a=Math.cos(e);e-=r=(e+Math.sin(e)*(a+2)-n)/(2*a*(1+a))}return[2/Math.sqrt(d*(4+d))*t*(1+Math.cos(e)),2*Math.sqrt(d/(4+d))*Math.sin(e)]}function nt(t,e){return[t*(1+Math.cos(e))/Math.sqrt(2+d),2*e/Math.sqrt(2+d)]}function it(t,e){for(var n=(1+f)*Math.sin(e),i=0,r=1/0;i<10&&Math.abs(r)>u;i++)e-=r=(e+Math.sin(e)-n)/(1+Math.cos(e));return n=Math.sqrt(2+d),[t*(1+Math.cos(e))/n,2*e/n]}function rt(t,e){var n=Math.sin(t/=2),i=Math.cos(t),r=Math.sqrt(Math.cos(e)),a=Math.cos(e/=2),s=Math.sin(e)/(a+Math.SQRT2*i*r),o=Math.sqrt(2/(1+s*s)),l=Math.sqrt((Math.SQRT2*a+(i+n)*r)/(Math.SQRT2*a+(i-n)*r));return[at*(o*(l-1/l)-2*Math.log(l)),at*(o*s*(l+1/l)-2*Math.atan(s))]}(d3.geoBromley=function(){return M(B)}).raw=B,(d3.geoChamberlin=function(){var t=[[0,0],[0,0],[0,0]],e=w(H),n=e(t),i=n.rotate;return delete n.rotate,n.points=function(r){if(!arguments.length)return t;t=r;var a=d3.geoCentroid({type:"MultiPoint",coordinates:t}),s=[-a[0],-a[1]];return i.call(n,s),e(t.map(d3.geoRotation(s)).map(Y))},n.points([[-150,55],[-35,55],[-92.5,10]])}).raw=H,G.invert=function(t,e){var n=(n=e/p-1)*n;return[n>0?t*Math.sqrt(d/n)/2:0,b(1-n)]},(d3.geoCollignon=function(){return M(G)}).raw=G,(d3.geoCraig=function(){return R(K)}).raw=K,X.invert=function(t,e){var n=Math.sqrt(3),i=3*b(e/(n*p));return[p*t/(n*(2*Math.cos(2*i/3)-1)),i]},(d3.geoCraster=function(){return M(X)}).raw=X,(d3.geoCylindricalEqualArea=function(){return R(Q)}).raw=Q,(d3.geoCylindricalStereographic=function(){return R($)}).raw=$,J.invert=function(t,e){var n=Math.sqrt(8/(3*d)),i=e/n;return[t/(n*(1-Math.abs(i)/d)),i]},(d3.geoEckert1=function(){return M(J)}).raw=J,Z.invert=function(t,e){var n=2-Math.abs(e)/Math.sqrt(2*d/3);return[t*Math.sqrt(6*d)/(2*n),m(e)*b((4-n*n)/3)]},(d3.geoEckert2=function(){return M(Z)}).raw=Z,tt.invert=function(t,e){var n=Math.sqrt(d*(4+d))/2;return[t*n/(1+_(1-e*e*(4+d)/(4*d))),e*n/2]},(d3.geoEckert3=function(){return M(tt)}).raw=tt,et.invert=function(t,e){var n=.5*e*Math.sqrt((4+d)/d),i=b(n),r=Math.cos(i);return[t/(2/Math.sqrt(d*(4+d))*(1+r)),b((i+n*(r+2))/(2+f))]},(d3.geoEckert4=function(){return M(et)}).raw=et,nt.invert=function(t,e){var n=Math.sqrt(2+d),i=e*n/2;return[n*t/(1+Math.cos(i)),i]},(d3.geoEckert5=function(){return M(nt)}).raw=nt,it.invert=function(t,e){var n=1+f,i=Math.sqrt(n/2);return[2*t*i/(1+Math.cos(e*=i)),b((e+Math.sin(e))/n)]},(d3.geoEckert6=function(){return M(it)}).raw=it,rt.invert=function(t,e){var n=d3.geoAugust.raw.invert(t/1.2,1.065*e);if(!n)return null;var i=n[0],r=n[1],a=20;t/=at,e/=at;do{var s=i/2,o=r/2,l=Math.sin(s),c=Math.cos(s),h=Math.sin(o),d=Math.cos(o),p=Math.cos(r),v=Math.sqrt(p),g=h/(d+Math.SQRT2*c*v),m=g*g,b=Math.sqrt(2/(1+m)),y=(Math.SQRT2*d+(c+l)*v)/(Math.SQRT2*d+(c-l)*v),_=Math.sqrt(y),M=_-1/_,w=_+1/_,x=b*M-2*Math.log(_)-t,S=b*g*w-2*Math.atan(g)-e,z=h&&Math.SQRT1_2*v*l*m/h,O=(Math.SQRT2*c*d+v)/(2*(d+Math.SQRT2*c*v)*(d+Math.SQRT2*c*v)*v),k=-.5*g*b*b*b,E=k*z,T=k*O,P=(P=2*d+Math.SQRT2*v*(c-l))*P*_,A=(Math.SQRT2*c*d*v+p)/P,C=-Math.SQRT2*l*h/(v*P),L=M*E-2*A/_+b*(A+A/y),D=M*T-2*C/_+b*(C+C/y),I=g*w*E-2*z/(1+m)+b*w*z+b*g*(A-A/y),F=g*w*T-2*O/(1+m)+b*w*O+b*g*(C-C/y),j=D*I-F*L;if(!j)break;var R=(S*D-x*F)/j,N=(x*I-S*L)/j;i-=R,r=Math.max(-f,Math.min(f,r-N))}while((Math.abs(R)>u||Math.abs(N)>u)&&--a>0);return Math.abs(Math.abs(r)-f)<u?[0,r]:a&&[i,r]};var at=3+2*Math.SQRT2;function st(t,e){var n=Math.tan(e/2);return[t*ot*_(1-n*n),(1+ot)*n]}(d3.geoEisenlohr=function(){return M(rt)}).raw=rt,st.invert=function(t,e){var n=e/(1+ot);return[t?t/(ot*_(1-n*n)):0,2*Math.atan(n)]};var ot=Math.cos(35*v);function lt(t,e){var n=e/2,i=Math.cos(n);return[2*t/p*Math.cos(e)*i*i,p*Math.tan(n)]}(d3.geoFahey=function(){return M(st)}).raw=st,lt.invert=function(t,e){var n=Math.atan(e/p),i=Math.cos(n),r=2*n;return[t*p*.5/(Math.cos(r)*i*i),r]},(d3.geoFoucaut=function(){return M(lt)}).raw=lt,d3.geoGilbert=function(t){var e=d3.geoEquirectangular().scale(g).translate([0,0]);function n(e){return t([.5*e[0],b(Math.tan(.5*e[1]*v))*g])}return t.invert&&(n.invert=function(e){return(e=t.invert(e))[0]*=2,e[1]=2*Math.atan(Math.sin(e[1]*v))*g,e}),n.stream=function(n){n=t.stream(n);var i=e.stream({point:function(t,e){n.point(.5*t,b(Math.tan(.5*-e*v))*g)},lineStart:function(){n.lineStart()},lineEnd:function(){n.lineEnd()},polygonStart:function(){n.polygonStart()},polygonEnd:function(){n.polygonEnd()}});return i.sphere=function(){n.sphere()},i.valid=!1,i},n};var ct=d3.geoAzimuthalEquidistant.raw;function ut(t,e){var n=2*d/e,i=t*t;function r(e,r){var a=ct(e,r),s=a[0],o=a[1],l=s*s+o*o;if(l>i){var c=Math.sqrt(l),h=Math.atan2(o,s),p=n*Math.round(h/n),v=h-p,g=t*Math.cos(v),m=(t*Math.sin(v)-v*Math.sin(g))/(f-g),b=ht(v,m),y=(d-t)/dt(b,g,d);s=c;var _,M=50;do{s-=_=(t+dt(b,g,s)*y-c)/(b(s)*y)}while(Math.abs(_)>u&&--M>0);o=v*Math.sin(s),s<f&&(o-=m*(s-f));var w=Math.sin(p),x=Math.cos(p);a[0]=s*x-o*w,a[1]=s*w+o*x}return a}return r.invert=function(e,r){var a=e*e+r*r;if(a>i){var s=Math.sqrt(a),o=Math.atan2(r,e),l=n*Math.round(o/n),c=o-l;e=s*Math.cos(c);r=s*Math.sin(c);for(var u=e-f,p=Math.sin(e),v=r/p,g=e<f?1/0:0,m=10;;){var b=t*Math.sin(v),y=t*Math.cos(v),_=Math.sin(y),M=f-y,w=(b-v*_)/M,x=ht(v,w);if(Math.abs(g)<h||!--m)break;v-=g=(v*p-w*u-r)/(p-2*u*(M*(y+v*b*Math.cos(y)-_)-b*(b-v*_))/(M*M))}o=l+v,e=(s=t+dt(x,y,e)*(d-t)/dt(x,y,d))*Math.cos(o),r=s*Math.sin(o)}return ct.invert(e,r)},r}function ht(t,e){return function(n){var i=t*Math.cos(n);return n<f&&(i-=e),Math.sqrt(1+i*i)}}function dt(t,e,n){for(var i=(n-e)/50,r=t(e)+t(n),a=1,s=e;a<50;++a)r+=2*t(s+=i);return.5*r*i}function ft(t,e,n,i,r,a,s,o){function l(l,c){if(!c)return[t*l/d,0];var u=c*c,h=t+u*(e+u*(n+u*i)),f=c*(r-1+u*(a-o+u*s)),p=(h*h+f*f)/(2*f),v=l*Math.asin(h/p)/d;return[p*Math.sin(v),c*(1+u*o)+p*(1-Math.cos(v))]}return arguments.length<8&&(o=0),l.invert=function(l,c){var h,f,p=d*l/t,v=c,g=50;do{var m=v*v,b=t+m*(e+m*(n+m*i)),y=v*(r-1+m*(a-o+m*s)),M=b*b+y*y,w=2*y,x=M/w,S=x*x,z=Math.asin(b/x)/d,O=p*z;if(xB2=b*b,dxBdφ=(2*e+m*(4*n+6*m*i))*v,dyBdφ=r+m*(3*a+5*m*s),dpdφ=2*(b*dxBdφ+y*(dyBdφ-1)),dqdφ=2*(dyBdφ-1),dmdφ=(dpdφ*w-M*dqdφ)/(w*w),cosα=Math.cos(O),sinα=Math.sin(O),mcosα=x*cosα,msinα=x*sinα,dαdφ=p/d*(1/_(1-xB2/S))*(dxBdφ*x-b*dmdφ)/S,fx=msinα-l,fy=v*(1+m*o)+x-mcosα-c,δxδφ=dmdφ*sinα+mcosα*dαdφ,δxδλ=mcosα*z,δyδφ=1+dmdφ-(dmdφ*cosα-msinα*dαdφ),δyδλ=msinα*z,denominator=δxδφ*δyδλ-δyδφ*δxδλ,!denominator)break;p-=h=(fy*δxδφ-fx*δyδφ)/denominator,v-=f=(fx*δyδλ-fy*δxδλ)/denominator}while((Math.abs(h)>u||Math.abs(f)>u)&&--g>0);return[p,v]},l}(d3.geoGingery=function(){var t=6,e=30*v,n=Math.cos(e),i=Math.sin(e),r=w(ut),a=r(e,t),s=a.stream,o=-Math.cos(.01*v),l=Math.sin(.01*v);return a.radius=function(a){return arguments.length?(n=Math.cos(e=a*v),i=Math.sin(e),r(e,t)):e*g},a.lobes=function(n){return arguments.length?r(e,t=+n):t},a.stream=function(e){var r=a.rotate(),c=s(e),u=(a.rotate([0,0]),s(e));return a.rotate(r),c.sphere=function(){u.polygonStart(),u.lineStart();for(var e=0,r=2*d/t,a=0;e<t;++e,a-=r)u.point(Math.atan2(l*Math.cos(a),o)*g,Math.asin(l*Math.sin(a))*g),u.point(Math.atan2(i*Math.cos(a-r/2),n)*g,Math.asin(i*Math.sin(a-r/2))*g);u.lineEnd(),u.polygonEnd()},c},a}).raw=ut;var pt=ft(2.8284,-1.6988,.75432,-.18071,1.76003,-.38914,.042555);(d3.geoGinzburg4=function(){return M(pt)}).raw=pt;var vt=ft(2.583819,-.835827,.170354,-.038094,1.543313,-.411435,.082742);(d3.geoGinzburg5=function(){return M(vt)}).raw=vt;var gt=ft(5/6*d,-.62636,-.0344,0,1.3493,-.05524,0,.045);function mt(t,e){var n=t*t,i=e*e;return[t*(1-.162388*i)*(.87-952426e-9*n*n),e*(1+i/12)]}(d3.geoGinzburg6=function(){return M(gt)}).raw=gt,mt.invert=function(t,e){var n,i=t,r=e,a=50;do{var s=r*r;r-=n=(r*(1+s/12)-e)/(1+s/4)}while(Math.abs(n)>u&&--a>0);a=50,t/=1-.162388*s;do{var o=(o=i*i)*o;i-=n=(i*(.87-952426e-9*o)-t)/(.87-.00476213*o)}while(Math.abs(n)>u&&--a>0);return[i,r]},(d3.geoGinzburg8=function(){return M(mt)}).raw=mt;var bt=ft(2.6516,-.76534,.19123,-.047094,1.36289,-.13965,.031762);function yt(t){var e=t(f,0)[0]-t(-f,0)[0];function n(){var t=!1,e=w(i),n=e(t);return n.quincuncial=function(n){return arguments.length?e(t=!!n):t},n}function i(n){var i=n?function(n,i){var r=Math.abs(n)<f,a=t(r?n:n>0?n-d:n+d,i),s=(a[0]-a[1])*Math.SQRT1_2,o=(a[0]+a[1])*Math.SQRT1_2;if(r)return[s,o];var l=e*Math.SQRT1_2,c=s>0^o>0?-1:1;return[c*s-m(o)*l,c*o-m(s)*l]}:function(n,i){var r=n>0?-.5:.5,a=t(n+r*d,i);return a[0]-=r*e,a};return t.invert&&(i.invert=n?function(n,i){var r=(n+i)*Math.SQRT1_2,a=(i-n)*Math.SQRT1_2,s=Math.abs(r)<.5*e&&Math.abs(a)<.5*e;if(!s){var o=e*Math.SQRT1_2,l=r>0^a>0?-1:1,c=-l*(n+(a>0?1:-1)*o),u=-l*(i+(r>0?1:-1)*o);r=(-c-u)*Math.SQRT1_2,a=(c-u)*Math.SQRT1_2}var h=t.invert(r,a);return s||(h[0]+=r>0?d:-d),h}:function(n,i){var r=n>0?-.5:.5,a=t.invert(n+r*e,i),s=a[0]-r*d;return s<-d?s+=2*d:s>d&&(s-=2*d),a[0]=s,a}),i}return n.raw=i,n}function _t(t,e){var n=m(t),i=m(e),r=Math.cos(e),a=Math.cos(t)*r,s=Math.sin(t)*r,o=Math.sin(i*e);t=Math.abs(Math.atan2(s,o)),e=b(a),Math.abs(t-f)>u&&(t%=f);var l=function(t,e){if(e===f)return[0,0];var n=Math.sin(e),i=n*n,r=i*i,a=1+r,s=1+3*r,o=1-r,l=b(1/Math.sqrt(a)),c=o+i*a*l,h=(1-n)/c,p=Math.sqrt(h),v=h*a,g=Math.sqrt(v),m=p*o;if(0===t)return[0,-(m+i*g)];var y=Math.cos(e),M=1/y,w=2*n*y,x=(-c*y-(-3*i+l*s)*w*(1-n))/(c*c),S=-M*w,z=-M*(i*a*x+h*s*w),O=-2*M*(o*(.5*x/p)-2*i*p*w),k=4*t/d;if(t>.222*d||e<d/4&&t>.175*d){var E=(m+i*_(v*(1+r)-m*m))/(1+r);if(t>d/4)return[E,E];var T=E,P=.5*E,A=50;E=.5*(P+T);do{var C=Math.sqrt(v-E*E),L=E*(O+S*C)+z*b(E/g)-k;if(!L)break;L<0?P=E:T=E,E=.5*(P+T)}while(Math.abs(T-P)>u&&--A>0)}else{var D,E=u,A=25;do{var I=E*E,C=_(v-I),F=O+S*C,L=E*F+z*b(E/g)-k,j=F+(z-S*I)/C;E-=D=C?L/j:0}while(Math.abs(D)>u&&--A>0)}return[E,-m-i*_(v-E*E)]}(t>d/4?f-t:t,e);return t>d/4&&(o=l[0],l[0]=-l[1],l[1]=-o),l[0]*=n,l[1]*=-i,l}function Mt(t,e){var n,i,r,a,s,o;if(e<u)return[(a=Math.sin(t))-(n=.25*e*(t-a*(i=Math.cos(t))))*i,i+n*a,1-.5*e*a*a,t-n];if(e>=1-u)return n=.25*(1-e),i=k(t),o=t,r=1/i,[(a=((o=Math.exp(2*o))-1)/(o+1))+n*((s=i*O(t))-t)/(i*i),r-n*a*r*(s-t),r+n*a*r*(s+t),2*Math.atan(Math.exp(t))-f+n*(s-t)/i];var l=[1,0,0,0,0,0,0,0,0],c=[Math.sqrt(e),0,0,0,0,0,0,0,0],h=0;for(i=Math.sqrt(1-e),s=1;Math.abs(c[h]/l[h])>u&&h<8;)n=l[h++],c[h]=.5*(n-i),l[h]=.5*(n+i),i=_(n*i),s*=2;r=s*l[h]*t;do{r=.5*(b(a=c[h]*Math.sin(i=r)/l[h])+r)}while(--h);return[Math.sin(r),a=Math.cos(r),a/Math.cos(r-i),r]}function wt(t,e){if(!e)return t;if(1===e)return Math.log(Math.tan(t/2+d/4));for(var n=1,i=Math.sqrt(1-e),r=Math.sqrt(e),a=0;Math.abs(r)>u;a++){if(t%d){var s=Math.atan(i*Math.tan(t)/n);s<0&&(s+=d),t+=s+~~(t/d)*d}else t+=t;r=(n+i)/2,i=Math.sqrt(n*i),r=((n=r)-i)/2}return t/(Math.pow(2,a)*n)}function xt(t,e){var n=(Math.SQRT2-1)/(Math.SQRT2+1),i=Math.sqrt(1-n*n),r=wt(f,i*i),a=Math.log(Math.tan(d/4+Math.abs(e)/2)),s=Math.exp(-1*a)/Math.sqrt(n),o=function(t,e){var n=t*t,i=e+1,r=1-n-e*e;return[.5*((t>=0?f:-f)-Math.atan2(r,2*t)),-.25*Math.log(r*r+4*n)+.5*Math.log(i*i+n)]}(s*Math.cos(-1*t),s*Math.sin(-1*t)),l=function(t,e,n){var i=Math.abs(t),r=O(Math.abs(e));if(i){var a=1/Math.sin(i),s=1/(Math.tan(i)*Math.tan(i)),o=-(s+n*r*r*a*a-1+n),l=(n-1)*s,c=.5*(-o+Math.sqrt(o*o-4*l));return[wt(Math.atan(1/Math.sqrt(c)),n)*m(t),wt(Math.atan(_((c/s-1)/n)),1-n)*m(e)]}return[0,wt(Math.atan(r),1-n)*m(e)]}(o[0],o[1],i*i);return[-l[1],(e>=0?1:-1)*(.5*r-l[0])]}function St(t){var e=Math.sin(t),n=Math.cos(t),i=zt(t);function r(t,r){var a=i(t,r);t=a[0],r=a[1];var s=Math.sin(r),o=Math.cos(r),l=Math.cos(t),c=y(e*s+n*o*l),h=Math.sin(c),d=Math.abs(h)>u?c/h:1;return[d*n*Math.sin(t),(Math.abs(t)>f?d:-d)*(e*o-n*s*l)]}return i.invert=zt(-t),r.invert=function(t,n){var r=Math.sqrt(t*t+n*n),a=-Math.sin(r),s=Math.cos(r),o=r*s,l=-n*a,c=r*e,u=_(o*o+l*l-c*c),h=Math.atan2(o*c+l*u,l*c-o*u),d=(r>f?-1:1)*Math.atan2(t*a,r*Math.cos(h)*s+n*Math.sin(h)*a);return i.invert(d,h)},r}function zt(t){var e=Math.sin(t),n=Math.cos(t);return function(t,i){var r=Math.cos(i),a=Math.cos(t)*r,s=Math.sin(t)*r,o=Math.sin(i);return[Math.atan2(s,a*n-o*e),b(o*n+a*e)]}}(d3.geoGinzburg9=function(){return M(bt)}).raw=bt,_t.invert=function(t,e){var n=m(t),i=m(e),r=-n*t,a=-i*e,s=a/r<1,o=function(t,e){var n=0,i=1,r=.5,a=50;for(;;){var s=r*r,o=Math.sqrt(r),l=Math.asin(1/Math.sqrt(1+s)),c=1-s+r*(1+s)*l,u=(1-o)/c,f=Math.sqrt(u),p=u*(1+s),v=f*(1-s),g=p-t*t,m=Math.sqrt(g),b=e+v+r*m;if(Math.abs(i-n)<h||0==--a||0===b)break;b>0?n=r:i=r,r=.5*(n+i)}if(!a)return null;var y=Math.asin(o),_=Math.cos(y),M=1/_,w=2*o*_,x=(-c*_-(-3*r+l*(1+3*s))*w*(1-o))/(c*c);return[d/4*(t*(-2*M*(.5*x/f*(1-s)-2*r*f*w)+-M*w*m)+-M*(r*(1+s)*x+u*(1+3*s)*w)*Math.asin(t/Math.sqrt(p))),y]}(s?a:r,s?r:a),l=o[0],c=o[1];s&&(l=-f-l);var u=Math.cos(c),p=(t=Math.cos(l)*u,e=Math.sin(l)*u,Math.sin(c));return[n*(Math.atan2(e,-p)+d),i*b(t)]},d3.geoGringorten=yt(_t),xt.invert=function(t,e){var n,i,r,a=(Math.SQRT2-1)/(Math.SQRT2+1),s=Math.sqrt(1-a*a),o=function(t,e,n){if(!t)return[[0,(r=Mt(e,1-n))[0]/r[1]],[1/r[1],0],[r[2]/r[1],0]];var i=Mt(t,n);if(!e)return[[i[0],0],[i[1],0],[i[2],0]];var r,a=(r=Mt(e,1-n))[1]*r[1]+n*i[0]*i[0]*r[0]*r[0];return[[i[0]*r[2]/a,i[1]*i[2]*r[0]*r[1]/a],[i[1]*r[1]/a,-i[0]*i[2]*r[0]*r[2]/a],[i[2]*r[1]*r[2]/a,-n*i[0]*i[1]*r[0]/a]]}(.5*wt(f,s*s)-e,-t,s*s),l=(n=o[0],i=o[1],r=i[0]*i[0]+i[1]*i[1],[(n[0]*i[0]+n[1]*i[1])/r,(n[1]*i[0]-n[0]*i[1])/r]);return[Math.atan2(l[1],l[0])/-1,2*Math.atan(Math.exp(-.5*Math.log(a*l[0]*l[0]+a*l[1]*l[1])))-f]},d3.geoGuyou=yt(xt),(d3.geoHammerRetroazimuthal=function(){var t=0,e=w(St),n=e(t),i=n.rotate,r=n.stream,a=d3.geoCircle();return n.parallel=function(i){if(!arguments.length)return t/d*180;var r=n.rotate();return e(t=i*d/180).rotate(r)},n.rotate=function(e){return arguments.length?(i.call(n,[e[0],e[1]-t/d*180]),a.center([-e[0],-e[1]]),n):((e=i.call(n))[1]+=t/d*180,e)},n.stream=function(t){return(t=r(t)).sphere=function(){t.polygonStart();var e,n=a.radius(89.99)().coordinates[0],i=n.length-1,r=-1;for(t.lineStart();++r<i;)t.point((e=n[r])[0],e[1]);for(t.lineEnd(),i=(n=a.radius(90.01)().coordinates[0]).length-1,t.lineStart();--r>=0;)t.point((e=n[r])[0],e[1]);t.lineEnd(),t.polygonEnd()},t},n}).raw=St;var Ot=d3.geoAzimuthalEqualArea.raw;function kt(t,e){if(arguments.length<2&&(e=t),1===e)return Ot;if(e===1/0)return Et;function n(n,i){var r=Ot(n/e,i);return r[0]*=t,r}return n.invert=function(n,i){var r=Ot.invert(n/t,i);return r[0]*=e,r},n}function Et(t,e){return[t*Math.cos(e)/Math.cos(e/=2),2*Math.sin(e)]}function Tt(t,e){for(var n,i=Math.sin(e)*(e<0?2.43763:2.67595),r=0;r<20&&(e-=n=(e+Math.sin(e)-i)/(1+Math.cos(e)),!(Math.abs(n)<u));r++);return[.85*t*Math.cos(e*=.5),Math.sin(e)*(e<0?1.93052:1.75859)]}Et.invert=function(t,e){var n=2*b(e/2);return[t*Math.cos(n/2)/Math.cos(n),n]},(d3.geoHammer=function(){var t=2,e=w(kt),n=e(t);return n.coefficient=function(n){return arguments.length?e(t=+n):t},n}).raw=kt,Tt.invert=function(t,e){var n=Math.abs(n=e*(e<0?.5179951515653813:.5686373742600607))>1-u?n>0?f:-f:b(n);return[1.1764705882352942*t/Math.cos(n),Math.abs(n=((n+=n)+Math.sin(n))*(e<0?.4102345310814193:.3736990601468637))>1-u?n>0?f:-f:b(n)]},(d3.geoHatano=function(){return M(Tt)}).raw=Tt;var Pt=41+48/36+37/3600;function At(t){var e=d3.geoCylindricalEqualArea.raw(0),n=Pt*d/180,i=2*d,r=d3.geoCollignon.raw(d,n)[0]-d3.geoCollignon.raw(-d,n)[0],a=e(0,n)[1],s=d3.geoCollignon.raw(0,n)[1],o=d3.geoCollignon.raw(0,f)[1]-s,l=2*d/t;function c(c,u){var h,f=Math.abs(u);if(f>n){var p=Math.min(t-1,Math.max(0,Math.floor((c+d)/l)));c+=d*(t-1)/t-p*l,(h=d3.geoCollignon.raw(c,f))[0]=h[0]*i/r-i*(t-1)/(2*t)+p*i/t,h[1]=a+4*(h[1]-s)*o/i,u<0&&(h[1]=-h[1])}else h=e(c,u);return h[0]/=2,h}return c.invert=function(n,c){n*=2;var u=Math.abs(c);if(u>a){var h=Math.min(t-1,Math.max(0,Math.floor((n+d)/l)));n=(n+d*(t-1)/t-h*l)*r/i;var f=d3.geoCollignon.raw.invert(n,.25*(u-a)*i/o+s);return f[0]-=d*(t-1)/t-h*l,c<0&&(f[1]=-f[1]),f}return e.invert(n,c)},c}function Ct(t){var e,n=1+t,i=b(Math.sin(1/n)),r=2*Math.sqrt(d/(e=d+4*i*n)),a=.5*r*(n+Math.sqrt(t*(2+t))),s=t*t,o=n*n;function l(l,c){var u,p,v=1-Math.sin(c);if(v&&v<2){var g,m=f-c,b=25;do{var y=Math.sin(m),_=Math.cos(m),M=i+Math.atan2(y,n-_),w=1+o-2*n*_;m-=g=(m-s*i-n*y+w*M-.5*v*e)/(2*n*y*M)}while(Math.abs(g)>h&&--b>0);u=r*Math.sqrt(w),p=l*M/d}else u=r*(t+v),p=l*i/d;return[u*Math.sin(p),a-u*Math.cos(p)]}return l.invert=function(t,l){var c=t*t+(l-=a)*l,u=(1+o-c/(r*r))/(2*n),h=y(u),f=Math.sin(h),p=i+Math.atan2(f,n-u);return[b(t/Math.sqrt(c))*d/p,b(1-2*(h-s*i-n*f+(1+o-2*n*u)*p)/e)]},l}(d3.geoHealpix=function(){var t=2,e=w(At),n=e(t),i=n.stream;return n.lobes=function(n){return arguments.length?e(t=+n):t},n.stream=function(e){var r=n.rotate(),a=i(e),s=(n.rotate([0,0]),i(e));return n.rotate(r),a.sphere=function(){var e;d3.geoStream((e=180/t,{type:"Polygon",coordinates:[d3.range(-180,180+e/2,e).map(function(t,e){return[t,1&e?90-1e-6:Pt]}).concat(d3.range(180,-180-e/2,-e).map(function(t,e){return[t,1&e?1e-6-90:-Pt]}))]}),s)},a},n}).raw=At,(d3.geoHill=function(){var t=1,e=w(Ct),n=e(t);return n.ratio=function(n){return arguments.length?e(t=+n):t},n}).raw=Ct;var Lt=.7109889596207567,Dt=.0528035274542;function It(t,e){return e>-Lt?((t=F(t,e))[1]+=Dt,t):N(t,e)}function Ft(t,e){return Math.abs(e)>Lt?((t=F(t,e))[1]-=e>0?Dt:-Dt,t):N(t,e)}function jt(t,e){return[3*t/(2*d)*Math.sqrt(d*d/3-e*e),e]}function Rt(t){function e(e,n){if(Math.abs(Math.abs(n)-f)<u)return[0,n<0?-2:2];var i=Math.sin(n),r=Math.pow((1+i)/(1-i),t/2),a=.5*(r+1/r)+Math.cos(e*=t);return[2*Math.sin(e)/a,(r-1/r)/a]}return e.invert=function(e,n){var i=Math.abs(n);if(Math.abs(i-2)<u)return e?null:[0,m(n)*f];if(i>2)return null;var r=(e/=2)*e,a=(n/=2)*n,s=2*n/(1+r+a);return s=Math.pow((1+s)/(1-s),1/t),[Math.atan2(2*e,1-r-a)/t,b((s-1)/(s+1))]},e}function Nt(t,e){return[t*(1+Math.sqrt(Math.cos(e)))/2,e/(Math.cos(e/2)*Math.cos(t/6))]}function qt(t,e){var n=t*t,i=e*e;return[t*(.975534+i*(-.0143059*n-.119161+-.0547009*i)),e*(1.00384+n*(.0802894+-.02855*i+199025e-9*n)+i*(.0998909+-.0491032*i))]}function Bt(t,e){return[Math.sin(t)/Math.cos(e),Math.tan(e)*Math.cos(t)]}function Ht(t){var e=Math.cos(t),n=Math.tan(d/4+t/2);function i(i,r){var a=r-t,s=Math.abs(a)<u?i*e:Math.abs(s=d/4+r/2)<u||Math.abs(Math.abs(s)-f)<u?0:i*a/Math.log(Math.tan(s)/n);return[s,a]}return i.invert=function(i,r){var a,s=r+t;return[Math.abs(r)<u?i/e:Math.abs(a=d/4+s/2)<u||Math.abs(Math.abs(a)-f)<u?0:i*Math.log(Math.tan(a)/n)/r,s]},i}function Vt(t,e){return[t,1.25*Math.log(Math.tan(d/4+.4*e))]}function Wt(t){var e=t.length-1;function n(n,i){for(var r,a=Math.cos(i),s=2/(1+a*Math.cos(n)),o=s*a*Math.sin(n),l=s*Math.sin(i),c=e,u=t[c],h=u[0],d=u[1];--c>=0;)h=(u=t[c])[0]+o*(r=h)-l*d,d=u[1]+o*d+l*r;return[h=o*(r=h)-l*d,d=o*d+l*r]}return n.invert=function(n,i){var r=20,a=n,s=i;do{for(var o,l=e,c=t[l],h=c[0],d=c[1],f=0,p=0;--l>=0;)c=t[l],f=h+a*(o=f)-s*p,p=d+a*p+s*o,h=c[0]+a*(o=h)-s*d,d=c[1]+a*d+s*o;var v,g,m=(f=h+a*(o=f)-s*p)*f+(p=d+a*p+s*o)*p;a-=v=((h=a*(o=h)-s*d-n)*f+(d=a*d+s*o-i)*p)/m,s-=g=(d*f-h*p)/m}while(Math.abs(v)+Math.abs(g)>u*u&&--r>0);if(r){var y=Math.sqrt(a*a+s*s),_=2*Math.atan(.5*y),M=Math.sin(_);return[Math.atan2(a*M,y*Math.cos(_)),y?b(s*M/y):0]}},n}It.invert=function(t,e){return e>-Lt?F.invert(t,e-Dt):N.invert(t,e)},(d3.geoSinuMollweide=function(){return M(It).rotate([-20,-55])}).raw=It,Ft.invert=function(t,e){return Math.abs(e)>Lt?F.invert(t,e+(e>0?Dt:-Dt)):N.invert(t,e)},(d3.geoHomolosine=function(){return M(Ft)}).raw=Ft,jt.invert=function(t,e){return[2/3*d*t/Math.sqrt(d*d/3-e*e),e]},(d3.geoKavrayskiy7=function(){return M(jt)}).raw=jt,(d3.geoLagrange=function(){var t=.5,e=w(Rt),n=e(t);return n.spacing=function(n){return arguments.length?e(t=+n):t},n}).raw=Rt,Nt.invert=function(t,e){var n=Math.abs(t),i=Math.abs(e),r=d/Math.SQRT2,a=u,s=f;i<r?s*=i/r:a+=6*y(r/i);for(var o=0;o<25;o++){var l=Math.sin(s),c=_(Math.cos(s)),h=Math.sin(s/2),p=Math.cos(s/2),v=Math.sin(a/6),g=Math.cos(a/6),m=.5*a*(1+c)-n,b=s/(p*g)-i,M=c?-.25*a*l/c:0,w=.5*(1+c),x=(1+.5*s*h/p)/(p*g),S=s/p*(v/6)/(g*g),z=M*S-x*w,O=(m*S-b*w)/z,k=(b*M-m*x)/z;if(s-=O,a-=k,Math.abs(O)<u&&Math.abs(k)<u)break}return[t<0?-a:a,e<0?-s:s]},(d3.geoLarrivee=function(){return M(Nt)}).raw=Nt,qt.invert=function(t,e){var n=m(t)*d,i=e/2,r=50;do{var a=n*n,s=i*i,o=n*i,l=n*(.975534+s*(-.0143059*a-.119161+-.0547009*s))-t,c=i*(1.00384+a*(.0802894+-.02855*s+199025e-9*a)+s*(.0998909+-.0491032*s))-e,h=.975534-s*(.119161+3*a*.0143059+.0547009*s),f=-o*(.238322+.2188036*s+.0286118*a),p=o*(.1605788+7961e-7*a+-.0571*s),v=1.00384+a*(.0802894+199025e-9*a)+s*(3*(.0998909-.02855*a)-.245516*s),g=f*p-v*h,b=(c*f-l*v)/g,y=(l*p-c*h)/g;n-=b,i-=y}while((Math.abs(b)>u||Math.abs(y)>u)&&--r>0);return r&&[n,i]},(d3.geoLaskowski=function(){return M(qt)}).raw=qt,Bt.invert=function(t,e){var n=t*t,i=e*e,r=i+1,a=t?Math.SQRT1_2*Math.sqrt((r-Math.sqrt(n*n+2*n*(i-1)+r*r))/n+1):1/Math.sqrt(r);return[b(t*a),m(e)*y(a)]},(d3.geoLittrow=function(){return M(Bt)}).raw=Bt,(d3.geoLoximuthal=function(){return R(Ht).parallel(40)}).raw=Ht,Vt.invert=function(t,e){return[t,2.5*Math.atan(Math.exp(.8*e))-.625*d]},(d3.geoMiller=function(){return M(Vt)}).raw=Vt;var Ut={alaska:[[.9972523,0],[.0052513,-.0041175],[.0074606,.0048125],[-.0153783,-.1968253],[.0636871,-.1408027],[.3660976,-.2937382]],gs48:[[.98879,0],[0,0],[-.050909,0],[0,0],[.075528,0]],gs50:[[.984299,0],[.0211642,.0037608],[-.1036018,-.0575102],[-.0329095,-.0320119],[.0499471,.1223335],[.026046,.0899805],[7388e-7,-.1435792],[.0075848,-.1334108],[-.0216473,.0776645],[-.0225161,.0853673]],miller:[[.9245,0],[0,0],[.01943,0]],lee:[[.721316,0],[0,0],[-.00881625,-.00617325]]};function Yt(t,e){var n=Math.sqrt(6),i=Math.sqrt(7),r=Math.asin(7*Math.sin(e)/(3*n));return[n*t*(2*Math.cos(2*r/3)-1)/i,9*Math.sin(r/3)/i]}function Gt(t,e){for(var n,i=(1+Math.SQRT1_2)*Math.sin(e),r=e,a=0;a<25&&(r-=n=(Math.sin(r/2)+Math.sin(r)-i)/(.5*Math.cos(r/2)+Math.cos(r)),!(Math.abs(n)<u));a++);return[t*(1+2*Math.cos(r)/Math.cos(r/2))/(3*Math.SQRT2),2*Math.sqrt(3)*Math.sin(r/2)/Math.sqrt(2+Math.SQRT2)]}function Kt(t,e){for(var n,i=Math.sqrt(6/(4+d)),r=(1+d/4)*Math.sin(e),a=e/2,s=0;s<25&&(a-=n=(a/2+Math.sin(a)-r)/(.5+Math.cos(a)),!(Math.abs(n)<u));s++);return[i*(.5+Math.cos(a))*t/1.5,i*a]}function Xt(t,e){var n=e*e,i=n*n;return[t*(.8707-.131979*n+i*(i*(.003971*n-.001529*i)-.013791)),e*(1.007226+n*(.015085+i*(.028874*n-.044475-.005916*i)))]}function Qt(t,e){return[t*(1+Math.cos(e))/2,2*(e-Math.tan(e/2))]}(d3.geoModifiedStereographic=function(){var t=Ut.miller,e=w(Wt),n=e(t);return n.coefficients=function(n){return arguments.length?e(t="string"==typeof n?Ut[n]:n):t},n}).raw=Wt,Yt.invert=function(t,e){var n=Math.sqrt(6),i=Math.sqrt(7),r=3*b(e*i/9);return[t*i/(n*(2*Math.cos(2*r/3)-1)),b(3*Math.sin(r)*n/7)]},(d3.geoMtFlatPolarParabolic=function(){return M(Yt)}).raw=Yt,Gt.invert=function(t,e){var n=e*Math.sqrt(2+Math.SQRT2)/(2*Math.sqrt(3)),i=2*b(n);return[3*Math.SQRT2*t/(1+2*Math.cos(i)/Math.cos(i/2)),b((n+Math.sin(i))/(1+Math.SQRT1_2))]},(d3.geoMtFlatPolarQuartic=function(){return M(Gt)}).raw=Gt,Kt.invert=function(t,e){var n=Math.sqrt(6/(4+d)),i=e/n;return Math.abs(Math.abs(i)-f)<u&&(i=i<0?-f:f),[1.5*t/(n*(.5+Math.cos(i))),b((i/2+Math.sin(i))/(1+d/4))]},(d3.geoMtFlatPolarSinusoidal=function(){return M(Kt)}).raw=Kt,Xt.invert=function(t,e){var n,i=e,r=25;do{var a=i*i,s=a*a;i-=n=(i*(1.007226+a*(.015085+s*(.028874*a-.044475-.005916*s)))-e)/(1.007226+a*(.045255+s*(.259866*a-.311325-.005916*11*s)))}while(Math.abs(n)>u&&--r>0);return[t/(.8707+(a=i*i)*(a*(a*a*a*(.003971-.001529*a)-.013791)-.131979)),i]},(d3.geoNaturalEarth=function(){return M(Xt)}).raw=Xt,Qt.invert=function(t,e){for(var n=e/2,i=0,r=1/0;i<10&&Math.abs(r)>u;i++){var a=Math.cos(e/2);e-=r=(e-Math.tan(e/2)-n)/(1-.5/(a*a))}return[2*t/(1+Math.cos(e)),e]},(d3.geoNellHammer=function(){return M(Qt)}).raw=Qt;var $t=1.0148,Jt=.23185,Zt=-.14499,te=.02406,ee=$t,ne=5*Jt,ie=7*Zt,re=9*te;function ae(t,e){var n=e*e;return[t,e*($t+n*n*(Jt+n*(Zt+te*n)))]}ae.invert=function(t,e){e>1.790857183?e=1.790857183:e<-1.790857183&&(e=-1.790857183);var n,i=e;do{var r=i*i;i-=n=(i*($t+r*r*(Jt+r*(Zt+te*r)))-e)/(ee+r*r*(ne+r*(ie+re*r)))}while(Math.abs(n)>u);return[t,i]},(d3.geoPatterson=function(){return M(ae)}).raw=ae;var se=yt(xt);function oe(t,e){if(Math.abs(e)<u)return[t,0];var n=Math.tan(e),i=t*Math.sin(e);return[Math.sin(i)/n,e+(1-Math.cos(i))/n]}function le(t){var e=Math.sin(t);function n(n,i){var r=e?Math.tan(n*e/2)/e:n/2;if(!i)return[2*r,-t];var a=2*Math.atan(r*Math.sin(i)),s=1/Math.tan(i);return[Math.sin(a)*s,i+(1-Math.cos(a))*s-t]}return n.invert=function(n,i){if(Math.abs(i+=t)<u)return[e?2*Math.atan(e*n/2)/e:n,0];var r,a=n*n+i*i,s=0,o=10;do{var l=Math.tan(s),c=1/Math.cos(s),h=a-2*i*s+s*s;s-=r=(l*h+2*(s-i))/(2+h*c*c+2*(s-i)*l)}while(Math.abs(r)>u&&--o>0);var f=n*(l=Math.tan(s)),p=Math.tan(Math.abs(i)<Math.abs(s+1/l)?.5*b(f):.5*y(f)+d/4)/Math.sin(s);return[e?2*Math.atan(e*p)/e:2*p,s]},n}(d3.geoPeirceQuincuncial=function(){return se().quincuncial(!0).rotate([-90,-90,45]).clipAngle(180-1e-6)}).raw=se.raw,oe.invert=function(t,e){if(Math.abs(e)<u)return[t,0];var n,i=t*t+e*e,r=.5*e,a=10;do{var s=Math.tan(r),o=1/Math.cos(r),l=i-2*e*r+r*r;r-=n=(s*l+2*(r-e))/(2+l*o*o+2*(r-e)*s)}while(Math.abs(n)>u&&--a>0);return s=Math.tan(r),[(Math.abs(e)<Math.abs(r+1/s)?b(t*s):m(t)*(y(Math.abs(t*s))+f))/Math.sin(r),r]},(d3.geoPolyconic=function(){return M(oe)}).raw=oe,(d3.geoRectangularPolyconic=function(){return R(le)}).raw=le;var ce=[[.9986,-.062],[1,0],[.9986,.062],[.9954,.124],[.99,.186],[.9822,.248],[.973,.31],[.96,.372],[.9427,.434],[.9216,.4958],[.8962,.5571],[.8679,.6176],[.835,.6769],[.7986,.7346],[.7597,.7903],[.7186,.8435],[.6732,.8936],[.6213,.9394],[.5722,.9761],[.5322,1]];function ue(t,e){var n,i=Math.min(18,36*Math.abs(e)/d),r=Math.floor(i),a=i-r,s=(n=ce[r])[0],o=n[1],l=(n=ce[++r])[0],c=n[1],u=(n=ce[Math.min(19,++r)])[0],h=n[1];return[t*(l+a*(u-s)/2+a*a*(u-2*l+s)/2),(e>0?f:-f)*(c+a*(h-o)/2+a*a*(h-2*c+o)/2)]}function he(t,e){var n=function(t){function e(e,n){var i=Math.cos(n),r=(t-1)/(t-i*Math.cos(e));return[r*i*Math.sin(e),r*Math.sin(n)]}return e.invert=function(e,n){var i=e*e+n*n,r=Math.sqrt(i),a=(t-Math.sqrt(1-i*(t+1)/(t-1)))/((t-1)/r+r/(t-1));return[Math.atan2(e*a,r*Math.sqrt(1-a*a)),r?b(n*a/r):0]},e}(t);if(!e)return n;var i=Math.cos(e),r=Math.sin(e);function a(e,a){var s=n(e,a),o=s[1],l=o*r/(t-1)+i;return[s[0]*i/l,o/l]}return a.invert=function(e,a){var s=(t-1)/(t-1-a*r);return n.invert(s*e,s*a*i)},a}function de(t,e){var n=Math.tan(e/2),i=Math.sin(d/4*n);return[t*(.74482-.34588*i*i),1.70711*n]}function fe(t){if(!t)return d3.geoAzimuthalEquidistant.raw;var e=-t/2,n=-e,i=t*t,r=Math.tan(n),a=.5/Math.sin(n);function s(r,a){var s=y(Math.cos(a)*Math.cos(r-e)),o=y(Math.cos(a)*Math.cos(r-n));return[((s*=s)-(o*=o))/(2*t),(a<0?-1:1)*_(4*i*o-(i-s+o)*(i-s+o))/(2*t)]}return s.invert=function(t,i){var s,o,l=i*i,c=Math.cos(Math.sqrt(l+(s=t+e)*s)),u=Math.cos(Math.sqrt(l+(s=t+n)*s));return[Math.atan2(o=c-u,s=(c+u)*r),(i<0?-1:1)*y(Math.sqrt(s*s+o*o)*a)]},s}function pe(t){var e=Math.cos(t);function n(t,n){var i=d3.geoGnomonic.raw(t,n);return i[0]*=e,i}return n.invert=function(t,n){return d3.geoGnomonic.raw.invert(t/e,n)},n}function ve(t,e){if(Math.abs(e)<u)return[t,0];var n=Math.abs(e/f),i=b(n);if(Math.abs(t)<u||Math.abs(Math.abs(e)-f)<u)return[0,m(e)*d*Math.tan(i/2)];var r=Math.cos(i),a=Math.abs(d/t-t/d)/2,s=a*a,o=r/(n+r-1),l=o*(2/n-1),c=l*l,h=c+s,p=o-c,v=s+o;return[m(t)*d*(a*p+Math.sqrt(s*p*p-h*(o*o-c)))/h,m(e)*d*(l*v-a*Math.sqrt((s+1)*h-v*v))/h]}function ge(t,e){if(Math.abs(e)<u)return[t,0];var n=Math.abs(e/f),i=b(n);if(Math.abs(t)<u||Math.abs(Math.abs(e)-f)<u)return[0,m(e)*d*Math.tan(i/2)];var r=Math.cos(i),a=Math.abs(d/t-t/d)/2,s=a*a,o=r*(Math.sqrt(1+s)-a*r)/(1+s*n*n);return[m(t)*d*o,m(e)*d*_(1-o*(2*a+o))]}function me(t,e){if(Math.abs(e)<u)return[t,0];var n=e/f,i=b(n);if(Math.abs(t)<u||Math.abs(Math.abs(e)-f)<u)return[0,d*Math.tan(i/2)];var r=(d/t-t/d)/2,a=n/(1+Math.cos(i));return[d*(m(t)*_(r*r+1-a*a)-r),d*a]}function be(t,e){if(!e)return[t,0];var n=Math.abs(e);if(!t||n===f)return[0,e];var i=n/f,r=i*i,a=(8*i-r*(r+2)-5)/(2*r*(i-1)),s=a*a,o=i*a,l=r+s+2*o,c=i+3*a,u=t/f,h=u+1/u,d=m(Math.abs(t)-f)*Math.sqrt(h*h-4),p=d*d,v=(d*(l+s-1)+2*_(l*(r+s*p-1)+(1-r)*(r*(c*c+4*s)+12*o*s+4*s*s)))/(4*l+p);return[m(t)*f*v,m(e)*f*_(1+d*Math.abs(v)-v*v)]}ce.forEach(function(t){t[1]*=1.0144}),ue.invert=function(t,e){var n=e/f,i=90*n,r=Math.min(18,Math.abs(i/5)),a=Math.max(0,Math.floor(r));do{var s=ce[a][1],o=ce[a+1][1],l=ce[Math.min(19,a+2)][1],c=l-s,u=l-2*o+s,d=2*(Math.abs(n)-o)/c,p=u/c,m=d*(1-p*d*(1-2*p*d));if(m>=0||1===a){i=(e>=0?5:-5)*(m+r);var b,y=50;do{m=(r=Math.min(18,Math.abs(i)/5))-(a=Math.floor(r)),s=ce[a][1],o=ce[a+1][1],l=ce[Math.min(19,a+2)][1],i-=(b=(e>=0?f:-f)*(o+m*(l-s)/2+m*m*(l-2*o+s)/2)-e)*g}while(Math.abs(b)>h&&--y>0);break}}while(--a>=0);var _=ce[a][0],M=ce[a+1][0],w=ce[Math.min(19,a+2)][0];return[t/(M+m*(w-_)/2+m*m*(w-2*M+_)/2),i*v]},(d3.geoRobinson=function(){return M(ue)}).raw=ue,(d3.geoSatellite=function(){var t=1.4,e=0,n=w(he),i=n(t,e);return i.distance=function(i){return arguments.length?n(t=+i,e):t},i.tilt=function(i){return arguments.length?n(t,e=i*d/180):180*e/d},i}).raw=he,de.invert=function(t,e){var n=e/1.70711,i=Math.sin(d/4*n);return[t/(.74482-.34588*i*i),2*Math.atan(n)]},(d3.geoTimes=function(){return M(de)}).raw=de,(d3.geoTwoPointEquidistant=function(){var t=[[0,0],[0,0]],e=w(fe),n=e(0),i=n.rotate;return delete n.rotate,n.points=function(n){if(!arguments.length)return t;t=n;var r=d3.geoInterpolate(n[0],n[1]),a=r(.5),s=d3.geoRotation([-a[0],-a[1]])(n[0]),o=.5*r.distance,l=-b(Math.sin(s[1]*v)/Math.sin(o));return s[0]>0&&(l=d-l),i.call(s,[-a[0],-a[1],-l*g]),e(2*o)},n}).raw=fe,(d3.geoTwoPointAzimuthal=function(){var t=[[0,0],[0,0]],e=w(pe),n=e(0),i=n.rotate;return delete n.rotate,n.points=function(n){if(!arguments.length)return t;t=n;var r=d3.geoInterpolate(n[0],n[1]),a=r(.5),s=d3.geoRotation([-a[0],-a[1]])(n[0]),o=.5*r.distance,l=-b(Math.sin(s[1]*v)/Math.sin(o));return s[0]>0&&(l=d-l),i.call(s,[-a[0],-a[1],-l*g]),e(o)},n}).raw=pe,ve.invert=function(t,e){if(Math.abs(e)<u)return[t,0];if(Math.abs(t)<u)return[0,f*Math.sin(2*Math.atan(e/d))];var n=(t/=d)*t,i=(e/=d)*e,r=n+i,a=r*r,s=-Math.abs(e)*(1+r),o=s-2*i+n,l=-2*s+1+2*i+a,c=i/l+(2*o*o*o/(l*l*l)-9*s*o/(l*l))/27,h=(s-o*o/(3*l))/l,p=2*Math.sqrt(-h/3),v=y(3*c/(h*p))/3;return[d*(r-1+Math.sqrt(1+2*(n-i)+a))/(2*t),m(e)*d*(-p*Math.cos(v+d/3)-o/(3*l))]},(d3.geoVanDerGrinten=function(){return M(ve)}).raw=ve,ge.invert=function(t,e){if(!t)return[0,f*Math.sin(2*Math.atan(e/d))];var n=Math.abs(t/d),i=(1-n*n-(e/=d)*e)/(2*n),r=i*i,a=Math.sqrt(r+1);return[m(t)*d*(a-i),m(e)*f*Math.sin(2*Math.atan2(Math.sqrt((1-2*i*n)*(i+a)-n),Math.sqrt(a+i+n)))]},(d3.geoVanDerGrinten2=function(){return M(ge)}).raw=ge,me.invert=function(t,e){if(!e)return[t,0];var n=e/d,i=(d*d*(1-n*n)-t*t)/(2*d*t);return[t?d*(m(t)*Math.sqrt(i*i+1)-i):0,f*Math.sin(2*Math.atan(n))]},(d3.geoVanDerGrinten3=function(){return M(me)}).raw=me,be.invert=function(t,e){if(!t||!e)return[t,e];e/=d;var n=m(t)*t/f,i=(n*n-1+4*e*e)/Math.abs(n),r=i*i,a=2*e,s=50;do{var o=a*a,l=(8*a-o*(o+2)-5)/(2*o*(a-1)),c=(3*a-o*a-10)/(2*o*a),h=l*l,p=a*l,v=a+l,g=v*v,b=a+3*l,y=g*(o+h*r-1)+(1-o)*(o*(b*b+4*h)+h*(12*p+4*h)),_=-2*v*(4*p*h+(1-4*o+3*o*o)*(1+c)+h*(14*o-6-r+(8*o-8-2*r)*c)+p*(12*o-8+(10*o-10-r)*c)),M=Math.sqrt(y);a-=δ=(i*(g+h-1)+2*M-n*(4*g+r))/(i*(2*l*c+2*v*(1+c))+_/M-8*v*(i*(-1+h+g)+2*M)*(1+c)/(r+4*g))}while(δ>u&&--s>0);return[m(t)*(Math.sqrt(i*i+4)+i)*d/4,f*a]},(d3.geoVanDerGrinten4=function(){return M(be)}).raw=be;var ye,_e,Me=(ye=4*d+3*Math.sqrt(3),D((_e=2*Math.sqrt(2*d*Math.sqrt(3)/ye))*Math.sqrt(3)/d,_e,ye/6));function we(t,e){return[t*Math.sqrt(1-3*e*e/(d*d)),e]}function xe(t,e){var n=.90631*Math.sin(e),i=Math.sqrt(1-n*n),r=Math.sqrt(2/(1+i*Math.cos(t/=3)));return[2.66723*i*r*Math.sin(t),1.24104*n*r]}function Se(t,e){var n=Math.cos(e),i=Math.cos(t)*n,r=1-i,a=Math.cos(t=Math.atan2(Math.sin(t)*n,-Math.sin(e))),s=Math.sin(t);return[s*(n=_(1-i*i))-a*r,-a*n-s*r]}function ze(t,e){var n=S(t,e);return[(n[0]+t/f)/2,(n[1]+e)/2]}(d3.geoWagner4=function(){return M(Me)}).raw=Me,we.invert=function(t,e){return[t/Math.sqrt(1-3*e*e/(d*d)),e]},(d3.geoWagner6=function(){return M(we)}).raw=we,xe.invert=function(t,e){var n=t/2.66723,i=e/1.24104,r=Math.sqrt(n*n+i*i),a=2*b(r/2);return[3*Math.atan2(t*Math.tan(a),2.66723*r),r&&b(e*Math.sin(a)/(1.24104*.90631*r))]},(d3.geoWagner7=function(){return M(xe)}).raw=xe,Se.invert=function(t,e){var n=-.5*(t*t+e*e),i=Math.sqrt(-n*(2+n)),r=e*n+t*i,a=t*n-e*i,s=Math.sqrt(a*a+r*r);return[Math.atan2(i*r,s*(1+n)),s?-b(i*a/s):0]},(d3.geoWiechel=function(){return M(Se)}).raw=Se,ze.invert=function(t,e){var n=t,i=e,r=25;do{var a,s=Math.cos(i),o=Math.sin(i),l=Math.sin(2*i),c=o*o,h=s*s,d=Math.sin(n),p=Math.cos(n/2),v=Math.sin(n/2),g=v*v,m=1-h*p*p,b=m?y(s*p)*Math.sqrt(a=1/m):a=0,_=.5*(2*b*s*v+n/f)-t,M=.5*(b*o+i)-e,w=.5*a*(h*g+b*s*p*c)+.5/f,x=a*(d*l/4-b*o*v),S=.125*a*(l*v-b*o*h*d),z=.5*a*(c*p+b*g*s)+.5,O=x*S-z*w,k=(M*x-_*z)/O,E=(_*S-M*w)/O;n-=k,i-=E}while((Math.abs(k)>u||Math.abs(E)>u)&&--r>0);return[n,i]},(d3.geoWinkel3=function(){return M(ze)}).raw=ze}},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i=function(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n]);return e.default=t,e}(n(1)),r=o(n(31)),a=o(n(437)),s=n(21);function o(t){return t&&t.__esModule?t:{default:t}}var l=function(t){return function(){var e=t,n=void 0;a.setCssPrefix=function(t){return n=t,a};var r=d3.drag().on("start",function(t,n){d3.event.sourceEvent.stopPropagation();e.KEY}).on("drag",function(t,n){var i=e.KEY;if(e.model.ui.chart.labels.dragging){this.druging||(e.druging=t[i]);var r=e.cached[t[i]];r.labelFixed=!0;var s=e.context.width,o=e.context.height;r.labelX_+=d3.event.dx/s,r.labelY_+=d3.event.dy/o;var l=e.xScale(r.labelX0)+r.labelX_*s,c=e.yScale(r.labelY0)+r.labelY_*o,u=e.xScale(r.labelX0),h=e.yScale(r.labelY0),d=e.entityLines.filter(function(e){return e[i]==t[i]});a._repositionLabels(t,n,null,this,l,c,u,h,0,null,d)}}).on("end",function(t,n){var i=e.KEY;if(e.druging){var r=e.cached[t[i]];e.druging=null,r.labelOffset[0]=r.labelX_,r.labelOffset[1]=r.labelY_,e.model.marker.setLabelOffset(t,[r.labelX_,r.labelY_])}});function a(t,o){return t.each(function(t,r){var a=d3.select(this);a.append("rect").attr("class","vzb-label-glow").attr("filter","url("+location.pathname+"#vzb-glow-filter)"),a.append("rect").attr("class","vzb-label-fill vzb-tooltip-border");var l=a.append("text").attr("class",n+"-label-content stroke");if(a.style("paint-order").length||(a.insert("text","."+n+"-label-content").attr("class",n+"-label-content "+n+"-label-shadow vzb-noexport"),l.classed("stroke",!1)),!o){var c=a.append("g").attr("class",n+"-label-x vzb-transparent");i.setIcon(c,s.close),c.insert("circle","svg"),c.select("svg").attr("class",n+"-label-x-icon").attr("width","0px").attr("height","0px"),c.on("click",function(){d3.event.defaultPrevented||(d3.event.stopPropagation(),e.model.marker.clearHighlighted(),e.model.marker.selectMarker(t))})}}),o||t.call(r).on("mouseover",function(t){if(!i.isTouchDevice()){e.model.marker.highlightMarker(t);var r=e.KEY||e.context.KEY;e.entityLabels.sort(function(e,n){return e[r]!=t[r]?-1:1}),d3.select(this).selectAll("."+n+"-label-x").classed("vzb-transparent",!1)}}).on("mouseout",function(t){i.isTouchDevice()||(e.model.marker.clearHighlighted(),d3.select(this).selectAll("."+n+"-label-x").classed("vzb-transparent",!0))}).on("click",function(t){if(i.isTouchDevice()){var r=d3.select(this).selectAll("."+n+"-label-x"),a=e.KEY||e.context.KEY,s=r.classed("vzb-transparent");s&&(e.entityLabels.sort(function(e,n){return e[a]!=t[a]?-1:1}),e.showCloseCross(null,!1)),r.classed("vzb-transparent",!s),e.options.SUPPRESS_HIGHLIGHT_DURING_PLAY&&e.model.time.playing||(s?e.model.marker.setHighlight(t):e.model.marker.clearHighlighted())}}),a}return a.line=function(t){t.append("line").attr("class",n+"-label-line")},a._repositionLabels=function(t,n,i,r,a,s,o,l,c,u,h){var d=i||e.cached[t[e.KEY]],f=d3.select(r),p=!a&&0!==a||!s&&0!==s||!o&&0!==o||!l&&0!==l;if(p)return f.classed("vzb-invisible",p),void h.classed("vzb-invisible",p);var v=e.context.width,g=e.context.height,m=d.rectBBox,b=m.height,y=d.rectOffsetX,_=d.rectOffsetY;a+m.x<=0?(a=-m.x,d.labelX_=(a-e.xScale(d.labelX0))/v):a+y>v&&(a=v-y,d.labelX_=(a-e.xScale(d.labelX0))/v);s+m.y<=0?(s=-m.y,d.labelY_=(s-e.yScale(d.labelY0))/g):s+_>g&&(s=g-_,d.labelY_=(s-e.yScale(d.labelY0))/g);null==c&&(c=e.context.duration);d._new&&(c=0,delete d._new);c?u&&!t.hidden?(f.classed("vzb-invisible",t.hidden),f.attr("transform","translate("+a+","+s+")").style("opacity",0).transition().duration(c).ease(d3.easeExp).style("opacity",1).on("interrupt",function(){f.style("opacity",1)}),h.classed("vzb-invisible",t.hidden),h.attr("transform","translate("+a+","+s+")").style("opacity",0).transition().duration(c).ease(d3.easeExp).style("opacity",1).on("interrupt",function(){h.style("opacity",1)})):u&&t.hidden?(f.style("opacity",1).transition().duration(c).ease(d3.easeExp).style("opacity",0).on("end",function(){f.style("opacity",1).classed("vzb-invisible",t.hidden)}),h.style("opacity",1).transition().duration(c).ease(d3.easeExp).style("opacity",0).on("end",function(){h.style("opacity",1).classed("vzb-invisible",t.hidden)})):(f.transition().duration(c).ease(d3.easeLinear).attr("transform","translate("+a+","+s+")"),h.transition().duration(c).ease(d3.easeLinear).attr("transform","translate("+a+","+s+")")):(f.interrupt().attr("transform","translate("+a+","+s+")").transition(),h.interrupt().attr("transform","translate("+a+","+s+")").transition(),u&&f.classed("vzb-invisible",t.hidden),u&&h.classed("vzb-invisible",t.hidden));var M=o-a,w=l-s,x=f.select("text").node().getBBox(),S=.5*-x.width,z=.2*-b,O=e.model.ui.chart.labels,k=O.removeLabelBox?x:m,E=e.activeProfile.labelLeashCoeff||0,T=function(t,e){var n=Math.abs(t.x-e.x),i=Math.abs(t.y-e.y),r=.5*e.width,a=.5*e.height;if(n>r+t.r)return!1;if(i>a+t.r)return!1;if(n<=r)return!0;if(i<=a)return!0;return Math.pow(n-r,2)+Math.pow(i-a,2)<=Math.pow(t.r,2)}({x:M,y:w,r:d.scaledS0},{x:S,y:z,width:2*k.height*E+k.width,height:k.height*(2*E+1)});if(h.select("line").classed("vzb-invisible",T),T)return;if(O.removeLabelBox){var P=180*Math.atan2(M-S,w-z)/Math.PI,A=P>=0&&P<=180?.5*k.width:.5*-k.width,C=Math.abs(P)<=90?.55*k.height:.45*-k.height;S+=Math.abs(M-S)>.5*x.width?A:0,z+=Math.abs(w-z)>.5*x.height?C:.05*x.height}var L=Math.abs(M)>Math.abs(w)?Math.abs(M):Math.abs(w);h.select("line").style("stroke-dasharray","0 "+d.scaledS0+" "+2*~~L),h.selectAll("line").attr("x1",M).attr("y1",w).attr("x2",S).attr("y2",z)},a}()},c={LABELS_CONTAINER_CLASS:"",LINES_CONTAINER_CLASS:"",LINES_CONTAINER_SELECTOR:"",CSS_PREFIX:"",SUPPRESS_HIGHLIGHT_DURING_PLAY:!0},u=r.default.extend({init:function(t,e){this.context=t,this.options=i.extend({},c),this.label=l(this),this._xScale=null,this._yScale=null,this._closeCrossHeight=0,this.labelSizeTextScale=null},ready:function(){this.KEYS=this.context.KEYS,this.KEY=this.context.KEY,this.updateIndicators(),this.updateLabelSizeLimits()},readyOnce:function(){var t=this;this.model=this.context.model,this.model.on("change:marker.select",function(){t.context._readyOnce&&t.selectDataPoints()}),this.model.marker.size_label&&this.model.on("change:marker.size_label.extent",function(e,n){t.context._readyOnce&&(t.updateLabelSizeLimits(),t.model.time.splash||t.updateLabelsOnlyTextSize())}),this.model.ui.chart.labels.hasOwnProperty("removeLabelBox")&&this.model.on("change:ui.chart.labels.removeLabelBox",function(e,n){t.context._readyOnce&&t.updateLabelsOnlyTextSize()}),this.KEYS=this.context.KEYS,this.KEY=this.context.KEY,this.cached={},this.label.setCssPrefix(this.options.CSS_PREFIX),this.rootEl=this.context.root.element instanceof Array?this.context.root.element:d3.select(this.context.root.element),this.labelsContainer=this.rootEl.select("."+this.options.LABELS_CONTAINER_CLASS),this.linesContainer=this.rootEl.select("."+this.options.LINES_CONTAINER_CLASS),this.updateIndicators(),this.updateSize(),this.selectDataPoints(),this._initLabelTooltip()},config:function(t){i.extend(this.options,t)},updateLabelSizeLimits:function(){if(this.model.marker.size_label){var t=this.model.marker.size_label.extent||[0,1],e=this.activeProfile.minLabelTextSize,n=this.activeProfile.maxLabelTextSize-e;this.minLabelTextSize=Math.max(e+n*t[0],e),this.maxLabelTextSize=Math.max(e+n*t[1],e),"constant"==this.model.marker.size_label.use&&(this.minLabelTextSize=this.maxLabelTextSize),"ordinal"!==this.model.marker.size_label.scaleType||"constant"==this.model.marker.size_label.use?this.labelSizeTextScale.range([this.minLabelTextSize,this.maxLabelTextSize]):this.labelSizeTextScale.rangePoints([this.minLabelTextSize,this.maxLabelTextSize],0).range()}},updateIndicators:function(){this.model.marker.size_label&&(this.labelSizeTextScale=this.model.marker.size_label.getScale())},setScales:function(t,e){this._xScale=t,this._yScale=e},setCloseCrossHeight:function(t){this._closeCrossHeight!=t&&(this._closeCrossHeight=t,this.updateLabelCloseGroupSize(this.entityLabels.selectAll("."+this.options.CSS_PREFIX+"-label-x"),this._closeCrossHeight))},xScale:function(t){return this._xScale?this._xScale(t):t*this.context.width},yScale:function(t){return this._yScale?this._yScale(t):t*this.context.height},selectDataPoints:function(){var t=this,e=this.KEYS,n=this.KEY,r=this.options.CSS_PREFIX,s=t.model.marker.select.map(function(t){var r=i.clone(t,e);return r[n]=i.getKey(t,e),r});this.entityLabels=this.labelsContainer.selectAll("."+r+"-entity").data(s,function(t){return t[n]}),this.entityLines=this.linesContainer.selectAll("g.entity-line."+r+"-entity").data(s,function(t){return t[n]}),this.entityLabels.exit().each(function(e){null!=t.cached[e[n]]&&(t.cached[e[n]]=void 0)}).remove(),this.entityLines.exit().remove(),this.entityLines=this.entityLines.enter().insert("g",function(e){return this.querySelector("."+t.options.LINES_CONTAINER_SELECTOR_PREFIX+(0,a.default)(e[n]))}).attr("class",function(t,e){return r+"-entity entity-line line-"+t[n]}).each(function(e,n){t.label.line(d3.select(this))}).merge(this.entityLines),this.entityLabels=this.entityLabels.enter().append("g").attr("class",function(t,e){return r+"-entity label-"+t[n]}).each(function(e,i){t.cached[e[n]]={_new:!0},t.label(d3.select(this))}).merge(this.entityLabels)},showCloseCross:function(t,e){var n=this.KEY;this.entityLabels.filter(function(e){return!t||e[n]==t[n]}).select("."+this.options.CSS_PREFIX+"-label-x").classed("vzb-transparent",!e)},highlight:function(t,e){var n=this.KEY,i=this.entityLabels;t&&(i=i.filter(function(e){return!t||e[n]==t[n]})),i.classed("vzb-highlighted",e)},updateLabel:function(t,e,n,r,a,s,o,l,c,u,h){var d=this,f=this.KEYS,p=this.KEY;if(t[p]!=d.druging){var v=this.options.CSS_PREFIX;if(d.model.marker.isSelected(t)&&null!=d.entityLabels){null==d.cached[t[p]]&&this.selectDataPoints();var g=d.cached[t[p]];if(n&&i.extend(g,n),null!=g.scaledS0&&null!=g.labelX0&&null!=g.labelY0||this._initNewCache(g,r,a,s,o,c),null==g.labelX_||null==g.labelY_){var m=i.find(d.model.marker.select,function(e){return i.getKey(e,f)==t[p]});g.labelOffset=m.labelOffset||[0,0]}var b=!g.labelX0&&0!==g.labelX0||!g.labelY0&&0!==g.labelY0||!g.scaledS0&&0!==g.scaledS0,y=d.entityLines.filter(function(e){return e[p]==t[p]});d.entityLabels.filter(function(e){return e[p]==t[p]}).each(function(n){var i=d3.select(this);if(b)return i.classed("vzb-invisible",b),void y.classed("vzb-invisible",b);var r=i.selectAll("."+v+"-label-content").text(l);d._updateLabelSize(t,e,null,i,c,r),d.positionLabel(t,e,null,this,u,h,y)})}}},_initNewCache:function(t,e,n,r,a,s){(r||0===r)&&(t.scaledS0=i.areaToRadius(this.context.sScale(r))),t.labelX0=e,t.labelY0=n,t.valueLST=s,t.scaledC0=null!=a?this.context.cScale(a):this.context.COLOR_WHITEISH},_initLabelTooltip:function(){this.tooltipEl=this.labelsContainer.append("g").attr("class",this.options.CSS_PREFIX+"-tooltip")},setTooltip:function(t,e,n,i){if(e){var r=0,a=this.options.CSS_PREFIX;if(this.tooltipEl.raise().text(null),this.label(this.tooltipEl,!0),t){var s={};this._initNewCache(s,i.valueX,i.valueY,i.valueS,i.valueC,i.valueLST),this.tooltipEl.classed(this.options.CSS_PREFIX+"-tooltip",!1).classed(this.options.CSS_PREFIX+"-entity",!0).selectAll("."+a+"-label-content").text(i.labelText),this._updateLabelSize(t,null,s,this.tooltipEl,i.valueLST),r=this.positionLabel(t,null,s,this.tooltipEl.node(),0,null,this.tooltipEl.select(".lineemptygroup"))}this.tooltipEl.classed(this.options.CSS_PREFIX+"-entity",!1).classed(this.options.CSS_PREFIX+"-tooltip",!0).selectAll("."+a+"-label-content").text(e),this._updateLabelSize(t,null,n,this.tooltipEl,null),this.positionLabel(t,null,n,this.tooltipEl.node(),0,null,this.tooltipEl.select(".lineemptygroup"),r)}else this.tooltipEl.text(null)},setTooltipFontSize:function(t){this.tooltipEl.style("font-size",t)},_updateLabelSize:function(t,e,n,i,r,a){var s=this.KEY,o=n||this.cached[t[s]],l=this.options.CSS_PREFIX,c=this.model.ui.chart.labels||{};i.classed("vzb-label-boxremoved",c.removeLabelBox);var u=a||i.selectAll("."+l+"-label-content");if(this.labelSizeTextScale)if(null!=r){var h=this.labelSizeTextScale.range(),d=h[0]+Math.sqrt((this.labelSizeTextScale(r)-h[0])*(h[1]-h[0]));u.attr("font-size",d+"px")}else u.attr("font-size",null);u.style("stroke","none");var f=u.node().getBBox();u.style("stroke",null);var p=i.selectAll("rect");if(!o.textWidth||o.textWidth!=f.width){o.textWidth=f.width;var v=this._closeCrossHeight||f.height,g=this.model.locale.isRTL(),m=i.select("."+l+"-label-x").attr("transform","translate("+(g?-f.width-4:4)+","+.85*-f.height+")");this.updateLabelCloseGroupSize(m,v),p.attr("width",f.width+8).attr("height",1.2*f.height).attr("x",-f.width-4).attr("y",.85*-f.height).attr("rx",.2*f.height).attr("ry",.2*f.height),o.rectBBox=p.node().getBBox(),o.rectOffsetX=o.rectBBox.width+o.rectBBox.x,o.rectOffsetY=o.rectBBox.height+o.rectBBox.y}var b=i.select(".vzb-label-glow");b.attr("stroke")!==o.scaledC0&&b.attr("stroke",o.scaledC0)},updateLabelCloseGroupSize:function(t,e){t.select("circle").attr("cx",0).attr("cy",0).attr("r",.5*e),t.select("svg").attr("x",.5*-e).attr("y",-.5*e).attr("width",e).attr("height",e)},updateLabelsOnlyTextSize:function(){var t=this,e=this.KEYS,n=this.KEY;this.entityLabels.each(function(r,a){t.cached[r[n]];t._updateLabelSize(r,a,null,d3.select(this),t.context.frame.size_label[i.getKey(r,e)]);var s=t.entityLines.filter(function(t){return t[n]==r[n]});t.positionLabel(r,a,null,this,0,null,s)})},updateLabelOnlyPosition:function(t,e,n){var r=this,a=this.KEY,s=this.cached[t[a]];n&&i.extend(s,n);var o=r.entityLines.filter(function(e){return e[a]==t[a]});this.entityLabels.filter(function(e){return e[a]==t[a]}).each(function(n){r.positionLabel(t,e,null,this,0,null,o)})},updateLabelOnlyColor:function(t,e,n){var r=this.KEY,a=this.cached[t[r]];n&&i.extend(a,n);var s=this.entityLabels.filter(function(e){return e[r]==t[r]});this._updateLabelSize(t,e,null,s,null)},positionLabel:function(t,e,n,r,a,s,o,l){var c=this.KEY,u=n||this.cached[t[c]],h=l||0===l,d=1&(l||0),f=(2&(l||0))>>1,p=0,v=0,g=this.context.width,m=this.context.height,b=this.xScale(u.labelX0),y=this.yScale(u.labelY0),_=u.rectOffsetX,M=u.rectOffsetY;u.labelOffset||(u.labelOffset=[0,0]),u.labelX_=u.labelOffset[0]||(.75*-u.scaledS0-_)/g,u.labelY_=u.labelOffset[1]||(.75*-u.scaledS0-M)/m;var w=b+u.labelX_*g,x=y+u.labelY_*m;if(u.labelOffset[0]+u.labelOffset[1]==0&&((!h&&x-u.rectBBox.height+M<=0||f)&&(v=1,u.labelY_=(.75*u.scaledS0+u.rectBBox.height-M)/m,x=y+u.labelY_*m),(!h&&w-u.rectBBox.width+_<=0||d)&&(p=1,u.labelX_=(.75*u.scaledS0+u.rectBBox.width-_)/g,(w=b+u.labelX_*g)>g&&(p=0,v=0==v&&y-.5*M-u.scaledS0<u.rectBBox.height?1:v,u.labelY_=v?.5*-M+u.rectBBox.height+u.scaledS0:1.5*-M-u.scaledS0,u.labelY_/=m,x=y+u.labelY_*m,u.labelX_=(u.rectBBox.width-_-b)/g,w=b+u.labelX_*g))),h){var S=!1;if(w-u.rectBBox.width+_<=0){var z=b-u.rectBBox.width,O=z>0?i.cathetus(u.scaledS0,z):u.scaledS0;(x=v?y+u.rectBBox.height-.5*M+O:y-1.5*M-O)-u.rectBBox.height<0&&(S=!0)}if(x-u.rectBBox.height+M<=0){var k=y-u.rectBBox.height,E=k>0?i.cathetus(u.scaledS0,k):u.scaledS0;((w=p?b+u.rectBBox.width+E:b-2*_-E)-u.rectBBox.width<0||w>g)&&(S=!0)}if(S){v++;var T=b-u.rectBBox.width;x=y+u.rectBBox.height-.5*M+(T>0?i.cathetus(u.scaledS0,T):u.scaledS0)}}return this.label._repositionLabels(t,e,n,r,w,x,b,y,a,s,o),2*v+p},updateSize:function(){this.activeProfile=this.context.getActiveProfile({small:{minLabelTextSize:7,maxLabelTextSize:21,defaultLabelTextSize:12,labelLeashCoeff:.4},medium:{minLabelTextSize:7,maxLabelTextSize:30,defaultLabelTextSize:15,labelLeashCoeff:.3},large:{minLabelTextSize:6,maxLabelTextSize:48,defaultLabelTextSize:20,labelLeashCoeff:.2}},{medium:{minLabelTextSize:15,maxLabelTextSize:35,defaultLabelTextSize:15,labelLeashCoeff:.3},large:{minLabelTextSize:20,maxLabelTextSize:55,defaultLabelTextSize:20,labelLeashCoeff:.2}}),this.updateLabelSizeLimits()}});e.default=u},function(t,e,n){(function(e){var n;n=void 0!==e?e:this,t.exports=function(t){if(t.CSS&&t.CSS.escape)return t.CSS.escape;var e=function(t){if(0==arguments.length)throw new TypeError("`CSS.escape` requires an argument.");for(var e,n=String(t),i=n.length,r=-1,a="",s=n.charCodeAt(0);++r<i;)0!=(e=n.charCodeAt(r))?a+=e>=1&&e<=31||127==e||0==r&&e>=48&&e<=57||1==r&&e>=48&&e<=57&&45==s?"\\"+e.toString(16)+" ":0==r&&1==i&&45==e||!(e>=128||45==e||95==e||e>=48&&e<=57||e>=65&&e<=90||e>=97&&e<=122)?"\\"+n.charAt(r):n.charAt(r):a+="�";return a};return t.CSS||(t.CSS={}),t.CSS.escape=e,e}(n)}).call(this,n(80))},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i,r=n(31),a=(i=r)&&i.__esModule?i:{default:i};var s="",o=[];e.default=a.default.extend({init:function(t){this.context=t,this.shapes=[],this.groups=[],this.counter=0,this.name="",this.label=""},reset:function(){this.container.remove(),this.context.element.selectAll(".vzb-export-redball").remove(),this.context.element.selectAll(".vzb-export-counter").remove(),this.counter=0},prefix:function(t){return arguments.length?(s=t,this):s},deleteClasses:function(t){return arguments.length?(o=t,this):o},open:function(t,e){var n=this;this.svg&&this.reset(),t||(t=this.context.element),e||(e=this.context.name),this.name=e;var i=parseInt(t.style("width"),10)||0,r=parseInt(t.style("height"),10)||0;this.container=t.append("div").attr("class","vzb-svg-export"),this.svg=this.container.node().appendChild(t.select("svg").node().cloneNode(!0)),this.svg=d3.select(this.svg),this.svg.attr("viewBox","0 0 "+i+" "+r).attr("version","1.1").attr("param1","http://www.w3.org/2000/svg").attr("param2","http://www.w3.org/1999/xlink").attr("x","0px").attr("y","0px").attr("style","enable-background:new 0 0 "+i+" "+r).attr("xml:space","preserve"),this.redBall=t.append("div").attr("class","vzb-export-redball").style("position","absolute").style("top","20px").style("right","20px").style("width","20px").style("height","20px").style("background","red").style("color","white").style("text-align","center").style("border-radius","10px").style("font-size","14px").style("line-height","20px").style("opacity",.8).style("cursor","pointer").on("mouseover",function(){d3.select(this).style("opacity",1).text("▼"),n.counterEl.text("Download")}).on("mouseout",function(){d3.select(this).style("opacity",.8).text(""),n.counterEl.text(n.label)}).on("click",function(){n.close()}),this.counterEl=t.append("div").attr("class","vzb-export-counter").style("position","absolute").style("top","20px").style("right","45px").style("color","red").style("opacity",.8).style("line-height","20px").style("font-size","14px").style("text-align","center"),this.root=this.svg.select("."+s+"graph"),this.root.selectAll("g, text, svg, line, rect").filter(function(){var t=d3.select(this),e=!1;return o.forEach(function(n){e=e||t.classed(n)}),e}).remove(),this.svg.selectAll(".tick line").attr("fill","none").attr("stroke","#999"),this.svg.selectAll("."+s+"axis-x path").attr("fill","none").attr("stroke","#999"),this.svg.selectAll("."+s+"axis-y path").attr("fill","none").attr("stroke","#999")},write:function(t){if(this.root||this.open(),!(this.shapes.indexOf(t.id+"_"+t.time)>-1)){this.shapes.push(t.id+"_"+t.time),-1==this.groups.indexOf(t.time)&&(this.root.append("g").attr("id","g_"+t.time),this.groups.push(t.time)),null==t.opacity&&(t.opacity=.5),null==t.fill&&(t.fill="#ff80dd");var e=this.root.select("#g_"+t.time).append(t.type).attr("id",t.id+"_"+t.time).style("fill",t.fill).style("opacity",t.opacity);switch(t.type){case"path":e.attr("d",t.d);break;case"circle":e.attr("cx",t.cx).attr("cy",t.cy).attr("r",t.r)}this.counter++,this.redBall.style("opacity",this.counter%10/12+.2),this.label=t.type+" shapes: "+this.counter,this.counterEl.text(this.label)}},close:function(){var t='<?xml version="1.0" encoding="utf-8"?> '+this.container.node().innerHTML.replace("param1","xmlns").replace("param2","xmlns:xlink").replace(/\d+(\.\d+)/g,function(t){return Math.round(100*+t)/100+""});if(t.length/1024/1024>2)alert("The file size is "+Math.round(t.length/1024)+"kB, which is too large to download. Will try to print it in the console instead..."),console.log(t);else{var e=document.createElement("a");e.download=this.name+" "+this.counter+" shapes.svg",e.href="data:,"+t,e.click()}}})},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i,r=n(31);var a=((i=r)&&i.__esModule?i:{default:i}).default.extend({init:function(t){this.context=t,this.interact=this._createInteract()},setTooltip:function(t){this.tooltip=t},_createInteract:function(){var t=this;return{mouseOver:function(){var e=d3.event,n=d3.mouse(t.context.element.node());t._setTooltip(d3.select(e.target).attr("data-text"),n[0],n[1])},mouseOut:function(){t._setTooltip()},tap:function(){}}},_setTooltip:function(t,e,n){if(t){this.tooltip.classed("vzb-hidden",!1).selectAll("text").text(t);var i=this.tooltip.select("text").node().getBBox();e-i.width<0?e+=i.width+5:e-=5,n-i.height<0?n+=i.height:n-=11,this.tooltip.attr("transform","translate("+e+","+n+")"),this.tooltip.selectAll("rect").attr("width",i.width+8).attr("height",1.2*i.height).attr("x",-i.width-4).attr("y",.85*-i.height).attr("rx",.2*i.height).attr("ry",.2*i.height)}else this.tooltip.classed("vzb-hidden",!0)},clear:function(t){t.attr("data-text",null)},wrap:function(t,e){var n=d3.select(t),i=Math.abs,r=n.attr("data-text");r||(r=n.text(),n.attr("data-text",r)),n.text(r);for(var a=r,s=a.length,o=n.node().getComputedTextLength();e-o<=0&&""!==a;)a=o>=e?a.slice(0,-i(.5*s)):r.slice(0,i(.5*s)),n.text(a+"…"),o=n.node().getComputedTextLength(),s=a.length;a!==r?(""===a&&n.text(r[0]),n.on("mouseover.tooltip",this.interact.mouseOver).on("mouseout.tooltip",this.interact.mouseOut).style("pointer-events","all")):n.on("mouseover.tooltip",null).on("mouseout.tooltip",null).style("pointer-events",null)}});e.default=a},function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.default=function(){function t(t,e){var n={},i={},r={},a=[],s=-1;function o(t,e){for(var i in t){var r=t[i];delete e[r.start],delete r.start,delete r.end,r.forEach(function(t){n[t<0?~t:t]=1}),a.push(r)}}return e.forEach(function(n,i){var r,a=t.arcs[n<0?~n:n];a.length<3&&!a[1][0]&&!a[1][1]&&(r=e[++s],e[s]=n,e[i]=r)}),e.forEach(function(e){var n,a,s=function(e){var n,i=t.arcs[e<0?~e:e],r=i[0];t.transform?(n=[0,0],i.forEach(function(t){n[0]+=t[0],n[1]+=t[1]})):n=i[i.length-1];return e<0?[n,r]:[r,n]}(e),o=s[0],l=s[1];if(n=r[o])if(delete r[n.end],n.push(e),n.end=l,a=i[l]){delete i[a.start];var c=a===n?n:n.concat(a);i[c.start=n.start]=r[c.end=a.end]=c}else i[n.start]=r[n.end]=n;else if(n=i[l])if(delete i[n.start],n.unshift(e),n.start=o,a=r[o]){delete r[a.end];var u=a===n?n:a.concat(n);i[u.start=a.start]=r[u.end=n.end]=u}else i[n.start]=r[n.end]=n;else i[(n=[e]).start=o]=r[n.end=l]=n}),o(r,i),o(i,r),e.forEach(function(t){n[t<0?~t:t]||a.push([t])}),a}function e(e,n,i){var r=[];function a(t){var e=t<0?~t:t;(c[e]||(c[e]=[])).push({i:t,g:l})}function s(t){t.forEach(a)}function o(t){t.forEach(s)}if(arguments.length>1){var l,c=[],u={LineString:s,MultiLineString:o,Polygon:o,MultiPolygon:function(t){t.forEach(o)}};!function t(e){"GeometryCollection"===e.type?e.geometries.forEach(t):e.type in u&&(l=e,u[e.type](e.arcs))}(n),c.forEach(arguments.length<3?function(t){r.push(t[0].i)}:function(t){i(t[0].g,t[t.length-1].g)&&r.push(t[0].i)})}else for(var h=0,d=e.arcs.length;h<d;++h)r.push(h);return{type:"MultiLineString",arcs:t(e,r)}}function i(e,i){var r={},s=[],o=[];function l(t){t.forEach(function(e){e.forEach(function(e){(r[e=e<0?~e:e]||(r[e]=[])).push(t)})}),s.push(t)}function c(t){return function(t){var e,n=-1,i=t.length,r=t[i-1],a=0;for(;++n<i;)e=r,r=t[n],a+=e[0]*r[1]-e[1]*r[0];return.5*a}(a(e,{type:"Polygon",arcs:[t]}).coordinates[0])>0}return i.forEach(function(t){"Polygon"===t.type?l(t.arcs):"MultiPolygon"===t.type&&t.arcs.forEach(l)}),s.forEach(function(t){if(!t._){var e=[],n=[t];for(t._=1,o.push(e);t=n.pop();)e.push(t),t.forEach(function(t){t.forEach(function(t){r[t<0?~t:t].forEach(function(t){t._||(t._=1,n.push(t))})})})}}),s.forEach(function(t){delete t._}),{type:"MultiPolygon",arcs:o.map(function(i){var a=[];if(i.forEach(function(t){t.forEach(function(t){t.forEach(function(t){r[t<0?~t:t].length<2&&a.push(t)})})}),a=t(e,a),(n=a.length)>1)for(var s,o=c(i[0][0]),l=0;l<n;++l)if(o===c(a[l])){s=a[0],a[0]=a[l],a[l]=s;break}return a})}}function r(t,e){var n={type:"Feature",id:e.id,properties:e.properties||{},geometry:a(t,e)};return null==e.id&&delete n.id,n}function a(t,e){var n=c(t.transform),i=t.arcs;function r(t,e){e.length&&e.pop();for(var r,a=i[t<0?~t:t],s=0,o=a.length;s<o;++s)e.push(r=a[s].slice()),n(r,s);t<0&&function(t,e){var n,i=t.length,r=i-e;for(;r<--i;)n=t[r],t[r++]=t[i],t[i]=n}(e,o)}function a(t){return t=t.slice(),n(t,0),t}function s(t){for(var e=[],n=0,i=t.length;n<i;++n)r(t[n],e);return e.length<2&&e.push(e[0].slice()),e}function o(t){for(var e=s(t);e.length<4;)e.push(e[0].slice());return e}function l(t){return t.map(o)}var u={Point:function(t){return a(t.coordinates)},MultiPoint:function(t){return t.coordinates.map(a)},LineString:function(t){return s(t.arcs)},MultiLineString:function(t){return t.arcs.map(s)},Polygon:function(t){return l(t.arcs)},MultiPolygon:function(t){return t.arcs.map(l)}};return function t(e){var n=e.type;return"GeometryCollection"===n?{type:n,geometries:e.geometries.map(t)}:n in u?{type:n,coordinates:u[n](e)}:null}(e)}function s(t,e){for(var n=0,i=t.length;n<i;){var r=n+i>>>1;t[r]<e?n=r+1:i=r}return n}function o(t){var e=t[0],n=t[1],i=t[2];return Math.abs((e[0]-i[0])*(n[1]-e[1])-(e[0]-n[0])*(i[1]-e[1]))}function l(t,e){return t[1][2]-e[1][2]}function c(t){if(!t)return u;var e,n,i=t.scale[0],r=t.scale[1],a=t.translate[0],s=t.translate[1];return function(t,o){o||(e=n=0),t[0]=(e+=t[0])*i+a,t[1]=(n+=t[1])*r+s}}function u(){}return{version:"1.6.19",mesh:function(t){return a(t,e.apply(this,arguments))},meshArcs:e,merge:function(t){return a(t,i.apply(this,arguments))},mergeArcs:i,feature:function(t,e){return"GeometryCollection"===e.type?{type:"FeatureCollection",features:e.geometries.map(function(e){return r(t,e)})}:r(t,e)},neighbors:function(t){var e={},n=t.map(function(){return[]});function i(t,n){t.forEach(function(t){t<0&&(t=~t);var i=e[t];i?i.push(n):e[t]=[n]})}function r(t,e){t.forEach(function(t){i(t,e)})}var a={LineString:i,MultiLineString:r,Polygon:r,MultiPolygon:function(t,e){t.forEach(function(t){r(t,e)})}};for(var o in t.forEach(function t(e,n){"GeometryCollection"===e.type?e.geometries.forEach(function(e){t(e,n)}):e.type in a&&a[e.type](e.arcs,n)}),e)for(var l=e[o],c=l.length,u=0;u<c;++u)for(var h=u+1;h<c;++h){var d,f=l[u],p=l[h];(d=n[f])[o=s(d,p)]!==p&&d.splice(o,0,p),(d=n[p])[o=s(d,f)]!==f&&d.splice(o,0,f)}return n},presimplify:function(t,e){var n=c(t.transform),i=function(t){if(!t)return u;var e,n,i=t.scale[0],r=t.scale[1],a=t.translate[0],s=t.translate[1];return function(t,o){o||(e=n=0);var l=(t[0]-a)/i|0,c=(t[1]-s)/r|0;t[0]=l-e,t[1]=c-n,e=l,n=c}}(t.transform),r=function(){var t={},e=[],n=0;function i(t,n){for(;n>0;){var i=(n+1>>1)-1,r=e[i];if(l(t,r)>=0)break;e[r._=n]=r,e[t._=n=i]=t}}function r(t,i){for(;;){var r=i+1<<1,a=r-1,s=i,o=e[s];if(a<n&&l(e[a],o)<0&&(o=e[s=a]),r<n&&l(e[r],o)<0&&(o=e[s=r]),s===i)break;e[o._=i]=o,e[t._=i=s]=t}}return t.push=function(t){return i(e[t._=n]=t,n++),n},t.pop=function(){if(!(n<=0)){var t,i=e[0];return--n>0&&(t=e[n],r(e[t._=0]=t,0)),i}},t.remove=function(t){var a,s=t._;if(e[s]===t)return s!==--n&&(l(a=e[n],t)<0?i:r)(e[a._=s]=a,s),s},t}();e||(e=o);function a(t){r.remove(t),t[1][2]=e(t),r.push(t)}return t.arcs.forEach(function(t){for(var s,o,l=[],c=0,u=0,h=t.length;u<h;++u)o=t[u],n(t[u]=[o[0],o[1],1/0],u);for(u=1,h=t.length-1;u<h;++u)(s=t.slice(u-1,u+2))[1][2]=e(s),l.push(s),r.push(s);for(u=0,h=l.length;u<h;++u)(s=l[u]).previous=l[u-1],s.next=l[u+1];for(;s=r.pop();){var d=s.previous,f=s.next;s[1][2]<c?s[1][2]=c:c=s[1][2],d&&(d.next=f,d[2]=s[2],a(d)),f&&(f.previous=d,f[0]=s[0],a(f))}t.forEach(i)}),t}}}()},function(t,e,n){}])});
//# sourceMappingURL=vizabi.min.js.map