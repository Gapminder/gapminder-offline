!function(i){var a={};function s(t){if(a[t])return a[t].exports;var e=a[t]={i:t,l:!1,exports:{}};return i[t].call(e.exports,e,e.exports,s),e.l=!0,e.exports}s.m=i,s.c=a,s.d=function(t,e,i){s.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:i})},s.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},s.t=function(e,t){if(1&t&&(e=s(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var i=Object.create(null);if(s.r(i),Object.defineProperty(i,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var a in e)s.d(i,a,function(t){return e[t]}.bind(null,a));return i},s.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return s.d(e,"a",e),e},s.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},s.p="",s(s.s=0)}([function(t,e,i){t.exports=i(1)},function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),i(2);var a,s=i(3),l=(a=s)&&a.__esModule?a:{default:a};var n=Vizabi.Tool.extend("LineChart",{init:function(t,e){this.name="linechart",this.components=[{component:l.default,placeholder:".vzb-tool-viz",model:["state.time","state.marker","locale","ui"]},{component:Vizabi.Component.get("timeslider"),placeholder:".vzb-tool-timeslider",model:["state.time","state.marker","ui"],ui:{show_value_when_drag_play:!0,axis_aligned:!1}},{component:Vizabi.Component.get("dialogs"),placeholder:".vzb-tool-dialogs",model:["state","ui","locale"]},{component:Vizabi.Component.get("buttonlist"),placeholder:".vzb-tool-buttonlist",model:["state","ui","locale"]},{component:Vizabi.Component.get("treemenu"),placeholder:".vzb-tool-treemenu",model:["state.marker","state.time","locale","ui"]},{component:Vizabi.Component.get("datawarning"),placeholder:".vzb-tool-datawarning",model:["locale"]},{component:Vizabi.Component.get("datanotes"),placeholder:".vzb-tool-datanotes",model:["state.marker","locale"]},{component:Vizabi.Component.get("steppedspeedslider"),placeholder:".vzb-tool-stepped-speed-slider",model:["state.time","locale"]}],this._super(t,e)},default_model:{state:{time:{autoconfig:{type:"time"}},entities:{autoconfig:{type:"entity_domain",excludeIDs:["tag"]}},entities_colorlegend:{autoconfig:{type:"entity_domain",excludeIDs:["tag"]}},marker:{limit:5e3,space:["entities","time"],axis_x:{use:"indicator",allow:{scales:["time"]},autoconfig:{index:0,type:"time"}},axis_y:{use:"indicator",allow:{scales:["linear","log"]},autoconfig:{type:"measure"}},label:{use:"property",autoconfig:{includeOnlyIDs:["name"],type:"string"}},color:{syncModels:["marker_colorlegend"],autoconfig:{}}},marker_colorlegend:{space:["entities_colorlegend"],label:{use:"property",which:"name"},hook_rank:{use:"property",which:"rank"},hook_geoshape:{use:"property",which:"shape_lores_svg"}}},locale:{},ui:{chart:{curve:"curveMonotoneX",labels:{min_number_of_entities_when_values_hide:2},whenHovering:{hideVerticalNow:!1,showProjectionLineX:!0,showProjectionLineY:!0,higlightValueX:!0,higlightValueY:!0,showTooltip:!1}},datawarning:{doubtDomain:[],doubtRange:[]},buttons:["colors","find","moreoptions","presentation","sidebarcollapse","fullscreen"],dialogs:{popup:["colors","find","moreoptions"],sidebar:["colors","find"],moreoptions:["opacity","speed","axes","colors","presentation","technical","about"],dialog:{find:{panelMode:"show"}}},presentation:!1}},versionInfo:{version:"2.3.1",build:1547630336039}});e.default=n},function(t,e,i){},function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var a=Vizabi,p=a.utils,s=a.Component,l=a.helpers,n=l["d3.axisWithLabelPicker"],o=l["d3.collisionResolver"],r=a.iconset,h=r.warn,c=r.question,d=s.extend("linechart",{init:function(t,e){var s=this;this.name="linechart",this.template=i(4),this.model_expects=[{name:"time",type:"time"},{name:"marker",type:"marker"},{name:"locale",type:"locale"},{name:"ui",type:"ui"}],this.model_binds={"change:time.value":function(){s._readyOnce&&(s.updateTime(),s.redrawDataPoints())},"change:time.playing":function(){s.model.time.playing&&p.isTouchDevice()&&!s.tooltip.classed("vzb-hidden")&&s.tooltip.classed("vzb-hidden",!0),!s.ui.chart.hideXAxisValue&&s.model.time.playing&&s.time-s.model.time.start==0&&s.xAxisEl.call(s.xAxis.highlightTransDuration(0).highlightValue(s.time))},"change:time.start":function(){s._readyOnce&&s.all_values&&s.values&&(s.updateIndicators(),s.updateShow(),s.zoomToMaxMin(),s.updateSize(),s.redrawDataPoints(),s.highlightLines())},"change:time.end":function(){s._readyOnce&&s.all_values&&s.values&&(s.updateIndicators(),s.updateShow(),s.zoomToMaxMin(),s.updateSize(),s.redrawDataPoints(),s.highlightLines())},"change:marker":function(t,e){if(s._readyOnce){if(-1<e.indexOf("domainMin")||-1<e.indexOf("domainMax")||-1<e.indexOf("zoomedMin")||-1<e.indexOf("zoomedMax")){if(!s.yScale||!s.xScale)return;if(-1<e.indexOf("axis_x")){var i=s.model.time.formatDate(s.model.marker.axis_x.getZoomedMin()),a=s.model.time.formatDate(s.model.marker.axis_x.getZoomedMax());return void s.model.time.set({startOrigin:i,endOrigin:a})}if(!s.all_values||!s.values)return;return s.updateIndicators(),s.updateShow(),s.zoomToMaxMin(),s.updateSize(),s.updateTime(),s.redrawDataPoints(),void s.highlightLines()}if(-1<e.indexOf("scaleType")){if(!s.all_values||!s.values)return;s.updateIndicators(),s.updateShow(),s.zoomToMaxMin(),s.updateSize(),s.redrawDataPoints(),s.highlightLines()}}},"change:marker.highlight":function(){s._readyOnce&&s.highlightLines()},"change:marker.select":function(){s._readyOnce&&(s.updateDoubtOpacity(),s.highlightLines())},"change:marker.opacitySelectDim":function(){s._readyOnce&&s.highlightLines()},"change:marker.opacityRegular":function(){s._readyOnce&&s.highlightLines()},"change:marker.color":function(){s._ready&&s.model.marker.getFrame(s.model.time.value,function(t,e){if(!s._frameIsValid(t))return p.warn("change:marker.color: empty data received from marker.getFrame(). doing nothing");s.values=t,s.updateColors()})},"change:ui.chart.showForecastOverlay":function(){s._readyOnce&&s._updateForecastOverlay()}},this._super(t,e),this.xScale=null,this.yScale=null,this.rangeXRatio=1,this.rangeXShift=0,this.rangeYRatio=1,this.rangeYShift=0,this.lineWidthScale=d3.scaleLinear().domain([0,20]).range([7,1]).clamp(!0),this.xAxis=n("bottom"),this.yAxis=n("left"),this.COLOR_BLACKISH="#333",this.COLOR_WHITEISH="#fdfdfd",this.COLOR_WHITEISH_SHADE="#555",this.isDataPreprocessed=!1,this.timeUpdatedOnce=!1,this.sizeUpdatedOnce=!1,this.getNearestKey=p.memoize(this.getNearestKey)},readyOnce:function(){var t=this,i=this;this.element=d3.select(this.element),this.graph=this.element.select(".vzb-lc-graph"),this.yAxisElContainer=this.graph.select(".vzb-lc-axis-y"),this.yAxisEl=this.yAxisElContainer.select("g"),this.xAxisElContainer=this.graph.select(".vzb-lc-axis-x"),this.xAxisEl=this.xAxisElContainer.select("g"),this.xTitleEl=this.graph.select(".vzb-lc-axis-x-title"),this.yTitleEl=this.graph.select(".vzb-lc-axis-y-title"),this.yInfoEl=this.graph.select(".vzb-lc-axis-y-info"),this.linesContainerCrop=this.graph.select(".vzb-lc-lines-crop"),this.linesContainer=this.graph.select(".vzb-lc-lines"),this.labelsContainerCrop=this.graph.select(".vzb-lc-labels-crop"),this.labelsContainer=this.graph.select(".vzb-lc-labels"),this.forecastOverlay=this.element.select(".vzb-lc-forecastoverlay"),this.dataWarningEl=this.graph.select(".vzb-data-warning"),this.verticalNow=this.labelsContainer.select(".vzb-lc-vertical-now"),this.tooltip=this.element.select(".vzb-tooltip"),this.projectionX=this.graph.select(".vzb-lc-projection-x"),this.projectionY=this.graph.select(".vzb-lc-projection-y"),this.entityLabels=this.labelsContainer.selectAll(".vzb-lc-entity"),this.entityLines=this.linesContainer.selectAll(".vzb-lc-entity"),this.totalLength_1={},this.TIMEDIM=this.model.time.getDimension(),this.KEYS=p.unique(this.model.marker._getAllDimensions({exceptType:"time"})),this.KEY=this.KEYS.join(","),this.dataKeys=this.model.marker.getDataKeysPerHook(),this.collisionResolver=o().selector(".vzb-lc-label").value("valueY").filter(function(t,e){return t.valueX-e==0&&!t.hidden});var e=this.model.marker.axis_y.getConceptprops();p.setIcon(this.yInfoEl,c).select("svg").attr("width","0px").attr("height","0px").style("opacity",Number(Boolean(e.description||e.sourceLink))),this.yInfoEl.on("click",function(){i.parent.findChildByName("gapminder-datanotes").pin()}),this.yInfoEl.on("mouseover",function(){var t=this.getBBox(),e=p.makeAbsoluteContext(this,this.farthestViewportElement)(t.x-10,t.y+t.height+10);i.parent.findChildByName("gapminder-datanotes").setHook("axis_y").show().setPos(e.x,e.y)}),this.yInfoEl.on("mouseout",function(){i.parent.findChildByName("gapminder-datanotes").hide()}),this.wScale=d3.scaleLinear().domain(this.model.ui.datawarning.doubtDomain).range(this.model.ui.datawarning.doubtRange),this.on("resize",function(){i.updateSize()||(i.updateTime(),i.redrawDataPoints())}),this.graph.on("click",function(){1==t.model.marker.highlight.length&&i.model.marker.selectMarker(t.model.marker.highlight[0])})},ready:function(){var e=this;this.KEYS=p.unique(this.model.marker._getAllDimensions({exceptType:"time"})),this.KEY=this.KEYS.join(","),this.dataKeys=this.model.marker.getDataKeysPerHook(),this.all_steps=this.model.time.getAllSteps(),this.all_values=this.values=null,this.updateTime(),this.updateUIStrings(),this.updateIndicators(),this.entityLines.remove(),this.entityLabels.remove(),this.model.marker.getFrame(null,function(t){e.all_values=t,e.model.marker.getFrame(e.model.time.value,function(t){e._frameIsValid(t)&&(e.values=t,e.updateShow(),e.updateSize()||(e.updateDoubtOpacity(),e.zoomToMaxMin(),e.redrawDataPoints(),e.highlightLines(),e.linesContainerCrop.on("mousemove",e.entityMousemove.bind(e,null,null,e)).on("mouseleave",e.entityMouseout.bind(e,null,null,e))))})})},_frameIsValid:function(t){return!(!t||0===Object.keys(t.axis_y).length||0===Object.keys(t.axis_x).length||0===Object.keys(t.color).length)},updateUIStrings:function(){var t=this,e=t.model.marker.axis_y.getConceptprops(),i=t.model.marker.axis_x.getConceptprops(),a=t.model.marker.color.getConceptprops();this.translator=this.model.locale.getTFunction(),this.strings={title:{Y:e.name,X:i.name,C:a.name},unit:{Y:e.unit||"",X:i.unit||"",C:a.unit||""}},this.strings.unit.Y==="unit/"+this.model.marker.axis_y.which&&(this.strings.unit.Y=""),this.strings.unit.X==="unit/"+this.model.marker.axis_x.which&&(this.strings.unit.X=""),this.strings.unit.C==="unit/"+this.model.marker.color.which&&(this.strings.unit.C=""),this.strings.unit.Y&&(this.strings.unit.Y=", "+this.strings.unit.Y),this.strings.unit.X&&(this.strings.unit.X=", "+this.strings.unit.X),this.strings.unit.C&&(this.strings.unit.C=", "+this.strings.unit.C),p.setIcon(this.dataWarningEl,h).select("svg").attr("width","0px").attr("height","0px"),this.dataWarningEl.append("text").attr("text-anchor","end").text(this.translator("hints/dataWarning")),this.dataWarningEl.on("click",function(){t.parent.findChildByName("gapminder-datawarning").toggle()}).on("mouseover",function(){t.updateDoubtOpacity(1)}).on("mouseout",function(){t.updateDoubtOpacity()});var s=this.xTitleEl.selectAll("text").data([0]);s=s.enter().append("text").merge(s);var l=this.yTitleEl.selectAll("text").data([0]);(l=l.enter().append("text").merge(l)).on("click",function(){t.parent.findChildByName("gapminder-treemenu").markerID("axis_y").alignX("left").alignY("top").updateView().toggle()})},updateDoubtOpacity:function(t){null==t&&(t=this.wScale(+this.time.getUTCFullYear().toString())),this.someSelected&&(t=1),this.dataWarningEl.style("opacity",t)},updateIndicators:function(){var t=this.KEY;if(this.yScale=this.model.marker.axis_y.getScale(),!this.splash){var e=this.model.marker.axis_y.getLimits(this.model.marker.axis_y.which);this.yScale.domain([e.min,e.max])}this.xScale=this.model.marker.axis_x.getScale(),this.cScale=this.model.marker.color.getScale(),this.yAxis.tickFormat(this.model.marker.axis_y.getTickFormatter()),this.xAxis.tickFormat(this.model.marker.axis_x.getTickFormatter()),this.collisionResolver.scale(this.yScale).KEY(t)},updateShow:function(){var e=this,c=this,i=this.KEYS,a=this.KEY,d=this.dataKeys;this.cached={},this.dataHash={},this.data=this.model.marker.getKeys().map(function(t){return t[a]=p.getKey(t,i),e.dataHash[t[a]]=t}),this.linesContainer.selectAll(".vzb-lc-entity").remove(),this.entityLines=this.linesContainer.selectAll(".vzb-lc-entity").data(this.data),this.lineWidth=this.lineWidthScale(this.data.length),2<=this.lineWidth?this.shadowWidth=1.3*this.lineWidth:this.shadowWidth=null,this.labelsContainer.classed("small",!this.shadowWidth),this.entityLines=this.entityLines.enter().append("g").attr("class",function(t){return"vzb-lc-entity vzb-lc-entity-"+t[a]}).each(function(t,e){var i=d3.select(this);c.shadowWidth&&i.append("path").attr("class","vzb-lc-line-shadow"),i.append("path").attr("class","vzb-lc-line")}).merge(this.entityLines),this.labelsContainer.selectAll(".vzb-lc-entity").remove(),this.entityLabels=this.labelsContainer.selectAll(".vzb-lc-entity").data(this.data),this.entityLabels=this.entityLabels.enter().append("g").attr("class","vzb-lc-entity").on("mouseover",function(t){c.model.marker.highlightMarker(t)}).on("mouseout",function(t){c.model.marker.clearHighlighted()}).each(function(t,e){var i=d3.select(this);i.append("circle").attr("class","vzb-lc-circle").attr("cx",0);var a=i.append("g").attr("class","vzb-lc-label");a.append("text").attr("class","vzb-lc-labelname vzb-lc-labelstroke").attr("dy",".35em"),a.append("text").attr("class","vzb-lc-labelname vzb-lc-labelfill").attr("dy",".35em"),a.append("text").attr("class","vzb-lc-label-value").attr("dy","1.6em")}).merge(this.entityLabels),this.all_values&&this.values&&this.entityLabels.each(function(t,e){var i=d3.select(this),a=c.getColorsByValue(c.values.color[p.getKey(t,d.color)]),s=a.color,l=a.colorShadow,n=c.model.marker.getCompoundLabelText(t,c.values),o=c.yAxis.tickFormat()(c.values.axis_y[p.getKey(t,d.axis_y)]),r=n.length<13?n:n.substring(0,10)+"...",h=c.ui.chart.labels.min_number_of_entities_when_values_hide;i.select("circle").style("fill",s),i.selectAll(".vzb-lc-labelname").text(r+" "+(c.data.length<h?o:"")),i.select(".vzb-lc-labelfill").style("fill",l),i.append("title").text(n+" "+o),i.select(".vzb-lc-label-value").style("fill",l)}),this.line=d3.line().curve(d3[this.ui.chart.curve||"curveMonotoneX"]).x(function(t){return c.xScale(t[0])}).y(function(t){return c.yScale(t[1])})},getColorsByValue:function(t){return{color:null!=t?this.cScale(t):this.COLOR_WHITEISH,colorShadow:null!=t?this.model.marker.color.getColorShade({colorID:t,shadeID:"shade"}):this.COLOR_WHITEISH_SHADE}},updateColors:function(){var n=this,o=this.dataKeys=this.model.marker.getDataKeysPerHook(),r=this.values.color;this.cScale=this.model.marker.color.getScale(),this.entityLabels.each(function(t,e){var i=d3.select(this),a=n.getColorsByValue(r[p.getKey(t,o.color)]),s=a.color,l=a.colorShadow;i.select("circle").style("fill",s),i.select(".vzb-lc-labelfill").style("fill",l),i.select(".vzb-lc-label-value").style("fill",l)}),this.entityLines.each(function(t,e){var i=d3.select(this),a=n.getColorsByValue(r[p.getKey(t,o.color)]),s=a.color,l=a.colorShadow;i.select(".vzb-lc-line").style("stroke",s),i.select(".vzb-lc-line-shadow").style("stroke",l)})},updateTime:function(){var e=this,t=(this.KEY,null===this.time?this.model.time.value:this.time);this.time=this.model.time.value,this.duration=this.model.time.playing&&0<this.time-t?this.model.time.delayAnimations:0,this._updateForecastOverlay();this.model.time.getDimension();this.time,this.prev_steps=this.all_steps.filter(function(t){return t<e.time}),this.timeUpdatedOnce=!0},_updateForecastOverlay:function(){this.forecastOverlay.classed("vzb-hidden",this.model.time.value<=this.model.time.endBeforeForecast||!this.model.time.endBeforeForecast||!this.model.ui.chart.showForecastOverlay)},profiles:{small:{margin:{top:30,right:20,left:40,bottom:20},infoElHeight:16,yAxisTitleBottomMargin:6,tick_spacing:60,text_padding:12,lollipopRadius:6,limitMaxTickNumberX:5},medium:{margin:{top:40,right:60,left:60,bottom:25},infoElHeight:20,yAxisTitleBottomMargin:6,tick_spacing:80,text_padding:15,lollipopRadius:7,limitMaxTickNumberX:10},large:{margin:{top:50,right:60,left:75,bottom:30},infoElHeight:22,yAxisTitleBottomMargin:6,tick_spacing:100,text_padding:20,lollipopRadius:9,limitMaxTickNumberX:0}},presentationProfileChanges:{medium:{margin:{top:70,bottom:40,left:70},yAxisTitleBottomMargin:20,xAxisTitleBottomMargin:20,infoElHeight:26,text_padding:30},large:{margin:{top:70,bottom:50,left:70},yAxisTitleBottomMargin:20,xAxisTitleBottomMargin:20,infoElHeight:32,text_padding:36,hideSTitle:!0}},timeSliderProfiles:{small:{margin:{top:7,right:15,bottom:10,left:60}},medium:{margin:{top:10,right:15,bottom:10,left:60}},large:{margin:{top:5,right:15,bottom:10,left:75}}},updateSize:function(){var t=this,e=(this.values,this.KEY,this.model.locale.isRTL());this.activeProfile=this.getActiveProfile(this.profiles,this.presentationProfileChanges),this.margin=this.activeProfile.margin,this.tick_spacing=this.activeProfile.tick_spacing;var i=this.activeProfile.infoElHeight,a=0;this.entityLabels.selectAll(".vzb-lc-labelname").attr("dx",t.activeProfile.text_padding).each(function(t,e){var i=this.getComputedTextLength();a<i&&(a=i)}),this.entityLabels.selectAll(".vzb-lc-circle").attr("r",this.shadowWidth?t.activeProfile.lollipopRadius:.8*t.activeProfile.lollipopRadius);if(this.margin.right=Math.max(this.margin.right,a+this.activeProfile.text_padding+20),this.height=parseInt(this.element.style("height"),10)-this.margin.top-this.margin.bottom||0,this.width=parseInt(this.element.style("width"),10)-this.margin.left-this.margin.right||0,this.height<=0||this.width<=0)return p.warn("Line chart updateSize() abort: vizabi container is too little or has display:none");this.linesContainerCrop.attr("width",this.width).attr("height",Math.max(0,this.height)),this.labelsContainerCrop.attr("width",this.width+this.margin.right).attr("height",Math.max(0,this.height)),this.collisionResolver.height(this.height),this.graph.attr("transform","translate("+this.margin.left+","+this.margin.top+")"),this.yScale.range([this.height-this.activeProfile.lollipopRadius,this.activeProfile.lollipopRadius]),this.xScale.range([this.rangeXShift,this.width*this.rangeXRatio+this.rangeXShift]),this.yAxis.scale(this.yScale).tickSizeInner(-this.width).tickSizeOuter(0).tickPadding(6).tickSizeMinor(-this.width,0).labelerOptions({scaleType:this.model.marker.axis_y.scaleType,toolMargin:this.margin,limitMaxTickNumber:6,viewportLength:this.height,formatter:this.model.marker.axis_y.getTickFormatter()}),this.xAxis.scale(this.xScale).tickSizeInner(-this.height).tickSizeOuter(0).tickSizeMinor(-this.height,0).tickPadding(6).labelerOptions({scaleType:this.model.marker.axis_x.scaleType,limitMaxTickNumber:this.activeProfile.limitMaxTickNumberX,toolMargin:this.margin,bump:2*this.activeProfile.text_padding,formatter:this.model.marker.axis_x.getTickFormatter()}),this.xAxisElContainer.attr("width",this.width+2*this.activeProfile.text_padding).attr("height",this.activeProfile.margin.bottom+this.height).attr("y",-1).attr("x",-this.activeProfile.text_padding),this.xAxisEl.attr("transform","translate("+(this.activeProfile.text_padding-1)+","+(this.height+1)+")"),this.yAxisElContainer.attr("width",this.activeProfile.margin.left+this.width).attr("height",Math.max(0,this.height)).attr("x",-this.activeProfile.margin.left),this.yAxisEl.attr("transform","translate("+(this.activeProfile.margin.left-1)+",0)"),this.yAxisEl.call(this.yAxis),this.xAxisEl.call(this.xAxis),this.yTitleEl.style("font-size",i+"px").attr("transform","translate("+(10-this.activeProfile.margin.left+(e?1.4*i:0))+", -"+this.activeProfile.yAxisTitleBottomMargin+")");var s=this.yTitleEl.select("text").text(this.strings.title.Y+this.strings.unit.Y);if(s.node().getBBox().width>this.width&&s.text(this.strings.title.Y),this.yInfoEl.select("svg").node()){var l=this.yTitleEl.node().getBBox(),n=p.transform(this.yTitleEl.node());this.yInfoEl.select("svg").attr("width",i+"px").attr("height",i+"px"),this.yInfoEl.attr("transform","translate("+(e?10-this.activeProfile.margin.left:l.x+n.translateX+l.width+.4*i)+","+(n.translateY-.8*i)+")")}var o=this.dataWarningEl.select("text").node().getBBox();this.dataWarningEl.select("svg").attr("width",.75*o.height).attr("height",.75*o.height).attr("x",-o.width-1.2*o.height).attr("y",.65*-o.height),this.dataWarningEl.attr("transform","translate("+(this.width+.85*this.margin.right)+",-"+this.activeProfile.yAxisTitleBottomMargin+")").select("text");var r=this.xTitleEl.select("text").text(this.strings.title.X+this.strings.unit.X);this.xTitleEl.style("font-size",i+"px").attr("transform","translate("+(this.width+this.activeProfile.text_padding+this.activeProfile.yAxisTitleBottomMargin)+","+(this.height+.72*r.node().getBBox().height)+")"),r.node().getBBox().width>this.width-100&&r.text(this.strings.title.X),this.verticalNow.attr("y1",this.yScale.range()[0]).attr("y2",this.yScale.range()[1]).attr("x1",0).attr("x2",0),this.projectionX.attr("y1",t.yScale.range()[0]),this.projectionY.attr("x2",t.xScale.range()[0]),p.isTouchDevice()&&(t.tooltip.classed("vzb-hidden",!0),t.verticalNow.style("opacity",1),t.projectionX.style("opacity",0),t.projectionY.style("opacity",0),t.xAxisEl.call(t.xAxis.highlightValue(t.time)),t.yAxisEl.call(t.yAxis.highlightValue("none")),t.graph.selectAll(".vzb-lc-entity").each(function(){d3.select(this).classed("vzb-dimmed",!1).classed("vzb-hovered",!1)}),t.hoveringNow=null);var h={rangeMax:this.xScale.range()[1],mRight:a-20,profile:this.timeSliderProfiles[this.getLayoutProfile()]};this.parent.trigger("myEvent",h),this.sizeUpdatedOnce=!0},redrawDataPoints:function(){var m=this,n=this.KEYS,g=this.KEY,u=this.dataKeys=this.model.marker.getDataKeysPerHook();m.all_values&&this.model.marker.getFrame(this.time,function(d,t){if(!m._frameIsValid(d))return p.warn("redrawDataPoints(): empty data received from marker.getFrame(). doing nothing");m.values=d,m.timeUpdatedOnce||m.updateTime(),m.sizeUpdatedOnce||m.updateSize(),m.updateDoubtOpacity(),m.entityLines.each(function(i,t){var e=d3.select(this),a=m.getColorsByValue(d.color[p.getKey(i,u.color)]),s=a.color,l=a.colorShadow,n=m.prev_steps.map(function(t,e){return[t,m.all_values[t]?m.all_values[t].axis_y[p.getKey(i,u.axis_y)]:null]}).filter(function(t){return t[1]||0===t[1]});(d.axis_y[p.getKey(i,u.axis_y)]||0===d.axis_y[p.getKey(i,u.axis_y)])&&n.push([d.axis_x[p.getKey(i,u.axis_x)],d.axis_y[p.getKey(i,u.axis_y)]]),0<n.length?m.cached[i[g]]={valueX:n[n.length-1][0],valueY:n[n.length-1][1]}:delete m.cached[i[g]];var o=e.select(".vzb-lc-line");m.model.time.playing&&null===m.totalLength_1[i[g]]&&(m.totalLength_1[i[g]]=o.node().getTotalLength());var r=m.line(n)||"",h=e.select(".vzb-lc-line-shadow").style("stroke",l).style("stroke-width",m.shadowWidth+"px").attr("transform","translate(0, "+(m.shadowWidth-m.lineWidth)+")").attr("d",r);o.style("stroke",s).style("stroke-width",m.lineWidth+"px").attr("d",r);var c=o.node().getTotalLength();m.model.time.playing?(h.interrupt().attr("stroke-dasharray",c).attr("stroke-dashoffset",c-m.totalLength_1[i[g]]).transition().delay(0).duration(m.duration).ease(d3.easeLinear).attr("stroke-dashoffset",0),o.interrupt().attr("stroke-dasharray",c).attr("stroke-dashoffset",c-m.totalLength_1[i[g]]).transition().delay(0).duration(m.duration).ease(d3.easeLinear).attr("stroke-dashoffset",0),m.totalLength_1[i[g]]=c):(m.totalLength_1[i[g]]=null,h.attr("stroke-dasharray","none").attr("stroke-dashoffset","none"),o.attr("stroke-dasharray","none").attr("stroke-dashoffset","none"))}),m.entityLabels.each(function(t,e){var i=d3.select(this);if(m.cached[t[g]]){if(t.valueX=m.xScale(m.cached[t[g]].valueX),t.valueY=m.yScale(m.cached[t[g]].valueY),i.classed("vzb-hidden",!1).transition().duration(m.duration).ease(d3.easeLinear).attr("transform","translate("+t.valueX+",0)"),i.select(".vzb-lc-circle").transition().duration(m.duration).ease(d3.easeLinear).attr("cy",t.valueY+1),m.data.length<m.ui.chart.labels.min_number_of_entities_when_values_hide*n.length){var a=m.model.marker.getCompoundLabelText(t,m.values),s=m.yAxis.tickFormat()(m.cached[t[g]].valueY),l=a.length<13?a:a.substring(0,12)+"â€¦";i.selectAll(".vzb-lc-labelname").text(l+" "+s)}i.select(".vzb-lc-label").transition().duration(m.duration).ease(d3.easeLinear).attr("transform","translate(0,"+t.valueY+")")}else i.classed("vzb-hidden",!0)}),m.verticalNow.transition().duration(m.duration).ease(d3.easeLinear).attr("transform","translate("+m.xScale(d3.min([m.model.marker.axis_x.getZoomedMax(),m.time]))+",0)"),m.hoveringNow||m.time-m.model.time.start==0?(m.ui.chart.hideXAxisValue||m.xAxisEl.call(m.xAxis.highlightValue("none")),m.verticalNow.style("opacity",0)):(m.ui.chart.hideXAxisValue||m.xAxisEl.call(m.xAxis.highlightTransDuration(m.duration).highlightValue(m.time)),m.verticalNow.style("opacity",1)),0==m.duration&&d3.timerFlush(),clearTimeout(m.collisionTimeout),m.collisionTimeout=setTimeout(function(){m.entityLabels.call(m.collisionResolver.time(m.xScale(m.time)))},1.5*m.model.time.delayAnimations)})},entityMousemove:function(s,t,e,i){var l=e,a=(l.KEY,l.values,d3.mouse(l.element.node()).map(function(t){return parseInt(t)})),n=l.xScale.invert(a[0]-l.margin.left);l.time-n<0?n=l.time:n<this.model.time.start&&(n=this.model.time.start);var o=void 0,r=a[1]-l.margin.top;p.isDate(n)||(n=this.model.time.parse(n)),this.model.marker.getFrame(n,function(t){if(l._frameIsValid(t)){var e=l.getNearestKey(r,l.dataHash,t.axis_y,l.yScale.bind(l));if(o=t.axis_y[e],s=l.dataHash[e],l.model.marker.isHighlighted(s)||(l.model.marker.clearHighlighted(),l.model.marker.highlightMarker(s)),l.hoveringNow=s,!p.isNaN(o)){var i=l.xScale(n),a=l.yScale(o);l.ui.chart.whenHovering.showTooltip&&l.tooltip.style("left",i+l.margin.left+"px").style("bottom",l.height-a+l.margin.bottom+"px").text(l.yAxis.tickFormat()(o)).classed("vzb-hidden",!1),l.ui.chart.whenHovering.hideVerticalNow&&l.verticalNow.style("opacity",0),l.ui.chart.whenHovering.showProjectionLineX&&l.projectionX.style("opacity",1).attr("y2",a).attr("x1",i).attr("x2",i),l.ui.chart.whenHovering.showProjectionLineY&&l.projectionY.style("opacity",1).attr("y1",a).attr("y2",a).attr("x1",i),l.ui.chart.whenHovering.higlightValueX&&l.xAxisEl.call(l.xAxis.highlightValue(n).highlightTransDuration(0)),l.ui.chart.whenHovering.higlightValueY&&l.yAxisEl.call(l.yAxis.highlightValue(o).highlightTransDuration(0)),clearTimeout(l.unhoverTimeout)}}})},entityMouseout:function(t,e,i){var a=i;d3.event.relatedTarget&&d3.select(d3.event.relatedTarget).classed("vzb-tooltip")||(a.unhoverTimeout=setTimeout(function(){a.tooltip.classed("vzb-hidden",!0),a.verticalNow.style("opacity",1),a.projectionX.style("opacity",0),a.projectionY.style("opacity",0),a.xAxisEl.call(a.xAxis.highlightValue(a.time)),a.yAxisEl.call(a.yAxis.highlightValue("none")),a.model.marker.clearHighlighted(),a.hoveringNow=null},300))},highlightLines:function(){var e=this,i=this.KEYS,a=this.KEY,s=this.model.marker.opacityRegular,l=this.model.marker.opacitySelectDim,n=0<this.model.marker.highlight.length;this.someSelected=0<this.model.marker.select.length,this.nonSelectedOpacityZero=e.model.marker.opacitySelectDim<.01;var o={};e.model.marker.getSelected().map(function(t){o[p.getKey(t,i)]=!0}),this.entityLines.style("opacity",function(t){return e.model.marker.isHighlighted(t)?1:e.someSelected?o[t[a]]?1:l:n?.3:s}),this.entityLabels.style("opacity",function(t){return e.model.marker.isHighlighted(t)?t.sortValue=1:(t.sortValue=0,e.someSelected?o[t[a]]?1:l:n?.3:s)}).attr("pointer-events",function(t){return e.someSelected&&e.nonSelectedOpacityZero&&!o[t[a]]?(t.hidden=!0,"none"):(t.hidden=!1,"visible")}).sort(function(t,e){return d3.ascending(t.sortValue,e.sortValue)})},zoomToMaxMin:function(){null!=this.model.marker.axis_x.getZoomedMin()&&null!=this.model.marker.axis_x.getZoomedMax()&&(this.xScale.domain([this.model.marker.axis_x.getZoomedMin(),this.model.marker.axis_x.getZoomedMax()]),this.xAxisEl.call(this.xAxis)),null!=this.model.marker.axis_y.getZoomedMin()&&null!=this.model.marker.axis_y.getZoomedMax()&&((this.model.marker.axis_y.getZoomedMin()<=0||this.model.marker.axis_y.getZoomedMax()<=0)&&"log"==this.model.marker.axis_y.scaleType?(this.yScale=d3.scaleGenericlog().domain([this.model.marker.axis_y.getZoomedMin(),this.model.marker.axis_y.getZoomedMax()]).range(this.yScale.range()),this.model.marker.axis_y.scale=d3.scaleGenericlog().domain([this.model.marker.axis_y.getZoomedMin(),this.model.marker.axis_y.getZoomedMax()]).range(this.yScale.range()),this.yScale=this.model.marker.axis_y.scale):this.yScale.domain([this.model.marker.axis_y.getZoomedMin(),this.model.marker.axis_y.getZoomedMax()]),this.yAxisEl.call(this.yAxis))},getNearestKey:function(t,e,i,a){var s=this.KEYS,l=Object.keys(e);this.someSelected&&this.nonSelectedOpacityZero&&(l=this.model.marker.select.map(function(t){return p.getKey(t,s)}));for(var n=l[0],o=1;o<l.length;o++){var r=l[o];Math.abs((a?a(i[r]):i[r])-t)<Math.abs((a?a(i[n]):i[n])-t)&&(n=r)}return n}});e.default=d},function(t,e){t.exports='\x3c!-- LineChart Component --\x3e\n<div class="vzb-linechart">\n    <svg class="vzb-linechart-svg vzb-export">\n        <g class="vzb-lc-graph">\n\n            <svg class="vzb-lc-axis-x"><g></g></svg>\n            <svg class="vzb-lc-axis-y"><g></g></svg>\n            <text class="vzb-lc-axis-x-value"></text>\n            <text class="vzb-lc-axis-y-value"></text>\n            <svg class="vzb-lc-lines-crop">\n                <svg class="vzb-lc-lines"></svg>\n                <line class="vzb-lc-projection-x"></line>\n                <line class="vzb-lc-projection-y"></line>\n            </svg>\n            <svg class="vzb-lc-labels-crop">\n                <g class="vzb-lc-labels">\n                    <line class="vzb-lc-vertical-now"></line>\n                </g>\n            </svg>\n\n            <g class="vzb-lc-axis-y-title"></g>\n            <g class="vzb-lc-axis-x-title"></g>\n            <g class="vzb-lc-axis-y-info"></g>\n\n            <g class="vzb-data-warning vzb-noexport">\n                <svg></svg>\n                <text></text>\n            </g>\n\n\n            \x3c!--filter id="vzb-lc-filter-dropshadow"> \n              <feOffset result="offOut" in="SourceGraphic" dx="0" dy="2" />\n              <feColorMatrix result = "matrixOut" in = "offOut" type = "matrix"\n                             values = "0.3 .0 .0 .0 .0\n                                       .0 .3 .0 .0 .0\n                                       .0 .0 .3 .0 .0\n                                       1.0 1.0 1.0 1.0 .0"/>\n              <feGaussianBlur result="blurOut" in="matrixOut" stdDeviation="0.8" />\n              <feBlend in="SourceGraphic" in2="blurOut" mode="normal" />\n            </filter--\x3e\n\n        </g>\n        <rect class="vzb-lc-forecastoverlay vzb-hidden" x="0" y="0" width="100%" height="100%" fill="url(#vzb-lc-pattern-lines)" pointer-events=\'none\'></rect>\n    </svg>\n    <div class="vzb-tooltip vzb-hidden"></div>\n    <svg>\n      <defs>\n          <pattern id="vzb-lc-pattern-lines" x="0" y="0" patternUnits="userSpaceOnUse" width="50" height="50" viewBox="0 0 10 10"> \n              <path d=\'M-1,1 l2,-2M0,10 l10,-10M9,11 l2,-2\' stroke=\'black\' stroke-width=\'3\' opacity=\'0.08\'/>\n          </pattern> \n      </defs>\n    </svg>\n</div>\n'}]);
//# sourceMappingURL=linechart.min.js.map